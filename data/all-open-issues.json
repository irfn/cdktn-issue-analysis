[{"assignees":[],"author":{"id":"MDQ6VXNlcjQ0ODYwNTI=","is_bot":false,"login":"jvyang","name":"JV Yang"},"body":"### Expected Behavior\n\n`npm audit` passes without vulnerabilities.\n\n### Actual Behavior\n\n`npm audit` fails with vulnerabilities.\n\n- glob CLI: Command injection via -c/--cmd executes matches with shell:true ([CVE-2025-64756](https://github.com/advisories/GHSA-5j98-mcp5-4vw2))\n- brace-expansion Regular Expression Denial of Service vulnerability ([CVE-2025-5889](https://github.com/advisories/GHSA-v6h2-p8h4-qcjw))\n\n### Steps to Reproduce\n\n`npm install` or `npm audit`\n\n### Versions\n\nlanguage: typescript\nnode: 24\ncdktf: 0.21.0\n\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\nBump `glob` to `10.5.0`.\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-12-03T18:56:05Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3947,"title":"CVE-2025-64756: Bump glob dependency to 10.5.0","updatedAt":"2025-12-09T17:30:46Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjkwMTE2NTQ=","is_bot":false,"login":"arruw","name":"mmav"},"body":"### Expected Behavior\n\nHCL files generated\n\n### Actual Behavior\n\n```\n$ cdktf synth --hcl --log-level info\nruntime: out of memory: cannot allocate 792723456-byte block (3279781888 in use)\nfatal error: out of memory\n\ngoroutine 6 [running]:\nruntime.throw({0x3f240, 0xd})\n        /opt/golang/go/src/runtime/panic.go:992 +0x7 fp=0x4fd5c0 sp=0x4fd598 pc=0x12080007\nruntime.(*mcache).allocLarge(0x270108, 0x2f10a000, 0x0)\n        /opt/golang/go/src/runtime/mcache.go:215 +0x31 fp=0x4fd610 sp=0x4fd5c0 pc=0x10e80031\nruntime.mallocgc(0x2f10a000, 0x2a2e0, 0x1)\n        /opt/golang/go/src/runtime/malloc.go:1096 +0x8b fp=0x4fd690 sp=0x4fd610 pc=0x109f008b\nruntime.growslice(0x2a2e0, {0xaa000000, 0x646700, 0x646700}, 0x646701)\n        /opt/golang/go/src/runtime/slice.go:278 +0x89 fp=0x4fd6e0 sp=0x4fd690 pc=0x12c80089\ngithub.com/hashicorp/hcl/v2/hclsyntax.(*tokenAccum).emitToken(0x4fdb20, 0xbb, 0x27c9fad, 0x27c9fae)\n        /github/home/go/pkg/mod/github.com/hashicorp/hcl/v2@v2.19.1/hclsyntax/token.go:154 +0x14 fp=0x4fd7e8 sp=0x4fd6e0 pc=0x1ac60014\ngithub.com/hashicorp/hcl/v2/hclsyntax.scanTokens.func1(...)\n        scan_tokens.rl:348\ngithub.com/hashicorp/hcl/v2/hclsyntax.scanTokens({0xc00000, 0x4eb5709, 0x4eb6000}, {0x0, 0x0}, {0x1, 0x1, 0x0}, 0x0)\n        scan_tokens.rl:86 +0x120 fp=0x4fdb88 sp=0x4fd7e8 pc=0x1ac40120\ngithub.com/hashicorp/hcl/v2/hclsyntax.LexConfig({0xc00000, 0x4eb5709, 0x4eb6000}, {0x0, 0x0}, {0x1, 0x1, 0x0})\n        /github/home/go/pkg/mod/github.com/hashicorp/hcl/v2@v2.19.1/hclsyntax/public.go:129 +0x2 fp=0x4fdc08 sp=0x4fdb88 pc=0x1ac30002\ngithub.com/hashicorp/hcl/v2/hclwrite.lexConfig({0xc00000, 0x4eb5709, 0x4eb6000})\n        /github/home/go/pkg/mod/github.com/hashicorp/hcl/v2@v2.19.1/hclwrite/parser.go:639 +0x2 fp=0x4fdd58 sp=0x4fdc08 pc=0x1ad40002\ngithub.com/hashicorp/hcl/v2/hclwrite.Format({0xc00000, 0x4eb5709, 0x4eb6000})\n        /github/home/go/pkg/mod/github.com/hashicorp/hcl/v2@v2.19.1/hclwrite/public.go:42 +0x2 fp=0x4fddc0 sp=0x4fdd58 pc=0x1ad50002\nmain.main.func1({{}, 0x0, 0x0}, {0x42c120, 0x1, 0x2})\n        /__w/terraform-cdk/terraform-cdk/packages/@cdktf/hcl-tools/main.go:58 +0x7 fp=0x4fde00 sp=0x4fddc0 pc=0x1ae20007\nmain.registrationWrapper.func1({{}, 0x0, 0x0}, {0x42c120, 0x2, 0x2})\n        /__w/terraform-cdk/terraform-cdk/packages/@cdktf/hcl-tools/main.go:27 +0x5 fp=0x4fdec0 sp=0x4fde00 pc=0x1ae00005\nsyscall/js.handleEvent()\n        /opt/golang/go/src/syscall/js/func.go:94 +0x26 fp=0x4fdf90 sp=0x4fdec0 pc=0x15840026\nruntime.handleEvent()\n        /opt/golang/go/src/runtime/lock_js.go:243 +0x14 fp=0x4fdfe0 sp=0x4fdf90 pc=0x10960014\nruntime.goexit()\n        /opt/golang/go/src/runtime/asm_wasm.s:401 +0x1 fp=0x4fdfe8 sp=0x4fdfe0 pc=0x13c80001\ncreated by runtime.beforeIdle\n        /opt/golang/go/src/runtime/lock_js.go:199 +0x1a\n\ngoroutine 1 [chan receive]:\nexit code: 2\n```\n\n### Steps to Reproduce\n\n1. Have huge monorepo workspace managing DataDog resources (10k+ resources)\n2. Run `cdktf synth --hcl --log-level info`\n\n### Versions\n\nWe are using `uv` and not `pipenv`, seems like `cdktf debug` have strong dependency on `pipenv`:\n```\n$ cdktf debug\n[2025-11-27T20:36:09.649] [ERROR] default - Loading .env environment variables...\n\nLoading .env environment variables...\n[2025-11-27T20:36:09.650] [ERROR] default - WARNING:pipenv.vendor.dotenv.main:Python-dotenv could not parse statement starting at line 1\nWARNING:pipenv.vendor.dotenv.main:Python-dotenv could not parse statement starting at line 2\nCourtesy Notice:\nPipenv found itself running within a virtual environment,  so it will \nautomatically use that environment, instead of  creating its own for any \nproject. You can set\nPIPENV_IGNORE_VIRTUALENVS=1 to force pipenv to ignore that environment and \ncreate  its own instead.\nYou can set PIPENV_VERBOSITY=-1 to suppress this warning.\n\nWARNING:pipenv.vendor.dotenv.main:Python-dotenv could not parse statement starting at line 1\nWARNING:pipenv.vendor.dotenv.main:Python-dotenv could not parse statement starting at line 2\nCourtesy Notice:\nPipenv found itself running within a virtual environment,  so it will \nautomatically use that environment, instead of  creating its own for any \nproject. You can set\nPIPENV_IGNORE_VIRTUALENVS=1 to force pipenv to ignore that environment and \ncreate  its own instead.\nYou can set PIPENV_VERBOSITY=-1 to suppress this warning.\n[2025-11-27T20:36:10.252] [ERROR] default - WARNING: Package(s) not found: cdktf\n\nWARNING: Package(s) not found: cdktf\n[2025-11-27T20:36:10.861] [ERROR] default - WARNING: Package(s) not found: cdktf\n\nWARNING: Package(s) not found: cdktf\n```\n\n```\ncdktf --version\n0.21.0\n\n$ terraform --version\nTerraform v1.11.4\non darwin_arm64\n\n$ python --version\nPython 3.9.24\n\n$ node --version\nv24.7.0\n```\n\n### Providers\n\n`cdktf provider list` fails with similar error as `cdktf debug`\n\nwe use only one tf provider:\n* \"cdktf-cdktf-provider-datadog>=12.10.0\"\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-11-27T20:45:18Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3945,"title":"cdktf synth out of memory","updatedAt":"2025-11-27T20:45:18Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjI2MzAzNzU0","is_bot":false,"login":"gsy0911","name":"Y.Hashimoto"},"body":"### Expected Behavior\n\nDeploying code below, I want to add `SNOWFLAKE.NETWORK_SECURITY.GITHUBACTIONS_GLOBAL` to `CUSTOM_NETWORK_POLICY` by cdktf.\n\n\n```\nimport { Construct } from \"constructs\";\nimport { App, TerraformStack } from \"cdktf\";\nimport {\n  provider,\n  networkPolicy,\n  accountRole,\n  serviceUser,\n  grantAccountRole,\n  grantPrivilegesToAccountRole,\n} from \"@cdktf/provider-snowflake\";\nimport { S3Backend } from \"cdktf\";\n\n\nclass NetworkPolicyStack extends TerraformStack {\n  constructor(scope: Construct, id: string) {\n    super(scope, id);\n\n    new S3Backend(this, {\n      bucket,\n      key: \"tf-snowflake-network-policy/terraform.tfstate\",\n      region: \"ap-northeast-1\",\n      encrypt: true,\n    });\n\n    new provider.SnowflakeProvider(this, \"Snowflake\", {\n      organizationName: process.env.SNOWFLAKE_ORGANIZATION,\n      accountName: process.env.SNOWFLAKE_ACCOUNT,\n      user: \"SERVICE_USER_NAME\",\n      role: \"SERVICE_ROLE_NAME\",\n      authenticator: \"SNOWFLAKE_JWT\",\n      privateKey: (process.env.SNOWFLAKE_PRIVATE_KEY || \"\").replace(/\\\\n/g, \"\\n\"),\n      privateKeyPassphrase: process.env.SNOWFLAKE_PRIVATE_KEY_PASSPHRASE,\n    });\n\n    new networkPolicy.NetworkPolicy(this, \"NetworkPolicy\", {\n      name: \"CUSTOM_NETWORK_POLICY\",\n      comment: \"network\",\n      allowedIpList: [],\n      blockedIpList: [],\n      allowedNetworkRuleList: [\"SNOWFLAKE.NETWORK_SECURITY.GITHUBACTIONS_GLOBAL\"],\n    });\n  }\n}\n```\n\nWhen I add `SNOWFLAKE.NETWORK_SECURITY.GITHUBACTIONS_GLOBAL` to `CUSTOM_NETWORK_POLICY` on snowflake query console, it works successfully\n\n```\nALTER NETWORK POLICY CUSTOM_NETWORK_POLICY ADD ALLOWED_NETWORK_RULE_LIST = (\n  'SNOWFLAKE.NETWORK_SECURITY.GITHUBACTIONS_GLOBAL'\n);\n```\n\n\n### Actual Behavior\n\nWhen I deploy code above, an error occurred.\n\n```\ntf-snowflake-network-policy  snowflake_network_policy.NetworkPolicy: Modifying... [id=CUSTOM_NETWORK_POLICY]\ntf-snowflake-network-policy  â•·\n                             â”‚ Error: [errors.go:23] object does not exist or not authorized\n                             â”‚\n                             â”‚   with snowflake_network_policy.NetworkPolicy (NetworkPolicy),\n                             â”‚   on cdk.tf.json line 43, in resource.snowflake_network_policy.NetworkPolicy (NetworkPolicy):\n                             â”‚   43:       }\n                             â”‚\n                             â•µ\n```\n\n>  [errors.go:23] object does not exist or not authorized\n\naccording to the error message, I've checked\n\n- `CUSTOM_NETWORK_POLICY` exists\n- cdktf-deploying-role owns `CUSTOM_NETWORK_POLICY`\n\n\n\n### Steps to Reproduce\n\n```\n$ npx cdktf synth\n$ npx cdktf deploy `stack-name` --auto-approve\n``` \n\n### Versions\n\nlanguage: typescript\ncdktf-cli: 0.21.0\nnode: v24.11.1\ncdktf: 0.21.0\nconstructs: 10.4.3\njsii: null\nterraform: 1.14.0\narch: arm64\nos: darwin 25.1.0\nproviders\n@cdktf/provider-snowflake (PREBUILT)\n        terraform provider version: 2.11.0\n        prebuilt provider version: 15.9.0\n        cdktf version: ^0.21.0\n\n### Providers\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Provider Name         â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name              â”‚ Package Version â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ snowflakedb/snowflake â”‚ 2.11.0           â”‚ ^0.21.0 â”‚            â”‚ @cdktf/provider-snowflake â”‚ 15.9.0          â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\nNo, I couldn't find anything.\n\n### Anything Else?\n\n_No response_\n\n### References\n\nI haven't found related issues.\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-11-26T12:57:50Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3944,"title":"`snowflake`: networkPolicy.NetworkPolicy failed to add `allowedNetworkRuleList`","updatedAt":"2025-12-03T13:43:32Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjQzMjg2MTQ0","is_bot":false,"login":"98claes98","name":"Claes Andersson"},"body":"The azurerm package for .NET is failing in the pipeline when being published. The API key for the NuGet feed is invalid. The latest version available is 14.12.0 which is preventing us from upgrading our application. When will this issue be fixed?","comments":[{"id":"IC_kwDODd1Amc7W9hOb","author":{"login":"claes-andersson-odevo"},"authorAssociation":"NONE","body":"@team-tf-cdk @mutahhir @xiehan can you check on this? We can't update NuGet packages because of this.","createdAt":"2025-12-03T11:39:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3943#issuecomment-3606451099","viewerDidAuthor":false}],"createdAt":"2025-11-20T17:58:46Z","labels":[],"milestone":null,"number":3943,"title":"`azurerm` provider: Package fails to publish to NuGet feed in pipeline","updatedAt":"2025-12-03T11:39:47Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjcxNzk1ODI1","is_bot":false,"login":"sawaryu","name":"Ryuya Sawaki"},"body":"In CDK for Terraform (cdktf) Google Provider version 6.50.0, the subnetwork field under google_container_node_pool.network_config is not implemented in the TypeScript type definitions.\n\nWhile the Terraform Google Provider itself supports this field as per its documentation, the cdktf TypeScript bindings lack the type definition, making it impossible to use network_config.subnetwork with proper type safety in cdktf code.\n\nExpected behavior:\n\nThe subnetwork property within network_config should have a corresponding TypeScript type definition.\n\nThis would allow users of cdktf to set the subnetwork field on the google_container_node_pool resource with type safety.\n\nActual behavior:\n\nThe missing type causes compilation errors or absence of type checking when attempting to use network_config.subnetwork.\n\nEnvironment:\n\n@cdktf/provider-google version: 16.12.0\n\nPlease consider adding the missing type definition for this field in the cdktf Google Provider package.","comments":[],"createdAt":"2025-11-13T05:57:13Z","labels":[],"milestone":null,"number":3942,"title":"`google` provider: subnetwork field in google_container_node_pool.network_config missing in cdktf TypeScript Google Provider v6.50.0","updatedAt":"2025-11-13T05:57:13Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUwMzM5NDg=","is_bot":false,"login":"paulannetts","name":"Paul Annetts"},"body":"### Expected Behavior\n\nCDKTF should handle inline comments in variable type definitions gracefully, either by:\n1. Stripping comments before parsing type definitions, or\n2. Parsing the type definition in a way that ignores comments\n\nThe Terraform CLI itself has no issues with this syntax, as inline comments are valid HCL.\n\n### Actual Behavior\n\nCDKTF fails with an \"unknown type\" error and cannot generate the module bindings.\n\n### Steps to Reproduce\n\n1. Create a `cdktf.json` with:\n```json\n{\n  \"language\": \"python\",\n  \"terraformModules\": [\n    {\n      \"name\": \"karpenter\",\n      \"source\": \"terraform-aws-modules/eks/aws//modules/karpenter\",\n      \"version\": \"~> 21.0\"\n    }\n  ]\n}\n```\n\n2. Run `cdktf get`\n3. Observe the error\n\n### Versions\n\npython: Python 3.11.12\npip: pip 25.3 from ... python 3.11)\npipenv: null\nproviders\ncdktf-cdktf-provider-aws (PREBUILT)\n        terraform provider version: 6.19.0 \n        prebuilt provider version: 21.16.0\n        cdktf version: ^0.21.0\ncdktf-cdktf-provider-helm (PREBUILT)\n        terraform provider version: 3.0.2 \n        prebuilt provider version: 12.0.1\n        cdktf version: ^0.21.0\ncdktf-cdktf-provider-kubernetes (PREBUILT)\n        terraform provider version: 2.38.0 \n        prebuilt provider version: 12.1.0\n        cdktf version: ^0.21.0\ncdktf-cdktf-provider-time (PREBUILT)\n        terraform provider version: 0.13.1 \n        prebuilt provider version: 11.0.0\n        cdktf version: ^0.21.0\n\n### Providers\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n\n Provider Name â”‚ Provider Versionâ”‚ CDKTF  â”‚ Constraintâ”‚ Package Name                    Package Version â”‚\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n\n aws           â”‚ 6.19.0          â”‚ ^0.21.0â”‚           â”‚ cdktf-cdktf-provider-aws        21.16.0         â”‚\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n\n helm          â”‚ 3.0.2           â”‚ ^0.21.0â”‚           â”‚ cdktf-cdktf-provider-helm       12.0.1          â”‚\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n\n kubernetes    â”‚ 2.38.0          â”‚ ^0.21.0â”‚           â”‚ cdktf-cdktf-provider-kubernetes 12.1.0          â”‚\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n\n time          â”‚ 0.13.1          â”‚ ^0.21.0â”‚           â”‚ cdktf-cdktf-provider-time       11.0.0          â”‚\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n\n\n\n### Workarounds\n\nPin the module to a version before the inline comment was added:\n```json\n{\n  \"name\": \"karpenter\",\n  \"source\": \"terraform-aws-modules/eks/aws//modules/karpenter\",\n  \"version\": \"21.4.0\"\n}\n```\n\n### Anything Else?\n\n### Error Output\n```\nError: unknown type list(object({ # TODO - change to `map(object({...\n    at cL (/Users/paulannetts/.nvm/versions/node/v22.20.0/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:112:1008)\n    at lL.emitSubmodule (/Users/paulannetts/.nvm/versions/node/v22.20.0/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:112:2380)\n    at new lL (/Users/paulannetts/.nvm/versions/node/v22.20.0/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:112:1493)\n    at Pre.generateTypescriptModule (/Users/paulannetts/.nvm/versions/node/v22.20.0/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:114:76332)\n    at Pre.generateTypescript (/Users/paulannetts/.nvm/versions/node/v22.20.0/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:114:76559)\n    at /Users/paulannetts/.nvm/versions/node/v22.20.0/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:117:618\n    at Array.map (<anonymous>)\n    at Pre.generate (/Users/paulannetts/.nvm/versions/node/v22.20.0/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:117:606)\n    at async kMe (/Users/paulannetts/.nvm/versions/node/v22.20.0/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:197:3611)\n```\n\n### Root Cause\n\nThe issue occurs in the `terraform-aws-modules/eks/aws//modules/karpenter` module (v21.5.0+) at line 121 of `modules/karpenter/variables.tf`:\n\n```hcl\nvariable \"iam_policy_statements\" {\n  description = \"A list of IAM policy [statements](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document#statement) - used for adding specific IAM permissions as needed\"\n  type = list(object({ # TODO - change to `map(object({...}))` in next major version\n    sid           = optional(string)\n    actions       = optional(list(string))\n    not_actions   = optional(list(string))\n    effect        = optional(string)\n    resources     = optional(list(string))\n    not_resources = optional(list(string))\n    principals = optional(list(object({\n      type        = string\n      identifiers = list(string)\n    })))\n    not_principals = optional(list(object({\n      type        = string\n      identifiers = list(string)\n    })))\n    condition = optional(list(object({\n      test     = string\n      values   = list(string)\n      variable = string\n    })))\n  }))\n  default = null\n}\n```\n\nThe inline comment `# TODO - change to map(object({...}))` in the type definition causes CDKTF's parser to fail, even though this is valid HCL syntax that Terraform CLI handles without issues.\n\n**Source:** https://github.com/terraform-aws-modules/terraform-aws-eks/blob/v21.8.0/modules/karpenter/variables.tf#L121\n\n### Related Issues\n\nThis is similar to #928 (unknown type set(string)) but the root cause is different - it's not an unsupported type, but the parser failing to handle valid HCL comments within type definitions.\n\n### Impact\n\nThis issue can occur with any Terraform module that includes inline comments in variable type definitions. As module maintainers add documentation or TODO comments inline, more modules may become incompatible with CDKTF unless they're specifically aware of this limitation.\n\nThe parser should be made more robust to handle all valid HCL syntax, including inline comments in any context.\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-11-05T12:22:07Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3940,"title":"`cdktf get` fails with \"unknown type\" error when Terraform module contains inline comments in variable type definitions","updatedAt":"2025-11-05T12:22:07Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjMzNTk5Nzkx","is_bot":false,"login":"hoteye","name":"Dylan liu"},"body":"## Overview\n\nTerraform CDK CLI has multiple UI rendering issues that could be prevented with automated visual regression testing. Since CDKTF already uses Ink framework and has , implementing visual regression testing would be a natural next step to ensure consistent CLI experience.\n\n## Evidence of Current UI Problems\n\nMultiple open issues demonstrate recurring UI rendering problems:\n\n### Animation & Display Issues\n- **#2951**: \"disable animations via flag\" - CI environments show broken spinner animations:\n  \n- **#3503**: \"Fixed width output on deploy is unusable\" - Text wrapping makes output unreadable\n- **#2793**: \"Nicer output for cdktf synth if there are no stacks\" - Output formatting improvements needed\n- **#3041**: \"CLI hangs if interactive input is required\" - Interactive component issues\n\n### Technical Context\nCDKTF CLI already uses rich Ink ecosystem:\n-  (v3.2.0) - Main UI framework\n-  (v4.0.3) - Loading animations  \n-  (v4.2.2) - Selection components\n-  (v3.1.0) - Table displays\n-  (v2.1.0) - **Existing testing foundation**\n\n## Proposed Solution: Enhanced Visual Testing\n\nI recommend implementing [ink-visual-testing](https://github.com/hoteye/ink-visual-testing) alongside the existing  for comprehensive UI testing.\n\n### Why ink-visual-testing for CDKTF?\n\n- âœ… **Perfect compatibility**: Works with Ink v3+ (CDKTF uses v3.2.0)\n- âœ… **CI-focused**: Specifically designed to solve CI animation issues like #2951\n- âœ… **Easy integration**: Complements existing  setup\n- âœ… **Cross-platform consistency**: Bundled fonts ensure identical rendering across environments\n- âœ… **Real terminal rendering**: Uses node-pty for accurate CLI simulation\n\n### Implementation Benefits\n\n1. **Solve CI animation issues** (#2951) - Detect broken spinner rendering automatically\n2. **Prevent layout problems** (#3503) - Catch width/wrapping issues before release  \n3. **Ensure component stability** - Verify ink-table, ink-select-input display correctly\n4. **Cross-platform consistency** - Identical rendering on Mac/Linux/Windows/CI\n5. **Release confidence** - Visual baselines prevent UI regressions\n\n### Example Implementation\n\n```typescript\nimport { fixedPtyRender, getCIOptimizedConfig } from 'ink-visual-testing';\n\n// Test main CDKTF CLI commands\ndescribe('CDKTF CLI Visual Tests', () => {\n  it('should render help command correctly', async () => {\n    await fixedPtyRender(\n      './dist/bin/cdktf.js',\n      './tests/__output__/help-command.png',\n      {\n        ...getCIOptimizedConfig(), // Solves CI animation issues\n        args: ['--help'],\n        cols: 120,\n        rows: 40\n      }\n    );\n  });\n\n  it('should handle synth output properly', async () => {\n    await fixedPtyRender(\n      './dist/bin/cdktf.js', \n      './tests/__output__/synth-command.png',\n      {\n        ...getCIOptimizedConfig(),\n        args: ['synth'],\n        cols: 100,\n        rows: 30\n      }\n    );\n  });\n});\n```\n\n### Recommended Test Coverage\n\n1. **Core commands**: `cdktf deploy`, `cdktf synth`, `cdktf init`\n2. **Interactive components**: Selection prompts, confirmation dialogs\n3. **Progress displays**: Spinners, progress bars, status tables\n4. **Error states**: Error messages, warnings, validation output\n5. **Different terminal sizes**: Narrow (80 cols) to wide (120+ cols)\n6. **CI environment**: Animation-free rendering for automation\n\n### Integration with Existing Testing\n\nVisual testing would complement existing tools:\n- **ink-testing-library**: Continue for unit/component testing\n- **ink-visual-testing**: Add for integration/regression testing\n- **Jest**: Orchestrate both types of tests\n\n```typescript\n// Existing unit test (keep these)\nimport { render } from 'ink-testing-library';\n\n// New visual test (add these)\nimport { visualTest } from 'ink-visual-testing';\n\ndescribe('Deploy Command', () => {\n  // Unit test - fast, logic verification\n  it('should render deploy status', () => {\n    const { lastFrame } = render(<DeployStatus status=\"deploying\" />);\n    expect(lastFrame()).toContain('Deploying');\n  });\n\n  // Visual test - end-to-end, regression protection  \n  it('should display deploy output correctly', async () => {\n    await visualTest('deploy-output', './fixtures/deploy-command.tsx', {\n      cols: 100,\n      rows: 25\n    });\n  });\n});\n```\n\n## Technical Support Offer\n\nI'm the author of ink-visual-testing and would be happy to provide comprehensive technical support for implementing visual regression testing in CDKTF:\n\n1. **Integration guidance** - Help set up visual tests alongside existing ink-testing-library\n2. **CI optimization** - Specifically address #2951 animation issues in CI environments  \n3. **Baseline establishment** - Assist with creating initial visual baselines for key commands\n4. **Performance optimization** - Ensure tests run efficiently in CI/CD pipelines\n5. **Component-specific testing** - Handle complex Ink components like tables and spinners\n\n## Expected Impact\n\n- **Solve CI animation issues** (#2951) through consistent, animation-free CI rendering\n- **Prevent layout regressions** (#3503) with automated width/formatting checks\n- **Improve developer confidence** with visual baselines for UI changes\n- **Better user experience** through consistent CLI appearance across platforms\n- **Faster debugging** of UI issues with visual diff images\n\n## Next Steps\n\nIf you're interested in exploring this approach, I'm available for:\n- Technical discussion on integration strategy\n- Demo/proof of concept implementation\n- Documentation and best practices guidance\n- Long-term maintenance and support\n\nThis would significantly enhance CDKTF's reliability and solve existing UI pain points while building on your current testing infrastructure.\n\n---\n\n*Note: ink-visual-testing successfully prevents similar UI issues in other Ink-based CLIs. It's specifically designed to work alongside ink-testing-library for comprehensive testing coverage.*","comments":[],"createdAt":"2025-10-18T09:09:32Z","labels":[],"milestone":null,"number":3938,"title":"Implement Visual Regression Testing for Ink UI Components to Prevent CLI Display Issues","updatedAt":"2025-10-18T09:09:32Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEyNzE3OTU4","is_bot":false,"login":"supersmo","name":""},"body":"It would be great if a new pre-built package could be published.\nThe current pre-build is on 6.5.0 while the latest available is 7.7.0.","comments":[],"createdAt":"2025-10-16T12:46:48Z","labels":[],"milestone":null,"number":3937,"title":"`google` provider: Update to newer provider. Current pre-build: 6.50.0. Latest available 7.7.0","updatedAt":"2025-10-16T12:46:48Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjY2MDM0ODgx","is_bot":false,"login":"davidwegs","name":"David Wegsman"},"body":"### Expected Behavior\n\nUpdated versions of the cdktf-provider-azurerm library should be published to the Maven Central repository as they get released.\n\n### Actual Behavior\n\nRelease pipelines have been failing to publish new versions of the pre-built azurerm provider to Maven Central and NuGet Gallery for the past few months. The most recent version in Maven Central is 14.3.0, uploaded June 21, 2025. Failures are caused by a 403 Forbidden error when trying to push to the repository.\n\n### Steps to Reproduce\n\nRerun the release pipeline\n\n### Versions\n\nN/A\n\n### Providers\n\n_No response_\n\n### Gist\n\nhttps://gist.github.com/davidwegs/33b85384d85eb75aa17ee4d0ff624cca\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\nhttps://github.com/cdktf/cdktf-provider-azurerm/issues/2041\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc7KpvgY","author":{"login":"gpshonik"},"authorAssociation":"NONE","body":"Could someone please take a look at the nuget API key? Looks like it might have expired. Thanks!\n\nhttps://github.com/cdktf/cdktf-provider-azurerm/actions/runs/18212766880/job/51856727215\n\n<img width=\"1187\" height=\"249\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/e7bdcc69-3807-4dd8-8355-31f091d21038\" />\n\n\nMaven Central Publish step is returning a `403 Forbidden` as well.\n ","createdAt":"2025-10-14T03:06:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3935#issuecomment-3399940120","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7MKKIc","author":{"login":"salvianreynaldi"},"authorAssociation":"NONE","body":"I'm using CDKTF - java, and am facing this issue as well. it seems the issue is on authenticating to the maven repository.\nNot sure if this is related, but the repository they're using reached EoL: https://hashicorp.oss.sonatype.org/#welcome\n\nHope this would be fixed soon..","createdAt":"2025-10-21T07:41:58Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3935#issuecomment-3425215004","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7M4Ss0","author":{"login":"benkeil"},"authorAssociation":"NONE","body":"There are no update since end of June. @skorfmann is this somewhere on a roadmap? Because a lot of people are using the `terraform-aws-modules` modules, which all require a newer AWS provider version.","createdAt":"2025-10-23T14:22:50Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3935#issuecomment-3437308724","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7W9eMk","author":{"login":"claes-andersson-odevo"},"authorAssociation":"NONE","body":"@team-tf-cdk @mutahhir @xiehan can you check on this? We can't update NuGet packages because of this.","createdAt":"2025-12-03T11:36:10Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3935#issuecomment-3606438692","viewerDidAuthor":false}],"createdAt":"2025-10-08T21:31:05Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"}],"milestone":null,"number":3935,"title":"azurerm: Updates not publishing to Maven Central","updatedAt":"2025-12-03T11:38:47Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjYwODIyMA==","is_bot":false,"login":"scott-brady","name":"Scott Brady"},"body":"### Expected Behavior\n\nRequesting to re-open #3834 \n\nThis was closed with a workaround but the workaround isn't going to work for us, so requesting this get resolved without the need for a workaround.\n\nThanks to @chrisdrobison for raising this originally. Copying their original issue details below.\n\n---\nAdd support for using the new S3 locking state capability. This is documented here:\n\nhttps://developer.hashicorp.com/terraform/language/backend/s3\n\n### Actual Behavior\n\nReceiving the following warning when deploying using S3 and an associated DynamoDB locking state table:\n\n```\nâ”‚ Warning: Deprecated Parameter\nâ”‚ \nâ”‚   with data.terraform_remote_state.cross-stack-reference-input-infra-services,\nâ”‚   on cdk.tf.json line 44, in data.terraform_remote_state.cross-stack-reference-input-infra-services:\nâ”‚   44:       }\nâ”‚ \nâ”‚ The parameter \"dynamodb_table\" is deprecated. Use parameter \"use_lockfile\"\nâ”‚ instead.\nâ”‚ \nâ”‚ (and 2 more similar warnings elsewhere)\n```\n\nThere doesn't appear to be support for setting this new property in CDKTF.\n\n### Steps to Reproduce\n\n1. Configure a stack to use an S3 backend with a DynamoDB table for locking state\n\n### Versions\n\n```\nlanguage: csharp\ncdktf-cli: 0.21.0\nnode: v22.20.0\ncdktf: 0.21.0\nconstructs: 10.4.2\njsii: 1.113.0\nterraform: 1.13.3\narch: arm64\nos: linux 6.14.0-1013-aws\ndotnet: 9.0.305\n```\n\n### Providers\n\n| Provider Name | Provider Version | CDKTF | Constraint | Package Name | Package Version |\n|-|-|-|-|-|-|\n| aws | 6.12.0 | ^0.21.0 | | HashiCorp.Cdktf.Providers.Aws | 21.10.0 |\n| helm | 3.0.2 | ^0.21.0 | | HashiCorp.Cdktf.Providers.Helm | 12.0.1 |\n| kubernetes | 2.38.0 | ^0.21.0 | | HashiCorp.Cdktf.Providers.Kubernetes | 12.1.0 |\n\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n- #3834 \n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc7IMW4n","author":{"login":"scott-brady"},"authorAssociation":"NONE","body":"For more context on why the workaround isn't going to work -\n\nWe create the `S3BackendConfig` in a shared library in order to centralise the S3 bucket and IAM role settings, then call a library method to create the config and pass it into an `S3Backend` constructor, e.g.:\n\n```csharp\nvar s3BackendConfig = config.DefineS3BackendConfig(StackTaxonomyPath);\nif (s3BackendConfig != null)\n{\n    _ = new S3Backend(this, s3BackendConfig);\n}\n```\n\nThe above code is part of our templates and included in every repo. We could add the override per the workaround on #3834 as follows:\n\n```csharp\nvar s3BackendConfig = config.DefineS3BackendConfig(StackTaxonomyPath);\nif (s3BackendConfig != null)\n{\n    var s3Backend = new S3Backend(this, s3BackendConfig);\n    s3Backend.AddOverride(\"use_lockfile\", true);\n}\n```\n\nThis would work but we would need to apply this to every repo. Then if/when resolved via a new `UseLockfile` property on `S3BackendConfig`, we would need to remove it from every repo as well.\n\nFixing this upstream would save us this overhead.","createdAt":"2025-10-02T01:21:11Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3933#issuecomment-3358682663","viewerDidAuthor":false}],"createdAt":"2025-10-02T01:13:26Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3933,"title":"S3 dynamo state locking deprecated (re-open #3834)","updatedAt":"2025-10-02T01:21:11Z"},{"assignees":[],"author":{"id":"U_kgDOB2Qs0A","is_bot":false,"login":"HackedRico","name":"Ricky Chen"},"body":"### Expected Behavior\n\nWhen running CDKTF init from a Terraform Project Template in HCL, the generated CDKTF Typescript does not recognize Terraform Lifecycle `ignore_changes` field.\n\n<img width=\"901\" height=\"679\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/adc28209-1817-42c7-be9e-9f8fd6924351\" />\n\n### Actual Behavior\n\nGenerated CDKTF App properly handles Terraform Lifecycle fields.\n\n### Steps to Reproduce\n\n1. Create a Terraform Project with resources that uses Lifecycle feature. Sample Test Case: \n\n```terraform\nterraform {\n  required_providers {\n    aws = {\n      source = \"hashicorp/aws\"\n      version = \"6.14.1\"\n    }\n  }\n}\n\nprovider \"aws\" {\n}\n\nresource \"aws_instance\" \"example\" {\n  ami           = \"resolve:ssm:/aws/service/ami-amazon-linux-latest/al2023-ami-kernel-default-x86_64\"\n  instance_type = \"t3.micro\"\n\n  tags = {\n    Name = \"HelloWorld\"\n  }\n\n  lifecycle {\n    ignore_changes = [ tags ]\n  }\n}\n```\n\n2. Initialize CDKTF from Terraform Project template\n\n```bash\ncdktf init --template=typescript \\\n    --from-terraform-project=../terraform \\\n    --local \\\n    --providers=aws\n```\n\n3. Observe generated `main.ts` file for invalid lifecycle.\n\n### Versions\n\n```shell\ncdktf debug\nlanguage: typescript\ncdktf-cli: 0.21.0\nnode: v22.17.1\ncdktf: 0.21.0\nconstructs: 10.4.2\njsii: null\nterraform: 1.13.0\narch: x64\nos: darwin 24.6.0\nproviders\naws@6.14.1 (LOCAL)\n        terraform provider version: 6.14.1\n@cdktf/provider-aws (PREBUILT)\n        terraform provider version: 6.14.1 \n        prebuilt provider version: 21.11.1\n        cdktf version: ^0.21.0\n```\n\n### Providers\n\n```shell\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name        â”‚ Package Version â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ aws           â”‚ 6.14.1           â”‚         â”‚ 6.14.1     â”‚                     â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ aws           â”‚ 6.14.1           â”‚ ^0.21.0 â”‚            â”‚ @cdktf/provider-aws â”‚ 21.11.1         â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜```\n```\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\nFrom Terraform code converted to Typescript, create Lifecycle fields as String Arrays. The values are recognized, needs conversion to be string values.\n\n### Workarounds\n\nBased on the CDKTF Lifecycle Resource defined, it expects an string array. \n\n```typescript\nexport interface TerraformResourceLifecycle {\n    readonly createBeforeDestroy?: boolean;\n    readonly preventDestroy?: boolean;\n    readonly ignoreChanges?: string[] | \"all\";\n    readonly replaceTriggeredBy?: Array<ITerraformDependable | string>;\n    readonly precondition?: Precondition[];\n    readonly postcondition?: Postcondition[];\n}\n```\n\nWhereas, the CDKTF init from Template does not create an String array. It creates the following: \n```typescript\n      lifecycle: {\n        ignoreChanges: [ tags ],\n      },\n```\n\nI changed it to be an String and it worked, after change: \n\n```typescript\n      lifecycle: {\n        ignoreChanges: [ \"tags\" ],\n      },\n```\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [X] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-09-26T19:35:48Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3931,"title":"cdktf: HCL Lifecycle Objects not Found in Typescript","updatedAt":"2025-09-26T20:04:36Z"},{"assignees":[],"author":{"id":"U_kgDOB2Qs0A","is_bot":false,"login":"HackedRico","name":"Ricky Chen"},"body":"### Expected Behavior\n\nAfter running the following CDKTF init command, it should produce a working `main.ts` file. `../vbox-terraform` is an terraform project utilizing the VirtualBox Provider whereas initing from this project should have this provider in `main.ts`. Furthermore, there is an duplicate TerraformStack lib being imported which causes errors.\n\n```bash\ncdktf init --template=typescript \\\n    --from-terraform-project=../vbox-terraform \\\n    --local\n    --providers=local\n```\n\nThe result of the above command produces: \n```typescript\nimport { Construct } from \"constructs\";\nimport {\n  VariableType,\n  TerraformVariable,\n  TerraformCount,\n  TerraformOutput,\n  Fn,\n  TerraformStack, // Terraform Stack lib imported here already\n} from \"cdktf\";\n/*\n * Provider bindings are generated by running `cdktf get`.\n * See https://cdk.tf/provider-generation for more details.\n */\nimport { Vm } from \"./.gen/providers/virtualbox/vm\";\nimport { App, TerraformStack } from \"cdktf\"; // BUG: Duplicate Terraform Stack Import\n\nimport { VirtualboxProvider } from \"./.gen/providers/virtualbox/provider\";\n\nclass MyStack extends TerraformStack {\n  constructor(scope: Construct, id: string) {\n    super(scope, id);\n    new VirtualboxProvider(this, \"virtualbox\", {});\n    // existing code...\n  }\n}\n```\n\n### Actual Behavior\n\nA working `main.ts` to run `cdktf deploy` which does not have duplicate import of `TerraformStack` lib and has imported `VirtualboxProvider` lib.\n\nExpected:\n```typescript\nimport { Construct } from \"constructs\";\nimport {\n  VariableType,\n  TerraformVariable,\n  TerraformCount,\n  TerraformOutput,\n  Fn,\n  TerraformStack,\n} from \"cdktf\";\n/*\n * Provider bindings are generated by running `cdktf get`.\n * See https://cdk.tf/provider-generation for more details.\n */\nimport { Vm } from \"./.gen/providers/virtualbox/vm\";\nimport { App } from \"cdktf\"; // Fix: Removed Duplicate TerraformStack Lib\n\nimport { VirtualboxProvider } from \"./.gen/providers/virtualbox/provider\";\n\nclass MyStack extends TerraformStack {\n  constructor(scope: Construct, id: string) {\n    super(scope, id);\n    new VirtualboxProvider(this, \"virtualbox\", {});\n    // existing code...\n  }\n}\n```\n\n### Steps to Reproduce\n\n1. Create a directory with a test Terraform Project, a simple test could be:\n\n```terraform\nterraform {\n  required_providers {\n    virtualbox = {\n      source = \"terra-farm/virtualbox\"\n      version = \"0.2.2-alpha.1\"\n    }\n  }\n}\n\nprovider \"virtualbox\" {}\n\nresource \"virtualbox_vm\" \"single_vm\" {\n  name      = \"simple-vm\"\n  image     = \"https://app.vagrantup.com/ubuntu/boxes/bionic64/versions/20180903.0.0/providers/virtualbox.box\"\n  cpus      = 2\n  memory    = \"1024 mib\"\n\n  network_adapter {\n    type = \"bridged\"\n    host_interface = \"en0: Wi-Fi\"\n    device = \"IntelPro1000MTServer\"\n  }\n}\n```\n\n2. Run CDKTF init command on the created Terraform Project Directory \n\n```bash\ncdktf init --template=typescript \\\n    --from-terraform-project=<PATH-TO-TF-PROJECT> \\\n    --local\n    --providers=local\n```\n\n3. View generated CDKTF directory's `main.ts`\n\n### Versions\n\n```shell\ncdktf debug\nlanguage: typescript\ncdktf-cli: 0.21.0\nnode: v22.17.1\ncdktf: 0.21.0\nconstructs: 10.4.2\njsii: null\nterraform: 1.13.0\narch: x64\nos: darwin 24.6.0\nproviders\nterra-farm/virtualbox@0.2.2-alpha.1 (LOCAL)\n        terraform provider version: 0.2.2-alpha.1\n@cdktf/provider-local (PREBUILT)\n        terraform provider version: 2.5.3 \n        prebuilt provider version: 11.0.0\n        cdktf version: ^0.21.0\n\n```\n\n### Providers\n\n```shell\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Provider Name         â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint    â”‚ Package Name          â”‚ Package Version â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ terra-farm/virtualbox â”‚ 0.2.2-alpha.1    â”‚         â”‚ 0.2.2-alpha.1 â”‚                       â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ local                 â”‚ 2.5.3            â”‚ ^0.21.0 â”‚               â”‚ @cdktf/provider-local â”‚ 11.0.0          â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-09-24T17:40:28Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3930,"title":"cdktf: CDKTF init from Template Creates Duplicate/Missing Import Libs","updatedAt":"2025-09-26T19:43:26Z"},{"assignees":[],"author":{"id":"U_kgDOBpTnow","is_bot":false,"login":"hinling-blisspoint","name":""},"body":"### Expected Behavior\n\n`cdktf init --template=\"typescript\" --providers=\"aws\"` initialized with the typescript project skeleton. \n\n### Actual Behavior\n\nError out with `Error: Pre-built provider information not found`\n\n### Steps to Reproduce\n\n1. npm install -g cdktf-cli && npm install -g cdktf\n2. In an empty dir, run `cdktf init --template=\"typescript\" --providers=\"aws\"`\nHere's the log:\n```\ncdktf init --template=\"typescript\" --providers=\"aws\"\n? Project Name dd_alert_forwarder\n? Project Description A simple getting started project for cdktf.\n? Would you like to use Terraform Cloud? yes\n\nDetected Terraform Cloud token.\n\nWe will now set up Terraform Cloud for your project.\n\n? Terraform Cloud Organization Name <redacted>\n\nWe are going to create a new Terraform Cloud Workspace for your project.\n\n? Terraform Cloud Workspace Name dd_alert_forwarder\n? Do you want to start from an existing Terraform project? no\n\nSetting up a Cloud Backend for your project.\n? Do you want to send crash reports to the CDKTF team? Refer to \nhttps://developer.hashicorp.com/terraform/cdktf/create-and-deploy/configuration-file#enable-crash-reporting-for-the-cli for more information yes\n\nGenerating Terraform Cloud configuration for 'redacted' organization and 'dd_alert_forwarder' workspace.....\n\nadded 2 packages, and audited 102 packages in 5s\n\n28 packages are looking for funding\n  run `npm fund` for details\n\n1 low severity vulnerability\n\nTo address all issues, run:\n  npm audit fix\n\nRun `npm audit` for details.\nnpm WARN deprecated inflight@1.0.6: This module is not supported, and leaks memory. Do not use it. Check out lru-cache if you want a good and tested way to coalesce async requests by a key value, which is much more comprehensive and powerful.\nnpm WARN deprecated glob@7.2.3: Glob versions prior to v9 are no longer supported\n\nadded 325 packages, and audited 427 packages in 38s\n\n60 packages are looking for funding\n  run `npm fund` for details\n\n1 low severity vulnerability\n\nTo address all issues, run:\n  npm audit fix\n\nRun `npm audit` for details.\n========================================================================================================\n\n  Your CDKTF TypeScript project is ready!\n\n  cat help                Print this message\n\n  Compile:\n    npm run get           Import/update Terraform providers and modules (you should check-in this directory)\n    npm run compile       Compile typescript code to javascript (or \"npm run watch\")\n    npm run watch         Watch for changes and compile typescript in the background\n    npm run build         Compile typescript\n\n  Synthesize:\n    cdktf synth [stack]   Synthesize Terraform resources from stacks to cdktf.out/ (ready for 'terraform apply')\n\n  Diff:\n    cdktf diff [stack]    Perform a diff (terraform plan) for the given stack\n\n  Deploy:\n    cdktf deploy [stack]  Deploy the given stack\n\n  Destroy:\n    cdktf destroy [stack] Destroy the stack\n\n  Test:\n    npm run test        Runs unit tests (edit __tests__/main-test.ts to add your own tests)\n    npm run test:watch  Watches the tests and reruns them on change\n\n  Upgrades:\n    npm run upgrade        Upgrade cdktf modules to latest version\n    npm run upgrade:next   Upgrade cdktf modules to latest \"@next\" version (last commit)\n\n Use Providers:\n\n  You can add prebuilt providers (if available) or locally generated ones using the add command:\n  \n  cdktf provider add \"aws@~>3.0\" null kreuzwerker/docker\n\n  You can find all prebuilt providers on npm: https://www.npmjs.com/search?q=keywords:cdktf\n  You can also install these providers directly through npm:\n\n  npm install @cdktf/provider-aws\n  npm install @cdktf/provider-google\n  npm install @cdktf/provider-azurerm\n  npm install @cdktf/provider-docker\n  npm install @cdktf/provider-github\n  npm install @cdktf/provider-null\n\n  You can also build any module or provider locally. Learn more https://cdk.tf/modules-and-providers\n\n========================================================================================================\n\n[2025-09-16T10:16:50.631] [INFO] default - Checking whether pre-built provider exists for the following constraints:\n  provider: aws\n  version : latest\n  language: typescript\n  cdktf   : 0.21.0\n\nPre-built provider information not found\nError: Pre-built provider information not found\n    at HXt (/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:2716)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async MP (/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:2207)\n    at async UP (/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:3042)\n    at async YP (/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:4088)\n    at async VN.hasPrebuiltProvider (/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:172:183)\n    at async VN.addProvider (/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:8837)\n    at async Mse (/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:173:2071)\n    at async ojt (/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:173:140)\n    at async kze (/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:513:2980)\nCollecting Debug Information...\n/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/node_modules/yoga-layout-prebuilt/yoga-layout/build/Release/nbind.js:53\n        throw ex;\n        ^\n\nError: Pre-built provider information not found\n    at HXt (/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:2716)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async MP (/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:2207)\n    at async UP (/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:3042)\n    at async YP (/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:4088)\n    at async VN.hasPrebuiltProvider (/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:172:183)\n    at async VN.addProvider (/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:8837)\n    at async Mse (/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:173:2071)\n    at async ojt (/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:173:140)\n    at async kze (/Users/name/.nvm/versions/node/v20.12.2/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:513:2980)\n\nNode.js v20.12.2\n\n```\n\n### Versions\n\nlanguage: typescript\ncdktf-cli: 0.21.0\nnode: v20.12.2\ncdktf: 0.21.0\nconstructs: 10.4.2\njsii: null\nterraform: 1.9.8\narch: arm64\nos: darwin 23.6.0\nproviders\n\n\n### Providers\n\ncdktf provider list\nâ”Œâ”\nâ”‚â”‚\nâ””â”˜\nsince it's `cdktf init` in an empty dir, there is no provider list.\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc7Erh0x","author":{"login":"elovelan"},"authorAssociation":"NONE","body":"```\n$ curl -i https://www.cdk.tf/.well-known/prebuilt-providers.json\nHTTP/2 404 \ncache-control: public, max-age=0, must-revalidate\ncontent-type: text/plain; charset=utf-8\ndate: Tue, 16 Sep 2025 17:42:33 GMT\nserver: Vercel\nstrict-transport-security: max-age=63072000\nx-vercel-error: DEPLOYMENT_NOT_FOUND\nx-vercel-id: iad1::8w4jl-1758044553310-928a40e46c15\ncontent-length: 107\n\nThe deployment could not be found on Vercel.\n\nDEPLOYMENT_NOT_FOUND\n\niad1::8w4jl-1758044553310-928a40e46c15\n```","createdAt":"2025-09-16T17:42:50Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3929#issuecomment-3299745073","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7Erq_E","author":{"login":"elovelan"},"authorAssociation":"NONE","body":"not sure I'd recommend this, but manually changing the value in the source from `https://www.cdk.tf/.well-known/prebuilt-providers.json` to `https://raw.githubusercontent.com/cdktf/cdktf-repository-manager/main/provider.json` at least unblocks this issue.","createdAt":"2025-09-16T17:53:48Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3929#issuecomment-3299782596","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7ExRkQ","author":{"login":"jwharris38"},"authorAssociation":"NONE","body":"I also was having trouble with this today and spent quite some time messing around, had you not posted this I probably would still be losing my mind. Here is something that might help though fwiw. I found running cdktf init with the provider explicitly added in the providers param allowed the cdktf init to generate files.\n```powershell\nC:\\Users\\name\\helpme\\onemore> cdktf init --template=python --providers=\"aws@~>6.0\" --local\nNote: By supplying '--local' option you have chosen local storage mode for storing the state of your stack.\nThis means that your Terraform state file will be stored locally on disk in a file 'terraform.<STACK NAME>.tfstate' in the root of your project.\n? Project Name onemore\n? Project Description A simple getting started project for cdktf.\n? Do you want to send crash reports to the CDKTF team? Refer to https://developer.hashicorp.com/terraform/cdktf/create-and-deploy/configuration-file#enable-crash-reporting-for-the-cli for more information no\nPipfile.lock not found, creating...\nLocking  dependencies...\nLocking  dependencies...\nInstalling cdktf~=0.21.0...\nInstallation Succeeded\nTo activate this project's virtualenv, run pipenv shell.\nAlternatively, run a command inside the virtualenv with pipenv run.\nUpgrading cdktf~=0.21.0 in  dependencies.\nBuilding requirements...\nResolving dependencies...\nSuccess!\nTo activate this project's virtualenv, run pipenv shell.\nAlternatively, run a command inside the virtualenv with pipenv run.\nAll dependencies are now up-to-date!\nAll dependencies are now up-to-date!\n========================================================================================================\n\n  Your cdktf Python project is ready!\n\n  cat help                Prints this message\n\n  Compile:\n    pipenv run ./main.py  Compile and run the python code.\n\n  Synthesize:\n    cdktf synth [stack]   Synthesize Terraform resources to cdktf.out/\n\n  Diff:\n    cdktf diff [stack]    Perform a diff (terraform plan) for the given stack\n\n  Deploy:\n    cdktf deploy [stack]  Deploy the given stack\n\n  Destroy:\n    cdktf destroy [stack] Destroy the given stack\n\n  Learn more about using modules and providers https://cdk.tf/modules-and-providers\n\nUse Providers:\n\n  You can add prebuilt providers (if available) or locally generated ones using the add command:\n\n  cdktf provider add \"aws@~>3.0\" null kreuzwerker/docker\n\n  You can find all prebuilt providers on PyPI: https://pypi.org/user/cdktf-team/\n  You can also install these providers directly through pipenv:\n\n  pipenv install cdktf-cdktf-provider-aws\n  pipenv install cdktf-cdktf-provider-google\n  pipenv install cdktf-cdktf-provider-azurerm\n  pipenv install cdktf-cdktf-provider-docker\n  pipenv install cdktf-cdktf-provider-github\n  pipenv install cdktf-cdktf-provider-null\n\n  You can also build any module or provider locally. Learn more: https://cdk.tf/modules-and-providers\n\n========================================================================================================\n[2025-09-16T22:33:13.231] [INFO] default - Checking whether pre-built provider exists for the following constraints:\n  provider: aws\n  version : ~>6.0\n  language: python\n  cdktf   : 0.21.0\n\nPre-built provider information not found\nError: Pre-built provider information not found\n    at HXt (C:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:167:2716)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async MP (C:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:167:2207)\n    at async UP (C:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:167:3042)\n    at async YP (C:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:167:4088)\n    at async VN.hasPrebuiltProvider (C:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:172:183)\n    at async VN.addProvider (C:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:167:8837)\n    at async Mse (C:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:173:2071)\n    at async ojt (C:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:173:140)\n    at async kze (C:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:513:2980)\nCollecting Debug Information...\nC:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\node_modules\\yoga-layout-prebuilt\\yoga-layout\\build\\Release\\nbind.js:53\n        throw ex;\n        ^\n\nError: Pre-built provider information not found\n    at HXt (C:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:167:2716)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async MP (C:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:167:2207)\n    at async UP (C:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:167:3042)\n    at async YP (C:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:167:4088)\n    at async VN.hasPrebuiltProvider (C:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:172:183)\n    at async VN.addProvider (C:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:167:8837)\n    at async Mse (C:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:173:2071)\n    at async ojt (C:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:173:140)\n    at async kze (C:\\Users\\name\\Local\\nvm\\v20.17.0\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:513:298\nNode.js v20.17.0\n```\nAfter running **cdktf init** and explicitly defining the provider I still get the error, but our files are generated. However, this will still not have the provider included see below:\n\n<img width=\"297\" height=\"171\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/a2546a32-ca45-487c-a761-76327f2dde30\" />\n\n```powershell\nPS C:\\Users\\name\\helpme\\onemore> cdktf get\n[2025-09-16T22:33:47.005] [WARN] default - WARNING: No providers or modules found in \"cdktf.json\" config file, therefore cdktf get does nothing.\n```\nThis isn't the most optimal, but you can manually add the provider package and necessary modules now that your cdktf.json file is initialized in the directory:\n\n<img width=\"477\" height=\"282\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/19f42730-4cfc-4c36-99de-430fac457aed\" />\n\nNow run **cdktf get**:\n\n```powershell\nPS C:\\Users\\name\\helpme\\onemore> cdktf get\nGenerated python constructs in the output directory: imports\n```\nSuccessfully runs and adds the provider package to the imports directory as defined by cdktf.json:\n\n<img width=\"1231\" height=\"602\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/dd1cfdd5-01e9-4f24-b5f7-81d06420f8f5\" />\n\nThen I run cdktf synth and cdktf diff successfully:\n\n```shell\nPS C:\\Users\\name\\helpme\\onemore> cdktf get\nGenerated python constructs in the output directory: imports\nPS C:\\Users\\name\\helpme\\onemore> cdktf synth\n```\n\n```shell\nGenerated Terraform code for the stacks: onemore\nPS C:\\Users\\name\\helpme\\onemore> cdktf diff\nonemore\nonemore  \nInitializing the backend...\n         \nonemore\n         Successfully configured the backend \"local\"! Terraform will automatically\n         use this backend unless the backend configuration changes.\n         Initializing provider plugins...\nTerraform has been successfully initialized!\n\nYou may now begin working with Terraform. Try running \"terraform plan\" to see\n         any changes that are required for your infrastructure. All Terraform commands\n         should now work.\n\nIf you ever set or change modules or backend configuration for Terraform,\n         rerun this command to reinitialize your working directory. If you forget, other\n         commands will detect it and remind you to do so if necessary.\n\nonemore  Success! Terraform has validated the lock file and found no need for changes.\nonemore  No changes. Your infrastructure matches the configuration.\n\n\nonemore  Terraform has compared your real infrastructure against your configuration\n         and found no differences, so no changes are needed.\n```\nAgain, not the best workaround but you are able to continue moving along with your project at least.\n### Versions\nlanguage: python\ncdktf-cli: 0.21.0\nnode: v20.17.0\ncdktf: 0.21.0\nconstructs: 10.4.2\njsii: 1.114.1\nterraform: 1.13.2\narch: x64\nos: win32 10.0.26100\npython: Python 3.11.9\npip: pip 25.2 \npipenv: pipenv, version 2025.0.4\nproviders\naws@~>6.0 (LOCAL)\n        terraform provider version: 6.13.0\n\n","createdAt":"2025-09-17T04:19:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3929#issuecomment-3301251344","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7E3M9V","author":{"login":"EmekaNnaji"},"authorAssociation":"NONE","body":"I'm also getting this issue while attempting to install the latest version of cdktf-cli:\n```shell\n npm install -g cdktf-cli@latest \n```","createdAt":"2025-09-17T12:40:59Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3929#issuecomment-3302805333","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7FfcIz","author":{"login":"HackedRico"},"authorAssociation":"NONE","body":"Hello, \n\nI was experiencing this issue too, however was able to find a solution. It seems like the `cdktf init` command's `--providers` field is looking for an array by default as shown in the help menu. \n\nThus I tried doing `cdktf init --template=python --providers=aws --local ` and it worked!\n\nHere are the logs in which CDKTF does find the AWS Pre-built Provider and installs it.\n\n```bash\nNote: By supplying '--local' option you have chosen local storage mode for storing the state of your stack.\nThis means that your Terraform state file will be stored locally on disk in a file 'terraform.<STACK NAME>.tfstate' in the root of your project.\n? Project Name test\n? Project Description A simple getting started project for cdktf.\n? Do you want to send crash reports to the CDKTF team? Refer to \nhttps://developer.hashicorp.com/terraform/cdktf/create-and-deploy/configuration-file#enable-crash-reporting-for-the-cli for more \ninformation no\nCreating a virtualenv for this project\nPipfile: /Users/johndoe/Documents/GitHub/CDKTF-Convert/test/Pipfile\nUsing /usr/local/bin/python33.13.7 to create virtualenv...\nâ ‹ Creating virtual environment...created virtual environment CPython3.13.7.final.0-64 in 615ms\n  creator CPython3macOsBrew(dest=/Users/johndoe/.local/share/virtualenvs/test-WGJoxhNf, clear=False, no_vcs_ignore=False, \nglobal=False)\n  seeder FromAppData(download=False, pip=bundle, via=copy, app_data_dir=/Users/johndoe/Library/Application Support/virtualenv)\n    added seed packages: pip==25.2\n  activators BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator\n\nâœ” Successfully created virtual environment!\nVirtualenv location: /Users/johndoe/.local/share/virtualenvs/test-WGJoxhNf\nPipfile.lock not found, creating...\nLocking  dependencies...\nLocking  dependencies...\nUpdated Pipfile.lock (4e61a4ba9e6f02f50f68627253af5ababd9b1b4c1e10294e48158e1f42c0c5a6)!\nTo activate this project's virtualenv, run pipenv shell.\nAlternatively, run a command inside the virtualenv with pipenv run.\nInstalling dependencies from Pipfile.lock (c0c5a6)...\nTo activate this project's virtualenv, run pipenv shell.\nAlternatively, run a command inside the virtualenv with pipenv run.\nInstalling cdktf~=0.21.0...\nâœ” Installation Succeeded\nTo activate this project's virtualenv, run pipenv shell.\nAlternatively, run a command inside the virtualenv with pipenv run.\nInstalling dependencies from Pipfile.lock (c0c5a6)...\nAll dependencies are now up-to-date!\nUpgrading cdktf~=0.21.0 in  dependencies.\nBuilding requirements...\nResolving dependencies...\nâœ” Success!\nTo activate this project's virtualenv, run pipenv shell.\nAlternatively, run a command inside the virtualenv with pipenv run.\nInstalling dependencies from Pipfile.lock (dd9f43)...\nAll dependencies are now up-to-date!\nInstalling dependencies from Pipfile.lock (dd9f43)...\nTo activate this project's virtualenv, run pipenv shell.\nAlternatively, run a command inside the virtualenv with pipenv run.\nInstalling pytest...\nâœ” Installation Succeeded\nTo activate this project's virtualenv, run pipenv shell.\nAlternatively, run a command inside the virtualenv with pipenv run.\nInstalling dependencies from Pipfile.lock (dd9f43)...\nAll dependencies are now up-to-date!\nUpgrading pytest in  dependencies.\nBuilding requirements...\nResolving dependencies...\nâœ” Success!\nBuilding requirements...\nResolving dependencies...\nâœ” Success!\nTo activate this project's virtualenv, run pipenv shell.\nAlternatively, run a command inside the virtualenv with pipenv run.\nInstalling dependencies from Pipfile.lock (e244ae)...\nAll dependencies are now up-to-date!\nInstalling dependencies from Pipfile.lock (e244ae)...\n========================================================================================================\n\n  Your cdktf Python project is ready!\n\n  cat help                Prints this message\n\n  Compile:\n    pipenv run ./main.py  Compile and run the python code.\n\n  Synthesize:\n    cdktf synth [stack]   Synthesize Terraform resources to cdktf.out/\n\n  Diff:\n    cdktf diff [stack]    Perform a diff (terraform plan) for the given stack\n\n  Deploy:\n    cdktf deploy [stack]  Deploy the given stack\n\n  Destroy:\n    cdktf destroy [stack] Destroy the given stack\n\n  Learn more about using modules and providers https://cdk.tf/modules-and-providers\n\nUse Providers:\n\n  You can add prebuilt providers (if available) or locally generated ones using the add command:\n  \n  cdktf provider add \"aws@~>3.0\" null kreuzwerker/docker\n\n  You can find all prebuilt providers on PyPI: https://pypi.org/user/cdktf-team/\n  You can also install these providers directly through pipenv:\n\n  pipenv install cdktf-cdktf-provider-aws\n  pipenv install cdktf-cdktf-provider-google\n  pipenv install cdktf-cdktf-provider-azurerm\n  pipenv install cdktf-cdktf-provider-docker\n  pipenv install cdktf-cdktf-provider-github\n  pipenv install cdktf-cdktf-provider-null\n\n  You can also build any module or provider locally. Learn more: https://cdk.tf/modules-and-providers\n\n========================================================================================================\n[2025-09-19T14:27:27.476] [INFO] default - Checking whether pre-built provider exists for the following constraints:\n  provider: aws\n  version : latest\n  language: python\n  cdktf   : 0.21.0\n\n[2025-09-19T14:27:29.672] [INFO] default - Found pre-built provider.\nInstalling package cdktf-cdktf-provider-aws @ 21.11.0 using pipenv.\nTo activate this project's virtualenv, run pipenv shell.\nAlternatively, run a command inside the virtualenv with pipenv run.\nInstalling cdktf-cdktf-provider-aws~=21.11.0...\nâœ” Installation Succeeded\nTo activate this project's virtualenv, run pipenv shell.\nAlternatively, run a command inside the virtualenv with pipenv run.\nInstalling dependencies from Pipfile.lock (e244ae)...\nAll dependencies are now up-to-date!\nUpgrading cdktf-cdktf-provider-aws~=21.11.0 in  dependencies.\nBuilding requirements...\nResolving dependencies...\nâœ” Success!\nBuilding requirements...\nResolving dependencies...\nâœ” Success!\nTo activate this project's virtualenv, run pipenv shell.\nAlternatively, run a command inside the virtualenv with pipenv run.\nInstalling dependencies from Pipfile.lock (a7a66a)...\nAll dependencies are now up-to-date!\nInstalling dependencies from Pipfile.lock (a7a66a)...\nPackage installed.\n```","createdAt":"2025-09-19T18:35:10Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3929#issuecomment-3313353267","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7FfyVr","author":{"login":"hinling-blisspoint"},"authorAssociation":"NONE","body":"Looks like the option `--local` works as a workaround for now. Thanks everyone for the tip! I ended up still just running the `cdktf init --template=\"typescript\" --providers=\"aws\"` command and it created template files. (just `cdkt init` does nothing and that's what I used at the very beginning). I do use terraform cloud but that can be done later when doing `cdktf diff` or `cdktf list`","createdAt":"2025-09-19T19:01:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3929#issuecomment-3313444203","viewerDidAuthor":false}],"createdAt":"2025-09-16T17:37:03Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"}],"milestone":null,"number":3929,"title":"aws: Error: Pre-built provider information not found","updatedAt":"2025-09-19T19:01:53Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE5ODY5NTA=","is_bot":false,"login":"paymog","name":"Paymahn Moghadasian"},"body":"### Expected Behavior\n\nI expect class variables on my stack to be turned into outputs.\n\n### Actual Behavior\n\nThe class variables are not turned into outputs.\n\n### Steps to Reproduce\n\nI have a stack like the following\n\n```\nclass MyStack extends TerraformStack {\n  public readonly eksCluster: EksCluster;\n  public readonly oidcProvider: IamOpenidConnectProvider;\n  public readonly clusterVpc: Vpc;\n  public readonly graphNodeCluster: GraphNodeCluster;\n  public readonly goldskyApiDbName: string;\n  public readonly goldskyApiDbString: string;\n  public readonly apiShardDbs: Record<string, string>;\n  public readonly ipfsNode: IpfsNode;\n  public readonly goldskyApi: GoldskyApi;\n  public readonly workflowWorkerDopplerSecretCrd: DopplerSecretCrd;\n\n  constructor(scope: Construct, name: string) {\n  ...\n  }\n}\n```\n\nI'm just starting to migrate from a single stack to multiple stacks. I started by just exposing my EksCluster which successfully resulted in terraform automatically creating outputs.\n\nI now added all of the other public variables seen above and none of them are being turned into outputs when I run a deploy command even though I properly assign them to constructs and/or plain variables (like the string ones).\n\n### Versions\n```\n â¯â¯â¯ npx cdktf debug\ncdktf debug\nlanguage: typescript\ncdktf-cli: 0.20.12\nnode: v24.0.1\ncdktf: 0.20.12\nconstructs: 10.3.0\njsii: null\nterraform: 1.11.4\narch: arm64\nos: darwin 24.6.0\nproviders\naws@~> 5.61 (LOCAL)\n        terraform provider version: 5.100.0\nkubernetes@ ~> 2.31.0 (LOCAL)\n        terraform provider version: 2.31.0\nhttp@ ~> 2.1.0 (LOCAL)\n        terraform provider version: 2.1.0\ntls@ ~> 4.0.5 (LOCAL)\n        terraform provider version: 4.0.6\nrandom@ ~> 3.1.0 (LOCAL)\n        terraform provider version: 3.1.3\ngavinbunney/kubectl@~> 1.14.0 (LOCAL)\n        terraform provider version: 1.14.0\nDopplerHQ/doppler@1.1.6 (LOCAL)\n        terraform provider version: 1.1.6\nhelm@ ~> 2.17.0 (LOCAL)\n        terraform provider version: 2.17.0\n@cdktf/provider-aws (PREBUILT)\n        terraform provider version: 5.61.0\n        prebuilt provider version: 19.29.0\n        cdktf version: ^0.20.0\n@cdktf/provider-kubernetes (PREBUILT)\n        terraform provider version: 2.31.0\n        prebuilt provider version: 11.6.0\n        cdktf version: ^0.20.0\n```\n\n### Providers\n```\n â¯â¯â¯ npx cdktf provider list\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Provider Name       â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name               â”‚ Package Version â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ aws                 â”‚ 5.100.0          â”‚         â”‚ ~> 5.61    â”‚                            â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ kubernetes          â”‚ 2.31.0           â”‚         â”‚  ~> 2.31.0 â”‚                            â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ http                â”‚ 2.1.0            â”‚         â”‚  ~> 2.1.0  â”‚                            â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ tls                 â”‚ 4.0.6            â”‚         â”‚  ~> 4.0.5  â”‚                            â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ random              â”‚ 3.1.3            â”‚         â”‚  ~> 3.1.0  â”‚                            â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ gavinbunney/kubectl â”‚ 1.14.0           â”‚         â”‚ ~> 1.14.0  â”‚                            â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ DopplerHQ/doppler   â”‚ 1.1.6            â”‚         â”‚ 1.1.6      â”‚                            â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ helm                â”‚ 2.17.0           â”‚         â”‚  ~> 2.17.0 â”‚                            â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ aws                 â”‚ 5.61.0           â”‚ ^0.20.0 â”‚            â”‚ @cdktf/provider-aws        â”‚ 19.29.0         â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ kubernetes          â”‚ 2.31.0           â”‚ ^0.20.0 â”‚            â”‚ @cdktf/provider-kubernetes â”‚ 11.6.0          â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-09-10T14:48:25Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3927,"title":"COMPONENT: Stack outputs not being created","updatedAt":"2025-09-10T14:48:51Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjYzMDQ0OQ==","is_bot":false,"login":"blimmer","name":"Ben Limmer"},"body":"### Description\n\n`cdktf-cli` transitively depends on `tmp` via `inqurier`:\n\n```\n> npm ls tmp\ntest-cdkcli@1.0.0 /private/tmp/test-cdkcli\nâ””â”€â”¬ cdktf-cli@0.21.0\n  â””â”€â”¬ @inquirer/prompts@2.3.1\n    â””â”€â”¬ @inquirer/editor@1.2.15\n      â””â”€â”¬ external-editor@3.1.0\n        â””â”€â”€ tmp@0.0.33\n```\n\n`tmp` versions `<= 0.2.3` trigger a warning in dependabot: https://github.com/advisories/GHSA-52f5-9888-hmc6\n\nThis has been fixed upstream in `inquirer`: https://github.com/SBoudrias/Inquirer.js/issues/1802\n\nHowever, the current version of inquirer is pinned back at 2.x: https://github.com/hashicorp/terraform-cdk/blob/a36c83bf01fc4206d93500fe305e44c64801fbf1/packages/cdktf-cli/package.json#L46\n\n### References\n\n- https://github.com/advisories/GHSA-52f5-9888-hmc6\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc7ANbnI","author":{"login":"rcollette"},"authorAssociation":"NONE","body":"This issue affects FedRAMP deployment environments.  As a low level issue, it is expected to be resolved in 120 days.","createdAt":"2025-08-26T15:46:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3924#issuecomment-3224746440","viewerDidAuthor":false}],"createdAt":"2025-08-22T20:29:14Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3924,"title":"cli: CVE with transitive dependency `tmp`","updatedAt":"2025-08-26T15:46:09Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM0NjQ0NTI4","is_bot":false,"login":"whiteninja76","name":"Simon"},"body":"### Expected Behavior\n\nThis is in the typescript version of the cdktf \nIs this working or not . IT appears to work but is throwing a Synthesizing error but still works\n\n### Actual Behavior\n\nErrors\n\n### Steps to Reproduce\n\n  ```\n    const sourceBucket = Fn.element(\n      Fn.split(\"/\",pipelineInBucket),\n      0,\n    ) as string;\n```\n\n### Versions\n\nlanguage: typescript\ncdktf-cli: 0.16.1\nnode: v22.11.0\ncdktf: 0.20.11\n\nterraform: v1.12.2\n\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-08-22T13:29:53Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3923,"title":"You're using escape sequences (${...}) with CDKTF Built-in functions. This is not supported yet, and the output may be incorrect","updatedAt":"2025-08-22T13:29:53Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzNjI3NTA=","is_bot":false,"login":"acomagu","name":"Yuki Ito"},"body":"### Description\n\nAs AWS CDK, I believe that TerraformAsset should also have bundling functionality. Here are the advantages:\n\n- **It would significantly reduce the lines of code.** You wouldnâ€™t need to define a NullResource, which lowers both line count and complexity.\n- **When using Terraform Cloud,** if you bundle via NullResource, the pre-bundled sources get uploaded. Those can be very large; uploading the post-bundled artifact is much more efficient.(And this can be an advantage of CDKTF compared to Terraform)\n- **Better concurrency and prevention of duplicate runs.** Today you can run arbitrary commands in a constructor via `execSync`, but if a CDK constructor is invoked multiple times due to missing context, `execSync` will also run multiple times. Furthermore, `execSync` is inherently non-parallelizable. This makes constructing so slow sometimes.\n\nIdea:\n\n```typescript\nnew cdktf.TerraformAsset(this, 'asset', {\n  path: ...,\n  bundling: {\n    command: 'npm build',\n  },\n});\n```\n\nref. [AWS CDK BundlingOption Documentation](https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.BundlingOptions.html)\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-08-10T08:34:15Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3919,"title":"TerraformAsset: add bundling feature","updatedAt":"2025-08-10T08:44:16Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUyNDg4ODU5","is_bot":false,"login":"djakielski","name":"Dominik Jakielski"},"body":"### Expected Behavior\n\nWhenn I define an app with context, it shuld be readable from stack\n\n```typescript\napp = Testing.app({\n    context: {\n      accountID: '123456789012',\n      environment: 'development'\n   }\n});\n\n//In stack\nconst accountID = scope.node.getContext(\"accountID\") as string;\n```\n\n### Actual Behavior\n\nI got an exception\n\n```\n No context value present for accountID key\nonst accountID = scope.node.getContext(\"accountID\") as string;\n                            ^\n```\n\n### Steps to Reproduce\n\n1. Write a stack\n2. Write a simple test and inject a context\n3. Try to read context in the stack\n\n### Versions\n\nlanguage: typescript\ncdktf-cli: 0.21.0\nnode: v18.17.0\ncdktf: 0.21.0\nconstructs: 10.4.2\njsii: null\nterraform: 1.12.2\narch: arm64\nos: darwin 24.5.0\nproviders\n@cdktf/provider-aws (PREBUILT)\n        terraform provider version: 6.6.0 \n        prebuilt provider version: 21.5.0\n        cdktf version: ^0.21.0\n\n\n### Providers\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name        â”‚ Package Version â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ aws           â”‚ 6.6.0            â”‚ ^0.21.0 â”‚            â”‚ @cdktf/provider-aws â”‚ 21.5.0          â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [x] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-07-31T10:24:13Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3918,"title":"cdktf/testing: Context is empty for a testing app","updatedAt":"2025-07-31T10:24:13Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExNzkwODMz","is_bot":false,"login":"thaitrunghieu","name":"å„ä¸¨ä¹‡ã„© ã„’å„å‚ä¸¨"},"body":"### Description\n\nCDK for Terraform is using very old .NET Core Runtime (3.1). When I synthesize the infrastructure. I got 100s of warnings. Can you please upgrade it to latest .NET (9.0) to keep up with all the security bugs and avoid potentially incompatibility in the future?\n\nThank you\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-07-17T17:24:00Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3916,"title":"Upgrade .NET framework to 9.0","updatedAt":"2025-07-17T17:24:00Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE2MjUwNTU=","is_bot":false,"login":"nikolaymatrosov","name":"Nikolay Matrosov"},"body":"### Expected Behavior\n\nI can generate any provider with `cdktf-cli`\n\n### Actual Behavior\n\n```\ncdktf get      \n[2025-07-17T17:07:48.845] [INFO] default - Could not determine library version, skipping version compatibility check\nâ ¸ downloading and generating modules and providers...\n[2025-07-17T17:08:01.826] [ERROR] default - [2025-07-17T17:08:01.825] [ERROR] jsii/compiler - Compilation errors prevented the JSII assembly from being created\n\nError: non-zero exit code 1\n    at ChildProcess.<anonymous> (/tmp/examples/go/yc/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:102:34391)\n    at Object.onceWrapper (node:events:639:26)\n    at ChildProcess.emit (node:events:524:28)\n    at ChildProcess.emit (node:domain:489:12)\n    at maybeClose (node:internal/child_process:1104:16)\n    at Socket.<anonymous> (node:internal/child_process:456:11)\n    at Socket.emit (node:events:524:28)\n    at Socket.emit (node:domain:489:12)\n    at Pipe.<anonymous> (node:net:343:12) {\n  stderr: '[2025-07-17T17:08:01.825] [ERROR] jsii/compiler - Compilation errors prevented the JSII assembly from being created\\n'\n}\nâ ¸ downloading and generating modules and providers...\nError: non-zero exit code 1\n```\n\n### Steps to Reproduce\n\n1. Install `cdktf-cli`\n2. Try to get latest version of `yandex-cloud/yandex@~> 0.145.0` provider\n3. Got the error\n\n\n\n### Versions\n\n```\ncdktf debug\nlanguage: go\ncdktf-cli: 0.21.0\nnode: v20.19.3\ncdktf: github.com/hashicorp/terraform-cdk-go/cdktf\nconstructs: 10.4.2\njsii: 1.112.0\nterraform: 1.5.7\narch: arm64\nos: darwin 24.5.0\ngo: go version go1.24.2 darwin/arm64\nproviders\nyandex-cloud/yandex@~> 0.145.0 (LOCAL)\n```\n### Providers\n\n```\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Provider Name       â”‚ Provider Version â”‚ CDKTF â”‚ Constraint â”‚ Package Name â”‚ Package Version â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ yandex-cloud/yandex â”‚                  â”‚       â”‚ ~> 0.145.0 â”‚              â”‚                 â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\nAdd `StringMapMap` class to the `cdktf` as schema of the provider defined attribute with this type\n\n```\n\"airflow_config\": schema.MapAttribute{\n\tElementType: types.MapType{\n\t\tElemType: types.StringType,\n\t},\n\t...\n},\n```\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n- https://github.com/yandex-cloud/terraform-provider-yandex/blob/d599560500bb658d8896f1af9ba9cb8ba27cc73b/yandex-framework/services/airflow_cluster/datasource_schema.go#L21\n\n### Help Wanted\n\n- [x] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-07-17T15:18:24Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3915,"title":"lib: add StringMapMap class","updatedAt":"2025-07-17T15:19:34Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjgzOTk2MjM=","is_bot":false,"login":"liamstevens","name":"Liam Stevens"},"body":"### Description\n\n[Zod Version 4](https://zod.dev/v4) has been released, and comes with a slew of breaking changes.\n\nhcl2cdk and cdktf-cli both use zod, and are still on version 3.24.4.\n\nIt would be good to get these brought up so that we can use zod v4 alongside these modules!\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [x] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-07-17T06:42:16Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3914,"title":"cdktf: add support for zod v4","updatedAt":"2025-07-17T06:42:16Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE2MjUwNTU=","is_bot":false,"login":"nikolaymatrosov","name":"Nikolay Matrosov"},"body":"### Expected Behavior\n\nI can build packages\n\n### Actual Behavior\n\nWith go 1.24 installed I received `File $GOROOT/misc/wasm/wasm_exec.js does not exist!` error.\n\n### Steps to Reproduce\n\n1. Install go 1.24\n2. Checkout repo\n3. run `yarn install && yarn build`\n\n### Versions\n\ncdktf debug\nlanguage: go\ncdktf-cli: 0.0.0\nnode: v20.19.3\ncdktf: github.com/hashicorp/terraform-cdk-go/cdktf\nconstructs: 10.4.2\njsii: 1.112.0\nterraform: 1.5.7\narch: arm64\nos: darwin 24.5.0\ngo: go version go1.24.2 darwin/arm64\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\nSince go1.24 the `wasm_exec.js` is located not in the `misc` but in the `lib` folder.\nhttps://github.com/golang/go/issues/69989\n\n[prebuild.sh](https://github.com/hashicorp/terraform-cdk/blob/main/packages/%40cdktf/hcl2json/prebuild.sh) searches for it only in one location. I suggest add the new one so I can use newer go versions.\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n- https://github.com/golang/go/issues/69989\n\n### Help Wanted\n\n- [x] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-07-13T08:34:35Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3912,"title":"hcl2json: support new location of wasm_exec.js","updatedAt":"2025-07-13T08:34:35Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUzNDMwMzY4","is_bot":false,"login":"kostyaplis","name":"Konstantin Plis"},"body":"### Expected Behavior\n\nCorrect HCL generated\n\n### Actual Behavior\n\nIncorrect HCL generated\n\n### Steps to Reproduce\n\n1. Create a simple stack that includes variable and a resource that serializes an object with the variable, e.g. `IamPolicy`.\n2. `cdktf synth` --> correct JSON output\n3. `cdktf synth --hcl` --> broken HCL output\n\ngist attached below\n\n### Versions\n\nlanguage: typescript\ncdktf-cli: 0.21.0\nnode: v24.3.0\ncdktf: 0.21.0\nconstructs: 10.4.2\njsii: null\nterraform: 1.3.10\narch: arm64\nos: darwin 24.5.0\n\n### Providers\n\n@cdktf/provider-aws (PREBUILT)\n        terraform provider version: 6.2.0\n        prebuilt provider version: 21.1.0\n        cdktf version: ^0.21.0\n\n### Gist\n\nhttps://gist.github.com/kostyaplis/8d109342e6d1f2e71721c133fe9de711\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-07-09T09:57:28Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3911,"title":"HCL synth: any TOKEN in the serialized object results in wrong output synthesized","updatedAt":"2025-07-09T09:57:28Z"},{"assignees":[],"author":{"id":"U_kgDODJvzEw","is_bot":false,"login":"msztainbok","name":"Mark Sztainbok"},"body":"### Expected Behavior\n\n`toBeValidTerraform()` should work in all circumstances and not require access to the Terraform backend\n\n### Actual Behavior\n\n`toBeValidTerraform()` calls `terraform init` with no parameters so the Terraform backend which is instantitated in the code is used which increases the time it takes to do the validation and also causes the test to fail if the backend is not accessible. The backend is not needed for validation as it just validates the syntax of the generated Terraform and the actual validation is done by the `plan` operation (as per the Terraform documentation)\n\n### Steps to Reproduce\n\n1. Create a stack using CDKTF\n2. Add an Azure backend which has an inaccessible storage account\n3. Run a test that uses `toBeValidTerraform()` to validate the generated Terraform code\n\n### Versions\n\nlanugage: typescript\ncdktf-cli: 0.21.0\nnode: v20.19.2\nterraform: 1.12.2\narch: x64\nos: win32 10.0.26100\nproviders\n@cdktf/provider-azuread (PREBUILT)\n        terraform provider version: 3.4.0\n        prebuilt provider version: 14.0.0\n        cdktf version: ^0.21.0\n@cdktf/provider-azurerm (PREBUILT)\n        terraform provider version: 4.34.0\n        prebuilt provider version: 14.3.0\n        cdktf version: ^0.21.0\n\n### Providers\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name            â”‚ Package Version â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ azuread       â”‚ 3.4.0            â”‚ ^0.21.0 â”‚            â”‚ @cdktf/provider-azuread â”‚ 14.0.0          â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ azurerm       â”‚ 4.34.0           â”‚ ^0.21.0 â”‚            â”‚ @cdktf/provider-azurerm â”‚ 14.3.0          â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\nAlter the code for `toBeValidTerraform` to pass the `-backend=false` parameter to `terraform init`\n\n### Workarounds\n\nNone\n\n### Anything Else?\n\nThe Terraform documentation for `terraform validate` states that `terraform init` should be run with the `-backend=false` argument before doing the validate.\n\n### References\n\n- https://developer.hashicorp.com/terraform/cli/commands/validate\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-07-04T18:26:39Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3909,"title":"cdktf: toBeValidTerraform() should pass -backend=false to terraform init","updatedAt":"2025-07-04T18:26:39Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjQ0MTI4MDI0","is_bot":false,"login":"vizeit","name":""},"body":"### Expected Behavior\n\nStarting provider version 12.0.0, Release class expects â€˜idâ€™ instead of â€˜id_â€™ resulting into failures. The changes since 12.0.0 are not backward compatible \n\n### Actual Behavior\n\nError:\n\nRelease.__init__() got an unexpected keyword argument â€˜id_â€™\n\n### Steps to Reproduce\n\n1. Upgrade package to version 12.0.0\n2. If you have unit test coverage, execute tests, if not run synth\n3. An error is thrown by Release class for â€˜id_â€™ which was valid in previous versions. Apparently Release class now expects â€˜idâ€™ instead of â€˜id_â€™\n\n### Versions\n\nLanguage: Python\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-06-30T17:58:59Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3908,"title":"cdktf-provider-helm: â€˜id_â€™ error for â€˜Releaseâ€™ starting version 12.0.0","updatedAt":"2025-06-30T18:00:14Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjI5ODEzMDE=","is_bot":false,"login":"peter-majeed","name":"Peter Majeed"},"body":"### Expected Behavior\n\nA vulnerability was published 10 days ago that affects the `brace-expansion` project in use by the `cdktf` package.\n\nhttps://github.com/advisories/GHSA-v6h2-p8h4-qcjw\n\n> A vulnerability was found in juliangruber brace-expansion up to 1.1.11/2.0.1/3.0.0/4.0.0. It has been rated as problematic. Affected by this issue is the function expand of the file index.js. The manipulation leads to inefficient regular expression complexity. The attack may be launched remotely. The complexity of an attack is rather high. The exploitation is known to be difficult. The exploit has been disclosed to the public and may be used. Upgrading to version 1.1.12, 2.0.2, 3.0.1 and 4.0.1 is able to address this issue. The name of the patch is `a5b98a4f30d7813266b221435e1eaaf25a1b0ac5`. It is recommended to upgrade the affected component.\n\n![Image](https://github.com/user-attachments/assets/f83b2689-0d42-4681-93cf-a387ba6420a4)\n\nI would expect that there would be no vulnerabilities in the most up-to-date version of `cdktf`.\n\n### Actual Behavior\n\nThere is a vulnerability in the most up-to-date version of `cdktf`.\n\n### Steps to Reproduce\n\n1. In a new project, install the `cdktf@0.21.0` package.\n2. Run `npm audit`.\n\nThere should be no vulnerabilities.\n\n### Versions\n\nlanguage: typescript\ncdktf-cli: 0.21.0\nnode: v22.16.0\ncdktf: 0.21.0\nconstructs: 10.4.2\njsii: null\nterraform: 1.11.3\narch: arm64\nos: darwin 24.5.0\n\n### Providers\n\nâ”Œâ”\nâ”‚â”‚\nâ””â”˜\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\nhttps://github.com/advisories/GHSA-v6h2-p8h4-qcjw\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc6z6qdI","author":{"login":"dlgeraghty"},"authorAssociation":"NONE","body":"I have experienced the same issue when trying to upgrade from version v0.20.12 to the latest version v0.21.0 and this is preventing the upgrade","createdAt":"2025-06-30T09:46:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3906#issuecomment-3018499912","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7ANZNr","author":{"login":"rcollette"},"authorAssociation":"NONE","body":"This issue affects users who are using Terraform in an FedRAMP environment.   As a low level vulnerability is is expected to be resolved within 120 days in FedRAMP.","createdAt":"2025-08-26T15:43:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3906#issuecomment-3224736619","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7W7ySf","author":{"login":"breakpointninja"},"authorAssociation":"NONE","body":"We are also affected by this vulnerability in brace-expansion as a transitive dependency of cdktf@0.21.0. Unfortunately, cdktf bundles its dependencies, which prevents us from effectively overriding the brace-expansion version. We'd be glad to help test any potential fixes or contribute if there's a need to resolve this upstream.","createdAt":"2025-12-03T09:55:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3906#issuecomment-3605996703","viewerDidAuthor":false}],"createdAt":"2025-06-19T16:21:03Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3906,"title":"cdktf node package: low severity vulnerability","updatedAt":"2025-12-03T09:55:35Z"},{"assignees":[],"author":{"id":"U_kgDOBY1ElQ","is_bot":false,"login":"zamanh","name":"Hamza Zaman"},"body":"### Expected Behavior\n\nI should see no error when listing or deploying stacks\n\n### Actual Behavior\n\n- Errors are visible prior to deploying or listing stacks\n\n### Steps to Reproduce\n\n1. Attempt to deploy a stack\n2. Observe the error prior to synth\n\n### Versions\n\nlanguage: python\ncdktf-cli: 0.21.0\nnode: v20.8.0\ncdktf: 0.21.0\nconstructs: 10.4.2\njsii: 1.106.0\nterraform: 1.9.8\narch: x64\nos: linux 6.6.87.1-microsoft-standard-WSL2\npython: Python 3.11.7\npip: pip 23.2.1 from /usr/local/lib/python3.11/site-packages/pip (python 3.11)\npipenv: pipenv, version 2025.0.3\nproviders\njfrog/artifactory@~> 12.9.5 (LOCAL)\n        terraform provider version: 12.9.5\njfrog/platform@~> 2.2.4 (LOCAL)\n        terraform provider version: 2.2.4\ncdktf-cdktf-provider-null (PREBUILT)\n        terraform provider version: 3.2.4\n        prebuilt provider version: 11.0.0\n        cdktf version: ^0.21.0\ncdktf-cdktf-provider-vault (PREBUILT)\n        terraform provider version: 5.0.0\n        prebuilt provider version: 15.0.0\n        cdktf version: ^0.21.0\n\n### Providers\n\nâ”‚ Provider Name     â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name               â”‚ Package Version â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ jfrog/artifactory â”‚ 12.9.5           â”‚         â”‚ ~> 12.9.5  â”‚                            â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ jfrog/platform    â”‚ 2.2.4            â”‚         â”‚ ~> 2.2.4   â”‚                            â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ null              â”‚ 3.2.4            â”‚ ^0.21.0 â”‚            â”‚ cdktf-cdktf-provider-null  â”‚ 11.0.0          â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ vault             â”‚ 5.0.0            â”‚ ^0.21.0 â”‚            â”‚ cdktf-cdktf-provider-vault â”‚ 15.0.0          â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n### Gist\n\nhttps://gist.github.com/zamanh/303e005c97eabffed1b0bcef160bc4d4\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n- Running in an internal deployment container\n- Has tooling like node etc installed on it\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc7UJGmI","author":{"login":"zamanh"},"authorAssociation":"NONE","body":"Don't seem to get this after updating to Node 24. Will leave issue open for those who still experience it.","createdAt":"2025-11-20T17:11:48Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3898#issuecomment-3559156104","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7U0LMO","author":{"login":"zamanh"},"authorAssociation":"NONE","body":"Just to also add, I do get the warning about CDKTF being untested on Node Versions 24 and up.","createdAt":"2025-11-24T11:59:05Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3898#issuecomment-3570447118","viewerDidAuthor":false}],"createdAt":"2025-06-05T11:16:23Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3898,"title":"COMPONENT: cdktf commands show error before synth","updatedAt":"2025-11-24T11:59:06Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjMyMTY4NjE5","is_bot":false,"login":"X-Guardian","name":"Simon Heather"},"body":"### Expected Behavior\n\nSuccessful install of cdktf v0.20.12 and prebuilt binary dependencies when using Node 22 on linux arm64\n\n### Actual Behavior\n\n```\n.../@cdktf/node-pty-prebuilt-multiarch install: Prebuild binary missing for platform linux\n.../@cdktf/node-pty-prebuilt-multiarch install: prebuild-install warn install No prebuilt binaries found (target=22.16.0 runtime=node arch=arm64 libc= platform=linux)\n.../@cdktf/node-pty-prebuilt-multiarch install: gyp info it worked if it ends with ok\n.../@cdktf/node-pty-prebuilt-multiarch install: gyp info using node-gyp@10.2.0\n.../@cdktf/node-pty-prebuilt-multiarch install: gyp info using node@22.16.0 | linux | arm64\n```\n\n### Steps to Reproduce\n\nUsing a linux arm64 machine with Node 22 installed:\n\n```\npnpm add --global cdktf-cli@0.20.12\n```\n\n### Versions\n\nN/A\n\n### Providers\n\nN/A\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\nLooking at the latest [release action #45](https://github.com/cdktf/node-pty-prebuilt-multiarch/actions/runs/14491497802) on the [cdktf/node-pty-prebuilt-multiarch](https://github.com/cdktf/node-pty-prebuilt-multiarch) repo, the [debian-arm64v8](https://github.com/cdktf/node-pty-prebuilt-multiarch/actions/runs/14491497802/job/40648795538) and [alpine-arm64-v8](https://github.com/cdktf/node-pty-prebuilt-multiarch/actions/runs/14491497802/job/40648793281) job's `Linux - prebuild Binaries` steps failed for different reasons, even though the jobs were marked as successful. This makes me assume the relevant Debian/Alpine Linux arm64 Node 22 binaries were not published.\n\nThe [debian-x86_64](https://github.com/cdktf/node-pty-prebuilt-multiarch/actions/runs/14491497802/job/40648793849) job completed successfully for example, and the cdktf prebuilt binary dependencies are successfully installed when using Node 22 on linux amd64.\n\n#### debian-arm64v8 Error\n\n```\ngyp info ok \ngyp info it worked if it ends with ok\ngyp info using node-gyp@9.4.1\ngyp info using node@15.8.0 | linux | arm64\ngyp ERR! find Python \ngyp ERR! find Python Python is not set from command line or npm configuration\ngyp ERR! find Python Python is not set from environment variable PYTHON\ngyp ERR! find Python checking if \"python3\" can be used\ngyp ERR! find Python - \"python3\" is not in PATH or produced an error\ngyp ERR! find Python checking if \"python\" can be used\ngyp ERR! find Python - \"python\" is not in PATH or produced an error\ngyp ERR! find Python \ngyp ERR! find Python **********************************************************\ngyp ERR! find Python You need to install the latest version of Python.\ngyp ERR! find Python Node-gyp should be able to find and use Python. If not,\ngyp ERR! find Python you can try one of the following options:\ngyp ERR! find Python - Use the switch --python=\"/path/to/pythonexecutable\"\ngyp ERR! find Python   (accepted by both node-gyp and npm)\ngyp ERR! find Python - Set the environment variable PYTHON\ngyp ERR! find Python - Set the npm configuration variable python:\ngyp ERR! find Python   npm config set python \"/path/to/pythonexecutable\"\ngyp ERR! find Python For more information consult the documentation at:\ngyp ERR! find Python https://github.com/nodejs/node-gyp#installation\ngyp ERR! find Python **********************************************************\ngyp ERR! find Python \ngyp ERR! configure error \ngyp ERR! stack Error: Could not find any Python installation to use\ngyp ERR! stack     at PythonFinder.fail (/node-pty/node_modules/node-gyp/lib/find-python.js:330:47)\ngyp ERR! stack     at PythonFinder.runChecks (/node-pty/node_modules/node-gyp/lib/find-python.js:159:21)\ngyp ERR! stack     at PythonFinder.<anonymous> (/node-pty/node_modules/node-gyp/lib/find-python.js:202:16)\ngyp ERR! stack     at PythonFinder.execFileCallback (/node-pty/node_modules/node-gyp/lib/find-python.js:294:16)\ngyp ERR! stack     at exithandler (node:child_process:334:5)\ngyp ERR! stack     at ChildProcess.errorhandler (node:child_process:346:5)\ngyp ERR! stack     at ChildProcess.emit (node:events:378:20)\ngyp ERR! stack     at Process.ChildProcess._handle.onexit (node:internal/child_process:288:12)\ngyp ERR! stack     at onErrorNT (node:internal/child_process:480:16)\ngyp ERR! stack     at processTicksAndRejections (node:internal/process/task_queues:81:21)\ngyp ERR! System Linux 6.8.0-1021-azure\ngyp ERR! command \"/usr/local/bin/node\" \"/node-pty/node_modules/.bin/node-gyp\" \"rebuild\" \"--target=21.0.0\" \"--devdir=/tmp/prebuildify/node\" \"--arch=arm64\" \"--release\"\ngyp ERR! cwd /node-pty\ngyp ERR! node -v v15.8.0\ngyp ERR! node-gyp -v v9.4.1\ngyp ERR! not ok \nnode-gyp exited with 1\n```\n\n#### alpine-arm64v8 Error\n\n```\ng++: internal compiler error: Segmentation fault signal terminated program cc1plus\nPlease submit a full bug report, with preprocessed source (by using -freport-bug).\nSee <https://gitlab.alpinelinux.org/alpine/aports/-/issues> for instructions.\nmake: *** [pty.target.mk:111: Release/obj.target/pty/src/unix/pty.o] Error 4\nmake: Leaving directory '/node-pty/build'\ngyp ERR! build error \ngyp ERR! stack Error: `make` failed with exit code: 2\ngyp ERR! stack     at ChildProcess.onExit (/node-pty/node_modules/node-gyp/lib/build.js:203:23)\ngyp ERR! stack     at ChildProcess.emit (node:events:513:28)\ngyp ERR! stack     at Process.ChildProcess._handle.onexit (node:internal/child_process:293:12)\ngyp ERR! System Linux 6.8.0-1021-azure\ngyp ERR! command \"/usr/local/bin/node\" \"/node-pty/node_modules/.bin/node-gyp\" \"rebuild\" \"--target=21.0.0\" \"--devdir=/tmp/prebuildify/node\" \"--arch=arm64\" \"--release\"\ngyp ERR! cwd /node-pty\ngyp ERR! node -v v16.20.2\ngyp ERR! node-gyp -v v9.4.1\ngyp ERR! not ok \nnode-gyp exited with 1\n```\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n- #3641 \n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc6xW_HV","author":{"login":"X-Guardian"},"authorAssociation":"NONE","body":"@mutahhir, just making sure you are aware of this, as you ran the failed release jobs. ","createdAt":"2025-06-16T08:35:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3896#issuecomment-2975592917","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6x5qkZ","author":{"login":"deving1995"},"authorAssociation":"NONE","body":"I'm also getting the same problem with Node 22.\n\n```\nnpm error code 1\nnpm error path C:\\Users\\devin.gero\\Projects\\learn-cdktf-docker\\node_modules\\@cdktf\\node-pty-prebuilt-multiarch\nnpm error command failed\nnpm error command C:\\Windows\\system32\\cmd.exe /d /s /c node scripts/check-prebuild.js || prebuild-install || node scripts/install.js\nnpm error Prebuild binary missing for platform win32\nnpm error prebuild-install warn install No prebuilt binaries found (target=22.16.0 runtime=node arch=x64 libc= platform=win32)\nnpm error node:internal/child_process:420\nnpm error     throw new ErrnoException(err, 'spawn');\nnpm error     ^\nnpm error\nnpm error Error: spawn EINVAL\nnpm error     at ChildProcess.spawn (node:internal/child_process:420:11)\nnpm error     at spawn (node:child_process:753:9)\nnpm error     at Object.<anonymous> (C:\\Users\\devin.gero\\Projects\\learn-cdktf-docker\\node_modules\\@cdktf\\node-pty-prebuilt-multiarch\\scripts\\install.js:11:20)\nnpm error     at Module._compile (node:internal/modules/cjs/loader:1730:14)\nnpm error     at Object..js (node:internal/modules/cjs/loader:1895:10)\nnpm error     at Module.load (node:internal/modules/cjs/loader:1465:32)\nnpm error     at Function._load (node:internal/modules/cjs/loader:1282:12)\nnpm error     at TracingChannel.traceSync (node:diagnostics_channel:322:14)\nnpm error     at wrapModuleLoad (node:internal/modules/cjs/loader:235:24)\nnpm error     at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:171:5) {\nnpm error   errno: -4071,\nnpm error   code: 'EINVAL',\nnpm error   syscall: 'spawn'\nnpm error }\nnpm error\nnpm error Node.js v22.16.0\nnpm error A complete log of this run can be found in: C:\\Users\\devin.gero\\AppData\\Local\\npm-cache\\_logs\\2025-06-18T15_17_06_483Z-debug-0.log\n```","createdAt":"2025-06-18T15:25:55Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3896#issuecomment-2984683801","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7A6-zU","author":{"login":"ramarahul"},"authorAssociation":"NONE","body":"Even I'm facing the same issue in Windows 11.\n\nDid you find any fix/workaround for this issue? @deving1995 ","createdAt":"2025-08-29T11:15:22Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3896#issuecomment-3236687060","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7BVJM3","author":{"login":"deving1995"},"authorAssociation":"NONE","body":"> Even I'm facing the same issue in Windows 11.\n> \n> Did you find any fix/workaround for this issue? [@deving1995](https://github.com/deving1995)\n\nJust seeing this now, sorry about that.\n\nI ended up doing some sort of Docker container inside of a Docker container. Like Docker-ception.\n\nIt was a little bit of a time ago and I didn't stick with it aside from experimenting for a day or so, so I don't have a comprehensive workaround guide. This was just off the top of my head remembering what I did.","createdAt":"2025-09-02T01:52:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3896#issuecomment-3243545399","viewerDidAuthor":false}],"createdAt":"2025-06-03T14:51:39Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3896,"title":"cdktf: No prebuilt binaries found (target=22.0.0 runtime=node arch=arm64 libc= platform=linux)","updatedAt":"2025-09-02T01:52:52Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM0NTgwOA==","is_bot":false,"login":"farnoy","name":"Jakub OkoÅ„ski"},"body":"### Expected Behavior\n\nI'm using simple TypeScript code to generate my resources and CDKTF constructs. I expected it to be a fast process.\n\n### Actual Behavior\n\nWhen I profiled my script (without even running cdktf synth, jsut the script directly), I see huge overhead in `captureStackTrace` which is seemingly invoked all the time, whenever I call into a CDK TF routine.\n\n### Steps to Reproduce\n\nMy repro is private, but if you take a sizeable JavaScript CDKTF project, invoke it as:\n\n`$ node --inspect-brk main.js`\n\nThen capture a performance trace with Chrome devtools, you'll see captureStackTrace all over the place in leaf nodes.\n\nAfter that, test my workaround/hypothesis by executing the same command, attaching the chrome debugger, but then executing `require('cdktf/lib/tokens/private/stack-trace').captureStackTrace = () => [];` in the console **before** recording the performance profile.\n\nStubbing out `captureStackTrace` gives me a 10x speedup (3 seconds vs 300ms) in my CDK TF Stack generation. The `synth` function of CDKTF after that runs in about the same time, it's unaffected.\n\n### Versions\n\ntypescript\n\nlanguage: null\ncdktf-cli: 0.20.8\nnode: v22.3.0\nterraform: 1.9.2\narch: x64\nos: linux 6.14.5\n\n### Providers\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Provider Name       â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name            â”‚ Package Version â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ local               â”‚                  â”‚         â”‚ 2.5.2      â”‚                         â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ petetanton/cachet   â”‚                  â”‚         â”‚ 0.0.8      â”‚                         â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ mastercard/restapi  â”‚                  â”‚         â”‚ 1.19.1     â”‚                         â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ pagerduty/pagerduty â”‚                  â”‚         â”‚ 3.18.1     â”‚                         â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ datadog/datadog     â”‚ 3.44.0           â”‚ ^0.20.0 â”‚            â”‚ @cdktf/provider-datadog â”‚ 11.10.0         â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ tfe                 â”‚ 0.64.0           â”‚ ^0.20.0 â”‚            â”‚ @cdktf/provider-tfe     â”‚ 11.12.0         â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n```js\nrequire('cdktf/lib/tokens/private/stack-trace').captureStackTrace = () => [];\n```\n\nbefore running the bulk of the work in my CDK Stack generation.\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc6uKsNn","author":{"login":"farnoy"},"authorAssociation":"NONE","body":"Vanilla\n\n![Image](https://github.com/user-attachments/assets/c92472f6-f465-4015-bc2a-43567f948ccd)\n\nWith my stub workaround:\n\n![Image](https://github.com/user-attachments/assets/12026ebc-1749-46a7-9925-302d88a68436)\n\nJust the cost of my code and the use of friendlyLogicalId which triggers hashing","createdAt":"2025-05-30T11:01:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3892#issuecomment-2922038119","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7FbVlx","author":{"login":"gabegorelick"},"authorAssociation":"NONE","body":"In my rather large Typescript repo, disabling `captureStackTrace` as described above halved `cdktf synth` time from ~28s to ~14s.","createdAt":"2025-09-19T13:48:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3892#issuecomment-3312277873","viewerDidAuthor":false}],"createdAt":"2025-05-30T10:58:42Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3892,"title":"cdktf: excessive cost of captureStackTrace","updatedAt":"2025-09-19T13:48:33Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEyMTY3MDk=","is_bot":false,"login":"OrfeasZ","name":"Orfeas Zafeiris"},"body":"### Expected Behavior\n\nThe `oracle/oci` provider code should be generated and compile.\n\n### Actual Behavior\n\nThe provider fails to compile with the following errors:\n\n```\n0>DataOciDevopsRepositoryMirrorRecord.cs(19,132): Error CS0234 : The type or namespace name 'IDataOciDevopsRepositoryMirrorrecordConfig' does not exist in the namespace 'oci.DataOciDevopsRepositoryMirrorrecord' (are you missing an assembly reference?)\n0>DataOciDevopsRepositoryMirrorRecord.cs(14,131): Error CS0234 : The type or namespace name 'IDataOciDevopsRepositoryMirrorrecordConfig' does not exist in the namespace 'oci.DataOciDevopsRepositoryMirrorrecord' (are you missing an assembly reference?)\n0>LoadBalancerBackendSetConfig.cs(10,76): Error CS0234 : The type or namespace name 'ILoadBalancerBackendSetConfig' does not exist in the namespace 'oci.LoadBalancerBackendSet' (are you missing an assembly reference?)\n0>LoadBalancerBackendSetConfig.cs(17,43): Error CS0234 : The type or namespace name 'ILoadBalancerBackendSetHealthChecker' does not exist in the namespace 'oci.LoadBalancerBackendSet' (are you missing an assembly reference?)\n0>LoadBalancerBackendSetConfig.cs(75,43): Error CS0234 : The type or namespace name 'ILoadBalancerBackendSetLbCookieSessionPersistenceConfiguration' does not exist in the namespace 'oci.LoadBalancerBackendSet' (are you missing an assembly reference?)\n0>LoadBalancerBackendSetConfig.cs(87,43): Error CS0234 : The type or namespace name 'ILoadBalancerBackendSetSessionPersistenceConfiguration' does not exist in the namespace 'oci.LoadBalancerBackendSet' (are you missing an assembly reference?)\n0>LoadBalancerBackendSetConfig.cs(99,43): Error CS0234 : The type or namespace name 'ILoadBalancerBackendSetSslConfiguration' does not exist in the namespace 'oci.LoadBalancerBackendSet' (are you missing an assembly reference?)\n0>LoadBalancerBackendSetConfig.cs(111,43): Error CS0234 : The type or namespace name 'ILoadBalancerBackendSetTimeouts' does not exist in the namespace 'oci.LoadBalancerBackendSet' (are you missing an assembly reference?)\n0>LoadBalancerBackendSetHealthCheckerOutputReference.cs(232,51): Error CS0234 : The type or namespace name 'ILoadBalancerBackendSetHealthChecker' does not exist in the namespace 'oci.LoadBalancerBackendSet' (are you missing an assembly reference?)\n0>LoadBalancerBackendSetSessionPersistenceConfiguration.cs(10,101): Error CS0234 : The type or namespace name 'ILoadBalancerBackendSetSessionPersistenceConfiguration' does not exist in the namespace 'oci.LoadBalancerBackendSet' (are you missing an assembly reference?)\n0>LoadBalancerBackendSetSessionPersistenceConfigurationOutputReference.cs(92,51): Error CS0234 : The type or namespace name 'ILoadBalancerBackendSetSessionPersistenceConfiguration' does not exist in the namespace 'oci.LoadBalancerBackendSet' (are you missing an assembly reference?)\n0>LoadBalancerBackendSetSslConfigurationOutputReference.cs(218,51): Error CS0234 : The type or namespace name 'ILoadBalancerBackendSetSslConfiguration' does not exist in the namespace 'oci.LoadBalancerBackendSet' (are you missing an assembly reference?)\n0>LoadBalancerBackendSet.cs(141,51): Error CS0234 : The type or namespace name 'LoadBalancerBackendsetHealthCheckerOutputReference' does not exist in the namespace 'oci.LoadBalancerBackendset' (are you missing an assembly reference?)\n0>LoadBalancerBackendSet.cs(153,51): Error CS0234 : The type or namespace name 'LoadBalancerBackendsetSessionPersistenceConfigurationOutputReference' does not exist in the namespace 'oci.LoadBalancerBackendset' (are you missing an assembly reference?)\n0>LoadBalancerBackendSet.cs(159,51): Error CS0234 : The type or namespace name 'LoadBalancerBackendsetSslConfigurationOutputReference' does not exist in the namespace 'oci.LoadBalancerBackendset' (are you missing an assembly reference?)\n0>LoadBalancerBackendSet.cs(171,51): Error CS0234 : The type or namespace name 'LoadBalancerBackendsetTimeoutsOutputReference' does not exist in the namespace 'oci.LoadBalancerBackendset' (are you missing an assembly reference?)\n0>LoadBalancerBackendSetBackend.cs(8,77): Error CS0234 : The type or namespace name 'ILoadBalancerBackendsetBackend' does not exist in the namespace 'oci.LoadBalancerBackendset' (are you missing an assembly reference?)\n0>LoadBalancerBackendSetBackendOutputReference.cs(88,51): Error CS0234 : The type or namespace name 'ILoadBalancerBackendsetBackend' does not exist in the namespace 'oci.LoadBalancerBackendset' (are you missing an assembly reference?)\n0>DataOciLoadBalancerBackendSets.cs(104,59): Error CS0234 : The type or namespace name 'DataOciLoadBalancerBackendSetsBackendsetsList' does not exist in the namespace 'oci.DataOciLoadBalancerBackendSets' (are you missing an assembly reference?)\n0>DataOciLoadBalancerBackendSets.cs(110,59): Error CS0234 : The type or namespace name 'DataOciLoadBalancerBackendSetsFilterList' does not exist in the namespace 'oci.DataOciLoadBalancerBackendSets' (are you missing an assembly reference?)\n0>DataOciLoadBalancerBackendSetsBackendsets.cs(8,97): Error CS0234 : The type or namespace name 'IDataOciLoadBalancerBackendSetsBackendsets' does not exist in the namespace 'oci.DataOciLoadBalancerBackendSets' (are you missing an assembly reference?)\n0>DataOciLoadBalancerBackendSetsBackendsetsBackend.cs(8,104): Error CS0234 : The type or namespace name 'IDataOciLoadBalancerBackendSetsBackendsetsBackend' does not exist in the namespace 'oci.DataOciLoadBalancerBackendSets' (are you missing an assembly reference?)\n0>DataOciLoadBalancerBackendSetsBackendsetsLbCookieSessionPersistenceConfiguration.cs(8,136): Error CS0234 : The type or namespace name 'IDataOciLoadBalancerBackendSetsBackendsetsLbCookieSessionPersistenceConfiguration' does not exist in the namespace 'oci.DataOciLoadBalancerBackendSets' (are you missing an assembly reference?)\n0>DataOciLoadBalancerBackendSetsBackendsetsLbCookieSessionPersistenceConfigurationOutputReference.cs(82,59): Error CS0234 : The type or namespace name 'IDataOciLoadBalancerBackendSetsBackendsetsLbCookieSessionPersistenceConfiguration' does not exist in the namespace 'oci.DataOciLoadBalancerBackendSets' (are you missing an assembly reference?)\n0>DataOciLoadBalancerBackendSetsFilter.cs(10,92): Error CS0234 : The type or namespace name 'IDataOciLoadBalancerBackendSetsFilter' does not exist in the namespace 'oci.DataOciLoadBalancerBackendSets' (are you missing an assembly reference?)\n0>DataOciLoadBalancerBackendSetsBackendsetsHealthCheckerList.cs(39,59): Error CS0234 : The type or namespace name 'DataOciLoadBalancerBackendsetsBackendsetsHealthCheckerOutputReference' does not exist in the namespace 'oci.DataOciLoadBalancerBackendsets' (are you missing an assembly reference?)\n0>DataOciLoadBalancerBackendSetsBackendsetsOutputReference.cs(63,59): Error CS0234 : The type or namespace name 'DataOciLoadBalancerBackendsetsBackendsetsLbCookieSessionPersistenceConfigurationList' does not exist in the namespace 'oci.DataOciLoadBalancerBackendsets' (are you missing an assembly reference?)\n0>DataOciLoadBalancerBackendSetsBackendsetsSessionPersistenceConfiguration.cs(8,128): Error CS0234 : The type or namespace name 'IDataOciLoadBalancerBackendsetsBackendsetsSessionPersistenceConfiguration' does not exist in the namespace 'oci.DataOciLoadBalancerBackendsets' (are you missing an assembly reference?)\n0>DataOciLoadBalancerBackendSetsBackendsetsSessionPersistenceConfigurationList.cs(39,59): Error CS0234 : The type or namespace name 'DataOciLoadBalancerBackendsetsBackendsetsSessionPersistenceConfigurationOutputReference' does not exist in the namespace 'oci.DataOciLoadBalancerBackendsets' (are you missing an assembly reference?)\n0>DataOciLoadBalancerBackendSetsBackendsetsSslConfiguration.cs(8,113): Error CS0234 : The type or namespace name 'IDataOciLoadBalancerBackendsetsBackendsetsSslConfiguration' does not exist in the namespace 'oci.DataOciLoadBalancerBackendsets' (are you missing an assembly reference?)\n0>DataOciLoadBalancerBackendSetsBackendsetsSslConfigurationOutputReference.cs(88,59): Error CS0234 : The type or namespace name 'IDataOciLoadBalancerBackendsetsBackendsetsSslConfiguration' does not exist in the namespace 'oci.DataOciLoadBalancerBackendsets' (are you missing an assembly reference?)\n0>DataOciLoadBalancerBackendSetsFilterList.cs(39,59): Error CS0234 : The type or namespace name 'DataOciLoadBalancerBackendsetsFilterOutputReference' does not exist in the namespace 'oci.DataOciLoadBalancerBackendsets' (are you missing an assembly reference?)\n```\n\nThe referenced types / namespaces are there, but with different casing.\n\nFor example, `DataOciDevopsRepositoryMirrorRecord` references `oci.DataOciDevopsRepositoryMirrorrecord.IDataOciDevopsRepositoryMirrorrecordConfig`, while the correct type is `oci.DataOciDevopsRepositoryMirrorRecord.IDataOciDevopsRepositoryMirrorRecordConfig` (notice the upper-case `R` in `Record`). The rest of the errors seem to follow the same pattern.\n\n### Steps to Reproduce\n\n1. `cdktf init --template=csharp --local --providers=oracle/oci`\n2. Try to compile `.gen/oci/oci.csproj`\n\n### Versions\n\nlanguage: csharp\ncdktf-cli: 0.20.12\nnode: v20.17.0\ncdktf: 0.20.12\nconstructs: 10.3.0\njsii: 1.111.0\nterraform: 1.9.5\narch: x64\nos: win32 10.0.22631\ndotnet: 9.0.203\nproviders\noracle/oci@~> 7.2 (LOCAL)\n        terraform provider version: 7.2.0\n\n### Providers\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Provider Name             â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name                           â”‚ Package Version â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ oracle/oci                â”‚ 7.2.0            â”‚         â”‚ ~> 7.2     â”‚                                        â”‚                 â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\nThe errors can be fixed by hand, but not sure if there are any side-effects, as the JSII attributes have the same casing too.\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-05-30T10:28:12Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3891,"title":"cdktf: Generated Oracle OCI C# provider not compiling","updatedAt":"2025-05-30T10:28:12Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE0OTMyODM0","is_bot":false,"login":"swain","name":"Swain Molster"},"body":"### Description\n\nThe Terraform HCL docs claim that DynamoDB-based locking is now deprecated, and instead encourage using S3-based state locking: https://developer.hashicorp.com/terraform/language/backend/s3#state-locking.\n\nBut, enabling S3 state locking doesn't seem to be supported in the CDK. Are there plans to support this?\n\n### References\n\n-  https://developer.hashicorp.com/terraform/language/backend/s3#state-locking\n\n### Help Wanted\n\n- [x] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc6wyaD1","author":{"login":"stekern"},"authorAssociation":"NONE","body":"There is already an issue for this that I believe was closed by mistake: https://github.com/hashicorp/terraform-cdk/issues/3834\n\nIn the meantime you can use this workaround: https://github.com/hashicorp/terraform-cdk/issues/3834#issuecomment-2715730340","createdAt":"2025-06-12T10:11:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3889#issuecomment-2966003957","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6yCa1j","author":{"login":"lossanarch"},"authorAssociation":"NONE","body":"#3834 was indeed closed too early, and has now been locked, so this is the only issue left tracking this.","createdAt":"2025-06-19T07:16:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3889#issuecomment-2986978659","viewerDidAuthor":false}],"createdAt":"2025-05-29T16:34:06Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3889,"title":"COMPONENT: Support for S3-based State Locking","updatedAt":"2025-06-19T07:16:46Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjg4MTY3NQ==","is_bot":false,"login":"evanstachowiak","name":"Evan Stachowiak"},"body":"### Description\n\nHi,\n\nNow that Terraform ephemeral resources are out, is there any chance for getting this supported in CDKTF?\n\nhttps://developer.hashicorp.com/terraform/language/resources/ephemeral\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc7VvKfg","author":{"login":"sbkg0002"},"authorAssociation":"NONE","body":"Is there any progress on this?","createdAt":"2025-11-27T13:37:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"EYES","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3886#issuecomment-3585910752","viewerDidAuthor":false}],"createdAt":"2025-05-28T08:19:39Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3886,"title":"COMPONENT: Support Terraform ephemeral resources","updatedAt":"2025-11-27T13:37:02Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjQxMjEzOTE=","is_bot":false,"login":"jyecusch","name":"Jye Cusch"},"body":"### Expected Behavior\n\nIn the following example, the synth process should output HCL\n\n```javascript\nimport { Construct } from \"constructs\";\nimport { App, TerraformStack } from \"cdktf\";\n\nclass MyStack extends TerraformStack {\n  constructor(scope: Construct, id: string) {\n    super(scope, id);\n  }\n}\n\nconst app = new App({\n  // âš ï¸ AppConfig HCL property set to true\n  hclOutput: true,\n});\n\nnew MyStack(app, \"tfcdk-test\");\napp.synth();\n```\n\n### Actual Behavior\n\nIf you run `cdktf synch` using the CLI the `SYNTH_HCL_OUTPUT` env var is always set to `false`, which overrides the AppConfig, so the output is always `cdk.tf.json`.\n\nIf you run the project directly (e.g. `npx ts-node main.ts`) the `SYNTH_HCL_OUTPUT` isn't set, however the output is still in JSON format, but written to a file named `cdk.tf`, so the entire file is invalid.\n\nThis is because there are two disconnected `hclOutput` variables in the cdktf source. The `StackSynthesizer` class accepts `hclOutput` in its constructor. The `TerraformStack` class sets that constructor parameter exclusively from the `process.env.SYNTH_HCL_OUTPUT` variable. This value is used to [determine the contents of the output file](https://github.com/hashicorp/terraform-cdk/blob/1fb8588095a55d475dc4be28882ec4f42006ec8d/packages/cdktf/lib/synthesize/synthesizer.ts#L93). \n\nHowever, the file extension comes from `stackManifest.synthesizedStackPath`, which is correctly calculated from the `hclOutput` value from the manifest.\n\n### Steps to Reproduce\n\n1. `cdktf init --template=typescript --local`\n2. Edit `main.ts`, add the `hclOutput` property to the app, e.g. `new App({ hclOutput: true})`\n3. npx ts-node main.ts\n4. Check the contents of the output stack `cdk.tf` file\n\n### Versions\n\nlanguage: typescript\ncdktf-cli: 0.20.7\nnode: v20.11.1\ncdktf: 0.0.0\nconstructs: 10.4.2\njsii: null\nterraform: 1.5.7\narch: arm64\nos: darwin 24.4.0\n\n### Providers\n\nn/a\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\nRemove the hclOutput parameter from the `StackSynthesizer` class constructor and exclusively read it from the App (manifest).\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [x] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-05-22T03:59:39Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3875,"title":"cdktf: AppConfig.hclOutput is ignored","updatedAt":"2025-05-22T03:59:39Z"},{"assignees":[],"author":{"id":"U_kgDOCRhw9A","is_bot":false,"login":"jheck-abs","name":"Jonas Heck"},"body":"### Expected Behavior\n\nWhen testing with Jest and TypeScript the fullSynth method should returns the full synthesized version of the given stack.\n\n### Actual Behavior\n\nThe fullSynth method returns an erroneous JSON. \n```json\n\"cloudfoundry\": [\n      {\n        \"api_url\": \"${jsondecode(data.btp_subaccount_environment_instance.subaccount-environment-instance.labels)[\\\\\"API Endpoint\\\\\"]}\",\n        \"origin\": \"btpDeploymentUserOrigin\",\n        \"password\": \"btpDeploymentUserSecret\",\n        \"user\": \"btpDeploymentUser\"\n      }\n    ]\n```\n\nAbove you can see that in api_url the double quotes are escaped twice, this breaks the JSON syntax.\n\n### Steps to Reproduce\n\nThe bug can be reproduced in the following repo:\n[https://github.com/jheck-abs/terraform-testing](https://github.com/jheck-abs/terraform-testing)\n\n### Versions\n\nlanguage: typescript\ncdktf-cli: 0.20.12\nnode: v20.11.0\ncdktf: 0.20.12\nconstructs: 10.4.2\njsii: null\nterraform: 1.11.4\narch: x64\nos: win32 10.0.26100\n\n### Providers\n\n![Image](https://github.com/user-attachments/assets/f20543eb-0dc9-446f-b1c2-1a62ae3bfd36)\n\n### Gist\n\nhttps://github.com/jheck-abs/terraform-testing\n\n### Possible Solutions\n\ncurrently none\n\n### Workarounds\n\ncurrently none\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc60KQ4t","author":{"login":"mvk-abs"},"authorAssociation":"NONE","body":"any updates here from terraform cdktf side?","createdAt":"2025-07-01T08:25:56Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3874#issuecomment-3022589485","viewerDidAuthor":false}],"createdAt":"2025-05-20T13:30:22Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3874,"title":"cdktf: using fullSynth while testing returns invalid JSON","updatedAt":"2025-07-01T08:25:56Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjYxMDEyOQ==","is_bot":false,"login":"gabegorelick","name":"Gabe Gorelick"},"body":"### Expected Behavior\n\nI want to compile my Typescript Terraform with `erasableSyntaxOnly`. See https://www.typescriptlang.org/tsconfig/#erasableSyntaxOnly and https://devblogs.microsoft.com/typescript/announcing-typescript-5-8/#the---erasablesyntaxonly-option.\n\nErasable syntax is desirable since then you can use [Node's native support for Typescript](https://nodejs.org/api/typescript.html#type-stripping), removing the need for a compilation step or a custom runtime like `tsx` or `ts-node`.\n\n### Actual Behavior\n\nGenerated constructs use non-erasable syntax, leading to errors when compiling with `erasableSyntaxOnly` enabled:\n\n> error TS1294: This syntax is not allowed when 'erasableSyntaxOnly' is enabled.\n\nThis means applications that use generated constructs cannot enable `erasableSyntaxOnly` and cannot leverage Node's native Typescript support.\n\n### Steps to Reproduce\n\n1. Add a provider to cdktf.json `terraformProviders`\n2. Run `cdktf get`\n3. Generated Typescript code uses non-erasable syntax. I have verified that [parameter properties](https://www.typescriptlang.org/docs/handbook/2/classes.html#parameter-properties) are generated, but other non-erasable syntax may be as well. \n\n> error TS1294: This syntax is not allowed when 'erasableSyntaxOnly' is enabled.\n> constructor(protected terraformResource: cdktf.IInterpolatingParent, protected terraformAttribute: string, protected wrapsSet: boolean) {\n\n### Versions\n\nlanguage: typescript\ncdktf-cli: 0.20.12\nnode: v20.19.1\ncdktf: 0.20.12\nconstructs: 10.4.2\njsii: null\nterraform: 1.7.4\narch: arm64\nos: darwin 24.4.0\n\n### Providers\n\ntailscale/tailscale v0.17.2\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\nModify the Typescript code generation to not use parameter properties.\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc6sYwnG","author":{"login":"gabegorelick"},"authorAssociation":"NONE","body":"At least in the providers I use, the only non-erasable syntax is `constructor(protected terraformResource: cdktf.IInterpolatingParent, protected terraformAttribute: string, protected wrapsSet: boolean) {`. That seems to be generated in a few places in https://github.com/hashicorp/terraform-cdk/blob/1fb8588095a55d475dc4be28882ec4f42006ec8d/packages/%40cdktf/provider-generator/lib/get/generator/emitter/struct-emitter.ts.","createdAt":"2025-05-19T20:20:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3870#issuecomment-2892171718","viewerDidAuthor":false}],"createdAt":"2025-05-18T02:19:31Z","labels":[{"id":"MDU6TGFiZWwzMDEzNzM4ODIw","name":"needs-research","description":"","color":"709F22"}],"milestone":null,"number":3870,"title":"cdktf: generated Typescript constructs use non-erasable syntax","updatedAt":"2025-05-19T20:20:03Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjgxMzc3NDU=","is_bot":false,"login":"covracer","name":"Christopher Covington"},"body":"### Expected Behavior\n\nGenerate working HCL such as:\n```\nresource \"null_resource\" \"conditional_local\" {\n  count = local.envi == \"default\" ? 1 : 0\n}\n```\n\n### Actual Behavior\n\n```\njsii.errors.JavaScriptError:\n  @jsii/kernel.RuntimeError: Error: Resolution error: Resolution error: Trying to 'resolve()' a Construct at '/resource/null_resource/conditional_local/count/node'.\n\n  This often means an unintended cyclic dependency in your construct tree, leading to the resolution stuck in an infinite loop that fails.\n  This can happen if the scope passed into this construct is also part of its subtree.\n\n  To resolve this issue, refactor your code to avoid this cyclic dependency by changing the scope of this construct..\n  Object creation stack:\n    at new Intrinsic (/tmp/jsii-kernel-wIOsbW/node_modules/cdktf/lib/tokens/private/intrinsic.js:23:66)\n    at new OperatorExpression (/tmp/jsii-kernel-wIOsbW/node_modules/cdktf/lib/tfExpression.js:238:9)\n    at Op.eq (/tmp/jsii-kernel-wIOsbW/node_modules/cdktf/lib/terraform-operators.js:87:16)\n    at /tmp/tmputp_aeu1/lib/program.js:315:152\n    at Kernel._Kernel_ensureSync (/tmp/tmputp_aeu1/lib/program.js:920:24)\n    at Kernel.sinvoke (/tmp/tmputp_aeu1/lib/program.js:315:102)\n    at KernelHost.processRequest (/tmp/tmputp_aeu1/lib/program.js:15471:36)\n    at KernelHost.run (/tmp/tmputp_aeu1/lib/program.js:15431:22)\n    at Immediate._onImmediate (/tmp/tmputp_aeu1/lib/program.js:15432:46)\n    at process.processImmediate (node:internal/timers:491:21).\n  Object creation stack:\n    at new Intrinsic (/tmp/jsii-kernel-wIOsbW/node_modules/cdktf/lib/tokens/private/intrinsic.js:23:66)\n    at new ConditionalExpression (/tmp/jsii-kernel-wIOsbW/node_modules/cdktf/lib/tfExpression.js:211:9)\n    at conditional (/tmp/jsii-kernel-wIOsbW/node_modules/cdktf/lib/tfExpression.js:230:12)\n    at Fn.conditional (/tmp/jsii-kernel-wIOsbW/node_modules/cdktf/lib/terraform-functions.js:31:35)\n    at /tmp/tmputp_aeu1/lib/program.js:315:152\n    at Kernel._Kernel_ensureSync (/tmp/tmputp_aeu1/lib/program.js:920:24)\n    at Kernel.sinvoke (/tmp/tmputp_aeu1/lib/program.js:315:102)\n    at KernelHost.processRequest (/tmp/tmputp_aeu1/lib/program.js:15471:36)\n    at KernelHost.run (/tmp/tmputp_aeu1/lib/program.js:15431:22)\n    at Immediate._onImmediate (/tmp/tmputp_aeu1/lib/program.js:15432:46)\n    at process.processImmediate (node:internal/timers:491:21)\n      at Kernel._Kernel_ensureSync (/tmp/tmputp_aeu1/lib/program.js:931:23)\n      at Kernel.invoke (/tmp/tmputp_aeu1/lib/program.js:294:102)\n      at KernelHost.processRequest (/tmp/tmputp_aeu1/lib/program.js:15471:36)\n      at KernelHost.run (/tmp/tmputp_aeu1/lib/program.js:15431:22)\n      at Immediate._onImmediate (/tmp/tmputp_aeu1/lib/program.js:15432:46)\n      at process.processImmediate (node:internal/timers:491:21)\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"<frozen runpy>\", line 198, in _run_module_as_main\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/home/cov/prj/helicopyter/documentation/ternary.py\", line 57, in <module>\n    print(stack.to_hcl_terraform()['hcl'])\n          ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/cov/prj/helicopyter/.venv/lib/python3.12/site-packages/cdktf/__init__.py\", line 14880, in to_hcl_terraform\n    return typing.cast(typing.Mapping[builtins.str, typing.Any], jsii.invoke(self, \"toHclTerraform\", []))\n                                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/cov/prj/helicopyter/.venv/lib/python3.12/site-packages/jsii/_kernel/__init__.py\", line 149, in wrapped\n    return _recursize_dereference(kernel, fn(kernel, *args, **kwargs))\n                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/cov/prj/helicopyter/.venv/lib/python3.12/site-packages/jsii/_kernel/__init__.py\", line 399, in invoke\n    response = self.provider.invoke(\n               ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/cov/prj/helicopyter/.venv/lib/python3.12/site-packages/jsii/_kernel/providers/process.py\", line 380, in invoke\n    return self._process.send(request, InvokeResponse)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/cov/prj/helicopyter/.venv/lib/python3.12/site-packages/jsii/_kernel/providers/process.py\", line 342, in send\n    raise RuntimeError(resp.error) from JavaScriptError(resp.stack)\nRuntimeError: Error: Resolution error: Resolution error: Trying to 'resolve()' a Construct at '/resource/null_resource/conditional_local/count/node'.\n\nThis often means an unintended cyclic dependency in your construct tree, leading to the resolution stuck in an infinite loop that fails.\nThis can happen if the scope passed into this construct is also part of its subtree.\n\nTo resolve this issue, refactor your code to avoid this cyclic dependency by changing the scope of this construct..\nObject creation stack:\n  at new Intrinsic (/tmp/jsii-kernel-wIOsbW/node_modules/cdktf/lib/tokens/private/intrinsic.js:23:66)\n  at new OperatorExpression (/tmp/jsii-kernel-wIOsbW/node_modules/cdktf/lib/tfExpression.js:238:9)\n  at Op.eq (/tmp/jsii-kernel-wIOsbW/node_modules/cdktf/lib/terraform-operators.js:87:16)\n  at /tmp/tmputp_aeu1/lib/program.js:315:152\n  at Kernel._Kernel_ensureSync (/tmp/tmputp_aeu1/lib/program.js:920:24)\n  at Kernel.sinvoke (/tmp/tmputp_aeu1/lib/program.js:315:102)\n  at KernelHost.processRequest (/tmp/tmputp_aeu1/lib/program.js:15471:36)\n  at KernelHost.run (/tmp/tmputp_aeu1/lib/program.js:15431:22)\n  at Immediate._onImmediate (/tmp/tmputp_aeu1/lib/program.js:15432:46)\n  at process.processImmediate (node:internal/timers:491:21).\nObject creation stack:\n  at new Intrinsic (/tmp/jsii-kernel-wIOsbW/node_modules/cdktf/lib/tokens/private/intrinsic.js:23:66)\n  at new ConditionalExpression (/tmp/jsii-kernel-wIOsbW/node_modules/cdktf/lib/tfExpression.js:211:9)\n  at conditional (/tmp/jsii-kernel-wIOsbW/node_modules/cdktf/lib/tfExpression.js:230:12)\n  at Fn.conditional (/tmp/jsii-kernel-wIOsbW/node_modules/cdktf/lib/terraform-functions.js:31:35)\n  at /tmp/tmputp_aeu1/lib/program.js:315:152\n  at Kernel._Kernel_ensureSync (/tmp/tmputp_aeu1/lib/program.js:920:24)\n  at Kernel.sinvoke (/tmp/tmputp_aeu1/lib/program.js:315:102)\n  at KernelHost.processRequest (/tmp/tmputp_aeu1/lib/program.js:15471:36)\n  at KernelHost.run (/tmp/tmputp_aeu1/lib/program.js:15431:22)\n  at Immediate._onImmediate (/tmp/tmputp_aeu1/lib/program.js:15432:46)\n  at process.processImmediate (node:internal/timers:491:21)\n```\n\n### Steps to Reproduce\n\n#### ternary.py\n```python\nfrom cdktf import App, Fn, Op, TerraformStack, TerraformLocal, Token\nfrom cdktf_cdktf_provider_null.resource import Resource as NullResource\n\n\nstack = TerraformStack(App(), 'my-stack')\n\nNullResource(\n    stack,\n    'works-override_workspace',\n).add_override('count', '${terraform.workspace == \"default\" ? 1 : 0}')\n\nNullResource(\n    stack,\n    'works-as_number_workspace',\n    count=Token.as_number('${terraform.workspace == \"default\" ? 1 : 0}')\n)\n\nNullResource(\n    stack,\n    'broken_at_runtime-conditional_workspace',\n    count=Token.as_number(Fn.conditional(Op.eq('${terraform.workspace}', 'default'), 1, 0)),\n)\n\nNullResource(\n    stack,\n    'broken_at_runtime-conditional_workspace_as_string',\n    count=Token.as_number(Fn.conditional(Op.eq(Token.as_string('${terraform.workspace}'), 'default'), 1, 0)),\n)\n\n# Edit: additional writeup https://github.com/hashicorp/terraform/issues/33150 since original report\nNullResource(\n    stack,\n    'broken_at_runtime-tonumber_workspace_as_any',\n    count=Fn.tonumber(Op.eq(Token.as_any('terraform.workspace'), 'default')),\n)\n\n# Edit: new discovery https://devops.stackexchange.com/a/20288/24989 since original report\nNullResource(\n    stack,\n    'works-conditional_workspace_as_any',\n    count=Token.as_number(Fn.conditional(Op.eq(Token.as_any('terraform.workspace'), 'default'), 1, 0)),\n)\n\nlocal = TerraformLocal(stack, 'envi', '${terraform.workspace}')\n\nNullResource(\n    stack,\n    'works-override_local',\n).add_override('count', '${local.envi == \"default\" ? 1 : 0}')\n\n\nNullResource(\n    stack,\n    'works-as_number_local',\n    count=Token.as_number('${local.envi == \"default\" ? 1 : 0}')\n)\n\nNullResource(\n    stack,\n    'works-conditional_local_to_string',\n    count=Token.as_number(Fn.conditional(Op.eq(local.to_string(), 'default'), 1, 0)),\n)\n\n# Crashes\nNullResource(\n    stack,\n    'conditional_local',\n    count=Token.as_number(Fn.conditional(Op.eq(local, 'default'), 1, 0)),\n)\n\nprint(stack.to_hcl_terraform()['hcl'])\n```\n\n```sh\npython -m ternary | terraform fmt -\n```\n\n### Versions\n\ncdktf 0.20.12 (via uv pip) \nconstructs 10.4.2 (via uv pip) \njsii 1.111.0 (via uv pip) \nnode v22.14.0 (via asdf)\npython 3.12.3 (via uv)\n\n### Providers\n\nregistry.terraform.io/hashicorp/null 3.2.4\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\nSee above for `to_string()` and other alternatives.\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-05-02T12:19:17Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3865,"title":"Resolution error: Trying to 'resolve()' a Construct","updatedAt":"2025-05-02T14:20:06Z"},{"assignees":[{"id":"MDQ6VXNlcjU3MzUzMQ==","login":"mutahhir","name":"Mutahhir Hayat","databaseId":0}],"author":{"id":"MDQ6VXNlcjYxMDEyOQ==","is_bot":false,"login":"gabegorelick","name":"Gabe Gorelick"},"body":"### Expected Behavior\n\nNo deprecation warnings when running cdktf. \n\n### Actual Behavior\n\nWhen running on Node 22+, the following deprecation warning is logged:\n\n> [DEP0044] DeprecationWarning: The `util.isArray` API is deprecated. Please use `Array.isArray()` instead.\n\nSee https://nodejs.org/api/deprecations.html#DEP0044\n\nRelevant code: https://github.com/hashicorp/terraform-cdk/blob/fde8712078663595f2da4e90a9dfb718474b4ee0/packages/cdktf/lib/terraform-output.ts#L8\n\n### Steps to Reproduce\n\n1. Use Node 22+ (I've tested this on 22.15.0 and 23.11.0)\n2. Run `cdktf synth` on a project that uses TerraformOutput\n3. See deprecation warning\n\n### Versions\n\nlanguage: typescript\ncdktf-cli: 0.20.12\nnode: v22.15.0\ncdktf: 0.20.12\nconstructs: 10.4.2\njsii: 5.7.3\narch: arm64\nos: macOS\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [x] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-04-23T16:12:55Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3860,"title":"cdktf: DEP0044 in TerraformOutput","updatedAt":"2025-06-02T11:53:49Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM2Mjc2NDAz","is_bot":false,"login":"Veetaha","name":"Vitalii Kryvenko"},"body":"### Expected Behavior\n\nThe `@cdktf/hcl-tools` package works perfectly fine in NodeJS environments. There is no need to pull in the type definitions for the DOM library.\n\n### Actual Behavior\n\nThe `@cdktf/hcl-tools` package pulls in the DOM TypeScript library via the triple slash directive, which pollutes the global namespace of the entire TypeScript app that depends on this package with the unnecessary DOM library types:\n\nhttps://github.com/hashicorp/terraform-cdk/blob/41c1ccdbf9c9f140161d643bda424ee8595a7e48/packages/%40cdktf/hcl-tools/src/bridge.ts#L4\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-04-16T13:07:54Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3853,"title":"@cdktf/hcl-tools: unnecessary /// <reference lib=\"dom\" />","updatedAt":"2025-04-16T13:08:04Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE5OTI3NjA=","is_bot":false,"login":"jonshaffer","name":"Jonathan Shaffer"},"body":"the google/gcp provider fails cdktf init in go. i've been having issues importing the go cdktf google provider in a new project\n\n```bash\nâœ  test cdktf init --template=go --local\nNote: By supplying '--local' option you have chosen local storage mode for storing the state of your stack.\nThis means that your Terraform state file will be stored locally on disk in a file 'terraform.<STACK NAME>.tfstate' in the root of your project.\n? Project Name cdktfpoc-gcp\n? Project Description A simple getting started project for cdktf.\n? Do you want to send crash reports to the CDKTF team? Refer to \nhttps://developer.hashicorp.com/terraform/cdktf/create-and-deploy/configuration-file#enable-crash-reporting-for-the-cli for more information yes\nNote: You can always add providers using 'cdktf provider add' later on\n? What providers do you want to use? google, googlebeta\ngo: downloading github.com/aws/constructs-go/constructs/v10 v10.3.0\ngo: downloading github.com/aws/jsii-runtime-go v1.102.0\ngo: downloading github.com/Masterminds/semver/v3 v3.2.1\ngo: upgraded github.com/aws/jsii-runtime-go v1.67.0 => v1.102.0\n========================================================================================================\n\n  Your cdktf go project is ready!\n\n  cat help                Prints this message\n\n  Compile:\n    go build              Builds your go project\n\n  Synthesize:\n    cdktf synth [stack]   Synthesize Terraform resources to cdktf.out/\n\n  Diff:\n    cdktf diff [stack]    Perform a diff (terraform plan) for the given stack\n\n  Deploy:\n    cdktf deploy [stack]  Deploy the given stack\n\n  Destroy:\n    cdktf destroy [stack] Destroy the given stack\n\n  Learn more about using modules and providers https://cdk.tf/modules-and-providers\n\nUse Providers:\n\n  Use the add command to add providers:\n  \n  cdktf provider add \"aws@~>3.0\" null kreuzwerker/docker\n\n  Learn more: https://cdk.tf/modules-and-providers\n\n========================================================================================================\n[2025-03-23T07:45:12.026] [INFO] default - Checking whether pre-built provider exists for the following constraints:\n  provider: google\n  version : latest\n  language: go\n  cdktf   : 0.20.11\n\n[2025-03-23T07:45:12.822] [INFO] default - Found pre-built provider.\nAdding package github.com/cdktf/cdktf-provider-google-go/google @ 14.24.0\n[2025-03-23T07:45:13.323] [ERROR] default - go: downloading github.com/cdktf/cdktf-provider-google-go/google/v14 v14.24.0\n\ngo: downloading github.com/cdktf/cdktf-provider-google-go/google/v14 v14.24.0\n[2025-03-23T07:45:28.302] [ERROR] default - go: upgraded go 1.18 => 1.21\ngo: added toolchain go1.23.0\ngo: upgraded github.com/Masterminds/semver/v3 v3.2.1 => v3.3.1\ngo: upgraded github.com/aws/constructs-go/constructs/v10 v10.3.0 => v10.4.2\ngo: upgraded github.com/aws/jsii-runtime-go v1.102.0 => v1.108.0\ngo: added github.com/cdktf/cdktf-provider-google-go/google/v14 v14.24.0\n\ngo: upgraded go 1.18 => 1.21\ngo: added toolchain go1.23.0\ngo: upgraded github.com/Masterminds/semver/v3 v3.2.1 => v3.3.1\ngo: upgraded github.com/aws/constructs-go/constructs/v10 v10.3.0 => v10.4.2\ngo: upgraded github.com/aws/jsii-runtime-go v1.102.0 => v1.108.0\ngo: added github.com/cdktf/cdktf-provider-google-go/google/v14 v14.24.0\nPackage installed.\n[2025-03-23T07:45:28.308] [INFO] default - Checking whether pre-built provider exists for the following constraints:\n  provider: google-beta\n  version : latest\n  language: go\n  cdktf   : 0.20.11\n\nPre-built provider information not found\nError: Pre-built provider information not found\n    at yqt (/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:2716)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async TH (/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:2207)\n    at async gHe (/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:3484)\n    at async BH (/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:4124)\n    at async yD.hasPrebuiltProvider (/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:172:183)\n    at async yD.addProvider (/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:8837)\n    at async Boe (/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:173:2071)\n    at async Zqt (/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:173:140)\n    at async kje (/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:518:2552)\nCollecting Debug Information...\n/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/node_modules/yoga-layout-prebuilt/yoga-layout/build/Release/nbind.js:53\n        throw ex;\n        ^\n\nError: Pre-built provider information not found\n    at yqt (/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:2716)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async TH (/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:2207)\n    at async gHe (/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:3484)\n    at async BH (/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:4124)\n    at async yD.hasPrebuiltProvider (/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:172:183)\n    at async yD.addProvider (/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:167:8837)\n    at async Boe (/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:173:2071)\n    at async Zqt (/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:173:140)\n    at async kje (/usr/local/Cellar/cdktf/0.20.11/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:518:2552)\n\nNode.js v23.10.0\n```","comments":[{"id":"IC_kwDODd1Amc6pTS82","author":{"login":"guywilsonjr"},"authorAssociation":"NONE","body":"@jonshaffer Don't use NodeJS23. You must use Node22. Only the Even versions are LTS and all the big companies only support that for node. https://nodejs.org/en/about/previous-releases","createdAt":"2025-04-29T22:49:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3845#issuecomment-2840407862","viewerDidAuthor":false}],"createdAt":"2025-03-23T11:53:51Z","labels":[],"milestone":null,"number":3845,"title":"`google` provider: golang cdktf init fails","updatedAt":"2025-04-29T22:49:36Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjQwNDUyNTU5","is_bot":false,"login":"mimozell","name":""},"body":"### Expected Behavior\n\naws_s3_bucket_lifecycle_configuration.expiration should continue being an object (instead of array) same as in the AWS provider version 5.90.0 or before (currently an issue in 5.90.1 and 5.90.2)\n\n### Actual Behavior\n\nLogged the issue with the provider as well here: https://github.com/hashicorp/terraform-provider-aws/issues/41896\n\naws_s3_bucket_lifecycle_configuration.expiration has changed from being an object into being an array. In the terraform configuration this change is not apparent, but it breaks cdktf configurations in versions after 5.90.0. Previously a rule would be configured the following way:\n```\n      {\n        id: \"expire_object\",\n        status: \"Enabled\",\n        expiration: {\n          days: 7\n        },\n      },\n```\nwhile now we need to use:\n```\n      {\n        id: \"expire_object\",\n        status: \"Enabled\",\n        expiration: [{\n          days: 7\n        }],\n      },\n```\nfor no apparent reason. Configurations break with the following error:\n`Type '{ id: string; status: string; expiration: { days: number; }; }' is not assignable to type 'S3BucketLifecycleConfigurationRule'.\n        Types of property 'expiration' are incompatible.\n          Object literal may only specify known properties, and 'days' does not exist in type 'IResolvable | S3BucketLifecycleConfigurationRuleExpiration[]'.`\n\nI suspect expiration has changed from an object to a dynamic in terraform, that's why in the native HCL documentation - that has only examples of single expiration {} blocks - this change is not apparent, but becomes very visible when selecting the TypeScript docs.\n\n### Steps to Reproduce\n\n1. Create a bucket\n2. Set S3BucketLifecycleConfigurationRule with an lifecycle rule to expire objects\n\n### Versions\n\n@cdktf/provider-aws: 19.57.0\ncdktf-cli: 0.20.11\nterraform: v1.10.2\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc6lftpw","author":{"login":"InfraPlatformer"},"authorAssociation":"NONE","body":"Hi @hashicorp/cdk-team, I'd like to contribute a fix for this issue where aws_s3_bucket_lifecycle_configuration.expiration changed from object to array format in AWS provider v5.90.1+.\n\nProblem Confirmation\nConfirmed the breaking change between provider v5.90.0 (object) â†’ v5.90.1+ (array)\n\nCDKTF's current typings don't reflect this provider change\n\nProposed Solution\n\nType Definition Update:\n\n// Current\nreadonly expiration?: S3BucketLifecycleConfigurationRuleExpiration;\n\n// Proposed\nreadonly expiration?: S3BucketLifecycleConfigurationRuleExpiration | S3BucketLifecycleConfigurationRuleExpiration[];\n\nRuntime Normalization:\nprivate normalizeExpiration(exp: any) {\n  return exp ? (Array.isArray(exp) ? exp : [exp]) : undefined;\n}\n\nShould we match the provider's exact behavior (array-only) or support both?\n\nAny concerns with this approach?\n\nIf approved, I can submit a PR with tests and docs updates.","createdAt":"2025-04-03T18:02:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3842#issuecomment-2776554096","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6lh5ha","author":{"login":"mimozell"},"authorAssociation":"NONE","body":"@SREAlam since cdktf is generated from terraform, I think your approach wouldn't work, because on every regeneration it would be overridden. ","createdAt":"2025-04-03T22:23:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3842#issuecomment-2777127002","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6loP9L","author":{"login":"InfraPlatformer"},"authorAssociation":"NONE","body":"Hi @mimozell,\n\nThank you for clarifying that CDKTFâ€™s types are generated from Terraform schemasâ€”I understand now that manual fixes would be overwritten on regeneration.\n\nProposed Next Steps\nUpstream Fix (AWS Provider):\n\nIâ€™ll engage with the AWS provider team ([hashicorp/terraform-provider-aws#41896](https://github.com/hashicorp/terraform-provider-aws/issues/41896)) to:\n\nConfirm if this was an intentional schema change\n\nPropose reverting to Type: Object or adding ConfigMode: SchemaConfigModeAttr for backward compatibility\n\nWould you prefer I focus on the AWS provider fix first?\n\nIf the schema must stay as Type: List(Object), is there a CDKTF mechanism (e.g., schema patches) to preserve backward compatibility?\n\nIâ€™m happy to collaborate on the best path forwardâ€”let me know how youâ€™d like to proceed!","createdAt":"2025-04-04T13:51:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3842#issuecomment-2778791755","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6loZoO","author":{"login":"InfraPlatformer"},"authorAssociation":"NONE","body":"Hi @mimozell,\n\nThanks for spotting the prefix issue too - this confirms the pattern affects multiple attributes. Since manual type changes would be overwritten, I propose:\n\nImmediate User Solution:\nI'll draft a helper function users can import to normalize both cases:\n\nexport function normalizeLifecycleRule(rule: {\n  expiration?: object | object[],\n  filter?: { prefix?: string } | Array<{ prefix?: string }>\n}) {\n  return {\n    ...rule,\n    expiration: rule.expiration ? (Array.isArray(rule.expiration) ? rule.expiration : [rule.expiration]) : undefined,\n    filter: rule.filter ? (Array.isArray(rule.filter) ? rule.filter : [rule.filter]) : undefined\n  }\n}\n\n\nLong-Term Fix:\nI've commented on hashicorp/terraform-provider-aws#41896 asking:\n\nIf these changes were intentional\n\nWhether they'd accept a PR adding ConfigMode: SchemaConfigModeAttr to prevent forced array wrapping\n\nDocumentation:\nCan we add a migration note to CDKTF's AWS provider docs explaining this pattern?\n\nWould you prefer I:\n\nFocus on the AWS provider fix first?\n\nSubmit the helper function as a temporary solution?\n","createdAt":"2025-04-04T14:06:49Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3842#issuecomment-2778831374","viewerDidAuthor":false}],"createdAt":"2025-03-18T11:08:55Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3842,"title":"AWS Provider: aws_s3_bucket_lifecycle_configuration change in expiration breaks configuration","updatedAt":"2025-04-04T14:06:50Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM1NzQwNTEy","is_bot":false,"login":"risenxxx","name":"Evgenii Zakharov"},"body":"### Expected Behavior\n\nThe `value` property in `ZoneSetting` from `@cdktf/provider-cloudflare` should accept string values like 'on', 'off', 'full', etc., as these are valid values for many Cloudflare zone settings. The TypeScript type definitions should correctly reflect the actual data types Cloudflare API accepts for settings.\n\n### Actual Behavior\n\nThe current type definition for the value property in ZoneSetting only accepts objects, not primitive values like strings. This forces developers to use type assertions (as any) to bypass TypeScript errors when setting common string values, as shown in this example:\n\n```ts\nnew zoneSetting.ZoneSetting(this, 'example', {\n  zoneId: zoneId,\n  settingId: 'always_use_https',\n  value: 'on' as any,\n})\n```\n\nWithout the as any assertion, TypeScript generates an error indicating that a string value cannot be assigned to the value property, even though 'on' is a perfectly valid setting value for the always_use_https setting in Cloudflare's API. For such settings, any object values causing the errors like that:\n\n```\nError: failed to make http request\n\nwith cloudflare_zone_setting.example\n\nPATCH\n\"https://api.cloudflare.com/client/v4/zones/<redacted>/settings/always_use_https\":\n400 Bad Request {\"success\":false,\"errors\":[{\"code\":1007,\"message\":\"Invalid\nvalue for zone setting always_use_https\"}],\"messages\":[],\"result\":null}\n```\n\n### Steps to Reproduce\n\n1. Install the `@cdktf/provider-cloudflare` package in a TypeScript project\n2. Import the `zoneSetting` module\n3. Try to create a new `ZoneSetting` instance with a string value for common Cloudflare settings:\n    ```ts\n    new zoneSetting.ZoneSetting(this, 'cluster_setting_always_use_https', {\n      zoneId: clusterZone.zoneId,\n      settingId: 'always_use_https',\n      value: 'on' as any, // Type assertion needed to avoid errors\n    })\n    ```\n4. Observe the TypeScript error indicating that a string cannot be assigned to the value property\n5. Note that using value: 'on' as any works as a workaround but is not an ideal solution as it bypasses type checking\n\nThe issue affects multiple Cloudflare settings including but not limited to:\n- always_use_https (accepts 'on' / 'off')\n- automatic_https_rewrites (accepts 'on' / 'off')\n- ssl (accepts 'off' / 'flexible' / 'full' / 'strict')\n- security_level (accepts 'off' / 'essentially_off' / 'low' / 'medium' / 'high' / 'under_attack')\n\nThis type definition issue requires unnecessary type assertions throughout the codebase and reduces the DX and benefits of TypeScript's static type checking.\n\n### Versions\n\ncdktf debug\nlanguage: typescript\ncdktf-cli: 0.20.11\nnode: v20.18.1\ncdktf: 0.20.11\nconstructs: 10.4.2\njsii: null\nterraform: 1.10.3\narch: arm64\nos: darwin 24.3.0\nproviders\n@cdktf/provider-cloudflare (PREBUILT)\n        terraform provider version: 5.1.0 \n        prebuilt provider version: 12.1.0\n        cdktf version: ^0.20.0\n\n### Providers\n\n@cdktf/provider-cloudflare (PREBUILT)\n        terraform provider version: 5.1.0 \n        prebuilt provider version: 12.1.0\n        cdktf version: ^0.20.0\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\nModify the ZoneSetting type to accept either string values or objects for the value property using a union type:\n\n```ts\nvalue: string | object | boolean | number\n```\n\n### Workarounds\n\nContinue using type assertions with as any as in the example:\n\n```ts\nnew zoneSetting.ZoneSetting(this, 'cluster_setting_always_use_https', {\n   zoneId: clusterZone.zoneId,\n   settingId: 'always_use_https',\n   value: 'on' as any,\n })\n```\n\nOr create wrapper class / function:\n\n```ts\nclass TypedZoneSetting extends zoneSetting.ZoneSetting {\n  constructor(\n    scope: Construct,\n    id: string,\n    config: Omit<zoneSetting.ZoneSettingConfig, 'value'> & {\n      value: object | string\n    },\n  ) {\n    super(scope, id, { ...config, value: config.value as object })\n  }\n}\n```\n\n### Anything Else?\n\n_No response_\n\n### References\n\nMay be related:\n- https://github.com/hashicorp/terraform-cdk/issues/3822\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-03-08T19:56:40Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"}],"milestone":null,"number":3835,"title":"cloudflare: broken setting value types","updatedAt":"2025-03-08T20:48:10Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE2MjA0NDUy","is_bot":false,"login":"benkeil","name":"Ben Keil"},"body":"### Expected Behavior\n\nIt should render the ids into the json.\n\n### Actual Behavior\n\nWe try to start an ECS task with a step function state machine with the following definition.\n\n```kotlin\n.withDefinition(\n  \"\"\"\n  {\n    \"Comment\": \"${env.stage}.${env.service}.${config.name}.step-function state machine\",\n    \"StartAt\": \"List Tasks\",\n    \"States\": {\n      \"Start Task\": {\n        \"Resource\": \"arn:aws:states:::ecs:runTask.sync\",\n        \"Parameters\": {\n          \"LaunchType\": \"FARGATE\",\n          \"Cluster\": \"$clusterArn\",\n          \"TaskDefinition\": \"${task.taskDefinitionArn}\",\n          \"PropagateTags\": \"TASK_DEFINITION\",\n          \"NetworkConfiguration\": {\n            \"AwsvpcConfiguration\": {\n              \"Subnets\": ${subnets.ids},\n              \"SecurityGroups\": [\n                \"${task.securityGroupIdOutput}\"\n              ],\n              \"AssignPublicIp\": \"DISABLED\"\n            }\n          }\n        },\n        \"Retry\": [\n          {\n            \"ErrorEquals\": [\n              \"States.ALL\"\n            ],\n            \"IntervalSeconds\": 60,\n            \"MaxAttempts\": 3,\n            \"BackoffRate\": 2.0,\n            \"JitterStrategy\": \"FULL\"\n          }\n        ],\n        \"End\": true,\n        \"Type\": \"Task\"\n      },\n      \"Skip task\": {\n        \"Type\": \"Succeed\"\n      },\n      \"List Tasks\": {\n        \"Resource\": \"arn:aws:states:::aws-sdk:ecs:listTasks\",\n        \"Parameters\": {\n          \"Cluster\": \"$clusterArn\",\n          \"DesiredStatus\": \"RUNNING\",\n          \"Family\": \"${task.taskDefinitionArn}\"\n        },\n        \"Next\": \"Check for already running task\",\n        \"Type\": \"Task\"\n      },\n      \"Check for already running task\": {\n        \"Choices\": [\n          {\n            \"Not\": {\n              \"Variable\": \"${'$'}.TaskArns[0]\",\n              \"IsPresent\": true\n            },\n            \"Next\": \"Start Task\"\n          }\n        ],\n        \"Default\": \"Skip task\",\n        \"Type\": \"Choice\"\n      }\n    }\n  }\n\"\"\"\n    .trimIndent()\n```\n\nOur problem is the line `\"Subnets\": ${subnets.ids},` wich lead to the error `Found an encoded list token string in a scalar string context`. `subnets` is of type `DataAwsSubnets`.\n\nIt sounds for me like a bug, because we don'y try yo access a single element and we also don't care about the length of the `ids` property. I already tried to wrap it into `Token.asList` which does not help.\n\n### Steps to Reproduce\n\nMinimal code example that should point out the problem:\n\n\n```kotlin\nval subnets = DataAwsSubnets.Builder.create(this, \"subnets\").build()\n\nSfnStateMachine.Builder.create(this, \"SfnStateMachine\")\n    .name(\"example\")\n    .roleArn(\"arn:aws:iam::123456789012:role/foobar\")\n    .definition(\n        \"\"\"\n        {\n          \"Comment\": \"A Hello World example of the Amazon States Language using Pass states\",\n          \"StartAt\": \"HelloWorld\",\n          \"States\": {\n            \"HelloWorld\": {\n              \"Type\": \"Pass\",\n              \"Result\": \"Hello, World!\",\n              \"Parameters\": {\n                \"subnets\": \"${subnets.ids}\"\n              },\n              \"End\": true\n            }\n          }\n        }\n        \"\"\"\n            .trimIndent())\n    .build()\n```\n\n### Versions\n\n`cdktf debug` returns `External Error: Could not determine cdktf version. Please make sure you are in a directory containing a cdktf project and have all dependencies installed.`\n\nlanguage: java\ncdktf-cli: 0.20.11\n\nlibs.versions.tom:\n\n```toml\ncdktf = { module = \"com.hashicorp:cdktf\", version = \"0.20.11\" }\ncdktf-provider-aws = { module = \"com.hashicorp:cdktf-provider-aws\", version = \"19.53.0\" }\nconstructs = { module = \"software.constructs:constructs\", version = \"10.4.2\" }\n```\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-02-26T11:56:02Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3832,"title":"cdktf: Found an encoded list token string in a scalar string context","updatedAt":"2025-02-26T11:59:51Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjU4NTUwMQ==","is_bot":false,"login":"sixcorners","name":""},"body":"### Expected Behavior\n\nI want to init a project.\n\n### Actual Behavior\n\nWhen I try to init a project with node 20 it says that npm isn't returning a valid version.\nWhen I try to init a project after switching to node 22 it says a module is missing.\nWhen I try to init a project with node 22 after deleting my ~/.npm it says nothing other than the usual npm install warnings that say three packages being used are no longer supported.\n\n### Steps to Reproduce\n\n```\n$ sudo snap refresh node --channel 20/stable\n...\n$ npx cdktf-cli init\n...\nCould not run version check - npm returned an invalid semver \nUsage Error: Node.js version could not be determined\n$ sudo snap refresh node --channel 22/stable\n...\n$ rm -rf ~/.npm\n$ npx cdktf-cli; echo $?\n...\n7\n```\n\n### Versions\n\nExternal Error: Could not find cdktf.json. Make sure there is a cdktf.json file in the current directory or one of its parents.\n\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc6fw9fC","author":{"login":"sixcorners"},"authorAssociation":"NONE","body":"docker node doesn't work either so maybe it doesn't like being used with npx?\n```\n$ docker run --rm -it -v$PWD:/pwd -w/pwd node:alpine npx cdktf-cli init; echo $?\n...\n1\n```","createdAt":"2025-02-25T04:22:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3831#issuecomment-2680412098","viewerDidAuthor":false}],"createdAt":"2025-02-25T04:18:11Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3831,"title":"cdktf-cli: init doesn't work with node from snap","updatedAt":"2025-02-25T14:28:42Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjIwMjAyMzEy","is_bot":false,"login":"KentonParton","name":"Kenton Parton"},"body":"### Expected Behavior\n\nWhen running `pnpm exec cdktf deploy stack-name --auto-approve` within GitHub Actions, the workflow should complete successfully with a proper JSON response from Terraform Cloud after the apply operation completes.\n\n### Actual Behavior\n\nWhile the actual Terraform apply operation completes successfully (resources are correctly created/modified/destroyed), the connection to Terraform Cloud sometimes drops during the final output phase. This results in a JSON parsing error and causes the GitHub Actions workflow to fail with exit code 201.\nError message:\n\n```\n     Apply complete! Resources: 1 added, 0 changed, 1 destroyed.\n\n\n0 Stacks deploying     1 Stack done     0 Stacks waiting\nError: External Error: Failed to parse terraform output: SyntaxError: Unexpected token 'T', \"There was \"... is not valid JSON. The output was 'There was an error connecting to Terraform Cloud. Please do not exit\nTerraform to prevent data loss! Trying to restore the connection...\n\nStill trying to restore the connection... (3s elapsed)\n{}\n'\ntask: Failed to run task \"deploy:terraform-shared\": exit status 1\nError: Process completed with exit code 201.\n```\n\n### Steps to Reproduce\n\nUnfortunately, the issue is intermittent. I have not been able to reproduce consistently \n\n### Versions\n\nâ¯ cdktf debug\ncdktf debug\nlanguage: typescript\ncdktf-cli: 0.20.11\nnode: v20.9.0\ncdktf: 0.20.10\nconstructs: 10.4.2\njsii: null\nterraform: 1.5.7\narch: arm64\nos: darwin 24.1.0\nproviders\ntimescale/timescale@~> 1.12 (LOCAL)\n        terraform provider version: 1.13.1\n@cdktf/provider-github (PREBUILT)\n        terraform provider version: 6.4.0 \n        prebuilt provider version: 14.4.0\n        cdktf version: ^0.20.0\n@cdktf/provider-google-beta (PREBUILT)\n        terraform provider version: 6.14.0 \n        prebuilt provider version: 14.13.0\n        cdktf version: ^0.20.0\n@cdktf/provider-null (PREBUILT)\n        terraform provider version: 3.2.3 \n        prebuilt provider version: 10.0.1\n        cdktf version: ^0.20.0\n@cdktf/provider-tfe (PREBUILT)\n        terraform provider version: 0.61.0 \n        prebuilt provider version: 11.10.0\n        cdktf version: ^0.20.0\n\n### Providers\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n                                                           â”€â”€\n Provider Name       Provider Versionâ”‚ CDKTF  â”‚ Constraintâ”‚ Package Name             â”‚ Package Versionâ”‚\n                                                             \nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n                                                           â”€â”€\n timescale/timescale 1.13.1          â”‚        â”‚ ~> 1.12   â”‚                          â”‚                â”‚\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n                                                           â”€â”€\n integrations/github 6.4.0           â”‚ ^0.20.0â”‚           â”‚ @cdktf/provider-github   â”‚ 14.4.0         â”‚\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n                                                           â”€â”€\n google-beta         6.14.0          â”‚ ^0.20.0â”‚           â”‚                          â”‚ 14.13.0        â”‚\n                                                           @cdktf/provider-google-beta\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n                                                           â”€â”€\n null                3.2.3           â”‚ ^0.20.0â”‚           â”‚ @cdktf/provider-null     â”‚ 10.0.1         â”‚\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n                                                           â”€â”€\n tfe                 0.61.0          â”‚ ^0.20.0â”‚           â”‚ @cdktf/provider-tfe      â”‚ 11.10.0        â”‚\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n                 \n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc6ufc3q","author":{"login":"KentonParton"},"authorAssociation":"NONE","body":"Would anyone be able to help with this? We continue to experience this issue running the above commands from GitHub Actions or locally.","createdAt":"2025-06-01T16:17:36Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3830#issuecomment-2927480298","viewerDidAuthor":false}],"createdAt":"2025-02-24T23:58:49Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3830,"title":"Intermittent Terraform Cloud Connection Failures in GitHub Actions","updatedAt":"2025-06-01T16:17:52Z"},{"assignees":[],"author":{"id":"U_kgDOBpeaTw","is_bot":false,"login":"claremont-awilson","name":"Ally"},"body":"### Expected Behavior\n\n`cdktf get` should build the oci provider.\n\n\n### Actual Behavior\n\n\nTrying to get familiar with CDKTF and OCI. Created a simple main.py and have this in cdktf.json:\n\n```\n\"terraformProviders\": [\n    {\n      \"name\": \"oci\",\n      \"source\": \"hashicorp/oci\",\n      \"localProviderPath\": \"./providers/terraform-provider-oci\"\n    }\n  ],\n```\n\nI've tried a number of variations of the above. \"source: oracle/oci\" and not having a \"localProviderPath\" (downloaded the provider manually), downgraded cdktf-cli (from 0.20.11 to 0.20.1) but I can't get `cdktf get` to work.\n\n\n\n### Steps to Reproduce\n\nSpecify OCI as a provider and do a `cdktf get`\n\noutput (eventually, takes quite a while):\n\n> NOTE: Temp directory retained due to an error: /tmp/temp-5kEKyD\n> Error: jsii compilation failed with non-zero exit code: 1\n>   | !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n>   | !!                                                                                                                      !!\n>   | !!  This software has not been tested with node v22.14.0.                                                               !!\n>   | !!  Should you encounter odd runtime issues, please try using one of the supported release before filing a bug report.  !!\n>   | !!                                                                                                                      !!\n>   | !!  This software is currently running on node v22.14.0.                                                                !!\n>   | !!  As of the current release of this software, supported node releases are:                                            !!\n>   | !!  - ^20.0.0 (Planned end-of-life: 2026-04-30)                                                                         !!\n>   | !!  - ^18.0.0 (Planned end-of-life: 2025-04-30)                                                                         !!\n>   | !!                                                                                                                      !!\n>   | !!  This warning can be silenced by setting the JSII_SILENCE_WARNING_UNTESTED_NODE_VERSION environment variable.        !!\n>   | !!                                                                                                                      !!\n>   | !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n>   | !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n>   | !!                                                                                                     !!\n>   | !!  The 5.3 release line of jsii has reached End-of-Support.                                           !!\n>   | !!  We strongly recommend you upgrade to the current release line (5.7) at your earliest convenience.  !!\n>   | !!                                                                                                     !!\n>   | !!  Other actively supported release lines include:                                                    !!\n>   | !!  - 5.5 (planned End-of-Support date: 2025-05-15T00:00:00.000Z)                                      !!\n>   | !!  - 5.6 (planned End-of-Support date: 2025-07-01T00:00:00.000Z)                                      !!\n>   | !!                                                                                                     !!\n>   | !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n>   | [2025-02-17T13:52:48.091] [ERROR] jsii/compiler - Compilation errors prevented the JSII assembly from being created\n>   | warning JSII6: A \"peerDependency\" on \"constructs\" at \"10.1.167\" means you should take a \"devDependency\" on \"constructs\" at \"10.1.167\" (found \"undefined\")\n>   | warning JSII6: A \"peerDependency\" on \"cdktf\" at \"0.20.1\" means you should take a \"devDependency\" on \"cdktf\" at \"0.20.1\" (found \"undefined\")\n>   | warning JSII3: There is no \"README.md\" file. It is required in order to generate valid PyPI (Python) packages.\n>   | providers/oci/data-oci-objectstorage-private-endpoint-summaries/index.ts:201:30 - error TS2339: Property 'StringMapMapMap' does not exist on type 'typeof import(\"/tmp/temp-5kEKyD/node_modules/cdktf/lib/index\")'.\n>   | 201   private _fqdns = new cdktf.StringMapMapMap(this, \"fqdns\");\n>   |                                  ~~~~~~~~~~~~~~~\n>   | providers/oci/data-oci-objectstorage-private-endpoint/index.ts:196:30 - error TS2339: Property 'StringMapMapMap' does not exist on type 'typeof import(\"/tmp/temp-5kEKyD/node_modules/cdktf/lib/index\")'.\n>   | 196   private _fqdns = new cdktf.StringMapMapMap(this, \"fqdns\");\n>   |                                  ~~~~~~~~~~~~~~~\n>   +----------------------------------------------------------------------------------\n>   | Command: /home/awilson/.local/share/fnm/node-versions/v22.14.0/installation/lib/node_modules/cdktf-cli/node_modules/jsii/bin/jsii --silence-warnings reserved-word\n>   | Workdir: /tmp/temp-5kEKyD\n>   +----------------------------------------------------------------------------------\n>     at d (/home/awilson/.local/share/fnm/node-versions/v22.14.0/installation/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:110:1586)\n>     at ChildProcess.<anonymous> (/home/awilson/.local/share/fnm/node-versions/v22.14.0/installation/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:113:112)\n>     at Object.onceWrapper (node:events:633:26)\n>     at ChildProcess.emit (node:events:518:28)\n>     at ChildProcess.emit (node:domain:489:12)\n>     at ChildProcess._handle.onexit (node:internal/child_process:293:12)\n> â ¦ downloading and generating modules and providers...\n> Error: jsii compilation failed with non-zero exit code: 1\n>   | !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n>   | !!                                                                                                                      !!\n>   | !!  This software has not been tested with node v22.14.0.                                                               !!\n>   | !!  Should you encounter odd runtime issues, please try using one of the supported release before filing a bug report.  !!\n>   | !!                                                                                                                      !!\n>   | !!  This software is currently running on node v22.14.0.                                                                !!\n>   | !!  As of the current release of this software, supported node releases are:                                            !!\n>   | !!  - ^20.0.0 (Planned end-of-life: 2026-04-30)                                                                         !!\n>   | !!  - ^18.0.0 (Planned end-of-life: 2025-04-30)                                                                         !!\n>   | !!                                                                                                                      !!\n>   | !!  This warning can be silenced by setting the JSII_SILENCE_WARNING_UNTESTED_NODE_VERSION environment variable.        !!\n>   | !!                                                                                                                      !!\n>   | !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n>   | !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n>   | !!                                                                                                     !!\n>   | !!  The 5.3 release line of jsii has reached End-of-Support.                                           !!\n>   | !!  We strongly recommend you upgrade to the current release line (5.7) at your earliest convenience.  !!\n>   | !!                                                                                                     !!\n>   | !!  Other actively supported release lines include:                                                    !!\n>   | !!  - 5.5 (planned End-of-Support date: 2025-05-15T00:00:00.000Z)                                      !!\n>   | !!  - 5.6 (planned End-of-Support date: 2025-07-01T00:00:00.000Z)                                      !!\n>   | !!                                                                                                     !!\n>   | !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n>   | [2025-02-17T13:52:48.091] [ERROR] jsii/compiler - Compilation errors prevented the JSII assembly from being created\n>   | warning JSII6: A \"peerDependency\" on \"constructs\" at \"10.1.167\" means you should take a \"devDependency\" on \"constructs\" at \"10.1.167\" (found \"undefined\")\n>   | warning JSII6: A \"peerDependency\" on \"cdktf\" at \"0.20.1\" means you should take a \"devDependency\" on \"cdktf\" at \"0.20.1\" (found \"undefined\")\n>   | warning JSII3: There is no \"README.md\" file. It is required in order to generate valid PyPI (Python) packages.\n>   | providers/oci/data-oci-objectstorage-private-endpoint-summaries/index.ts:201:30 - error TS2339: Property 'StringMapMapMap' does not exist on type 'typeof import(\"/tmp/temp-5kEKyD/node_modules/cdktf/lib/index\")'.\n>   | 201   private _fqdns = new cdktf.StringMapMapMap(this, \"fqdns\");\n>   |                                  ~~~~~~~~~~~~~~~\n>   | providers/oci/data-oci-objectstorage-private-endpoint/index.ts:196:30 - error TS2339: Property 'StringMapMapMap' does not exist on type 'typeof import(\"/tmp/temp-5kEKyD/node_modules/cdktf/lib/index\")'.\n>   | 196   private _fqdns = new cdktf.StringMapMapMap(this, \"fqdns\");\n>   |                                  ~~~~~~~~~~~~~~~\n>   +----------------------------------------------------------------------------------\n>   | Command: /home/awilson/.local/share/fnm/node-versions/v22.14.0/installation/lib/node_modules/cdktf-cli/node_modules/jsii/bin/jsii --silence-warnings reserved-word\n>   | Workdir: /tmp/temp-5kEKyD\n>   +----------------------------------------------------------------------------------\n\n### Versions\n\nlanguage: python\ncdktf-cli: 0.20.1 & 0.20.11\nnode: v22.14.0\ncdktf: 0.20.1 & 0.20.11\nconstructs: 10.1.167\njsii: \nâ”œâ”€â”¬ cdktf-cli@0.20.1\nâ”‚ â”œâ”€â”¬ @cdktf/cli-core@0.20.1\nâ”‚ â”‚ â”œâ”€â”¬ jsii-srcmak@0.1.999\nâ”‚ â”‚ â”‚ â””â”€â”€ jsii@5.2.51\nâ”‚ â”‚ â””â”€â”€ jsii@5.3.3\nâ”‚ â”œâ”€â”¬ @cdktf/hcl2cdk@0.20.1\nâ”‚ â”‚ â”œâ”€â”¬ @cdktf/provider-generator@0.20.1\nâ”‚ â”‚ â”‚ â””â”€â”¬ jsii-srcmak@0.1.1005\nâ”‚ â”‚ â”‚   â”œâ”€â”¬ jsii-pacmak@1.106.0\nâ”‚ â”‚ â”‚   â”‚ â””â”€â”¬ jsii-rosetta@5.7.4\nâ”‚ â”‚ â”‚   â”‚   â””â”€â”€ jsii@5.7.5\nâ”‚ â”‚ â”‚   â””â”€â”€ jsii@5.3.59\nâ”‚ â”‚ â””â”€â”¬ jsii-rosetta@5.3.2\nâ”‚ â”‚   â””â”€â”€ jsii@5.3.59\nâ”‚ â”œâ”€â”¬ jsii-pacmak@1.93.0\nâ”‚ â”‚ â””â”€â”¬ jsii-rosetta@1.105.0\nâ”‚ â”‚   â””â”€â”€ jsii@1.105.0\nâ”‚ â””â”€â”€ jsii@5.3.2\nâ””â”€â”€ jsii@5.7.5\nterraform: v1.10.5\narch: amd64\nos: Oracle Linux 9.2 (WSL2)\n\n### Providers\n\nManually downloded oci v6.26.0\n\nbut `cdktf provider list` shows:\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF â”‚ Constraint â”‚ Package Name â”‚ Package Version â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ oci           â”‚                  â”‚       â”‚            â”‚              â”‚                 â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-02-17T14:09:26Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3829,"title":"cdktf get fails when specifying oci provider","updatedAt":"2025-02-17T14:09:51Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjIwOTcxMg==","is_bot":false,"login":"fbartho","name":"Frederic Barthelemy"},"body":"### Description\n\nIn order to minimize \"it works on my machine\" type errors, we have a policy of not globally installing helper tools. We use NVM to ensure our node-version is correct within every project. And we use `yarn` to access locally installed binaries without hardcoding paths.\n\nUnfortunately, `cdktf-cli init` throws an error when executed within a local-install / yarn context.\n\n```shell\n$ yarn cdktf init --template=typescript --providers=kreuzwerker/docker --local\n(node:35155) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.\n(Use `node --trace-deprecation ...` to show where the warning was created)\nERROR: Cannot initialize a project in a non-empty directory\n```\nThis `ERROR` goes away if you globally install it and run the same command (without `yarn`) in the same directory.\n\nEven if you don't support the feature request, this is an incorrect or at least very confusing error message for this condition, so if this ticket gets closed, we should open another one for that issue.\n\n### References\n\n- https://github.com/hashicorp/terraform-cdk/issues/1697\n- https://github.com/hashicorp/terraform-cdk/issues/2490\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc7CIGq4","author":{"login":"shellscape"},"authorAssociation":"NONE","body":"Just ran into this myself. This is a baffling restriction. ","createdAt":"2025-09-05T02:47:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3827#issuecomment-3256904376","viewerDidAuthor":false}],"createdAt":"2025-02-14T18:50:33Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3827,"title":"cdktf-cli: Support non-global installs (and report a correct error message if not supported)","updatedAt":"2025-09-05T02:47:54Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUzNjQ4MjA=","is_bot":false,"login":"alexedwardjones","name":"Alex Jones"},"body":"### Expected Behavior\n\nI have three accounts that I'm trying to set up with the necessary roles and permissions for people to assume roles across accounts.\n\nAccounts:\n- Root\n- Identity (IAM Users, Groups)\n- Production (Workload)\n\nI've created an `IdentityStack` using cdktf that has created the roles and permissions. Initially I was using a `LocalBackend` and everything was working fine.\n\nI've since migrated my state to an `S3Backend` and I expected things to continue working as long as I set the correct `assumeRole` on the `S3Backend`.\n\n### Actual Behavior\n\nInstead I'm now getting the following error.\n```\ninfrastructure-identity-stack  Initializing the backend...\ninfrastructure-identity-stack  Error refreshing state: AccessDenied: Access Denied\n```\nUnless I'm misunderstanding something, my guess is that it doesn't seem to be correctly assuming the role needed to access the configured `S3Backend`.\n\nI've run the equivalent command using the AWS CLI and my credentials have the necessary permissions to assume the role without any issue.\n```\naws sts assume-role --role-arn \"arn:aws:iam::123456789098:role/OrganizationAccountAccessRole\" --role-session-name foo\n```\n\n**N.B.**\nI'm only using `OrganizationAccountAccessRole` because my next step was going to be to create a dedicated role for terraform. Up until this point `OrganizationAccountAccessRole` had been working fine for bootstrapping the accounts.\n\n### Steps to Reproduce\n\nHere's an example of my stack. The credentials I'm using are from the Root account and have permissions to assume the `OrganizationAccountAccessRole` in Identity and Production.\n\n```\nexport default class IdentityStack extends TerraformStack {\n  private groups: Record<string, IamGroup> = {};\n\n  constructor(scope: Construct, id: string) {\n    super(scope, id);\n\n    // Default provider for identity account resources (users, groups)\n    new awsProvider.AwsProvider(this, \"aws\", {\n      region: \"eu-west-1\",\n      assumeRole: [{\n        roleArn: `arn:aws:iam::${Account.IDENTITY}:role/OrganizationAccountAccessRole`,\n      }],\n    });\n\n    // Identity stack remote state lives in the identity account\n    new S3Backend(this, {\n      bucket: REMOTE_STATE_BUCKET_NAME_IDENTITY,\n      key: `${id}/terraform.tfstate`,\n      region: \"eu-west-1\",\n      dynamodbTable: REMOTE_STATE_LOCK_TABLE_NAME,\n      assumeRole: {\n        roleArn: `arn:aws:iam::${Account.IDENTITY}:role/OrganizationAccountAccessRole`,\n      },\n    });\n\n    // Create account providers\n    const accountProviders = {\n      [Account.PRODUCTION]: new awsProvider.AwsProvider(this, \"aws-production\", {\n        alias: \"production\",\n        region: \"eu-west-1\",\n        assumeRole: [{\n          roleArn: `arn:aws:iam::${Account.PRODUCTION}:role/OrganizationAccountAccessRole`,\n        }],\n      }),\n      [Account.ROOT]: new awsProvider.AwsProvider(this, \"aws-root\", {\n        alias: \"root\",\n        region: \"eu-west-1\",\n      }),\n      [Account.IDENTITY]: new awsProvider.AwsProvider(this, \"aws-identity\", {\n        alias: \"identity\",\n        region: \"eu-west-1\",\n        assumeRole: [{\n          roleArn: `arn:aws:iam::${Account.IDENTITY}:role/OrganizationAccountAccessRole`,\n        }],\n      }),\n    };\n...\n```\n\n### Versions\n\n`cdktf debug` gives me...\n```\nExternal Error: Could not determine cdktf version. Please make sure you are in a directory containing a cdktf project and have all dependencies installed.\n```\nI'm using these versions...\nNode: v22.11.0\n```\n  \"cdktf\": \"^0.20.11\",\n  \"cdktf-cli\": \"^0.20.11\",\n  \"constructs\": \"^10.4.2\",\n```\n\n### Providers\n\n`cdktf provider list` gives me...\n```\nExternal Error: Could not determine cdktf version. Please make sure you are in a directory containing a cdktf project and have all dependencies installed.\n```\n\nI'm using these versions...\n```\n  \"@cdktf/provider-aws\": \"^19.48.1\",\n  \"@cdktf/provider-random\": \"^11.0.3\",\n```\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-02-14T17:13:01Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3826,"title":"AssumeRole not working with Multi-Accounts and S3 Backend","updatedAt":"2025-02-14T18:07:34Z"},{"assignees":[],"author":{"is_bot":true,"login":"app/"},"body":"### Expected Behavior\n\n- I add `\"hashicorp/hcp@~>0.0\"` to my `cdktf.json`. \n- I execute `cdktf get` which places it in a local `imports` directory.\n- I used the library via `from imports.hcp.provider import HcpProvider` and `HcpProvider(self, \"HcpProvider\")`\n- It works without warnings or error when running `cdktf apply`\n\n### Actual Behavior\n\n- Recently (perhaps w/the `0.102.0` release) when I run my `cdktf apply` I get:\n\n```text\nWarning: You may experience issues using HCP.\n            â”‚ \n            â”‚   with provider[\"registry.terraform.io/hashicorp/hcp\"],\n            â”‚   on cdk.tf.json line 89, in provider.hcp[0]:\n            â”‚   89:       }\n            â”‚ \n            â”‚ Unable unmarshal response to verify HCP status: invalid character '<' looking\n            â”‚ for beginning of value\n            â”‚ \n            â”‚ (and one more similar warning elsewhere)\n```\n\n- Aside from the warning, things appear to work properly. (I use the HCP provider for access to Vault).\n- Note that the warning appears to come from this in my `cdktf.out/stacks/<stack-name>/cdk.tf.json`:\n\n```json\n  \"provider\": {\n    \"hcp\": [\n      {\n      }\n    ],\n```\n\n- Unsure if this makes a difference, but I'm using Python with my CDKTF.\n- Let me know if there is any additional information needed.\n\n### Steps to Reproduce\n\n1. Import and call the HcpProvider class in a stack.\n2. See if the Warning message occurs.\n\n### Versions\n\nlanguage: python\ncdktf-cli: 0.20.11\nnode: v22.13.1\ncdktf: 0.20.11\nconstructs: 10.4.2\njsii: 1.106.0\nterraform: 1.10.5\narch: arm64\nos: darwin 24.1.0\npython: Python 3.13.1\npip: null\npipenv: pipenv, version 2024.4.1\nproviders\nazurerm@~> 4.0 (LOCAL)\n        terraform provider version: 4.18.0\nhcp@~>0.0 (LOCAL)\n        terraform provider version: 0.102.0\nkubernetes@~> 2.0 (LOCAL)\n        terraform provider version: 2.35.1\nrandom@~> 3.0 (LOCAL)\n        terraform provider version: 3.6.3\nkreuzwerker/docker@~> 3.0 (LOCAL)\n        terraform provider version: undefined\n\n### Providers\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Provider Name      â”‚ Provider Version â”‚ CDKTF â”‚ Constraint â”‚ Package Name â”‚ Package Version â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ azurerm            â”‚ 4.18.0           â”‚       â”‚ ~> 4.0     â”‚              â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ hcp                â”‚ 0.102.0          â”‚       â”‚ ~>0.0      â”‚              â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ kubernetes         â”‚ 2.35.1           â”‚       â”‚ ~> 2.0     â”‚              â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ random             â”‚ 3.6.3            â”‚       â”‚ ~> 3.0     â”‚              â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ kreuzwerker/docker â”‚                  â”‚       â”‚ ~> 3.0     â”‚              â”‚                 â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\nI don't know enough about CDKTF to help much here. My guess would be it is unable to parse the JSON because it has no arguments passed and is empty.\n\n### Workarounds\n\nIgnore the warning.\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc6fzFbf","author":{"login":"adnathanail"},"authorAssociation":"NONE","body":"I'm experiencing this too!","createdAt":"2025-02-25T07:40:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3825#issuecomment-2680968927","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6f8uUA","author":{"login":"dwschewe10"},"authorAssociation":"NONE","body":"I am also experiencing this issue","createdAt":"2025-02-25T23:09:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3825#issuecomment-2683495680","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6tlgrd","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"I was unable to reproduce this by using the latest prebuilt provider for HCP. Does it still happen for you?","createdAt":"2025-05-27T12:15:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3825#issuecomment-2912291549","viewerDidAuthor":false}],"createdAt":"2025-02-14T16:43:29Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMDEzNzM4ODIw","name":"needs-research","description":"","color":"709F22"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"}],"milestone":null,"number":3825,"title":"hashicorp/hcp 0.102.0: Warning during Apply","updatedAt":"2025-05-30T12:29:03Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjc5MTE2","is_bot":false,"login":"tmatilai","name":"Teemu Matilainen"},"body":"### Description\n\nI just learned that the execution order for the Aspects is not following the order they were added. Googling showed that this has recently been addressed in the aws-cdk: https://dev.to/aws-heroes/aws-cdk-aspects-specifications-have-changed-3i75\n\nWould it be possible to port the features, at least the priority, also to the cdktf?\n\n### References\n\n- https://dev.to/aws-heroes/aws-cdk-aspects-specifications-have-changed-3i75\n- https://github.com/aws/aws-cdk-rfcs/blob/main/text/0648-aspects-priority-ordering.md\n- https://github.com/aws/aws-cdk/pull/32097\n- https://developer.hashicorp.com/terraform/cdktf/concepts/aspects\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-02-10T14:24:08Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3824,"title":"lib: priority for the Aspects","updatedAt":"2025-02-10T14:24:08Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUxMDMw","is_bot":false,"login":"infowolfe","name":"Parker"},"body":"I'm not going to go through the massive list of issues I've been through on their repo tonight.\n\nTL;DR this is a VERY broken release on their end and nowhere near ready for prime-time. I'd recommend yanking it and having a talk with them. I know that CDKTF users are 2nd-class citizens for them, but...\n\n- multiple modules renamed (requiring manual tfstate edits)\n- `allow_overwrite` removed (breaking ACME dns validation for AWS ACM, among others)\n- lack of v4->v5 migration documentation\n- gymnastics required to \"glue\" domains onto iterators, since fqdns no longer seem to exist\n- rewrite of `DataCloudflareAccounts()` -> `DataCloudflareAccount()` means we can no longer grab the `account_id` by `name=`\n\nAt the moment, after about 5 hours of work on this tonight, I'm going to have to revert my state to an earlier serial and downgrade to an 11.x series (v4).","comments":[],"createdAt":"2025-02-09T04:58:07Z","labels":[],"milestone":null,"number":3822,"title":"`cloudflare` provider: 12.0.0 is horribly broken","updatedAt":"2025-02-09T04:58:07Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjMwNTk2MTY1","is_bot":false,"login":"eahrend","name":"Erik Ahrend"},"body":"### Description\n\nCurrently we have multiple stacks and we're naming them with a pattern of `highLevelLayerName-environment-stackName`, which makes it super easy to apply multiple stacks at the same time using a pattern, like `cdktf apply 'fdn-dev-*'`.\n\nHowever, this does not apply to cdktf plan. What that means is if we want to plan multiple stacks in a pattern, we'd need to either run a plan for each stack or run an apply and select \"don't apply\".\n\nSo the feature request is to extend this functionality to cdktf plan in the cdktf cli\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-02-03T20:37:07Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3817,"title":"CDKTF-CLI: Plan by pattern","updatedAt":"2025-02-03T20:37:07Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjg4OTQ2MDU=","is_bot":false,"login":"danielBreitlauch","name":"Daniel Breitlauch"},"body":"I have a CDKTF python project and use \n```\n\"terraformProviders\": [\n      \"hashicorp/aws@~>5.60.0\",\n      \"siderolabs/talos@~> 0.7.1\"\n  ],\n```\nTalos Terraform Provider example from the docs:\n```\nresource \"talos_machine_secrets\" \"this\" {}\n\ndata \"talos_machine_configuration\" \"this\" {\n  cluster_name     = \"example-cluster\"\n  machine_type     = \"controlplane\"\n  cluster_endpoint = \"https://cluster.local:6443\"\n  machine_secrets  = talos_machine_secrets.this.machine_secrets\n}\n```\n\nI imported the provider with `cdktf get` and replicated the example:\n```\nfrom cdktfimports.talos.machine_secrets import MachineSecrets\nfrom cdktfimports.talos.data_talos_machine_configuration import DataTalosMachineConfiguration\n\n        talos_machine_secrets = MachineSecrets(self, \"machine_secrets\")\n\n        DataTalosMachineConfiguration(\n            self,\"control_plane_config\",\n            cluster_name=\"example-cluster\",\n            machine_type=\"controlplane\",\n            cluster_endpoint = \"https://cluster.local:6443\",\n            machine_secrets=talos_machine_secrets.machine_secrets,\n        )\n```\n\nAnd running this generates this TypeError:\n```\n        DataTalosMachineConfiguration(\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n      File \"virtualenvs/CDKTF-lG0LMH7y/lib/python3.12/site-packages/jsii/_runtime.py\", line 118, in __call__\n        inst = super(JSIIMeta, cast(JSIIMeta, cls)).__call__(*args, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n      File \"cdktfimports/cdktfimports/talos/data_talos_machine_configuration/__init__.py\", line 81, in __init__\n        config = DataTalosMachineConfigurationConfig(\n                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n      File \"cdktfimports/cdktfimports/talos/data_talos_machine_configuration/__init__.py\", line 427, in __init__\n        check_type(argname=\"argument machine_secrets\", value=machine_secrets, expected_type=type_hints[\"machine_secrets\"])\n      File \"virtualenvs/CDKTF-lG0LMH7y/lib/python3.12/site-packages/typeguard/__init__.py\", line 757, in check_type\n        checker_func(argname, value, expected_type, memo)\n      File \"virtualenvs/CDKTF-lG0LMH7y/lib/python3.12/site-packages/typeguard/__init__.py\", line 558, in check_union\n        raise TypeError('type of {} must be one of ({}); got {} instead'.\n    TypeError: type of argument machine_secrets must be one of (cdktfimports.talos.data_talos_machine_configuration.DataTalosMachineConfigurationMachineSecrets, Dict[str, Any]); got cdktfimports.talos.machine_secrets.MachineSecretsMachineSecretsOutputReference instead\n```\n\n\nThe source of the `DataTalosMachineConfiguration` init parameter:\n```\nmachine_secrets: typing.Union[\"DataTalosMachineConfigurationMachineSecrets\", typing.Dict[builtins.str, typing.Any]],\n```\n\nThe member function of the `MachineSecrets` class:\n```\n@builtins.property\n    @jsii.member(jsii_name=\"machineSecrets\")\n    def machine_secrets(self) -> \"MachineSecretsMachineSecretsOutputReference\":\n        return typing.cast(\"MachineSecretsMachineSecretsOutputReference\", jsii.get(self, \"machineSecrets\"))\n```\n\nNot sure how these types get generated but seem to be incompatible.\nAny idea how this can be fixed?\n","comments":[{"id":"IC_kwDODd1Amc6d4Bnl","author":{"login":"danielBreitlauch"},"authorAssociation":"CONTRIBUTOR","body":"Anyone having similar issues with the code generator?","createdAt":"2025-02-10T17:11:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3812#issuecomment-2648709605","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6j-THP","author":{"login":"danielBreitlauch"},"authorAssociation":"CONTRIBUTOR","body":"Sorry to mention but this really looks like a bug @DanielMSchmidt .","createdAt":"2025-03-25T11:56:11Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3812#issuecomment-2751017423","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6mCS8i","author":{"login":"danielBreitlauch"},"authorAssociation":"CONTRIBUTOR","body":"Ping!","createdAt":"2025-04-08T08:17:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3812#issuecomment-2785619746","viewerDidAuthor":false}],"createdAt":"2025-01-27T20:50:02Z","labels":[],"milestone":null,"number":3812,"title":"Talos Provider: translation to Python produces incompatible types","updatedAt":"2025-04-08T08:17:09Z"},{"assignees":[],"author":{"id":"U_kgDOCRW1Lw","is_bot":false,"login":"richard-collette-precisely","name":""},"body":"### Description\n\nThe documentation https://github.com/hashicorp/terraform-cdk/blob/main/website/docs/cdktf/api-reference/typescript/constructs.mdx needs some form of navigational index, on the left hand side. It's currently one big huge page and there is no way to quickly explore the names of constructs that are available.\n\n\n\n### Links\n\n- https://github.com/hashicorp/terraform-cdk/blob/main/website/docs/cdktf/api-reference/typescript/constructs.mdx\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-01-22T18:19:40Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3805,"title":"Constructs: Navigation index needed","updatedAt":"2025-01-22T18:19:40Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjIzNTMxNDY3","is_bot":false,"login":"glacion","name":"Can GÃ¼vendiren"},"body":"### Expected Behavior\n\n`cdktf provider add grafana/grafana` completes successfully with the following log:\n```\n[2025-01-17T13:33:51.101] [INFO] default - Checking whether pre-built provider exists for the following constraints:\n  provider: grafana/grafana\n  version : latest\n  language: typescript\n  cdktf   : 0.20.11\n\n[2025-01-17T13:33:51.466] [INFO] default - Pre-built provider does not exist for the given constraints.\n[2025-01-17T13:33:51.467] [INFO] default - Adding local provider registry.terraform.io/grafana/grafana with version constraint undefined to cdktf.json\nLocal providers have been updated. Running cdktf get to update...\nGenerated typescript constructs in the output directory: src/gen\n```\n\n### Actual Behavior\n\nOn `cdktf-cli` versions higher than `0.20.1` this command fails with the following:\n```\n[2025-01-17T13:35:11.795] [INFO] default - Checking whether pre-built provider exists for the following constraints:\n  provider: grafana/grafana\n  version : latest\n  language: typescript\n  cdktf   : 0.20.11\n\n[2025-01-17T13:35:12.171] [INFO] default - Pre-built provider does not exist for the given constraints.\n[2025-01-17T13:35:12.171] [INFO] default - Adding local provider registry.terraform.io/grafana/grafana with version constraint undefined to cdktf.json\nLocal providers have been updated. Running cdktf get to update...\nâ ‹ starting...\n[2025-01-17T13:35:12.833] [INFO] default - The CDKTF version has changed, generating all cons\nError: Could not find provider with constraint {\"constraint\":{\"name\":\"grafana\",\"fqn\":\"grafana\",\"version\":\"~> 3.16\",\"source\":\"grafana/grafana\",\"namespace\":\"grafana\"},\"targetLanguage\":\"typescript\",\"fileName\":\"providers/grafana/index.ts\"}\n    at HT.generate (/Users/glacion/Source/infrastructure/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:111:13762)\n    at Ane.generateTypescriptProvider (/Users/glacion/Source/infrastructure/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:114:84132)\n    at Ane.generateTypescript (/Users/glacion/Source/infrastructure/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:114:86199)\n    at /Users/glacion/Source/infrastructure/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:117:618\n    at Array.map (<anonymous>)\n    at Ane.generate (/Users/glacion/Source/infrastructure/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:117:606)\n    at async YUe (/Users/glacion/Source/infrastructure/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:197:3611)\n    at async /Users/glacion/Source/infrastructure/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:519:16936\nâ ™ downloading and generating modules and providers...\nError: Could not find provider with constraint {\"constraint\":{\"name\":\"grafana\",\"fqn\":\"grafana\",\"version\":\"~> 3.16\",\"source\":\"grafana/grafana\",\"namespace\":\"grafana\"},\"targetLanguage\":\"typescript\",\"fileName\":\"providers/grafana/index.ts\"}\nerror: \"cdktf\" exited with code 1\n```\n\n### Steps to Reproduce\n\n1. Create a typescript cdktf project.\n2. Install `cdktf-cli` with version `0.20.1` or lower.\n3. Run `cdktf provider add grafana/grafana`.\n4. Reset\n5. Create a typescript cdktf project.\n6. Install `cdktf-cli` with version `0.20.2` or higher.\n7. Run `cdktf provider add grafana/grafana`.\n\n### Versions\n\nlanguage: typescript\ncdktf-cli: 0.20.11\nnode: v20.18.1\ncdktf: 0.20.11\nconstructs: 10.4.2\njsii: null\nterraform: 1.8.4\narch: arm64\nos: darwin 24.2.0\n\n### Providers\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ Provider Name         â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name                 â”‚ Package Version â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\nâ”‚ grafana/grafana       â”‚                  â”‚         â”‚ ~> 3.16    â”‚                              â”‚                 â”‚\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n\n\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\nPin `cdktf-cli` version to `0.20.2`\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[],"createdAt":"2025-01-17T10:41:07Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3803,"title":"CLI: provider generation fails on versions newer than 0.20.1","updatedAt":"2025-01-17T10:41:55Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjgxMTU5NA==","is_bot":false,"login":"dora-gt","name":"Taiga Nakayama"},"body":"### Description\r\n\r\nCurrently, in TypeScript, `region` and `zone` are expressed by `string`. This is not useful because we have to fill out the string on our own. Literal type helps here like:\r\n\r\n```\r\ntype Region = 'asia-northeast1' | 'asia-northeast2' | .....;\r\nreadonly region?: Region;\r\n```\r\n\r\nAre you open to accept pull-requests for this? I'm keen to.\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [x] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-12-03T01:51:55Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3783,"title":"GoogleProvider: add literal types","updatedAt":"2024-12-03T02:01:06Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjg5MzU1MTg=","is_bot":false,"login":"JordanSussman","name":"Jordan Sussman"},"body":"### Expected Behavior\n\nUpgrading from github.com/cdktf/cdktf-provider-azurerm-go/azurerm/v12/provider to github.com/cdktf/cdktf-provider-azurerm-go/azurerm/v13/provider works without issues.\n\n### Actual Behavior\n\nUpgrading from v12 to v13 results in the following errors:\r\n\r\n```\r\n[2024-11-19T18:21:49.369] [ERROR] default - panic: Passed to parameter config of new @cdktf/provider-azurerm.provider.AzurermProvider: Unable to deserialize value as @cdktf/provider-azurerm.provider.AzurermProviderConfig | undefined\r\n\tâ”œâ”€â”€ ğŸ›‘ Failing value is an object\r\n\tâ”‚      { '$jsii.struct': [Object] }\r\n\tâ•°â”€â”€ ğŸ” Failure reason(s):\r\n\t    â•°â”€ Key 'features': Unable to deserialize value as cdktf.IResolvable | array<@cdktf/provider-azurerm.provider.AzurermProviderFeatures> | undefined\r\n\t        â”œâ”€â”€ ğŸ›‘ Failing value is an object\r\n\t        â”‚      { '$jsii.struct': [Object] }\r\n\t        â•°â”€â”€ ğŸ” Failure reason(s):\r\n\t            â”œâ”€ [as array<@cdktf/provider-azurerm.provider.AzurermProviderFeatures>] Value is not an array\r\n\t            â•°â”€ [as cdktf.IResolvable] Value does not have the \"$jsii.byref\" key\r\n```\r\n\r\nThese errors can be resolved after `Features` is updated from `&provider.AzurermProviderFeatures{}` to `[]*provider.AzurermProviderFeatures{}`. However, this change results in a differnt error of:\r\n\r\n```\r\n     â”‚ Error: Missing required argument\r\n     â”‚\r\n     â”‚   with provider[\"registry.terraform.io/hashicorp/azurerm\"].test,\r\n     â”‚   on cdk.tf.json line 30, in provider.azurerm[0]:\r\n     â”‚   30:         \"features\": [\r\n     â”‚   31:         ],\r\n     â”‚\r\ncdk  â”‚ The argument \"features\" is required, but no definition was found.\r\n```\n\n### Steps to Reproduce\n\n1. Upgrade github.com/cdktf/cdktf-provider-azurerm-go/azurerm/v12/provider to github.com/cdktf/cdktf-provider-azurerm-go/azurerm/v13/provider\r\n2. Run `cdktf deploy` to see panic\r\n3. Update `Features` from `&provider.AzurermProviderFeatures{}` to `[]*provider.AzurermProviderFeatures{}`\r\n4. Run `cdktf deploy` to see error of `features` argument missing\r\n\r\nBroken code for v13:\r\n\r\n```go\r\npackage main\r\n\r\nimport (\r\n\t\"github.com/aws/constructs-go/constructs/v10\"\r\n\t\"github.com/aws/jsii-runtime-go\"\r\n\t\"github.com/cdktf/cdktf-provider-azurerm-go/azurerm/v13/dataazurermvirtualnetwork\"\r\n\t\"github.com/cdktf/cdktf-provider-azurerm-go/azurerm/v13/provider\"\r\n\t\"github.com/hashicorp/terraform-cdk-go/cdktf\"\r\n)\r\n\r\nfunc NewMyStack(scope constructs.Construct, id string) cdktf.TerraformStack {\r\n\tstack := cdktf.NewTerraformStack(scope, &id)\r\n\r\n\tprov := provider.NewAzurermProvider(stack, jsii.String(\"test\"), &provider.AzurermProviderConfig{\r\n\t\tAlias:                    jsii.String(\"test\"),\r\n\t\tFeatures:                 []*provider.AzurermProviderFeatures{},\r\n\t\tSubscriptionId:           jsii.String(\"1234\"),\r\n\t\tSkipProviderRegistration: jsii.Bool(true),\r\n\t\tTenantId:                 jsii.String(\"1234\"),\r\n\t})\r\n\r\n\t_ = dataazurermvirtualnetwork.NewDataAzurermVirtualNetwork(stack, jsii.String(\"fake\"), &dataazurermvirtualnetwork.DataAzurermVirtualNetworkConfig{\r\n\t\tName:              jsii.String(\"fake\"),\r\n\t\tProvider:          prov,\r\n\t\tResourceGroupName: jsii.String(\"fake\"),\r\n\t})\r\n\r\n\treturn stack\r\n}\r\n\r\nfunc main() {\r\n\tapp := cdktf.NewApp(nil)\r\n\r\n\tNewMyStack(app, \"cdk\")\r\n\r\n\tapp.Synth()\r\n}\r\n```\r\n\r\nWorking code for v12:\r\n\r\n```go\r\npackage main\r\n\r\nimport (\r\n\t\"github.com/aws/constructs-go/constructs/v10\"\r\n\t\"github.com/aws/jsii-runtime-go\"\r\n\t\"github.com/cdktf/cdktf-provider-azurerm-go/azurerm/v12/dataazurermvirtualnetwork\"\r\n\t\"github.com/cdktf/cdktf-provider-azurerm-go/azurerm/v12/provider\"\r\n\t\"github.com/hashicorp/terraform-cdk-go/cdktf\"\r\n)\r\n\r\nfunc NewMyStack(scope constructs.Construct, id string) cdktf.TerraformStack {\r\n\tstack := cdktf.NewTerraformStack(scope, &id)\r\n\r\n\tprov := provider.NewAzurermProvider(stack, jsii.String(\"test\"), &provider.AzurermProviderConfig{\r\n\t\tAlias:                    jsii.String(\"test\"),\r\n\t\tFeatures:                 &provider.AzurermProviderFeatures{},\r\n\t\tSubscriptionId:           jsii.String(\"1234\"),\r\n\t\tSkipProviderRegistration: jsii.Bool(true),\r\n\t\tTenantId:                 jsii.String(\"1234\"),\r\n\t})\r\n\r\n\t_ = dataazurermvirtualnetwork.NewDataAzurermVirtualNetwork(stack, jsii.String(\"fake\"), &dataazurermvirtualnetwork.DataAzurermVirtualNetworkConfig{\r\n\t\tName:              jsii.String(\"fake\"),\r\n\t\tProvider:          prov,\r\n\t\tResourceGroupName: jsii.String(\"fake\"),\r\n\t})\r\n\r\n\treturn stack\r\n}\r\n\r\nfunc main() {\r\n\tapp := cdktf.NewApp(nil)\r\n\r\n\tNewMyStack(app, \"cdk\")\r\n\r\n\tapp.Synth()\r\n}\r\n```\n\n### Versions\n\nlanguage: go\r\ncdktf-cli: 0.20.10\r\nnode: v23.1.0\r\ncdktf: 0.20.9\r\nconstructs: 10.4.2\r\njsii: 1.105.0\r\nterraform: 1.9.8\r\narch: arm64\r\nos: darwin 24.0.0\r\ngo: go version go1.23.3 darwin/arm64\r\nproviders\r\ngithub.com/cdktf/cdktf-provider-azurerm-go/azurerm (PREBUILT)\r\n        terraform provider version: 4.10.0\r\n        prebuilt provider version: 13.10.0\r\n        cdktf version: ^0.20.0\n\n### Providers\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name                                       â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ azurerm       â”‚ 4.10.0           â”‚ ^0.20.0 â”‚            â”‚ github.com/cdktf/cdktf-provider-azurerm-go/azurerm â”‚ 13.10.0         â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\nThe original error appears to be caused by the changes introduced within https://github.com/cdktf/cdktf-provider-azurerm-go/blob/main/azurerm/provider/AzurermProvider__checks.go#L111-L137.\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6U2p2a","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"The providers major version changed between 12 and 13 so I think the need to adjust the code in general is expected. Have you tried passing nil instead of an empty slice? I think JSII handles them quite differently, nil being handled as a Typescript null which is what you might be expressing here.","createdAt":"2024-11-25T09:12:19Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3774#issuecomment-2497355162","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6U5kQM","author":{"login":"JordanSussman"},"authorAssociation":"NONE","body":"Setting `Features` to `nil` does prevent the Go code from panicking. However, this leads to the same issue where Terraform fails with the error: `The argument \"features\" is required, but no definition was found.` because the features argument isn't being defined in the format that Terraform expects.","createdAt":"2024-11-25T14:07:49Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3774#issuecomment-2498118668","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6dO0Gm","author":{"login":"Socolin"},"authorAssociation":"NONE","body":"Same problem in C#, the example is not up-to-date.\n\nhttps://github.com/hashicorp/terraform-cdk/blob/main/examples/csharp/azure/Main.cs#L19\n\nI'm getting a first error that I was able to fix using this instead\n\n```cs\nFeatures = new IAzurermProviderFeatures[]\n{\n    new AzurermProviderFeatures()\n}\n```\n\nBut then I'm getting the same error\n\n```\n        â”‚ Error: Invalid provider configuration\n        â”‚ \n        â”‚ Provider \"registry.terraform.io/hashicorp/azurerm\" requires explicit\n        â”‚ configuration. Add a provider block to the root module and configure the\n        â”‚ provider's required arguments as described in the provider documentation.\n        â”‚ \n        â•µ\n        â•·\n        â”‚ Error: Missing required argument\n        â”‚ \n        â”‚   with provider[\"registry.terraform.io/hashicorp/azurerm\"],\n        â”‚   on <empty> line 0:\n        â”‚   (source code not available)\n        â”‚ \n        â”‚ The argument \"features\" is required, but no definition was found.\n        â•µ\n\n```\n","createdAt":"2025-02-05T20:00:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3774#issuecomment-2637906342","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6dPdVG","author":{"login":"JordanSussman"},"authorAssociation":"NONE","body":"This is by no means an ideal solution, but I used a basic jq command to modify the output file from `cdktf synth` to match the format Terraform requires. This serves as a temporary workaround until the official fix is available. For those interested, the steps are:\n\n1. `cdktf synth --output test`\n2. `jq '.provider.azurerm[].features |= if . == [] then {} else . end' test/stacks/cdk/cdk.tf.json > updated.json && mv updated.json test/stacks/cdk/cdk.tf.json\"`","createdAt":"2025-02-05T21:35:21Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3774#issuecomment-2638075206","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6n4UMj","author":{"login":"Malinskiy"},"authorAssociation":"NONE","body":"The same issue is for Java: the expectation is to have a `List`, and the only way to set the features is viathe  reflection API. The [sample](https://github.com/hashicorp/terraform-cdk/blob/fde8712078663595f2da4e90a9dfb718474b4ee0/examples/java/azure/src/main/java/com/mycompany/app/Main.java#L25) won't work. https://github.com/cdktf/cdktf-provider-azurerm/blob/v12.27.0/docs/provider.java.md is the last version of spec that works, anything v13 and above is broken.","createdAt":"2025-04-19T05:58:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3774#issuecomment-2816557859","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6yIEu5","author":{"login":"cmcniel"},"authorAssociation":"NONE","body":"Frustrating for sure especially the silence.   Looking at the code and via trial and error I was able to determine how to pass the provider config correctly, if you want to call it that.\n\nIt seems to expect that features is passed via a Slice and that slice cannot be empty so I arrived at this little beauty.   If you have real features you want to employ\n\n```go\n\tprovider.NewAzurermProvider(stack, jsii.String(\"azurerm\"), &provider.AzurermProviderConfig{\n\t\tSubscriptionId: jsii.String(\"<Your subscription Id>\"),\n\t\tFeatures: []provider.AzurermProviderFeatures{ provider.AzurermProviderFeatures{}}},\n\t)\n```","createdAt":"2025-06-19T15:15:49Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"CONFUSED","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3774#issuecomment-2988460985","viewerDidAuthor":false}],"createdAt":"2024-11-20T00:37:23Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"}],"milestone":null,"number":3774,"title":"azurerm: AzurermProviderFeatures Value is not an array","updatedAt":"2025-06-19T15:15:49Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM1OTg3Nw==","is_bot":false,"login":"kedare","name":"Mathieu Poussin"},"body":"### Description\n\nToday, the way module are exposed to python is not really ergonomic as 1 root module is created for each terraform provider:\r\n\r\n```\r\nfrom cdktf_cdktf_provider_docker.image import Image\r\nfrom cdktf_cdktf_provider_docker.container import Container\r\nfrom cdktf_cdktf_provider_docker.provider import DockerProvider\r\n```\r\n\r\nPython is (one of the?) only implementation to have it implemented like this.\r\n\r\nIt would be interesting to migrate (or at least make it compatible with a non breaking way) with [native package namespaces](https://packaging.python.org/en/latest/guides/packaging-namespace-packages/#native-namespace-packages) to allow a more natural naming\r\n\r\nThis would allow for example to have this kind of more natural and flexible imports \r\n\r\n```\r\nfrom cdktf.cdktf.provider.docker.image import Image\r\nfrom cdktf.cdktf.provider.docker.container import Container\r\nfrom cdktf.cdktf.provider.docker.provider import DockerProvider\r\n```\r\n\n\n### References\n\nhttps://packaging.python.org/en/latest/guides/packaging-namespace-packages\r\n\r\nhttps://peps.python.org/pep-0420/\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-11-19T10:31:01Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3773,"title":"Python: Use PEP-420 package namespaces","updatedAt":"2024-11-19T10:33:16Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjcwNTA0MA==","is_bot":false,"login":"rpatidar","name":"Rajesh Patidar"},"body":"### Expected Behavior\n\ncdk synth should work and should not fail.\n\n### Actual Behavior\n\ni have tried various options placing the file at differrent folders it always return  \r\n\r\nFailure1\r\n\r\n                           â”‚ Error: Invalid function argument\r\n                           â”‚\r\n                           â”‚   on cdk.tf.json line 94, in resource.aws_launch_template.MyService-LTConstruct-test (MyService-LTConstruct-test):\r\n                           â”‚   94:         \"user_data\": \"${filebase64(\\\"scripts/myscript.sh\\\")}\",\r\n                           â”‚     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r\n                           â”‚     â”‚ while calling filebase64(path)\r\n\r\n\r\n\r\nFailue2: \r\n\r\n\r\n                           â”‚ Error: Invalid function argument\r\n                           â”‚\r\n                           â”‚   on cdk.tf.json line 94, in resource.aws_launch_template.ResumeParsingService-LTConstruct-test (ResumeParsingService-LTConstruct-test):\r\n                           â”‚   94:         \"user_data\": \"${filebase64(\\\"$${path.module}/resumeparsingservice.sh\\\")}\",\r\n                           â”‚     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r\n                           â”‚     â”‚ while calling filebase64(path)\r\n                           â”‚\r\n                           â”‚ Invalid value for \"path\" parameter: no file exists at\r\n                           â”‚ \"${path.module}/resumeparsingservice.sh\"; this function works only with files\r\n                           â”‚ that are distributed as part of the configuration source code, so if this\r\n                           â”‚ file will be created by a resource in this configuration you must instead\r\n                           â”‚ obtain this result from an attribute of that resource.\n\n### Steps to Reproduce\n\ncreate cloudformation following the terraform from https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_template  ( typescript version) \r\n\r\n\r\nthe example have `userData: Token.asString(Fn.filebase64(\"${path.module}/example.sh\")),` which didn't worked. i simplified and moved all the content to root directory and still it was not finding the scripts. \r\n\n\n### Versions\n\nlanguage : typescript \r\n\r\ncdktf --version\r\n0.20.9\r\n\r\nnode --version\r\nv20.16.0\r\n\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-11-05T04:23:03Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3764,"title":"CDKTF userdata path: examples does not work in aws launch template","updatedAt":"2024-11-05T04:23:35Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjIzNzA1NDU1","is_bot":false,"login":"kalos92","name":""},"body":"### Expected Behavior\r\n\r\nthe result should be ```1```. \r\n\r\n### Actual Behavior\r\n\r\n```\r\napplication := appconfigapplication.NewAppconfigApplication(stack, jsii.String(project+\"apc-application\"+env), &appconfigapplication.AppconfigApplicationConfig{\r\n\t\tName:        jsii.String(project + \"application\" + env),\r\n\t\tDescription: jsii.String(\"Contains the configuration for mercury lambda\"),\r\n\t\tTags:        tags,\r\n\t\tTagsAll:     tags,\r\n\t})\r\n\r\n\tapcConfigProfile := appconfigconfigurationprofile.NewAppconfigConfigurationProfile(stack, jsii.String(project+\"apc-configuration-profile\"+env), &appconfigconfigurationprofile.AppconfigConfigurationProfileConfig{\r\n\t\tApplicationId: application.Id(),\r\n\t\tLocationUri:   jsii.String(\"hosted\"),\r\n\t\tName:          jsii.String(project + \"profile\" + env),\r\n\t\tDescription:   jsii.String(\"Configuration of mercury's notification\"),\r\n\t\tTags:          tags,\r\n\t\tTagsAll:       tags,\r\n\t\tType:          jsii.String(\"AWS.Freeform\"),\r\n\t\tValidator:     &[]*appconfigconfigurationprofile.AppconfigConfigurationProfileValidator{{Type: jsii.String(\"JSON_SCHEMA\"), Content: jsii.String(string(bbytes))}},\r\n\t})\r\n\r\n\tapcConfigurationVersion := appconfighostedconfigurationversion.NewAppconfigHostedConfigurationVersion(stack, jsii.String(project+\"apc-hosted-configuration\"+env), &appconfighostedconfigurationversion.AppconfigHostedConfigurationVersionConfig{\r\n\t\tApplicationId:          application.Id(),\r\n\t\tConfigurationProfileId: apcConfigProfile.ConfigurationProfileId(),\r\n\t\tContent:                jsii.String(string(jbytes)),\r\n\t\tContentType:            jsii.String(\"application/json\"),\r\n\t\tDescription:            jsii.String(\"Json configuration of what to send to the selected recipients\"),\r\n\t})\r\n\r\n\tapcEnv := appconfigenvironment.NewAppconfigEnvironment(stack, jsii.String(project+\"apc-environment\"+env), &appconfigenvironment.AppconfigEnvironmentConfig{\r\n\t\tApplicationId: application.Id(),\r\n\t\tName:          jsii.String(project + \"environment\" + env),\r\n\t\tDescription:   jsii.String(\"Current configuration of Mercury\"),\r\n\t\tTags:          tags,\r\n\t})\r\n\r\n\tappconfigdeployment.NewAppconfigDeployment(stack, jsii.String(project+\"apc-deployment\"+env), &appconfigdeployment.AppconfigDeploymentConfig{\r\n\t\tDependsOn:              &[]cdktf.ITerraformDependable{apcConfigurationVersion},\r\n\t\tApplicationId:          application.Id(),\r\n\t\tConfigurationProfileId: apcConfigProfile.ConfigurationProfileId(),\r\n\t\tConfigurationVersion:   apcConfigurationVersion.GetVersionNumber(),\r\n\t\tDeploymentStrategyId:   jsii.String(\"AppConfig.AllAtOnce\"),\r\n\t\tEnvironmentId:          apcEnv.EnvironmentId(),\r\n\t\tDescription:            jsii.String(\"Deploy\"),\r\n\t\tTags:                   tags,\r\n\t\tTagsAll:                tags,\r\n\t})\r\n```\r\n\r\nI'm trying to deploy an AWS appconfig configuration, but when deploying the last resource ```appconfigdeployment``` is invalid because the ```ConfigurationVersion``` is ```-8.109562212591382e+298```\r\n\r\n\r\n\r\nIf I try to print the ConfigDeploymentVersionID it gives me something like ```xxxxx\\xxxxx\\1``` showing the right version. Obviously I am unable to parse the ID at runtime.\r\n\r\n\r\n### Steps to Reproduce\r\n\r\n1) Declare an AWS AppConfig application\r\n2) Declare an AWS AppConfig ConfigurationProfile\r\n3) Declare an AWS AppConfig ConfigurationVersion\r\n4) Declare an AWS AppConfig Environment\r\n5) Declare an AWS AppConfig Deployment\r\n\r\n### Versions\r\n\r\nlanguage: go\r\ncdktf-cli: 0.20.9\r\nnode: v18.12.1\r\ncdktf: 0.20.9\r\nconstructs: 10.4.2\r\njsii: 1.104.0\r\nterraform: 1.9.8\r\narch: arm64\r\nos: darwin 23.3.0\r\ngo: go version go1.23.2 darwin/arm64\r\nproviders\r\ngithub.com/cdktf/cdktf-provider-aws-go/aws (PREBUILT)\r\n        terraform provider version: 5.73.0 \r\n        prebuilt provider version: 19.39.0\r\n        cdktf version: ^0.20.0\r\ngithub.com/cdktf/cdktf-provider-null-go/null (PREBUILT)\r\n        terraform provider version: 3.2.3 \r\n        prebuilt provider version: 10.0.1\r\n        cdktf version: ^0.20.0\r\n\r\n### Providers\r\n\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name                                 â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ aws           â”‚ 5.73.0           â”‚ ^0.20.0 â”‚            â”‚ github.com/cdktf/cdktf-provider-aws-go/aws   â”‚ 19.39.0         â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ null          â”‚ 3.2.3            â”‚ ^0.20.0 â”‚            â”‚ github.com/cdktf/cdktf-provider-null-go/null â”‚ 10.0.1          â”‚\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\n_No response_\r\n\r\n### Anything Else?\r\n\r\nIf I try to print the ConfigDeploymentVersionID it gives me something like xxxxx\\xxxxx\\1 showing the right version. Obviously I am unable to parse the ID at runtime.\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-11-04T15:42:43Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3762,"title":"AppConfig Hosted Configuration Version does not return the right deployment version","updatedAt":"2024-11-04T16:18:04Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE1MzE3NTA=","is_bot":false,"login":"thekevinbrown","name":"Kevin Brown"},"body":"### Description\n\nIâ€™m trying to create a certificate in Azure key vault with CDKTF. To do that, I need a key vault policy applied that allows the CDKTF user to do this action. The code Iâ€™ve got to do that currently looks like this:\r\n\r\n```typescript\r\n// The deploying user (us right now in CDKTF context) need to be able to manage certificates\r\nconst deployerAccessForCertificates = new KeyVaultAccessPolicyA(\r\n\tconstruct,\r\n\t`deploy-key-vault-access`,\r\n\t{\r\n\t\tkeyVaultId: vault.id,\r\n\t\tobjectId: process.env.AZURE_APP_REGISTRATION_OBJECT_ID ?? '',\r\n\t\ttenantId: vault.tenantId,\r\n\t\tcertificatePermissions: ['Create', 'Get', 'List', 'Delete'],\r\n\t}\r\n);\r\n```\r\n\r\nThis is really annoying though, because Iâ€™m already authenticating successfully and Iâ€™d like to have one less constant to pull from the Azure console. I see that this is supported in the azurerm provider now, how do I access it from CDK code? E.g. Iâ€™d like the objectId value in the above snippet to be able to grab the current userâ€™s objectId.\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-11-04T05:58:18Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3761,"title":"Azurerm Provider: Allow Accessing current user object ID","updatedAt":"2024-11-04T05:58:18Z"},{"assignees":[],"author":{"id":"U_kgDOBommPg","is_bot":false,"login":"nelsonleblanc-rl","name":"Nelson LeBlanc"},"body":"### Description\r\n\r\nCurrently the gradle project and cdktf library version detection functions only support when \"build.gradle\" is used, but it could easily be extended to support \"build.gradle.kts\" as well.\r\n\r\nThis would make the cdktf debug output correctly when Kotlin build scripts are used with Gradle.\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [X] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6SX87R","author":{"login":"nelsonleblanc-rl"},"authorAssociation":"NONE","body":"https://github.com/hashicorp/terraform-cdk/pull/3760","createdAt":"2024-11-04T21:37:11Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3759#issuecomment-2455752401","viewerDidAuthor":false}],"createdAt":"2024-11-02T05:05:15Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3759,"title":"cdktf-cli: Support Kotlin build scripts in cdktf library version detection when Gradle is used","updatedAt":"2024-11-04T21:37:13Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE1MzQzMDM=","is_bot":false,"login":"LozanoMatheus","name":"Matheus Lozano"},"body":"### Expected Behavior\n\nI expected the CDKTF (Typescript) to use the current path to read the file. This is happening to any CDKTF thing, like TF functions (e.g. [file](https://developer.hashicorp.com/terraform/language/functions/file), [filemd5](https://developer.hashicorp.com/terraform/language/functions/filemd5)), AWS resources (e.g. [aws_s3_object](https://registry.terraform.io/providers/hashicorp/aws/5.65.0/docs/resources/s3_object)).\r\n\r\nInstead of considering the current folder (`./`), it's considering a subfolder (`./cdktf.out/stacks/myproject-dev`). So, for me to read any files in the current folder (e.g. under the `./templates/`), I would need to do `../../../templates/`.\r\n\r\nBut, if I do this `const filePath = path.resolve(file);` and pass the `filePath` it will work fine because it will have the full path. So, only the TF stuff considers the path `./cdktf.out/stacks/<stackName>`.\r\n\r\nThis issue took me a while to figure this out. I couldn't use the full path since I'm uploading a file to S3 and the state will change if I run from my machine vs a colleague's machine vs CI/CD pipelines. I could, of course, use the [lifecycle ignore-changes](https://developer.hashicorp.com/terraform/tutorials/state/resource-lifecycle#ignore-changes), but it's just a workaround and I would rather not do it.\r\n\r\nThis behaviour doesn't happen on TF, only in CDKTF.\n\n### Actual Behavior\n\n```\r\n            â”‚ Invalid value for \"path\" parameter: no file exists at\r\n            â”‚ \"templates/my-template.json\"; this function works only with\r\n            â”‚ files that are distributed as part of the configuration source code, so if\r\n            â”‚ this file will be created by a resource in this configuration you must\r\n            â”‚ instead obtain this result from an attribute of that resource.\r\n```\n\n### Steps to Reproduce\n\n* Create a sample file under the `./templates`\r\n\r\n```typescript\r\nimport { Fn } from 'cdktf';\r\n\r\n...\r\n\r\n/*\r\nThe way to solve this is to go up three directories\r\nconst file = `../../../templates/my-template.json`;\r\n\r\nIMO, doing like 'const filePath = path.resolve(file);' is just a terrible workaround as you'll also have to use ignoreChanges.\r\n*/\r\n\r\nconst file = 'templates/my-template.json' // or const file = './templates/my-template.json'\r\nconst etag = Fn.filemd5(file);\r\n\r\nnew S3Object(this, `s3-object-${file}`, {\r\n        bucket: s3Created.id,\r\n        key: file,\r\n        source: file,\r\n        etag,\r\n        tags,\r\n      });\r\n```\n\n### Versions\n\n```\r\ncdktf debug\r\nlanguage: typescript\r\ncdktf-cli: 0.20.8\r\nnode: v20.15.1\r\ncdktf: 0.20.9\r\nconstructs: 10.3.0\r\njsii: null\r\nterraform: 1.9.6\r\narch: x64\r\nos: darwin 23.5.0\r\nproviders\r\n@cdktf/provider-aws (PREBUILT)\r\n        terraform provider version: 5.65.0\r\n        prebuilt provider version: 19.33.0\r\n        cdktf version: ^0.20.0\r\n```\n\n### Providers\n\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name        â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ aws           â”‚ 5.65.0           â”‚ ^0.20.0 â”‚            â”‚ @cdktf/provider-aws â”‚ 19.33.0         â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n- Maybe related to #3739`\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6SRYgO","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"This problem is why we introduced assets: https://developer.hashicorp.com/terraform/cdktf/concepts/assets They should help you with this ğŸ‘ ","createdAt":"2024-11-04T07:56:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3755#issuecomment-2454030350","viewerDidAuthor":false}],"createdAt":"2024-10-27T13:58:13Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3755,"title":"CDKTF paths: Fail to find the file because CDKTF takes another path into consideration","updatedAt":"2024-11-04T07:56:23Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjMwNjI1MDQ=","is_bot":false,"login":"jackchuka","name":"Masanori Uehara"},"body":"### Expected Behavior\r\n\r\nSuccessfully creates binding for dev_overrides providers.\r\n\r\n### Actual Behavior\r\n\r\nfailed to add custom/provider via `cdktf provider add custom/provider`. (*I'm masking provider name with `custom/provider`, the one I'm building is not public yet)\r\nI've also tried followings, but no matter what I do it tries to lookup public registry.\r\n\r\n* setting `TF_CLI_CONFIG_FILE=~/.terraformrc`\r\n* using `--force-local` flag with `cdktf get`\r\n\r\n```sh\r\n\r\nâ¯ cdktf provider add custom/provider\r\n(node:17756) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.\r\n(Use `node --trace-deprecation ...` to show where the warning was created)\r\n[2024-10-26T16:03:47.122] [INFO] default - Checking whether pre-built provider exists for the following constraints:\r\n  provider: custom/provider\r\n  version : latest\r\n  language: go\r\n  cdktf   : 0.20.8\r\n\r\n[2024-10-26T16:03:47.250] [INFO] default - Pre-built provider does not exist for the given constraints.\r\n[2024-10-26T16:03:47.250] [INFO] default - Adding local provider registry.terraform.io/custom/provider with version constraint undefined to cdktf.json\r\nUsage Error: Could not find a version for the provider 'registry.terraform.io/custom/provider' in the public registry. This could be due to a typo, please take a look at https://cdk.tf/registry-providers to find all supported providers.\r\n```\r\n\r\nmy terraformrc\r\n```sh\r\nâ¯ bat ~/.terraformrc\r\nâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r\n       â”‚ File: /Users/jackchuka/.terraformrc\r\nâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r\n   1   â”‚ provider_installation {\r\n   2   â”‚ \r\n   3   â”‚   dev_overrides {\r\n   4   â”‚       \"registry.terraform.io/custom/provider\"= \"/Users/jackchuka/.local/share/mise/installs/go/1.23.2/bin\"\r\n   5   â”‚   }\r\n   6   â”‚ \r\n   7   â”‚   # For all other providers, install them directly from their origin provider\r\n   8   â”‚   # registries as normal. If you omit this, Terraform will _only_ use\r\n   9   â”‚   # the dev_overrides block, and so no other providers will be available.\r\n  10   â”‚   direct {}\r\n  11   â”‚ }\r\nâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n1. create a custom provider\r\n2. register via dev_overrides\r\n3. confirm it's able to terraform plan/apply, etc...\r\n\r\n4. create cdktest stack\r\n\r\n```sh\r\nâ¯ cd cmd/terraform-provider-platform             \r\n\r\nâ¯ mkdir cdktest\r\n\r\nâ¯ cd cdktest\r\n\r\nâ¯ cdktf init --template=\"go\" --local\r\n(node:17582) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.\r\n(Use `node --trace-deprecation ...` to show where the warning was created)\r\nNote: By supplying '--local' option you have chosen local storage mode for storing the state of your stack.\r\nThis means that your Terraform state file will be stored locally on disk in a file 'terraform.<STACK NAME>.tfstate' in the root of your project.\r\n? Project Name cdktest\r\n? Project Description A simple getting started project for cdktf.\r\n? Do you want to send crash reports to the CDKTF team? Refer to \r\nhttps://developer.hashicorp.com/terraform/cdktf/create-and-deploy/configuration-file#enable-crash-reporting-for-the-cli for more \r\ninformation no\r\n```\r\n\r\n5. add my custom provider\r\n```sh\r\nâ¯ cdktf provider add custom/provider\r\n```\r\n\r\n### Versions\r\n\r\n```\r\nâ¯ node -v\r\nv20.6.1\r\n\r\nâ¯ terraform version\r\nTerraform v1.9.8\r\non darwin_arm64\r\n\r\nâ¯ cdktf --version\r\n0.20.8\r\n```\r\n\r\n### Providers\r\n\r\n_No response_\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\n_No response_\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [X] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc610bGh","author":{"login":"dil-ddecarvalhogomes"},"authorAssociation":"NONE","body":"Could reproduce, DEBUG says the provider is being overridden but then terraform goes to the registry anyways about it and fails.\n\n```\n(.venv) âœ  cdktf-mycustom TF_LOG=debug cdktf get --force-local\n[2025-07-08T16:02:14.390] [ERROR] default - 2025-07-08T16:02:13.816-0600 [INFO]  Terraform version: 1.11.4\n2025-07-08T16:02:13.816-0600 [DEBUG] using github.com/hashicorp/go-tfe v1.70.0\n2025-07-08T16:02:13.816-0600 [DEBUG] using github.com/hashicorp/hcl/v2 v2.23.0\n2025-07-08T16:02:13.816-0600 [DEBUG] using github.com/hashicorp/terraform-svchost v0.1.1\n2025-07-08T16:02:13.816-0600 [DEBUG] using github.com/zclconf/go-cty v1.16.0\n2025-07-08T16:02:13.816-0600 [INFO]  Go runtime version: go1.23.3\n2025-07-08T16:02:13.816-0600 [INFO]  CLI args: []string{\"terraform\", \"version\", \"-json\"}\n2025-07-08T16:02:13.816-0600 [DEBUG] Attempting to open CLI config file: /Users/ddecarvalhogomes/.terraformrc\n2025-07-08T16:02:13.816-0600 [INFO]  Loading CLI configuration from /Users/ddecarvalhogomes/.terraformrc\n2025-07-08T16:02:13.817-0600 [DEBUG] Explicit provider installation configuration is set\n2025-07-08T16:02:13.818-0600 [INFO]  CLI command args: []string{\"version\", \"-json\"}\n2025-07-08T16:02:13.819-0600 [DEBUG] Provider registry.terraform.io/hashicorp/scaffolding is overridden by dev_overrides\n\n2025-07-08T16:02:13.816-0600 [INFO]  Terraform version: 1.11.4\n2025-07-08T16:02:13.816-0600 [DEBUG] using github.com/hashicorp/go-tfe v1.70.0\n2025-07-08T16:02:13.816-0600 [DEBUG] using github.com/hashicorp/hcl/v2 v2.23.0\n2025-07-08T16:02:13.816-0600 [DEBUG] using github.com/hashicorp/terraform-svchost v0.1.1\n2025-07-08T16:02:13.816-0600 [DEBUG] using github.com/zclconf/go-cty v1.16.0\n2025-07-08T16:02:13.816-0600 [INFO]  Go runtime version: go1.23.3\n2025-07-08T16:02:13.816-0600 [INFO]  CLI args: []string{\"terraform\", \"version\", \"-json\"}\n2025-07-08T16:02:13.816-0600 [DEBUG] Attempting to open CLI config file: /Users/ddecarvalhogomes/.terraformrc\n2025-07-08T16:02:13.816-0600 [INFO]  Loading CLI configuration from /Users/ddecarvalhogomes/.terraformrc\n2025-07-08T16:02:13.817-0600 [DEBUG] Explicit provider installation configuration is set\n2025-07-08T16:02:13.818-0600 [INFO]  CLI command args: []string{\"version\", \"-json\"}\n2025-07-08T16:02:13.819-0600 [DEBUG] Provider registry.terraform.io/hashicorp/scaffolding is overridden by dev_overrides\n[2025-07-08T16:02:14.394] [ERROR] default - 2025-07-08T16:02:13.846-0600 [INFO]  Terraform version: 1.11.4\n2025-07-08T16:02:13.846-0600 [DEBUG] using github.com/hashicorp/go-tfe v1.70.0\n2025-07-08T16:02:13.846-0600 [DEBUG] using github.com/hashicorp/hcl/v2 v2.23.0\n2025-07-08T16:02:13.846-0600 [DEBUG] using github.com/hashicorp/terraform-svchost v0.1.1\n2025-07-08T16:02:13.846-0600 [DEBUG] using github.com/zclconf/go-cty v1.16.0\n2025-07-08T16:02:13.846-0600 [INFO]  Go runtime version: go1.23.3\n2025-07-08T16:02:13.846-0600 [INFO]  CLI args: []string{\"terraform\", \"version\", \"-json\"}\n2025-07-08T16:02:13.846-0600 [DEBUG] Attempting to open CLI config file: /Users/ddecarvalhogomes/.terraformrc\n2025-07-08T16:02:13.846-0600 [INFO]  Loading CLI configuration from /Users/ddecarvalhogomes/.terraformrc\n2025-07-08T16:02:13.846-0600 [DEBUG] Explicit provider installation configuration is set\n2025-07-08T16:02:13.847-0600 [INFO]  CLI command args: []string{\"version\", \"-json\"}\n2025-07-08T16:02:13.847-0600 [DEBUG] Provider registry.terraform.io/hashicorp/scaffolding is overridden by dev_overrides\n\n2025-07-08T16:02:13.846-0600 [INFO]  Terraform version: 1.11.4\n2025-07-08T16:02:13.846-0600 [DEBUG] using github.com/hashicorp/go-tfe v1.70.0\n2025-07-08T16:02:13.846-0600 [DEBUG] using github.com/hashicorp/hcl/v2 v2.23.0\n2025-07-08T16:02:13.846-0600 [DEBUG] using github.com/hashicorp/terraform-svchost v0.1.1\n2025-07-08T16:02:13.846-0600 [DEBUG] using github.com/zclconf/go-cty v1.16.0\n2025-07-08T16:02:13.846-0600 [INFO]  Go runtime version: go1.23.3\n2025-07-08T16:02:13.846-0600 [INFO]  CLI args: []string{\"terraform\", \"version\", \"-json\"}\n2025-07-08T16:02:13.846-0600 [DEBUG] Attempting to open CLI config file: /Users/ddecarvalhogomes/.terraformrc\n2025-07-08T16:02:13.846-0600 [INFO]  Loading CLI configuration from /Users/ddecarvalhogomes/.terraformrc\n2025-07-08T16:02:13.846-0600 [DEBUG] Explicit provider installation configuration is set\n2025-07-08T16:02:13.847-0600 [INFO]  CLI command args: []string{\"version\", \"-json\"}\n2025-07-08T16:02:13.847-0600 [DEBUG] Provider registry.terraform.io/hashicorp/scaffolding is overridden by dev_overrides\n[2025-07-08T16:02:14.394] [ERROR] default - 2025-07-08T16:02:14.231-0600 [INFO]  Terraform version: 1.11.4\n2025-07-08T16:02:14.231-0600 [DEBUG] using github.com/hashicorp/go-tfe v1.70.0\n2025-07-08T16:02:14.231-0600 [DEBUG] using github.com/hashicorp/hcl/v2 v2.23.0\n2025-07-08T16:02:14.231-0600 [DEBUG] using github.com/hashicorp/terraform-svchost v0.1.1\n2025-07-08T16:02:14.231-0600 [DEBUG] using github.com/zclconf/go-cty v1.16.0\n2025-07-08T16:02:14.231-0600 [INFO]  Go runtime version: go1.23.3\n2025-07-08T16:02:14.231-0600 [INFO]  CLI args: []string{\"terraform\", \"version\", \"-json\"}\n2025-07-08T16:02:14.231-0600 [DEBUG] Attempting to open CLI config file: /Users/ddecarvalhogomes/.terraformrc\n2025-07-08T16:02:14.231-0600 [INFO]  Loading CLI configuration from /Users/ddecarvalhogomes/.terraformrc\n2025-07-08T16:02:14.231-0600 [DEBUG] Explicit provider installation configuration is set\n2025-07-08T16:02:14.232-0600 [INFO]  CLI command args: []string{\"version\", \"-json\"}\n2025-07-08T16:02:14.232-0600 [DEBUG] Provider registry.terraform.io/hashicorp/scaffolding is overridden by dev_overrides\n\n2025-07-08T16:02:14.231-0600 [INFO]  Terraform version: 1.11.4\n2025-07-08T16:02:14.231-0600 [DEBUG] using github.com/hashicorp/go-tfe v1.70.0\n2025-07-08T16:02:14.231-0600 [DEBUG] using github.com/hashicorp/hcl/v2 v2.23.0\n2025-07-08T16:02:14.231-0600 [DEBUG] using github.com/hashicorp/terraform-svchost v0.1.1\n2025-07-08T16:02:14.231-0600 [DEBUG] using github.com/zclconf/go-cty v1.16.0\n2025-07-08T16:02:14.231-0600 [INFO]  Go runtime version: go1.23.3\n2025-07-08T16:02:14.231-0600 [INFO]  CLI args: []string{\"terraform\", \"version\", \"-json\"}\n2025-07-08T16:02:14.231-0600 [DEBUG] Attempting to open CLI config file: /Users/ddecarvalhogomes/.terraformrc\n2025-07-08T16:02:14.231-0600 [INFO]  Loading CLI configuration from /Users/ddecarvalhogomes/.terraformrc\n2025-07-08T16:02:14.231-0600 [DEBUG] Explicit provider installation configuration is set\n2025-07-08T16:02:14.232-0600 [INFO]  CLI command args: []string{\"version\", \"-json\"}\n2025-07-08T16:02:14.232-0600 [DEBUG] Provider registry.terraform.io/hashicorp/scaffolding is overridden by dev_overrides\n[2025-07-08T16:02:14.814] [ERROR] default - 2025-07-08T16:02:14.814-0600 [INFO]  Terraform version: 1.11.4\n\n[2025-07-08T16:02:14.814] [ERROR] default - 2025-07-08T16:02:14.814-0600 [DEBUG] using github.com/hashicorp/go-tfe v1.70.0\n2025-07-08T16:02:14.814-0600 [DEBUG] using github.com/hashicorp/hcl/v2 v2.23.0\n2025-07-08T16:02:14.814-0600 [DEBUG] using github.com/hashicorp/terraform-svchost v0.1.1\n2025-07-08T16:02:14.814-0600 [DEBUG] using github.com/zclconf/go-cty v1.16.0\n2025-07-08T16:02:14.814-0600 [INFO]  Go runtime version: go1.23.3\n2025-07-08T16:02:14.814-0600 [INFO]  CLI args: []string{\"terraform\", \"-v\"}\n2025-07-08T16:02:14.814-0600 [DEBUG] Attempting to open CLI config file: /Users/ddecarvalhogomes/.terraformrc\n2025-07-08T16:02:14.814-0600 [INFO]  Loading CLI configuration from /Users/ddecarvalhogomes/.terraformrc\n2025-07-08T16:02:14.814-0600 [DEBUG] Explicit provider installation configuration is set\n2025-07-08T16:02:14.814-0600 [INFO]  CLI command args: []string{\"version\", \"-v\"}\n2025-07-08T16:02:14.814-0600 [DEBUG] Provider registry.terraform.io/hashicorp/scaffolding is overridden by dev_overrides\n\nâ ‹ downloading and generating modules and providers...\n[2025-07-08T16:02:14.885] [ERROR] default - 2025-07-08T16:02:14.885-0600 [INFO]  Terraform version: 1.11.4\n\n2025-07-08T16:02:14.885-0600 [INFO]  Terraform version: 1.11.4\n[2025-07-08T16:02:14.885] [ERROR] default - 2025-07-08T16:02:14.885-0600 [DEBUG] using github.com/hashicorp/go-tfe v1.70.0\n2025-07-08T16:02:14.885-0600 [DEBUG] using github.com/hashicorp/hcl/v2 v2.23.0\n2025-07-08T16:02:14.885-0600 [DEBUG] using github.com/hashicorp/terraform-svchost v0.1.1\n2025-07-08T16:02:14.885-0600 [DEBUG] using github.com/zclconf/go-cty v1.16.0\n2025-07-08T16:02:14.885-0600 [INFO]  Go runtime version: go1.23.3\n2025-07-08T16:02:14.885-0600 [INFO]  CLI args: []string{\"terraform\", \"init\"}\n2025-07-08T16:02:14.885-0600 [DEBUG] Attempting to open CLI config file: /Users/ddecarvalhogomes/.terraformrc\n2025-07-08T16:02:14.885-0600 [INFO]  Loading CLI configuration from /Users/ddecarvalhogomes/.terraformrc\n\n2025-07-08T16:02:14.885-0600 [DEBUG] using github.com/hashicorp/go-tfe v1.70.0\n2025-07-08T16:02:14.885-0600 [DEBUG] using github.com/hashicorp/hcl/v2 v2.23.0\n2025-07-08T16:02:14.885-0600 [DEBUG] using github.com/hashicorp/terraform-svchost v0.1.1\n2025-07-08T16:02:14.885-0600 [DEBUG] using github.com/zclconf/go-cty v1.16.0\n2025-07-08T16:02:14.885-0600 [INFO]  Go runtime version: go1.23.3\n2025-07-08T16:02:14.885-0600 [INFO]  CLI args: []string{\"terraform\", \"init\"}\n2025-07-08T16:02:14.885-0600 [DEBUG] Attempting to open CLI config file: /Users/ddecarvalhogomes/.terraformrc\n2025-07-08T16:02:14.885-0600 [INFO]  Loading CLI configuration from /Users/ddecarvalhogomes/.terraformrc\n[2025-07-08T16:02:14.885] [ERROR] default - 2025-07-08T16:02:14.885-0600 [DEBUG] Explicit provider installation configuration is set\n\n2025-07-08T16:02:14.885-0600 [DEBUG] Explicit provider installation configuration is set\n[2025-07-08T16:02:14.885] [ERROR] default - 2025-07-08T16:02:14.885-0600 [INFO]  CLI command args: []string{\"init\"}\n\n2025-07-08T16:02:14.885-0600 [INFO]  CLI command args: []string{\"init\"}\n[2025-07-08T16:02:14.890] [ERROR] default - 2025-07-08T16:02:14.890-0600 [DEBUG] Provider registry.terraform.io/hashicorp/scaffolding is overridden by dev_overrides\n\n2025-07-08T16:02:14.890-0600 [DEBUG] Provider registry.terraform.io/hashicorp/scaffolding is overridden by dev_overrides\n[2025-07-08T16:02:14.890] [ERROR] default - 2025-07-08T16:02:14.890-0600 [DEBUG] Provider registry.terraform.io/hashicorp/scaffolding is overridden to load from /Users/ddecarvalhogomes/Projects/terraform-provider-scaffolding-framework\n\n2025-07-08T16:02:14.890-0600 [DEBUG] Provider registry.terraform.io/hashicorp/scaffolding is overridden to load from /Users/ddecarvalhogomes/Projects/terraform-provider-scaffolding-framework\n[2025-07-08T16:02:14.890] [ERROR] default - 2025-07-08T16:02:14.890-0600 [DEBUG] checking for provisioner in \".\"\n\n2025-07-08T16:02:14.890-0600 [DEBUG] checking for provisioner in \".\"\n[2025-07-08T16:02:14.891] [ERROR] default - 2025-07-08T16:02:14.891-0600 [DEBUG] checking for provisioner in \"/opt/homebrew/bin\"\n\n2025-07-08T16:02:14.891-0600 [DEBUG] checking for provisioner in \"/opt/homebrew/bin\"\n[2025-07-08T16:02:14.892] [ERROR] default - 2025-07-08T16:02:14.892-0600 [DEBUG] Provider registry.terraform.io/hashicorp/scaffolding is overridden by dev_overrides\n\n2025-07-08T16:02:14.892-0600 [DEBUG] Provider registry.terraform.io/hashicorp/scaffolding is overridden by dev_overrides\n[2025-07-08T16:02:14.893] [ERROR] default - 2025-07-08T16:02:14.893-0600 [DEBUG] Service discovery for registry.terraform.io at https://registry.terraform.io/.well-known/terraform.json\n\n2025-07-08T16:02:14.893-0600 [DEBUG] Service discovery for registry.terraform.io at https://registry.terraform.io/.well-known/terraform\nâ ™ downloading and generating modules and providers...\n[2025-07-08T16:02:14.966] [ERROR] default - 2025-07-08T16:02:14.966-0600 [DEBUG] GET https://registry.terraform.io/v1/providers/hashicorp/scaffolding/versions\n\nâ ¸ downloading and generating modules and providers...\n[2025-07-08T16:02:15.121] [ERROR] default - 2025-07-08T16:02:15.120-0600 [DEBUG] GET https://registry.terraform.io/v1/providers/-/scaffolding/versions\n\nâ ´ downloading and generating modules and providers...\n[2025-07-08T16:02:15.321] [ERROR] default - â•·\nâ”‚ Error: Failed to query available provider packages\nâ”‚\nâ”‚ Could not retrieve the list of available versions for provider\nâ”‚ hashicorp/scaffolding: provider registry registry.terraform.io does not\nâ”‚ have a provider named registry.terraform.io/hashicorp/scaffolding\nâ”‚\nâ”‚ All modules should specify their required_providers so that external\nâ”‚ consumers will get the correct providers when using a module. To see which\nâ”‚ modules are currently depending on hashicorp/scaffolding, run the following\nâ”‚ command:\nâ”‚     terraform providers\nâ•µ\n\nâ•·\nâ”‚ Error: Failed to query available provider packages\nâ”‚\nâ”‚ Could not retrieve the list of available versions for provider\nâ”‚ hashicorp/scaffolding: provider registry registry.terraform.io does not\nâ”‚ have a provider named registry.terraform.io/hashicorp/scaffolding\nâ”‚\nâ”‚ All modules should specify their required_providers so that external\nâ”‚ consumers will get the correct providers when using a module. To see which\nâ”‚ modules are currently depending on hashicorp/scaffolding, run the following\nâ”‚ command:\nâ”‚     terraform providers\nError: non-zero exit code 1\n    at ChildProcess.<anonymous> (/opt/homebrew/Cellar/cdktf/0.20.12_1/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:102:34019)\n    at Object.onceWrapper (node:events:622:26)\n    at ChildProcess.emit (node:events:507:28)\n    at ChildProcess.emit (node:domain:489:12)\n    at maybeClose (node:internal/child_process:1101:16)\n    at ChildProcess._handle.onexit (node:internal/child_process:305:5) {\n  stderr: '2025-07-08T16:02:14.885-0600 [INFO]  Terraform version: 1.11.4\\n' +\n    '2025-07-08T16:02:14.885-0600 [DEBUG] using github.com/hashicorp/go-tfe v1.70.0\\n' +\n    '2025-07-08T16:02:14.885-0600 [DEBUG] using github.com/hashicorp/hcl/v2 v2.23.0\\n' +\n    '2025-07-08T16:02:14.885-0600 [DEBUG] using github.com/hashicorp/terraform-svchost v0.1.1\\n' +\n    '2025-07-08T16:02:14.885-0600 [DEBUG] using github.com/zclconf/go-cty v1.16.0\\n' +\n    '2025-07-08T16:02:14.885-0600 [INFO]  Go runtime version: go1.23.3\\n' +\n    '2025-07-08T16:02:14.885-0600 [INFO]  CLI args: []string{\"terraform\", \"init\"}\\n' +\n    '2025-07-08T16:02:14.885-0600 [DEBUG] Attempting to open CLI config file: /Users/ddecarvalhogomes/.terraformrc\\n' +\n    '2025-07-08T16:02:14.885-0600 [INFO]  Loading CLI configuration from /Users/ddecarvalhogomes/.terraformrc\\n' +\n    '2025-07-08T16:02:14.885-0600 [DEBUG] Explicit provider installation configuration is set\\n' +\n    '2025-07-08T16:02:14.885-0600 [INFO]  CLI command args: []string{\"init\"}\\n' +\n    '2025-07-08T16:02:14.890-0600 [DEBUG] Provider registry.terraform.io/hashicorp/scaffolding is overridden by dev_overrides\\n' +\n    '2025-07-08T16:02:14.890-0600 [DEBUG] Provider registry.terraform.io/hashicorp/scaffolding is overridden to load from /Users/ddecarvalhogomes/Projects/terraform-provider-scaffolding-framework\\n' +\n    '2025-07-08T16:02:14.890-0600 [DEBUG] checking for provisioner in \".\"\\n' +\n    '2025-07-08T16:02:14.891-0600 [DEBUG] checking for provisioner in \"/opt/homebrew/bin\"\\n' +\n    '2025-07-08T16:02:14.892-0600 [DEBUG] Provider registry.terraform.io/hashicorp/scaffolding is overridden by dev_overrides\\n' +\n    '2025-07-08T16:02:14.893-0600 [DEBUG] Service discovery for registry.terraform.io at https://registry.terraform.io/.well-known/terraform.json\\n' +\n    '2025-07-08T16:02:14.966-0600 [DEBUG] GET https://registry.terraform.io/v1/providers/hashicorp/scaffolding/versions\\n' +\n    '2025-07-08T16:02:15.120-0600 [DEBUG] GET https://registry.terraform.io/v1/providers/-/scaffolding/versions\\n' +\n    '\\x1B[31mâ•·\\x1B[0m\\x1B[0m\\n' +\n    '\\x1B[31mâ”‚\\x1B[0m \\x1B[0m\\x1B[1m\\x1B[31mError: \\x1B[0m\\x1B[0m\\x1B[1mFailed to query available provider packages\\x1B[0m\\n' +\n    '\\x1B[31mâ”‚\\x1B[0m \\x1B[0m\\n' +\n    '\\x1B[31mâ”‚\\x1B[0m \\x1B[0m\\x1B[0mCould not retrieve the list of available versions for provider\\n' +\n    '\\x1B[31mâ”‚\\x1B[0m \\x1B[0mhashicorp/scaffolding: provider registry registry.terraform.io does not\\n' +\n    '\\x1B[31mâ”‚\\x1B[0m \\x1B[0mhave a provider named registry.terraform.io/hashicorp/scaffolding\\n' +\n    '\\x1B[31mâ”‚\\x1B[0m \\x1B[0m\\n' +\n    '\\x1B[31mâ”‚\\x1B[0m \\x1B[0mAll modules should specify their required_providers so that external\\n' +\n    '\\x1B[31mâ”‚\\x1B[0m \\x1B[0mconsumers will get the correct providers when using a module. To see which\\n' +\n    '\\x1B[31mâ”‚\\x1B[0m \\x1B[0mmodules are currently depending on hashicorp/scaffolding, run the following\\n' +\n    '\\x1B[31mâ”‚\\x1B[0m \\x1B[0mcommand:\\n' +\n    '\\x1B[31mâ”‚\\x1B[0m \\x1B[0m    terraform providers\\n' +\n    '\\x1B[31mâ•µ\\x1B[0m\\x1B[0m\\n'\n}\nâ ´ downloading and generating modules and providers...\nError: non-zero exit code 1\n```","createdAt":"2025-07-08T22:05:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3754#issuecomment-3050418593","viewerDidAuthor":false}],"createdAt":"2024-10-26T07:08:34Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3754,"title":"CDKTF: Cannot Get \"dev_overrides\" Provider Properly","updatedAt":"2025-07-08T22:05:20Z"},{"assignees":[],"author":{"id":"U_kgDOCqgwIA","is_bot":false,"login":"brent-at-aam","name":"Brent Souza"},"body":"### Expected Behavior\r\n\r\nWhen using Python, the time taken for a synth is only correlated to the volume of resources within a stack.\r\n\r\n### Actual Behavior\r\n\r\nWhen using Python, running any operations with larger providers takes a long time due to lengthy module import load times. You could have a single resource and it would still take ~30s to even get started with the synth.\r\n\r\n### Steps to Reproduce\r\n\r\n1. Use Python\r\n2. Add the cdktf-cdktf-provider-aws library to your project\r\n3. Make a small stack that uses any resource from the aws provider module\r\n4. Run a synth\r\n\r\n### Versions\r\n\r\nRunning with the latest versions\r\n\r\n### Providers\r\n\r\n_No response_\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\nThis is really just a general issue for all providers, but only becomes a big problem for the large ones like AWS.  Looking through the issues, this is related to #2792, which was ostensibly fixed by #3030.\r\n\r\nPerhaps this is a regression due to some newer behavior in upstream packages but importing AWS is back to taking around 30 seconds and has been for quite a while. I've switched a few projects from python to typescript to get away from it but really it would be nice to not have to do that.\r\n\r\nThe bulk of the time is spent loading the submodules (thanks @giner). This is why I wonder if it's a regression for the changes made in #3030\r\n\r\nAnother source of slowness is the large gzipped assembly in `_jsii`.\r\n\r\nThe root of the module loads it:\r\n\r\n**/__init__.py**\r\n ```python\r\nfrom ._jsii import *\r\n```\r\n\r\nAnd worth noting that resource modules also load it:\r\n\r\n**/foo/__init__.py**\r\n```python\r\nfrom .._jsii import *\r\n```\r\n\r\nI know much of this is really just behavior of other libraries, and thus this might not be something you can control here. I also realize this is something you have probably already considered, but there is no discussion about it in issues I could find. Is it possible to instruct the package generation to build separate assemblies for each of the submodules of a provider package?\r\n\r\nAnd you would then remove `from ._jsii import *` from the root. And resources would just import their specific jsii assembly.\r\n\r\n\r\n### Workarounds\r\n\r\nNone that are feasible\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n- #2792\r\n- #3030\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6SRX_l","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"I think the changes we made in 0.18 might help here already: https://developer.hashicorp.com/terraform/cdktf/release/upgrade-guide-v0-18#python-performance-improvements-disable-root-level-provider-imports\r\n\r\nI think any other improvements would need to be made on the JSII side, so I would suggest checking if there is a similar issue here: https://github.com/aws/jsii","createdAt":"2024-11-04T07:54:59Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3753#issuecomment-2454028261","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6ST2J4","author":{"login":"brent-at-aam"},"authorAssociation":"NONE","body":"@DanielMSchmidt Yes I referenced those changes above actually. It seems to have zero effect since the jsii assembly is imported at the root level, which is what slows down the runtime.\r\n\r\nMy question here really is if the package you are building could be structured differently so that it doesn't generate one large JSII assembly but many.","createdAt":"2024-11-04T13:09:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3753#issuecomment-2454676088","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6S5qym","author":{"login":"giner"},"authorAssociation":"NONE","body":"Module libraries always all submodules in from the root `__init__.py` which causes all submodules being loaded all the time. This in turn causes very slow start time. Here is an example (we load `cloudwatch_log_group` and check whether `alb_target_group` gets loaded):\r\n```shell\r\ntime python3 -c \"import cdktf_cdktf_provider_aws.cloudwatch_log_group; print(type(cdktf_cdktf_provider_aws.alb_target_group))\"\r\n<class 'module'>\r\n\r\nreal\t0m24.241s\r\nuser\t0m24.020s\r\nsys\t0m2.288s\r\n```\r\n\r\nThis looks as if it was a mistake. Fixing it will significantly improve experience with CDKTF for Python users.","createdAt":"2024-11-08T12:04:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3753#issuecomment-2464591014","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6S5sQw","author":{"login":"giner"},"authorAssociation":"NONE","body":"Here is a similar issue reported on jsii https://github.com/aws/jsii/issues/3389","createdAt":"2024-11-08T12:06:32Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3753#issuecomment-2464597040","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6S7DO-","author":{"login":"brent-at-aam"},"authorAssociation":"NONE","body":"Yeah I think we could side-step this entirely if the provider package for python was built similar to something like boto3-stubs, where each subject area is an extra package. I would love to have an interface like:\r\n\r\n```sh\r\npip install cdktf-cdktf-provider-aws[s3,iam,lambda]\r\n```\r\n\r\nSo this would require that instead of one giant AWS provider package, we would have multiple python packages.\r\n\r\nI know these providers are all generated so special tweaks per language like this might be hard to do, but it would seem like it's possible to work within the limitations of jsii, while still delivering a better experience.","createdAt":"2024-11-08T14:51:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3753#issuecomment-2464953278","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6S7OXX","author":{"login":"giner"},"authorAssociation":"NONE","body":"The problem is not in this being a single package, it's `__init__.py` importing all submodules for (likely) no good reason is causing the issue ","createdAt":"2024-11-08T15:10:28Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3753#issuecomment-2464998871","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6S9eBh","author":{"login":"brent-at-aam"},"authorAssociation":"NONE","body":"For sure the bulk of the time is the module imports. The jsii assembly load is a minimal impact comparatively, but still slows it down.\r\n\r\nI updated the issue description to designate the appropriate source of the slow down.","createdAt":"2024-11-08T19:23:00Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3753#issuecomment-2465587297","viewerDidAuthor":false}],"createdAt":"2024-10-25T16:45:24Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"}],"milestone":null,"number":3753,"title":"Providers of Large Size: Import is very slow in Python","updatedAt":"2025-05-30T12:29:59Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMDIyNjA5","is_bot":false,"login":"arjunkarnwal","name":"Arjun Karnwal"},"body":"### Description\n\nIn its current form, there is no way for the developers to remove a particular field from the generated cdk.tf.json. \r\ne.g. \r\n```\r\n\"terraform\": {\r\n    \"backend\" : \"XX\"\r\n    \"required_providers\": {\r\n      \"datadog\": {\r\n        \"source\": \"DataDog/datadog\",\r\n        \"version\": \"3.37.0\"\r\n      }\r\n    }\r\n  }\r\n```\r\n\r\nThere is no way where I can completely remove `backend` from the generated json file.\r\n\r\nThe functionality provided right now to override \r\n```\r\ncdkStack.AddOverride(\"terraform.backend\", \"\")\r\n```\r\nwill set the backend with a \"\" value but not completely remove. Moreover nil can not be passed as argument. \r\n\r\nPassing nil is supported in the terraform-cdk-typescript which completely removes the given key but is not supported in terraform-cdk-go.\r\n\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6_2ABI","author":{"login":"tjholm"},"authorAssociation":"NONE","body":"@arjunkarnwal I've achieved this in my own project using JSII overrides:\n\nExample linked here: https://github.com/hashicorp/terraform-cdk/issues/2435#issuecomment-3177885691","createdAt":"2025-08-25T02:08:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3751#issuecomment-3218604104","viewerDidAuthor":false}],"createdAt":"2024-10-22T22:18:04Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3751,"title":"terraform-cdk-go: able to override and remove a key completely from generated cdk.tf.json","updatedAt":"2025-08-25T02:08:14Z"},{"assignees":[],"author":{"id":"U_kgDOCBD_xQ","is_bot":false,"login":"ankitatdnv","name":"Ankit Choudhary"},"body":"### Expected Behavior\n\nThere should not be any issue\n\n### Actual Behavior\n\nGitHub workflow fails with following Error in hashicorp/terraform-cdk-action GitHub action:\r\nError: You have exceeded a secondary rate limit. Please wait a few minutes before you try again. If you reach out to GitHub Support for help, please include the request ID 9641:3C4423:13A2F5D:13CFDCF:670F98AE.\n\n### Steps to Reproduce\n\nTry to apply changes with at least 100 of resources\n\n### Versions\n\nlanguage: typescript\r\ncdktf-cli: 0.20.6\r\nnode: v20.12.2\r\ncdktf: 0.20.6\r\nconstructs: 10.3.0\r\njsii: null\r\nterraform: 1.8.0\r\narch: x64\r\nos: win32 10.0.19045\n\n### Providers\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name            â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ azuread       â”‚ 2.50.0           â”‚ ^0.20.0 â”‚            â”‚ @cdktf/provider-azuread â”‚ 12.3.0          â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ azurerm       â”‚ 3.99.0           â”‚ ^0.20.0 â”‚            â”‚ @cdktf/provider-azurerm â”‚ 12.12.0         â”‚\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6QmIFj","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"This seems to refer to GitHubs [secondary rate limit](https://docs.github.com/en/rest/using-the-rest-api/rate-limits-for-the-rest-api?apiVersion=2022-11-28#about-secondary-rate-limits), it stems from e.g. too many concurrent requests to the GitHub API. If your configuration is creating github resources you might need to look into the `--terraform-parallelism`  flag, but if your configuration only runs on github it is likely a cause unrelated to CDKTF.","createdAt":"2024-10-21T08:02:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3744#issuecomment-2425913699","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6RThjz","author":{"login":"rockcheung2004"},"authorAssociation":"NONE","body":"Related to [this](https://github.com/hashicorp/terraform-cdk-action/issues/224) issue","createdAt":"2024-10-25T13:40:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3744#issuecomment-2437814515","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6RxRd-","author":{"login":"levelupatlas-mat"},"authorAssociation":"NONE","body":"> This seems to refer to GitHubs [secondary rate limit](https://docs.github.com/en/rest/using-the-rest-api/rate-limits-for-the-rest-api?apiVersion=2022-11-28#about-secondary-rate-limits), it stems from e.g. too many concurrent requests to the GitHub API. If your configuration is creating github resources you might need to look into the `--terraform-parallelism` flag, but if your configuration only runs on github it is likely a cause unrelated to CDKTF.\r\n\r\nI'm not sure why it'd be unlikely it's related to this action. Are you confident that this action cannot trigger any of Github's secondary rate limits? I get it on multiple repos using this action.\r\n\r\nEDIT: Oops, didn't notice the repo difference here. @ OP check the related issue in the action's repo.","createdAt":"2024-10-30T01:14:55Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3744#issuecomment-2445612926","viewerDidAuthor":false}],"createdAt":"2024-10-16T11:25:40Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3744,"title":"GitHub Secondary rate limit error while applying the Terraform configurations","updatedAt":"2024-10-30T01:17:09Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjIxMjk1NjQx","is_bot":false,"login":"JamesNSmith","name":"James Smith"},"body":"### Expected Behavior\n\nhttps://developer.hashicorp.com/terraform/tutorials/cdktf/cdktf-install should provide an easy start.\n\n### Actual Behavior\n\nError: Failed to query available provider packages\r\nâ”‚ \r\nâ”‚ Could not retrieve the list of available versions for provider\r\nâ”‚ hashicorp/docker: provider registry registry.terraform.io does not have a\r\nâ”‚ provider named registry.terraform.io/hashicorp/docker\r\nâ”‚ \r\nâ”‚ Did you intend to use kreuzwerker/docker? If so, you must specify that\r\nâ”‚ source address in each module which requires that provider. To see which\r\nâ”‚ modules are currently depending on hashicorp/docker, run the following\r\nâ”‚ command:\r\nâ”‚     terraform providers\n\n### Steps to Reproduce\n\nFollow the tutorial: https://developer.hashicorp.com/terraform/tutorials/cdktf/cdktf-install \r\n\n\n### Versions\n\n\"cdktf\": \"0.20.0\",\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6O1IZi","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @JamesNSmith ğŸ‘‹\r\n\r\nWhich exact command produced the error message you encountered?","createdAt":"2024-10-07T08:43:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3738#issuecomment-2396292706","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6O1nxi","author":{"login":"JamesNSmith"},"authorAssociation":"NONE","body":"Hi @ansgarm \r\n\r\nThe command that causes the error is cdktf get. ","createdAt":"2024-10-07T09:38:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3738#issuecomment-2396421218","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6ae5Kc","author":{"login":"koyukan"},"authorAssociation":"NONE","body":"I can confirm, it's still not working. \n\ncdktf --version \n0.21.0-pre.143","createdAt":"2025-01-15T07:01:58Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3738#issuecomment-2591789724","viewerDidAuthor":false}],"createdAt":"2024-10-03T16:55:38Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":3738,"title":"COMPONENT: tutorial doesn't work","updatedAt":"2025-01-15T07:01:59Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE5ODY5NTA=","is_bot":false,"login":"paymog","name":"Paymahn Moghadasian"},"body":"### Expected Behavior\r\n\r\nCDKTF should not fetch providers if they already exist\r\n\r\n### Actual Behavior\r\n\r\nCDKTF fetches providers on every deploy, even subsequent deploys that did not change providers\r\n\r\n### Steps to Reproduce\r\n\r\nNot sure how to reliably reproduce.\r\n\r\n### Versions\r\n```\r\n â¯â¯â¯ npx cdktf debug\r\ncdktf debug\r\nlanguage: typescript\r\ncdktf-cli: 0.20.8\r\nnode: v18.17.0\r\ncdktf: 0.20.8\r\nconstructs: 10.3.0\r\njsii: null\r\nterraform: 1.9.3\r\narch: arm64\r\nos: darwin 23.6.0\r\nproviders\r\naws@~> 5.61 (LOCAL)\r\n        terraform provider version: 5.61.0\r\nkubernetes@ ~> 2.31.0 (LOCAL)\r\n        terraform provider version: 2.31.0\r\nhttp@ ~> 2.1.0 (LOCAL)\r\n        terraform provider version: 2.1.0\r\ntls@ ~> 4.0.5 (LOCAL)\r\n        terraform provider version: 4.0.5\r\nrandom@ ~> 3.1.0 (LOCAL)\r\n        terraform provider version: 3.1.3\r\ngavinbunney/kubectl@~> 1.14.0 (LOCAL)\r\n        terraform provider version: 1.14.0\r\nDopplerHQ/doppler@1.1.6 (LOCAL)\r\n        terraform provider version: 1.1.6\r\nhelm@undefined (LOCAL)\r\n        terraform provider version: 2.14.0\r\n@cdktf/provider-aws (PREBUILT)\r\n        terraform provider version: 5.61.0\r\n        prebuilt provider version: 19.29.0\r\n        cdktf version: ^0.20.0\r\n@cdktf/provider-kubernetes (PREBUILT)\r\n        terraform provider version: 2.31.0\r\n        prebuilt provider version: 11.6.0\r\n        cdktf version: ^0.20.0\r\n```\r\n\r\n### Providers\r\n\r\n_No response_\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\n_No response_\r\n\r\n### Anything Else?\r\n\r\nLooks like this was addressed in 0.15.3 but I'm on 0.20.0 and I'm still seeing it. Fetching these providers can be very slow. Here are some logs I see\r\n\r\n```\r\n                    - Reusing previous version of hashicorp/random from the dependency lock file\r\ngoldsky-infra-prod  - Reusing previous version of hashicorp/aws from the dependency lock file\r\ngoldsky-infra-prod  - Reusing previous version of hashicorp/archive from the dependency lock file\r\ngoldsky-infra-prod  - Reusing previous version of hashicorp/helm from the dependency lock file\r\ngoldsky-infra-prod  - Reusing previous version of hashicorp/tls from the dependency lock file\r\ngoldsky-infra-prod  - Reusing previous version of hashicorp/http from the dependency lock file\r\ngoldsky-infra-prod  - Reusing previous version of hashicorp/cloudinit from the dependency lock file\r\ngoldsky-infra-prod  - Reusing previous version of hashicorp/kubernetes from the dependency lock file\r\ngoldsky-infra-prod  - Reusing previous version of dopplerhq/doppler from the dependency lock file\r\ngoldsky-infra-prod  - Using previously-installed dopplerhq/doppler v1.1.6\r\ngoldsky-infra-prod  - Using previously-installed hashicorp/random v3.1.3\r\ngoldsky-infra-prod  - Using previously-installed hashicorp/cloudinit v2.3.5\r\ngoldsky-infra-prod  - Using previously-installed hashicorp/helm v2.14.0\r\ngoldsky-infra-prod  - Using previously-installed hashicorp/tls v4.0.5\r\ngoldsky-infra-prod  - Using previously-installed hashicorp/http v2.1.0\r\ngoldsky-infra-prod  - Using previously-installed hashicorp/kubernetes v2.31.0\r\ngoldsky-infra-prod  - Using previously-installed hashicorp/aws v5.61.0\r\ngoldsky-infra-prod  - Using previously-installed hashicorp/archive v2.6.0\r\ngoldsky-infra-prod  Terraform has been successfully initialized!\r\n\r\n                    You may now begin working with Terraform. Try running \"terraform plan\" to see\r\n                    any changes that are required for your infrastructure. All Terraform commands\r\n                    should now work.\r\n\r\n                    If you ever set or change modules or backend configuration for Terraform,\r\n                    rerun this command to reinitialize your working directory. If you forget, other\r\n                    commands will detect it and remind you to do so if necessary.\r\ngoldsky-infra-prod  - Fetching dopplerhq/doppler 1.1.6 for linux_amd64...\r\ngoldsky-infra-prod  - Retrieved dopplerhq/doppler 1.1.6 for linux_amd64 (self-signed, key ID D13E9DC04ACCB5E6)\r\ngoldsky-infra-prod  - Fetching hashicorp/http 2.1.0 for linux_amd64...\r\ngoldsky-infra-prod  - Retrieved hashicorp/http 2.1.0 for linux_amd64 (signed by HashiCorp)\r\ngoldsky-infra-prod  - Fetching hashicorp/random 3.1.3 for linux_amd64...\r\ngoldsky-infra-prod  - Retrieved hashicorp/random 3.1.3 for linux_amd64 (signed by HashiCorp)\r\ngoldsky-infra-prod  - Fetching hashicorp/archive 2.6.0 for linux_amd64...\r\ngoldsky-infra-prod  - Retrieved hashicorp/archive 2.6.0 for linux_amd64 (signed by HashiCorp)\r\ngoldsky-infra-prod  - Fetching hashicorp/kubernetes 2.31.0 for linux_amd64...\r\ngoldsky-infra-prod  - Retrieved hashicorp/kubernetes 2.31.0 for linux_amd64 (signed by HashiCorp)\r\ngoldsky-infra-prod  - Fetching hashicorp/helm 2.14.0 for linux_amd64...\r\ngoldsky-infra-prod  - Retrieved hashicorp/helm 2.14.0 for linux_amd64 (signed by HashiCorp)\r\ngoldsky-infra-prod  - Fetching hashicorp/cloudinit 2.3.5 for linux_amd64...\r\ngoldsky-infra-prod  - Retrieved hashicorp/cloudinit 2.3.5 for linux_amd64 (signed by HashiCorp)\r\ngoldsky-infra-prod  - Fetching hashicorp/aws 5.61.0 for linux_amd64...\r\ngoldsky-infra-prod  - Retrieved hashicorp/aws 5.61.0 for linux_amd64 (signed by HashiCorp)\r\ngoldsky-infra-prod  - Fetching hashicorp/tls 4.0.5 for linux_amd64...\r\ngoldsky-infra-prod  - Retrieved hashicorp/tls 4.0.5 for linux_amd64 (signed by HashiCorp)\r\ngoldsky-infra-prod  - Obtained hashicorp/cloudinit checksums for linux_amd64; All checksums for this platform were already tracked in the lock file\r\n                    - Obtained hashicorp/archive checksums for linux_amd64; All checksums for this platform were already tracked in the lock file\r\n                    - Obtained hashicorp/http checksums for linux_amd64; All checksums for this platform were already tracked in the lock file\r\n                    - Obtained hashicorp/kubernetes checksums for linux_amd64; All checksums for this platform were already tracked in the lock file\r\n                    - Obtained hashicorp/tls checksums for linux_amd64; All checksums for this platform were already tracked in the lock file\r\n                    - Obtained hashicorp/random checksums for linux_amd64; All checksums for this platform were already tracked in the lock file\r\n                    - Obtained hashicorp/aws checksums for linux_amd64; All checksums for this platform were already tracked in the lock file\r\n                    - Obtained dopplerhq/doppler checksums for linux_amd64; All checksums for this platform were already tracked in the lock file\r\n                    - Obtained hashicorp/helm checksums for linux_amd64; All checksums for this platform were already tracked in the lock file\r\n```\r\n\r\n### References\r\n\r\n- #2525 \r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6P9Gso","author":{"login":"lostick"},"authorAssociation":"NONE","body":"I'm also experiencing the same issue on my side, it makes the init stage unnecessary slow.\r\nI believe this issue is also related to #3622 ","createdAt":"2024-10-15T21:06:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3737#issuecomment-2415160104","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6YMzHd","author":{"login":"matttylr"},"authorAssociation":"NONE","body":"Also seeing this on 0.20.10 on macOS 15.0.1\r\nParticularly puzzled why its fetching providers for linux when I'm on a mac, e.g.\r\n\r\n```\r\n- Fetching hashicorp/aws 5.75.1 for linux_amd64...\r\n```\r\n\r\nwhen running with `TF_LOG=DEBUG`,  I see several instances of this where the `-platform` argument is being passed to terraform it seems\r\n\r\n```\r\n[2024-12-19T11:26:27.113] [ERROR] default - 2024-12-19T11:26:27.111Z [DEBUG] using github.com/hashicorp/hcl/v2 v2.16.2\r\n2024-12-19T11:26:27.111Z [DEBUG] using github.com/hashicorp/terraform-svchost v0.1.0\r\n2024-12-19T11:26:27.111Z [DEBUG] using github.com/zclconf/go-cty v1.12.2\r\n2024-12-19T11:26:27.111Z [INFO]  Go runtime version: go1.23.1\r\n2024-12-19T11:26:27.111Z [INFO]  CLI args: []string{\"terraform\", \"providers\", \"lock\", \"-platform=linux_amd64\"}\r\n2024-12-19T11:26:27.111Z [DEBUG] Attempting to open CLI config file: /Users/kevel/.terraformrc\r\n2024-12-19T11:26:27.111Z [DEBUG] File doesn't exist, but doesn't need to. Ignoring.\r\n2024-12-19T11:26:27.111Z [DEBUG] checking for credentials in \"/Users/kevel/.terraform.d/plugins\"\r\n2024-12-19T11:26:27.111Z [DEBUG] Using modified User-Agent: HashiCorp Terraform/1.5.7 (+https://www.terraform.io) cdktf/0.20.10 (+https://github.com/hashicorp/terraform-cdk)\r\n2024-12-19T11:26:27.111Z [DEBUG] ignoring non-existing provider search directory terraform.d/plugins\r\n2024-12-19T11:26:27.111Z [DEBUG] will search for provider plugins in /Users/kevel/.terraform.d/plugins\r\n2024-12-19T11:26:27.111Z [DEBUG] ignoring non-existing provider search directory /Users/kevel/Library/Application Support/io.terraform/plugins\r\n2024-12-19T11:26:27.111Z [DEBUG] ignoring non-existing provider search directory /Library/Application Support/io.terraform/plugins\r\n2024-12-19T11:26:27.112Z [INFO]  CLI command args: []string{\"providers\", \"lock\", \"-platform=linux_amd64\"}\r\n```","createdAt":"2024-12-19T11:38:00Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3737#issuecomment-2553491933","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6ZRNCw","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"Looks like the explicit `linux_amd64` argument is specified [here](https://github.com/hashicorp/terraform-cdk/blob/c1ca5b3896b2751a7297da97a1bd9eb10d2ffddf/packages/%40cdktf/cli-core/src/lib/models/terraform-cli.ts#L180).\r\nThat change was made as part of https://github.com/hashicorp/terraform-cdk/pull/2593.\r\n\r\nYou may want to try manually running `terraform providers lock` to pull in the mac hashes and make sure that you lockfile is committed.","createdAt":"2025-01-04T22:07:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3737#issuecomment-2571423920","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6lRyp9","author":{"login":"miertschink"},"authorAssociation":"NONE","body":"I am also experiencing this issue\nI am running cdktf in a docker container on a Mac host machine\n\n```\ncdktf debug\nlanguage: go\ncdktf-cli: 0.20.3\nnode: v20.11.0\ncdktf: 0.20.11\nconstructs: 10.4.2\njsii: 1.110.0\nterraform: 1.4.6\narch: arm64\nos: linux 6.10.14-linuxkit\ngo: go version go1.23.8 linux/amd64\nproviders\nkreuzwerker/docker@~> 3.0.2 (LOCAL)\n        terraform provider version: null\nhttp@~> 3.4.5 (LOCAL)\n        terraform provider version: null\nkubernetes@~> 2.33.0 (LOCAL)\n        terraform provider version: null\npagerduty/pagerduty@~> 3.18.1 (LOCAL)\n        terraform provider version: null\nrandom@~> 3.6.3 (LOCAL)\n        terraform provider version: null\naws@~> 5.93.0 (LOCAL)\n        terraform provider version: null\ngithub.com/cdktf/cdktf-provider-aws-go/aws (PREBUILT)\n        terraform provider version: 5.93.0 \n        prebuilt provider version: 19.59.0\n        cdktf version: ^0.20.0\ngithub.com/cdktf/cdktf-provider-docker-go/docker (PREBUILT)\n        terraform provider version: 3.0.2 \n        prebuilt provider version: 11.0.0\n        cdktf version: ^0.20.0\ngithub.com/cdktf/cdktf-provider-http-go/http (PREBUILT)\n        terraform provider version: 3.4.5 \n        prebuilt provider version: 9.0.4\n        cdktf version: ^0.20.0\ngithub.com/cdktf/cdktf-provider-kubernetes-go/kubernetes (PREBUILT)\n        terraform provider version: 2.33.0 \n        prebuilt provider version: 11.8.0\n        cdktf version: ^0.20.0\ngithub.com/cdktf/cdktf-provider-pagerduty-go/pagerduty (PREBUILT)\n        terraform provider version: 3.18.1 \n        prebuilt provider version: 13.14.1\n        cdktf version: ^0.20.0\ngithub.com/cdktf/cdktf-provider-postgresql-go/postgresql (PREBUILT)\n        terraform provider version: 1.24.0 \n        prebuilt provider version: 11.3.0\n        cdktf version: ^0.20.0\ngithub.com/cdktf/cdktf-provider-random-go/random (PREBUILT)\n        terraform provider version: 3.6.3 \n        prebuilt provider version: 11.0.3\n        cdktf version: ^0.20.0\n\n``` \n\ncdktf.json\n``` \n{\n  \"language\": \"go\",\n  \"app\": \"go run infrastructure/app.go\",\n  \"projectId\": \"9c2ebd5d-e5bf-4246-9c05-c852f8776b74\",\n  \"sendCrashReports\": \"false\",\n  \"terraformProviders\": [\n    \"kreuzwerker/docker@~> 3.0.2\",\n    \"hashicorp/http@~> 3.4.5\",\n    \"hashicorp/kubernetes@~> 2.33.0\",\n    \"pagerduty/pagerduty@~> 3.18.1\",\n    \"hashicorp/random@~> 3.6.3\",\n    \"hashicorp/aws@~> 5.93.0\"\n  ],\n  \"terraformModules\": [],\n  \"context\": {\n    \"excludeStackIdFromLogicalIds\": \"true\",\n    \"allowSepCharsInLogicalIds\": \"true\"\n  }\n}\n```\n\nOutput\n\n``` \ndocker compose -p myproject -f dev/docker-compose.yaml exec -T dev-container /usr/bin/env bash -c \"npx cdktf deploy --all --auto-approve  --outputs-file cdktf-exports.json --init-options=\"-migrate-state\"\"\n\nmyproject  Initializing the backend...\nmyproject  Initializing provider plugins...\n                - Reusing previous version of hashicorp/random from the dependency lock file\nmyproject  - Reusing previous version of hashicorp/aws from the dependency lock file\nmyproject  - Reusing previous version of kreuzwerker/docker from the dependency lock file\nmyproject  - Reusing previous version of hashicorp/http from the dependency lock file\nmyproject  - Reusing previous version of hashicorp/kubernetes from the dependency lock file\nmyproject  - Reusing previous version of pagerduty/pagerduty from the dependency lock file\nmyproject  - Using previously-installed hashicorp/random v3.6.3\nmyproject  - Using previously-installed hashicorp/aws v5.93.0\nmyproject  - Using previously-installed kreuzwerker/docker v3.0.2\nmyproject  - Using previously-installed hashicorp/http v3.4.5\nmyproject  - Using previously-installed hashicorp/kubernetes v2.33.0\nmyproject  - Using previously-installed pagerduty/pagerduty v3.18.1\nmyproject  Terraform has been successfully initialized!\n\n                You may now begin working with Terraform. Try running \"terraform plan\" to see\n                any changes that are required for your infrastructure. All Terraform commands\n                should now work.\n\n                If you ever set or change modules or backend configuration for Terraform,\n                rerun this command to reinitialize your working directory. If you forget, other\n                commands will detect it and remind you to do so if necessary.\nmyproject  - Fetching hashicorp/random 3.6.3 for linux_amd64...\nmyproject  - Retrieved hashicorp/random 3.6.3 for linux_amd64 (signed by HashiCorp)\nmyproject  - Fetching hashicorp/aws 5.93.0 for linux_amd64...\nmyproject  - Retrieved hashicorp/aws 5.93.0 for linux_amd64 (signed by HashiCorp)\nmyproject  - Fetching kreuzwerker/docker 3.0.2 for linux_amd64...\nmyproject  - Retrieved kreuzwerker/docker 3.0.2 for linux_amd64 (self-signed, key ID BD080C4571C6104C)\nmyproject  - Fetching hashicorp/http 3.4.5 for linux_amd64...\nmyproject  - Retrieved hashicorp/http 3.4.5 for linux_amd64 (signed by HashiCorp)\nmyproject  - Fetching hashicorp/kubernetes 2.33.0 for linux_amd64...\nmyproject  - Retrieved hashicorp/kubernetes 2.33.0 for linux_amd64 (signed by HashiCorp)\nmyproject  - Fetching pagerduty/pagerduty 3.18.1 for linux_amd64...\nmyproject  - Retrieved pagerduty/pagerduty 3.18.1 for linux_amd64 (signed by a HashiCorp partner, key ID 027C6DD1F0707B45)\n                - Obtained hashicorp/kubernetes checksums for linux_amd64; All checksums for this platform were already tracked in the lock file\n                - Obtained pagerduty/pagerduty checksums for linux_amd64; All checksums for this platform were already tracked in the lock file\n                - Obtained hashicorp/random checksums for linux_amd64; All checksums for this platform were already tracked in the lock file\n                - Obtained hashicorp/aws checksums for linux_amd64; All checksums for this platform were already tracked in the lock file\n                - Obtained kreuzwerker/docker checksums for linux_amd64; All checksums for this platform were already tracked in the lock file\n                - Obtained hashicorp/http checksums for linux_amd64; All checksums for this platform were already tracked in the lock file\nmyproject  Success! Terraform has validated the lock file and found no need for changes.\n\n```\n","createdAt":"2025-04-02T15:10:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3737#issuecomment-2772904573","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc66BPR_","author":{"login":"matthew-plusprogramming"},"authorAssociation":"NONE","body":"+1","createdAt":"2025-07-26T01:10:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3737#issuecomment-3120886911","viewerDidAuthor":false}],"createdAt":"2024-10-02T18:14:42Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":3737,"title":"COMPONENT: CDKTF fetching providers on every deploy","updatedAt":"2025-07-26T01:10:36Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjIzMjY0OTY2","is_bot":false,"login":"gytis-ivaskevicius","name":"Gytis Ivaskevicius"},"body":"### Description\r\n\r\nHCL is verbose and not turing complete, general-purpose programming languages add additional complexity and verbosity (Maybe not as verbose as HCL)\r\n\r\nI would love to have some proper configuration language for terrafrom. Possible candidates:\r\n- Jsonnet\r\n  - Clean, simple, everyone feels familiar with it\r\n  - Type system is underdeveloped\r\n- Nickel\r\n  - Great type system\r\n  - New project, lacks users or people familiar with the syntax  \r\n- Nix\r\n  - Project terranix already exists\r\n  - Not a great fit, does not run on windows\r\n  - terranix could be improved quite a bit with autogenerated types, its been a while since I worked with it, cant remember other downsides\r\n  \r\n  **Terranix example:**\r\n  I don't recommend Nix support but this should be a good visualization to imagine how Jsonnet/Nickel would look like\r\n  \r\n```nix\r\n{ config, ... }:\r\nlet\r\n  inherit (config) resource;\r\n  compartment_id = \"\\${var.tenancy_ocid}\";\r\n  cidr_block = \"10.10.0.0/24\";\r\n\r\n  # We can define functions to reduce verbosity\r\n  mkSomeResource = {var1, var2}: {\r\n    inherit var1 var2;\r\n    abc = 123;\r\n  };\r\nin\r\n{\r\n\r\n  # using function from above\r\n  resource.something = mkSomeResource {\r\n    var1 = \"123\";\r\n    var2 = \"abc\";\r\n  };\r\n\r\n  resource.oci_core_vcn.main = {\r\n    inherit cidr_block compartment_id;\r\n    dns_label = \"main\";\r\n    display_name = \"main\";\r\n  };\r\n\r\n  resource.oci_core_internet_gateway.main = {\r\n    inherit compartment_id;\r\n    vcn_id = \"\\${oci_core_vcn.main.id}\";\r\n    display_name = \"main\";\r\n  };\r\n\r\n\r\n  resource.oci_core_subnet.public = {\r\n    inherit cidr_block compartment_id;\r\n    vcn_id = \"\\${oci_core_vcn.main.id}\";\r\n    display_name = \"public\";\r\n    dns_label = \"public\";\r\n    security_list_ids = [ \"\\${resource.oci_core_security_list.allow-all.id}\" ];\r\n  };\r\n\r\n  resource.oci_core_default_route_table.ain = {\r\n    manage_default_resource_id = \"\\${oci_core_vcn.main.default_route_table_id}\";\r\n\r\n    route_rules = {\r\n      network_entity_id = \"\\${resource.oci_core_internet_gateway.main.id}\";\r\n\r\n      description = \"internet gateway\";\r\n      destination = \"0.0.0.0/0\";\r\n    };\r\n  };\r\n\r\n  resource.oci_core_default_security_list.default = {\r\n    manage_default_resource_id = \"\\${oci_core_vcn.main.default_security_list_id}\";\r\n\r\n    egress_security_rules = [\r\n      { protocol = \"6\"; destination = \"0.0.0.0/0\"; }\r\n      { protocol = \"17\"; destination = \"0.0.0.0/0\"; }\r\n    ];\r\n\r\n\r\n    # We have `map` function to simplify definitions. Turing complete config languages are great\r\n    ingress_security_rules = map\r\n      (it: {\r\n        inherit (it) description;\r\n        tcp_options = {\r\n          max = it.port;\r\n          min = it.port;\r\n        };\r\n        protocol = \"6\";\r\n        source = \"0.0.0.0/0\";\r\n      }) [\r\n      { description = \"SSH\"; port = 22; }\r\n      { description = \"HTTPS\"; port = 443; }\r\n      { description = \"HTTP\"; port = 80; }\r\n    ];\r\n  };\r\n\r\n\r\n  resource.oci_core_security_list.allow-all = {\r\n    inherit compartment_id;\r\n    vcn_id = \"\\${oci_core_vcn.main.id}\";\r\n\r\n    egress_security_rules = {\r\n      destination = \"0.0.0.0/0\";\r\n      protocol = \"all\";\r\n    };\r\n\r\n    ingress_security_rules = [\r\n      {\r\n        protocol = \"6\";\r\n        source = \"0.0.0.0/0\";\r\n        description = \"SSH\";\r\n\r\n        tcp_options = {\r\n          max = 22;\r\n          min = 22;\r\n        };\r\n      }\r\n      {\r\n        protocol = \"all\";\r\n        source = \"0.0.0.0/0\";\r\n      }\r\n    ];\r\n  };\r\n}\r\n```\r\n\r\n\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-09-27T12:27:58Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3734,"title":"Support for proper configuration language","updatedAt":"2024-09-27T12:28:43Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjIwODQzNDEy","is_bot":false,"login":"staswiner","name":"Stas Chern"},"body":"### Expected Behavior\n\nHappens when working in **typescript** with awsEcs resources, specifically with **EcsTaskDefinition.**\r\nWhen using capacity provider of 'FARGATE', a task-level 'cpu' field is required.\r\nThis field is supposed to accept 'number', such as value 10.\n\n### Actual Behavior\n\nHappens when working in **typescript** with awsEcs resources, specifically with **EcsTaskDefinition.**\r\nWhen using capacity provider of 'FARGATE', a task-level 'cpu' field is required.\r\nThis field accepts 'string', as provided by 'EcsTaskDefinitionConfig' interface.\r\nWhen providing a string value, such as \"10\",  terraform throws 'Invalid 'cpu' setting for task.'.\r\n\n\n### Steps to Reproduce\n\nHappens when working in **typescript** with awsEcs resources, specifically with **EcsTaskDefinition.**\r\nWhen using capacity provider of 'FARGATE', a task-level 'cpu' field is required.\r\nThis field is supposed to accept 'number', but the interface 'EcsTaskDefinitionConfig' is expecting a string.\r\nWhen providing a string value, such as \"10\",  terraform throws 'Invalid 'cpu' setting for task.'.\r\nI changed to 'number' manually in node_modules, and it worked.\n\n### Versions\n\nlanguage: typescript                                                                                                                                                                                             cdktf-cli: 0.20.8                                                                                                                                                                                                node: v20.17.0                                                                                                                                                                                                   cdktf: 0.20.8                                                                                                                                                                                                    constructs: 10.3.0                                                                                                                                                                                               jsii: null                                                                                                                                                                                                       terraform: 1.9.5                                                                                                                                                                                                 arch: x64                                                                                                                                                                                                        os: linux 5.15.153.1-microsoft-standard-WSL2                                                                                                                                                                     providers                                                                                                                                                                                                        aws@undefined (LOCAL)                                                                                                                                                                                                    terraform provider version: 5.65.0                                                                                                                                                                       @cdktf/provider-aws (PREBUILT)                                                                                                                                                                                           terraform provider version: 5.64.0                                                                                                                                                                               prebuilt provider version: 19.32.0                                                                                                                                                                               cdktf version: ^0.20.0 \n\n### Providers\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                                                                              â”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name        â”‚ Package Version â”‚                                                                                                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                                                                                              â”‚ aws           â”‚ 5.65.0           â”‚         â”‚            â”‚                     â”‚                 â”‚                                                                                                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                                                                                              â”‚ aws           â”‚ 5.64.0           â”‚ ^0.20.0 â”‚            â”‚ @cdktf/provider-aws â”‚ 19.32.0         â”‚                                                                                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\nin EcsTaskDefinitionConfig interface, change cpu type from 'string' to 'number'\n\n### Workarounds\n\nmanually change the cdktf library file typescript/node_modules/@cdktf/provider-aws/lib/ecs-task-definition/index.d.ts\r\nto accept number instead.\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [X] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-09-21T11:18:15Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3731,"title":"EcsTaskDefinition: typescript: cpu expects string instead of number","updatedAt":"2024-09-21T11:18:15Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjMwOTE1NTg=","is_bot":false,"login":"shinebayar-g","name":"Shinebayar G."},"body":"### Description\r\n\r\nI think https://github.com/cdktf/cdktf-tf-module-stack should be a native option for cdktf projects. Package is fairly small, but functionality is the most important.\r\n\r\nDocumentation at https://developer.hashicorp.com/terraform/cdktf/concepts/hcl-interoperability#cdktf-to-hcl claims cdktf synth generated output can be used as a terraform module.\r\n\r\n> To use this as a Terraform module, run `cdktf synth` and copy the resulting `cdktf.out/stacks/random-pet-module/cdk.tf.json` file out to the module directory in your HCL project. By default, `cdktf synth` generates Terraform JSON, but starting from version 0.20, CDKTF can also generate Terraform HCL output by passing the `--hcl` flag to `cdktf synth`.\r\n\r\nBut it _can't_! It's quite misleading that it can be a used as a terraform module. Cdktf generated code contains provider and backend configuration, so it cannot be reused.\r\n\r\n\r\n\r\n\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-09-12T05:24:50Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3728,"title":"cdktf: integrate cdktf-tf-module-stack natively ","updatedAt":"2024-09-12T06:51:06Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUxMDMw","is_bot":false,"login":"infowolfe","name":"Parker"},"body":"### Description\n\nThe fix in #3152 doesn't actually apply to constructs, but instead only to `TerraformResource` #219 leaving a substantial gap/difficulty in renaming constructs.\r\n\r\nGiven you have a construct like\r\n```\r\nclass Foo(Construct):\r\n    def __init__(self, scope: Construct, name: str) -> None:\r\n        super().__init__(scope, name)\r\n        \r\n        pass\r\n ```\r\n \r\n If you call it with a name from within your stack:\r\n \r\n ```\r\n class StackName(TerraformStack):\r\n    def __init__(self, scope: Construct, name: str) -> None:\r\n        super().__init__(scope, name)\r\n        \r\n        newthing = Foo(self, name=\"demo\")\r\n```\r\n\r\nyou cannot then do something like:\r\n```\r\nclass StackName(TerraformStack):\r\n    def __init__(self, scope: Construct, name: str) -> None:\r\n        super().__init__(scope, name)\r\n        \r\n        newthing = Foo(self, name=\"demo-copy\")\r\n        newthing.move_from(\"demo\")\r\n```\r\n\r\nBecause there's no support for `.move*` methods of the Construct class (at least in python)\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-09-06T08:35:37Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3722,"title":"Improve Experience of Renaming / Moving Constructs #2","updatedAt":"2024-09-06T08:35:37Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjQwODk5ODY=","is_bot":false,"login":"eduardosanzb","name":"Eduardo Bautista"},"body":"### Expected Behavior\r\n\r\nSQL DB should be created. I'm using the same configuration as I\"d use with HCL.\r\n\r\n>> I redacted the company name from the logs\r\n\r\n### Actual Behavior\r\n\r\nTHe debug message from why is the request badly done is not enough to continue. I'm not able to create a SQLdb in GCP\r\n\r\n\r\n\r\n### Steps to Reproduce\r\n\r\nWith the next code, just run `cdtfk deploy`.\r\nThe plan went fine.\r\n\r\n```ts\r\nimport { App, TerraformStack } from 'cdktf'\r\nimport { Construct } from 'constructs'\r\nimport { GoogleProvider } from '@cdktf/provider-google/lib/provider'\r\nimport * as path from 'path'\r\nimport * as fs from 'fs'\r\nimport { SqlDatabaseInstance } from '@cdktf/provider-google/lib/sql-database-instance'\r\nimport { DataGoogleProject } from '@cdktf/provider-google/lib/data-google-project'\r\nimport { SqlDatabase } from '@cdktf/provider-google/lib/sql-database'\r\nimport { password } from './.gen/providers/random'\r\nimport { SqlUser } from '@cdktf/provider-google/lib/sql-user'\r\nimport { RandomProvider } from './.gen/providers/random/provider'\r\n\r\nclass MyStack extends TerraformStack {\r\n  constructor(scope: Construct, name: string) {\r\n    super(scope, name)\r\n\r\n    const credentialsPath = path.join(process.cwd(), 'google.json')\r\n    const credentials = fs.existsSync(credentialsPath)\r\n      ? fs.readFileSync(credentialsPath).toString()\r\n      : '{}'\r\n\r\n    console.log('credentialsPath', credentialsPath)\r\n    console.log('credentials', credentials)\r\n    const region = 'europe-west4'\r\n    const projectId = 'company-development'\r\n    new GoogleProvider(this, 'Google', {\r\n      region,\r\n      project: projectId,\r\n      // credentials, //using the ones from ADC\r\n    })\r\n\r\n    new RandomProvider(this, 'random', {})\r\n\r\n    const googleProject = new DataGoogleProject(this, 'project', {\r\n      projectId,\r\n    })\r\n\r\n    const dbInstance = new SqlDatabaseInstance(this, 'db-instance', {\r\n      project: googleProject.id,\r\n      region,\r\n      name: 'db-instance',\r\n      databaseVersion: 'POSTGRES_13',\r\n\r\n      settings: {\r\n        tier: 'db-f1-micro',\r\n        diskSize: 10,\r\n        diskType: 'PD_SSD',\r\n        availabilityType: 'REGIONAL',\r\n\r\n        databaseFlags: [\r\n          {\r\n            name: 'autovacuum',\r\n            value: 'on',\r\n          },\r\n          {\r\n            name: 'max_connections',\r\n            value: '100',\r\n          },\r\n          {\r\n            name: 'max_wal_size',\r\n            value: '1GB',\r\n          },\r\n        ],\r\n\r\n        deletionProtectionEnabled: false,\r\n\r\n        ipConfiguration: {\r\n          ipv4Enabled: true,\r\n          // requireSsl: true,\r\n        },\r\n        maintenanceWindow: {\r\n          day: 1,\r\n          hour: 4,\r\n          updateTrack: 'stable',\r\n        },\r\n        backupConfiguration: {\r\n          enabled: true,\r\n          binaryLogEnabled: true,\r\n          pointInTimeRecoveryEnabled: true,\r\n          startTime: '05:00',\r\n          location: 'EU',\r\n        },\r\n        insightsConfig: {\r\n          queryInsightsEnabled: true,\r\n          queryStringLength: 4500,\r\n          recordApplicationTags: true,\r\n        },\r\n      },\r\n\r\n      lifecycle: {\r\n        ignoreChanges: [],\r\n      },\r\n    })\r\n\r\n    new SqlDatabase(this, 'name-db', {\r\n      project: googleProject.id,\r\n      instance: dbInstance.name,\r\n      name: 'name-db',\r\n    })\r\n\r\n    new SqlUser(this, 'name-db-user', {\r\n      project: googleProject.id,\r\n      instance: dbInstance.name,\r\n      name: 'name-db-user',\r\n      password: new password.Password(this, 'name-db-user-password', {\r\n        length: 16,\r\n      }).result,\r\n      host: '%',\r\n    })\r\n\r\n    // lets do the service api\r\n    // 1. service account\r\n    // 2. iam to cloudsql\r\n  }\r\n}\r\n\r\nconst app = new App()\r\nnew MyStack(app, 'name-app-dev')\r\napp.synth()\r\n\r\n```\r\n\r\n### Versions\r\n\r\nlanguage: typescript\r\ncdktf-cli: 0.20.8\r\nnode: v20.16.0\r\ncdktf: 0.20.8\r\nconstructs: 10.3.0\r\njsii: null\r\nterraform: 1.9.5\r\narch: arm64\r\nos: darwin 23.5.0\r\nproviders\r\nrandom@undefined (LOCAL)\r\n        terraform provider version: 3.6.2\r\n@cdktf/provider-google (PREBUILT)\r\n        terraform provider version: 5.43.1 \r\n        prebuilt provider version: 13.32.1\r\n        cdktf version: ^0.20.0\r\n@cdktf/provider-kubernetes (PREBUILT)\r\n        terraform provider version: 2.32.0 \r\n        prebuilt provider version: 11.7.0\r\n        cdktf version: ^0.20.0\r\ncdktf debug  14.17s user 1.98s system 178% cpu 9.070 total\r\n\r\n### Providers\r\n\r\n```\r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”€â”€          â”€â”€â”€            â”€â”€     â”€â”€        â”€â”€â”€â”€â”€â”€                â”€â”€â”€\r\n Provider    Provider     â”‚ CDKTFâ”‚         â”‚ Package Name        â”‚ Package     â”‚\r\nName        Version               Constraint                      Version\r\n\r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”€â”€          â”€â”€â”€            â”€â”€     â”€â”€        â”€â”€â”€â”€â”€â”€                â”€â”€â”€\r\n random      3.6.2        â”‚      â”‚         â”‚                     â”‚             â”‚\r\n\r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”€â”€          â”€â”€â”€            â”€â”€     â”€â”€        â”€â”€â”€â”€â”€â”€                â”€â”€â”€\r\n google      5.43.1       â”‚      â”‚         â”‚                     â”‚ 13.32.1     â”‚\r\n                           ^0.20.0          @cdktf/provider-google\r\n\r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”€â”€          â”€â”€â”€            â”€â”€     â”€â”€        â”€â”€â”€â”€â”€â”€                â”€â”€â”€\r\n kubernetes  2.32.0       â”‚      â”‚         â”‚ @cdktf/provider-kubeâ”‚ 11.7.0      â”‚\r\n                           ^0.20.0          netes\r\n\r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\nâ”€â”€          â”€â”€â”€            â”€â”€     â”€â”€        â”€â”€â”€â”€â”€â”€                â”€â”€â”€\r\n```\r\n\r\n### Gist\r\n\r\nhttps://gist.github.com/eduardosanzb/a85bba69ef2eb4067ac079a07d8b45db\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\n_No response_\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [X] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-09-03T10:00:02Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"}],"milestone":null,"number":3720,"title":"google: Cannot create a SQLDb instance because of a badRequest - not enough logs","updatedAt":"2024-09-03T10:00:46Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE0OTk3ODA=","is_bot":false,"login":"Hi-Fi","name":"Juho Saarinen"},"body":"### Expected Behavior\r\n\r\nWhen creating Azure Container App Job using Azapi provider with TS code:\r\n``` \r\n      secrets: [\r\n        {\r\n          name: \"organization-url\",\r\n          value: \"https://dev.azure.com/example-org\"\r\n        }\r\n      ]\r\n```\r\n\r\nIt's expected to be synthesized according given value (https://learn.microsoft.com/en-us/azure/templates/microsoft.app/jobs?pivots=deployment-language-terraform#secret-2). Note that documentation is incorrect in a way that is expects content needing to be JSON string, which is not the case with newer AzAPI.\r\n\r\nCorrect HCL from that would probably be like:\r\n```\r\nsecrets = [\r\n  {\r\n    name = \"organization-url\"\r\n   value = \"https://dev.azure.com/example-org\"\r\n  }\r\n]\r\n```\r\n\r\n\r\n### Actual Behavior\r\n\r\nValue in HCL is:\r\n```\r\nsecrets = {\r\n  0 = https : //dev.azure.com/OP-Azure-Development\r\n}\r\n```\r\n\r\nWith JSON formatting same core produces value:\r\n```\r\n\"secrets\": [\r\n                {\r\n                  \"name\": \"organization-url\",\r\n                  \"value\": \"https://dev.azure.com/example-org\"\r\n                }\r\n              ],\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n1. Provide simple AZAPI resource definition (note that definition is missing some values, but it doesn't matter in synth):\r\n   ```\r\n    new AzapiProvider(this, 'azapi', {});\r\n    new Resource(this, 'aca', {\r\n      type: 'Microsoft.App/jobs@2024-02-02-preview',\r\n      name: 'test-job',\r\n      location: 'eastus',\r\n      parentId: '/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg',\r\n      body: {\r\n        properties: {\r\n          secrets: [\r\n            {\r\n              name: 'secret1',\r\n              value: 'secret1-value'\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    });\r\n   ```\r\n3. Synthesize both HCL and JSON versions of stack\r\n4. Check validity\r\n\r\n### Versions\r\n\r\n```\r\nlanguage: typescript\r\ncdktf-cli: 0.20.8\r\nnode: v20.13.1\r\ncdktf: 0.20.8\r\nconstructs: 10.3.0\r\njsii: null\r\nterraform: 1.9.4\r\narch: arm64\r\nos: darwin 23.6.0\r\nproviders\r\nazure/azapi@undefined (LOCAL)\r\n        terraform provider version: 1.15.0\r\n```\r\n\r\n### Providers\r\n\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF â”‚ Constraint â”‚ Package Name â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ azure/azapi   â”‚ 1.15.0           â”‚       â”‚            â”‚              â”‚                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n``` \r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\nJSON works fine, but as we would like to utilize some Terraform tooling and Sonarqube with the code, HCL version is required.\r\n\r\n### Anything Else?\r\n\r\nIt seems that issue is somehow related to keys `name` and `value` (even environment variables with same keys work fine). \r\n\r\nWith TS code using secret reference:\r\n``` \r\nsecrets: [\r\n            {\r\n              name: 'secret1',\r\n              keyVaultUrl: 'secret1-value'\r\n            }\r\n          ]\r\n```\r\n\r\nHCL has is:\r\n```\r\nsecrets = {\r\n        0 = {\r\n          name        = \"secret1\"\r\n          keyVaultUrl = \"secret1-value\"\r\n        }\r\n      }\r\n``` \r\n\r\nAnd JSON:\r\n```\r\n\"secrets\": [\r\n              {\r\n                \"keyVaultUrl\": \"secret1-value\",\r\n                \"name\": \"secret1\"\r\n              }\r\n            ]\r\n``` \r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-08-30T05:01:34Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3717,"title":"HCL synth: key-value secret list is synhesized incorrectly to HCL","updatedAt":"2024-08-30T05:05:06Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjQ1MjEyMzA=","is_bot":false,"login":"micchickenburger","name":"Micah Henning"},"body":"### Description\r\n\r\n[Dynamic complex list iterations](https://github.com/hashicorp/terraform-cdk/blob/4f8c0c9984b130ffa3ce0537977dc09a08281782/examples/typescript/documentation/iterators.ts#L95) introduced in PR #3273 don't seem to handle sets containing more than one object.  Consider a certificate request with more than one Subject Alternative Name, viz.:\r\n\r\n```ts\r\nconst cert = new AcmCertificate(this, \"cert\", {\r\n  domainName: \"example.com\",\r\n  subjectAlternativeNames: [\"www.example.com\"], // tf will automatically add 'example.com' to this list\r\n  validationMethod: \"DNS\",\r\n});\r\nconst dataAwsRoute53ZoneExample = new DataAwsRoute53Zone(this, \"dns_zone\", {\r\n  name: \"example.com\",\r\n  privateZone: false,\r\n});\r\n\r\nconst exampleForEachIterator = TerraformIterator.fromComplexList(\r\n  cert.domainValidationOptions,\r\n  \"domain_name\"\r\n);\r\n\r\nconst records = new Route53Record(this, \"record\", {\r\n  forEach: exampleForEachIterator,\r\n  allowOverwrite: true,\r\n  ttl: 60,\r\n  name: exampleForEachIterator.getString(\"resource_record_name\"),\r\n  records: [exampleForEachIterator.getString(\"resource_record_value\")],\r\n  type: exampleForEachIterator.getString(\"resource_record_type\"),\r\n  zoneId: dataAwsRoute53ZoneExample.zoneId,\r\n});\r\n```\r\n\r\nThis results in the following new resource:\r\n\r\n```\r\n+ resource \"aws_acm_certificate\" \"cert\" {\r\n  + arn                       = (known after apply)\r\n  + domain_name               = \"example.com\"\r\n  + domain_validation_options = [\r\n      + {\r\n          + domain_name           = \"www.example.com\"\r\n          + resource_record_name  = (known after apply)\r\n          + resource_record_type  = (known after apply)\r\n          + resource_record_value = (known after apply)\r\n        },\r\n      + {\r\n          + domain_name           = \"example.com\"\r\n          + resource_record_name  = (known after apply)\r\n          + resource_record_type  = (known after apply)\r\n          + resource_record_value = (known after apply)\r\n        },\r\n    ]\r\n  + id                        = (known after apply)\r\n  + key_algorithm             = (known after apply)\r\n  + not_after                 = (known after apply)\r\n  + not_before                = (known after apply)\r\n  + pending_renewal           = (known after apply)\r\n  + renewal_eligibility       = (known after apply)\r\n  + renewal_summary           = (known after apply)\r\n  + status                    = (known after apply)\r\n  + subject_alternative_names = [\r\n      + \"www.example.com\",\r\n      + \"example.com\",\r\n    ]\r\n  + type                      = (known after apply)\r\n  + validation_emails         = (known after apply)\r\n  + validation_method         = \"DNS\"\r\n}\r\n```\r\n\r\nHowever, the Route53 records will fail to create:\r\n\r\n```\r\nError: Invalid for_each argument\r\n\r\n on cdk.tf.json line 207, in resource.aws_route53_record.acm_records:\r\n 207: \"for_each\": \"${{ for key, val in tolist(aws_acm_certificate.cert.domain_validation_options): val.domain_name => val }}\",\r\n â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r\n â”‚ aws_acm_certificate.cert.domain_validation_options is set of object with 2 elements\r\n\r\nThe \"for_each\" map includes keys derived from resource attributes that cannot\r\nbe determined until apply, and so Terraform cannot determine the full set of\r\nkeys that will identify the instances of this resource.\r\n\r\nWhen working with unknown values in for_each, it's better to define the map\r\nkeys statically in your configuration and place apply-time results only in\r\nthe map values.\r\n\r\nAlternatively, you could use the -target planning option to first apply only\r\nthe resources that the for_each value depends on, and then apply a second\r\ntime to fully converge.\r\n```\r\n\r\nIf `aws_acm_certificate.cert.domain_validation_options` is a set of one object, then the code works correctly.\r\n\r\n## System information\r\n\r\n```\r\n$ cdktf debug\r\nlanguage: typescript\r\ncdktf-cli: 0.20.8\r\nnode: v20.14.0\r\ncdktf: 0.20.8\r\nconstructs: null\r\njsii: null\r\nterraform: 1.9.4\r\narch: x64\r\nos: linux 5.15.0-119-generic\r\nproviders\r\naws@ = 5.60 (LOCAL)\r\n        terraform provider version: 5.60.0\r\n@cdktf/provider-aws (PREBUILT)\r\n        terraform provider version: 5.60.0 \r\n        prebuilt provider version: 19.28.0\r\n        cdktf version: ^0.20.0\r\n```\r\n\r\n### Links\r\n\r\n- https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/acm_certificate_validation?lang=typescript\r\n- https://github.com/hashicorp/terraform-cdk/blob/4f8c0c9984b130ffa3ce0537977dc09a08281782/examples/typescript/documentation/iterators.ts#L95\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6NGZ6m","author":{"login":"so0k"},"authorAssociation":"NONE","body":"seems related to actual bug in Terraform/Terraform Provider AWS:\r\n\r\n- https://github.com/hashicorp/terraform-provider-aws/issues/27299\r\n- https://github.com/hashicorp/terraform-provider-aws/issues/14447\r\n- https://github.com/hashicorp/terraform-provider-aws/issues/23260\r\n\r\nif you know the validation options as part of your CDK code, best to generate each route53 validation record directly without iterator or foreach.","createdAt":"2024-09-23T05:29:44Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3713#issuecomment-2367266470","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6TG3fH","author":{"login":"aclemmensen"},"authorAssociation":"NONE","body":"@so0k how do you know the validation options up-front if you're using DNS validation? Aren't they always random values provided by AWS that cannot be pre-assigned at creation? If it's possible to assign them, do you have any information or examples on how to do this?\r\n\r\nI'm also using values for `domain_name` that are known at plan time, yet I get the same error:\r\n\r\n```\r\n        var iter = TerraformIterator.FromComplexList(cert.DomainValidationOptions, \"domain_name\");\r\n        \r\n        var records = new Route53Record(this, \"validation_record\", new Route53RecordConfig\r\n        {\r\n            ForEach = iter,\r\n            ZoneId = _opts.ZoneId,\r\n            Name = iter.GetString(\"resource_record_name\"),\r\n            Type = iter.GetString(\"resource_record_type\"),\r\n            Records = [iter.GetString(\"resource_record_value\")],\r\n            Ttl = 60,\r\n            AllowOverwrite = true,\r\n        });\r\n```\r\n\r\nResulting in output:\r\n\r\n```\r\n              + resource \"aws_acm_certificate\" \"cert\" {\r\n                  + arn                       = (known after apply)\r\n                  + domain_name               = \"example.com\"\r\n                  + domain_validation_options = [\r\n                      + {\r\n                          + domain_name           = \"example.com\"\r\n                          + resource_record_name  = (known after apply)\r\n                          + resource_record_type  = (known after apply)\r\n                          + resource_record_value = (known after apply)\r\n                        },\r\n                      + {\r\n                          + domain_name           = \"*.example.com\"\r\n                          + resource_record_name  = (known after apply)\r\n                          + resource_record_type  = (known after apply)\r\n                          + resource_record_value = (known after apply)\r\n                        },\r\n                    ]\r\n                  + id                        = (known after apply)\r\n                  + key_algorithm             = (known after apply)\r\n...\r\n...\r\n            â”‚ Error: Invalid for_each argument\r\n            â”‚\r\n            â”‚   on cdk.tf.json line 794, in resource.aws_route53_record.validation_record (validation_record):\r\n            â”‚  794:         \"for_each\": \"${{ for key, val in tolist(aws_acm_certificate.cert (cert).domain_validation_options): val.domain_name => val }}\",\r\n            â”‚     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r\n            â”‚     â”‚ aws_acm_certificate.cert.domain_validation_options is set of object with 2 elements\r\n            â”‚\r\n            â”‚ The \"for_each\" map includes keys derived from resource attributes that\r\n            â”‚ cannot be determined until apply, and so Terraform cannot determine the\r\n            â”‚ full set of keys that will identify the instances of this resource.\r\n            â”‚\r\n            â”‚ When working with unknown values in for_each, it's better to define the map\r\n            â”‚ keys statically in your configuration and place apply-time results only in\r\n            â”‚ the map values.\r\n            â”‚\r\n            â”‚ Alternatively, you could use the -target planning option to first apply\r\n            â”‚ only the resources that the for_each value depends on, and then apply a\r\n            â”‚ second time to fully converge.\r\n```","createdAt":"2024-11-11T12:22:41Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3713#issuecomment-2468050887","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6TW8Ag","author":{"login":"so0k"},"authorAssociation":"NONE","body":"The order and count can be calculated from the Subject Name and SANS\r\n\r\nhttps://github.com/envtio/base/blob/bf99747f44f0fed912084052aa54a4142f8df835/src/aws/edge/certificate.ts#L172-L193\r\n\r\nso far my integration tests always pass, so this seems consistent...","createdAt":"2024-11-13T02:54:26Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3713#issuecomment-2472263712","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc69ytuV","author":{"login":"mhaley-tv"},"authorAssociation":"NONE","body":"This issue is particularly confusing as the CDK official doc [uses this exact example](https://developer.hashicorp.com/terraform/cdktf/concepts/iterators#using-iterators-on-complex-lists) to show how to use complex iterators.","createdAt":"2025-08-13T14:33:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3713#issuecomment-3184188309","viewerDidAuthor":false}],"createdAt":"2024-08-25T16:36:16Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3713,"title":"DynamicListTerraformIterator: Sets of more than one object unhandled","updatedAt":"2025-08-13T14:33:24Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE3NjI1OTk=","is_bot":false,"login":"so0k","name":"so0k"},"body":"### Description\r\n\r\nComparing `cdktf/testing` library to terratest, would it make sense to add full end to end testing helpers?\r\n\r\nFor example, a complex VPC Construct may want to confirm connectivity works once everything is provisioned... what is the recommended integration testing for CDKTF?\r\n\r\nSuggestion:\r\n- Add `shouldTerraformApplyAndDestroy` matcher with optional `Validate` function argument called in between apply and destroy\r\n\r\nAlternatively, rely fully on `terraform test` for full integration testing and add support for `test` command in `cdktf-cli`.\r\n\r\n\r\n### References\r\n\r\n- https://github.com/hashicorp/terraform-cdk/issues/3687\r\n- https://github.com/hashicorp/terraform-cdk/blob/v0.20.8/packages/cdktf/lib/testing/matchers.ts#L380\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6LTU_c","author":{"login":"vincenthsh"},"authorAssociation":"NONE","body":"ideally also add to cdktf-vitest for those using vitest","createdAt":"2024-09-09T04:40:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3703#issuecomment-2337099740","viewerDidAuthor":false}],"createdAt":"2024-08-17T00:47:59Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3703,"title":"cdktf/testing: Add shouldTerraformApplyAndDestroy","updatedAt":"2024-09-09T04:40:27Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjcwMDU0MDQ5","is_bot":false,"login":"Zyntogz","name":""},"body":"### Expected Behavior\r\n\r\nAround 15 seconds execution time for my small sample project (like cdktf synth time in poetry/pipenv venv)\r\n\r\n### Actual Behavior\r\n\r\nAround 48 seconds execution time (when using global dependencies as non-root user)\r\n\r\n### Steps to Reproduce\r\n\r\n1. Create a small Container Image containing all dependencies and install the same python dependencies\r\n  a) globally\r\n  b) using poetry venv\r\n  c) using pipenv\r\nFor ease of use, you can use this repository containing relevant snippets of our repo: https://github.com/Zyntogz/cdktf-bugreport\r\n2. Start VS Code Dev Container (or simply the image in general)\r\n3. Execute cdktf synth using each of the aforementioned configs\r\n  a) `time cdktf synth` (for running using global python packages)\r\n  b) `time poetry run cdktf synth` (for running using poetry's venv)\r\n  c) `time pipenv run cdktf synth` (for running using pipenv's venv)\r\n\r\n\r\n### Versions\r\n\r\n[dev-user@538780f9b082 cdktf]$ cdktf debug\r\ncdktf debug\r\nlanguage: python\r\ncdktf-cli: 0.20.8\r\nnode: v18.18.2\r\ncdktf: 0.20.8\r\nconstructs: 10.3.0\r\njsii: 1.102.0\r\nterraform: 1.9.4\r\narch: x64\r\nos: linux 5.15.123.1-microsoft-standard-WSL2\r\npython: Python 3.9.16\r\npip: pip 24.2 from /usr/local/lib/python3.11/site-packages/pip (python 3.11)\r\npipenv: pipenv, version 2024.0.1\r\nproviders\r\ncdktf-cdktf-provider-aws (PREBUILT)\r\n        terraform provider version: 5.62.0 \r\n        prebuilt provider version: 19.30.0\r\n        cdktf version: ^0.20.0\r\n[dev-user@538780f9b082 cdktf]$ poetry run cdktf debug\r\n[2024-08-15T11:40:07.296] [ERROR] default - Courtesy Notice: Pipenv found itself running within a virtual environment, so it will automatically use that environment, instead of creating its own for any project. You can set PIPENV_IGNORE_VIRTUALENVS=1 to force pipenv to ignore that environment and create its own instead. You can set PIPENV_VERBOSITY=-1 to suppress this warning.\r\n\r\nCourtesy Notice: Pipenv found itself running within a virtual environment, so it will automatically use that environment, instead of creating its own for any project. You can set PIPENV_IGNORE_VIRTUALENVS=1 to force pipenv to ignore that environment and create its own instead. You can set PIPENV_VERBOSITY=-1 to suppress this warning.\r\n[2024-08-15T11:40:08.766] [ERROR] default - Courtesy Notice: Pipenv found itself running within a virtual environment, so it will automatically use that environment, instead of creating its own for any project. You can set PIPENV_IGNORE_VIRTUALENVS=1 to force pipenv to ignore that environment and create its own instead. You can set PIPENV_VERBOSITY=-1 to suppress this warning.\r\n\r\nCourtesy Notice: Pipenv found itself running within a virtual environment, so it will automatically use that environment, instead of creating its own for any project. You can set PIPENV_IGNORE_VIRTUALENVS=1 to force pipenv to ignore that environment and create its own instead. You can set PIPENV_VERBOSITY=-1 to suppress this warning.\r\n[2024-08-15T11:40:08.783] [ERROR] default - Courtesy Notice: Pipenv found itself running within a virtual environment, so it will automatically use that environment, instead of creating its own for any project. You can set PIPENV_IGNORE_VIRTUALENVS=1 to force pipenv to ignore that environment and create its own instead. You can set PIPENV_VERBOSITY=-1 to suppress this warning.\r\n\r\nCourtesy Notice: Pipenv found itself running within a virtual environment, so it will automatically use that environment, instead of creating its own for any project. You can set PIPENV_IGNORE_VIRTUALENVS=1 to force pipenv to ignore that environment and create its own instead. You can set PIPENV_VERBOSITY=-1 to suppress this warning.\r\n[2024-08-15T11:40:08.822] [ERROR] default - Courtesy Notice: Pipenv found itself running within a virtual environment, so it will automatically use that environment, instead of creating its own for any project. You can set PIPENV_IGNORE_VIRTUALENVS=1 to force pipenv to ignore that environment and create its own instead. You can set PIPENV_VERBOSITY=-1 to suppress this warning.\r\n\r\nCourtesy Notice: Pipenv found itself running within a virtual environment, so it will automatically use that environment, instead of creating its own for any project. You can set PIPENV_IGNORE_VIRTUALENVS=1 to force pipenv to ignore that environment and create its own instead. You can set PIPENV_VERBOSITY=-1 to suppress this warning.\r\ncdktf debug\r\nlanguage: python\r\ncdktf-cli: 0.20.8\r\nnode: v18.18.2\r\ncdktf: 0.20.8\r\nconstructs: 10.3.0\r\njsii: 1.102.0\r\nterraform: 1.9.4\r\narch: x64\r\nos: linux 5.15.123.1-microsoft-standard-WSL2\r\npython: Python 3.11.6\r\npip: pip 24.1 from /home/dev-user/.cache/pypoetry/virtualenvs/qdwh-cdktf-9TtSrW0h-py3.11/lib/python3.11/site-packages/pip (python 3.11)\r\npipenv: pipenv, version 2024.0.1\r\nproviders\r\ncdktf-cdktf-provider-aws (PREBUILT)\r\n        terraform provider version: 5.62.0 \r\n        prebuilt provider version: 19.30.0\r\n        cdktf version: ^0.20.0\r\n[dev-user@538780f9b082 cdktf]$ pipenv run cdktf debug\r\ncdktf debug\r\nlanguage: python\r\ncdktf-cli: 0.20.8\r\nnode: v18.18.2\r\ncdktf: 0.20.8\r\nconstructs: 10.3.0\r\njsii: 1.102.0\r\nterraform: 1.9.4\r\narch: x64\r\nos: linux 5.15.123.1-microsoft-standard-WSL2\r\npython: Python 3.11.6\r\npip: pip 24.1 from /home/dev-user/.local/share/virtualenvs/app-4PlAip0Q/lib/python3.11/site-packages/pip (python 3.11)\r\npipenv: pipenv, version 2024.0.1\r\nproviders\r\ncdktf-cdktf-provider-aws (PREBUILT)\r\n        terraform provider version: 5.62.0 \r\n        prebuilt provider version: 19.30.0\r\n        cdktf version: ^0.20.0\r\n\r\n### Providers\r\n\r\n[dev-user@538780f9b082 cdktf]$ cdktf provider list\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name             â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ aws           â”‚ 5.62.0           â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-aws â”‚ 19.30.0         â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n[dev-user@538780f9b082 cdktf]$ poetry run cdktf provider list\r\n[2024-08-15T11:37:41.655] [ERROR] default - Courtesy Notice: Pipenv found itself running within a virtual environment, so it will automatically use that environment, instead of creating its own for any project. You can set PIPENV_IGNORE_VIRTUALENVS=1 to force pipenv to ignore that environment and create its own instead. You can set PIPENV_VERBOSITY=-1 to suppress this warning.\r\n\r\nCourtesy Notice: Pipenv found itself running within a virtual environment, so it will automatically use that environment, instead of creating its own for any project. You can set PIPENV_IGNORE_VIRTUALENVS=1 to force pipenv to ignore that environment and create its own instead. You can set PIPENV_VERBOSITY=-1 to suppress this warning.\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name             â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ aws           â”‚ 5.62.0           â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-aws â”‚ 19.30.0         â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n[dev-user@538780f9b082 cdktf]$ pipenv run cdktf provider list\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name             â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ aws           â”‚ 5.62.0           â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-aws â”‚ 19.30.0         â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\n_No response_\r\n\r\n### Anything Else?\r\n\r\nContainer is running inside a WSL not using Docker Desktop as backend, instead running natively installed docker daemon (but I don't think that's the problem here)\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-08-15T12:05:51Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3702,"title":"cdktf synth poor performance when installed globally","updatedAt":"2024-08-15T12:07:41Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjY4MzkwODU2","is_bot":false,"login":"konnta0","name":"konnta0"},"body":"### Description\n\nI think CDKTF is a great and versatile tool!\r\nHere are some suggestions to further improve the development experience\r\nFor k8s Provider, could you consider adding a tool like Pulumi's [crd2pulumi](https://github.com/pulumi/crd2pulumi) to generate structures with types for each programming language from Custom Resource's yaml?\r\n\r\nCRD is quite a lot of work to add by hand, so we thought that a tool that can generate boilerplate code might improve the development experience.\r\n\r\nIf possible, we would be very grateful if you would consider this!\r\n\r\nI am new to CDKTF and have no knowledge of it, so if you already have a tool with similar functionality, I would appreciate it if you could point me in the right direction.\r\n\r\n\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment","comments":[{"id":"IC_kwDODd1Amc6IuDuE","author":{"login":"zmully"},"authorAssociation":"NONE","body":"@konnta0 you should take a look at https://cdk8s.io, specifically the `cdk8s import` which will create a class definition for your CRD, and the `Include` method, which will create an `ApiObject` from an existing yaml manifest. \r\n\r\nAnother option is https://github.com/smallcase/kube2cdk8s which uses Pulumi and cdk8s to template manifests.","createdAt":"2024-08-16T16:07:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3701#issuecomment-2293775236","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6JCv1U","author":{"login":"konnta0"},"authorAssociation":"NONE","body":"@zmully \r\nThank you for your reply, I will try to get the cdk8s command to work for me.\r\nThe cdk8s command is indeed a useful tool, but currently it did not seem to support development in .NET (C#).\r\nI want to develop in C#, so cdk8s doesn't seem to work for me under the current circumstances...\r\nAlso, kube2cdk8s only supported TypeScript...\r\n\r\nI will consider contributing to https://github.com/cdk8s-team/cdk8s-cli\r\n\r\nIf you know of any .NET (C#) that could meet our requirements, I would be very happy if you could share it with us!","createdAt":"2024-08-20T15:57:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3701#issuecomment-2299198804","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6Kcho9","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"I haven't tired it myself, but you could take a look at https://github.com/learnk8s/templating-kubernetes/blob/master/csharp/README.md","createdAt":"2024-08-31T02:21:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3701#issuecomment-2322733629","viewerDidAuthor":false}],"createdAt":"2024-08-13T15:56:30Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3701,"title":"Typed Kubernetes Custom Resource Generator","updatedAt":"2024-08-31T02:21:48Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE0OTk3ODA=","is_bot":false,"login":"Hi-Fi","name":"Juho Saarinen"},"body":"### Expected Behavior\n\nTerraform can be initialized with CDKTF synthesized stack in HCL format. Remote configuration would look like:\n```\nterraform {\n  backend \"remote\" {\n    organization = \"test-organization\"\n    workspaces {\n      name = \"test-stack\"\n    }\n    hostname = \"test.artifactory.local\"\n  }\n}\n```\n\n### Actual Behavior\n\nCDKTF synthesized incorrect remove configuration\n```\nterraform {\n  backend \"remote\" {\n    organization = \"test-organization\"\n    workspaces = {\n      name = \"test-stack\"\n    }\n    hostname = \"test.artifactory.local\"\n  }\n}\n```\n\nWhen manually removing that `=` after `workspaces`, init works fine.\n\n### Steps to Reproduce\n\n1. Initialize empty CDKTF project\n2. Add following remote backend to it\n3. Synthesize stack to HCL (`cdktf synth --hcl`)\n4. Go to output directory of stack and run `terraform init`\n\n### Versions\n\nlanguage: typescript\ncdktf-cli: 0.20.8\nnode: v20.13.1\ncdktf: 0.20.8\nconstructs: 10.3.0\njsii: null\nterraform: 1.9.4\narch: arm64\nos: darwin 23.6.0\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\nProbably some specific handling needed for that part. Didn't had any other places with similar issues. Datasource to remote works different way and it requires that `=` sign.\n\n### Workarounds\n\nDon't use HCL (not working for me as HCL is needed for Sonarqube analysis)\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [x] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc6IGqu0","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"Another alternative is to use the `cloud` block. ([Docs](https://developer.hashicorp.com/terraform/cdktf/api-reference/typescript#cdktf.CloudBackendConfig)), which is recommended by terraform anyway over the remote backend. From my understanding, that doesn't have this problem.\r\n\r\nThe remote backend is a bug nonetheless. We will be fixing it in a future release.","createdAt":"2024-08-12T09:04:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3698#issuecomment-2283449268","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6IYuzS","author":{"login":"Hi-Fi"},"authorAssociation":"NONE","body":"We use Artifactory as state backend, I understood that `Cloud` backend is reserved for HCP Terraform (ex-Terraform Cloud) (and it's Enterprise version) and `remote` is for that","createdAt":"2024-08-14T08:41:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3698#issuecomment-2288184530","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc68XBHd","author":{"login":"jore731"},"authorAssociation":"NONE","body":"I guess there is no intention to fix this... CDKTF is cool and powerful, but without maintenance hard to use...","createdAt":"2025-08-06T13:19:21Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3698#issuecomment-3160150493","viewerDidAuthor":false}],"createdAt":"2024-08-12T04:55:33Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTMwNzg0MDc0","name":"priority/important-soon","description":"High priority, to be worked on as part of our current release or the following one.","color":"CC56C1"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":3698,"title":"CLI: HCL synth generates incorrect remote configuration with workspaces","updatedAt":"2025-08-10T18:00:53Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE0OTk3ODA=","is_bot":false,"login":"Hi-Fi","name":"Juho Saarinen"},"body":"### Expected Behavior\r\n\r\nStack is synthesized corretly as HCL\r\n\r\n### Actual Behavior\r\n\r\nCrash with error:\r\n```\r\nnpm run cdktf synth -- --hcl\r\n\r\n> test-repo@1.0.0 cdktf\r\n> cdktf synth --hcl\r\n\r\n\r\nâ ¹  Synthesizing\r\n[2024-08-09T10:57:17.900] [ERROR] default - /Users/user/test-repo/node_modules/cdktf/lib/hcl/render.ts:505\r\n    ...Object.entries(jsonObject).map(([name, value]) => {\r\n              ^\r\n\r\n[2024-08-09T10:57:17.901] [ERROR] default - TypeError: Cannot convert undefined or null to object\r\n    at Function.entries (<anonymous>)\r\n    at renderFuzzyJsonObject (/Users/user/test-repo/node_modules/cdktf/lib/hcl/render.ts:505:15)\r\n    at renderFuzzyJsonExpression (/Users/user/test-repo/node_modules/cdktf/lib/hcl/render.ts:525:12)\r\n    at /Users/user/test-repo/node_modules/cdktf/lib/hcl/render.ts:670:29\r\n    at Array.map (<anonymous>)\r\n    at renderAttributes (/Users/user/test-repo/node_modules/cdktf/lib/hcl/render.ts:586:6)\r\n    at renderModule (/Users/user/test-repo/node_modules/cdktf/lib/hcl/render.ts:372:3)\r\n    at /Users/user/test-repo/node_modules/cdktf/lib/terraform-stack.ts:292:49\r\n    at Array.map (<anonymous>)\r\nERROR: cdktf encountered an error while synthesizing\r\n\r\nSynth command: npx ts-node bin/main.ts\r\nError:         non-zero exit code 1\r\n\r\nCommand output on stderr:\r\n\r\n    /Users/user/test-repo/node_modules/cdktf/lib/hcl/render.ts:505\r\n        ...Object.entries(jsonObject).map(([name, value]) => {\r\n                  ^\r\n    TypeError: Cannot convert undefined or null to object\r\n        at Function.entries (<anonymous>)\r\n        at renderFuzzyJsonObject (/Users/user/test-repo/node_modules/cdktf/lib/hcl/render.ts:505:15)\r\n        at renderFuzzyJsonExpression (/Users/user/test-repo/node_modules/cdktf/lib/hcl/render.ts:525:12)\r\n        at /Users/user/test-repo/node_modules/cdktf/lib/hcl/render.ts:670:29\r\n        at Array.map (<anonymous>)\r\n        at renderAttributes (/Users/user/test-repo/node_modules/cdktf/lib/hcl/render.ts:586:6)\r\n        at renderModule (/Users/user/test-repo/node_modules/cdktf/lib/hcl/render.ts:372:3)\r\n        at /Users/user/test-repo/node_modules/cdktf/lib/terraform-stack.ts:292:49\r\n        at Array.map (<anonymous>)\r\n        at RunnerAcrStack.toHclTerraform (/Users/user/test-repo/node_modules/cdktf/lib/terraform-stack.ts:268:8)\r\n\r\n\r\n\r\n\r\nâ §  Synthesizing\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n1. Create stack with resource that has ignore_changes set to single item\r\n2. Try to synthesize stack to HCL (cdktf synth --hcl)\r\n\r\n### Versions\r\n\r\nlanguage: typescript\r\ncdktf-cli: 0.20.8\r\nnode: v20.13.1\r\ncdktf: 0.20.8\r\nconstructs: 10.3.0\r\njsii: null\r\nterraform: 1.9.4\r\narch: arm64\r\nos: darwin 23.6.0\r\n\r\n### Providers\r\n\r\nNone\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\nCheck handling of data in HCL render function.\r\n\r\nWith some console logging in `renderFuzzyJsonExpression` (like:\r\n```javascript\r\nfunction renderFuzzyJsonExpression(jsonExpression) {\r\n    console.log(jsonExpression);\r\n    console.log(typeof jsonExpression)\r\n```\r\n\r\noutput was:\r\n```\r\n    [ 'tags' ]\r\n    object\r\n    tags\r\n    string\r\n    null\r\n    object\r\n```\r\n\r\n### Workarounds\r\n\r\nDon't synth HCL\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6HzdMn","author":{"login":"Hi-Fi"},"authorAssociation":"NONE","body":"Apparently (unit tests) issue is not at the ignore_changes block, so have to check things a bit more. Also simple example stacks doesn't cause issues.\r\n\r\nIt seems that error is coming from AVM module https://github.com/Azure/terraform-azurerm-avm-res-containerregistry-registry/tree/0.1.0.\r\n\r\nWith some logging output is:\r\n```\r\n    rendering module: AvmContainerRegistry\r\n    Handling attribute: location\r\n    Handling attribute: managed_identities\r\n    null\r\n    object\r\n``` \r\n\r\n`renderAttributes` function get following attributes:\r\n\r\n```\r\n{\r\n  location: {\r\n    value: '${azurerm_resource_group.ResourceGroup.location}',\r\n    type: 'any'\r\n  },\r\n  managed_identities: { value: null, type: 'any' },\r\n  name: { value: 'testacr', type: 'any' },\r\n  network_rule_bypass_option: { value: 'AzureServices', type: 'any' },\r\n  public_network_access_enabled: { value: false, type: 'any' },\r\n  resource_group_name: {\r\n    value: '${azurerm_resource_group.ResourceGroup.name}',\r\n    type: 'any'\r\n  },\r\n  source: {\r\n    value: 'example.artifactory.com/terraform-modules__Azure/avm-res-containerregistry-registry/azurerm',\r\n    type: 'simple',\r\n    isBlock: false,\r\n    storageClassType: 'string'\r\n  },\r\n  version: {\r\n    value: '0.1.0',\r\n    type: 'simple',\r\n    isBlock: false,\r\n    storageClassType: 'string'\r\n  },\r\n  '//': {\r\n    metadata: {\r\n      path: 'test-avm-stack',\r\n      uniqueId: 'AvmContainerRegistry'\r\n    }\r\n  }\r\n}\r\n``` \r\n\r\nSame applies also to module 0.2.0 version.\r\n\r\nIn CDKTF code identities are explicitly set to null, as otherwise module would add identity to ACR which is not wanted.\r\n\r\n","createdAt":"2024-08-09T17:29:35Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3697#issuecomment-2278413095","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6IFqJ8","author":{"login":"Hi-Fi"},"authorAssociation":"NONE","body":"Code that cause the issue also at Azure/terraform-azurerm-avm-res-containerregistry-registry#76","createdAt":"2024-08-12T06:19:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3697#issuecomment-2283184764","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6IH82o","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"This needs a bit more clarity. I guess the issue is that in certain conditions, passing a null value to attribute causes the error. Can you give me a minimal reproducible code snippet to chase this down?","createdAt":"2024-08-12T12:03:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3697#issuecomment-2283785640","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6IYtJs","author":{"login":"Hi-Fi"},"authorAssociation":"NONE","body":"Init empty project with typescript with CDKTF\r\n\r\ncdktf.json:\r\n```json\r\n{\r\n  \"language\": \"typescript\",\r\n  \"app\": \"npx ts-node main.ts\",\r\n  \"projectId\": \"a24002df-12f0-46e1-9d08-9cfcb038742f\",\r\n  \"sendCrashReports\": \"false\",\r\n  \"terraformProviders\": [],\r\n  \"terraformModules\": [\r\n    \"Azure/avm-res-storage-storageaccount/azurerm@0.2.2\"\r\n  ],\r\n  \"context\": {\r\n\r\n  }\r\n}\r\n\r\n```\r\nMain.ts:\r\n```ts\r\nimport { Construct } from \"constructs\";\r\nimport { App, TerraformStack } from \"cdktf\";\r\nimport { AvmResStorageStorageaccount } from \"./.gen/modules/Azure/azurerm/avm-res-storage-storageaccount\"\r\n\r\nclass MyStack extends TerraformStack {\r\n  constructor(scope: Construct, id: string) {\r\n    super(scope, id);\r\n\r\n    new AvmResStorageStorageaccount(this, \"storage\", {\r\n      location: \"eastus\",\r\n      resourceGroupName: \"cdktf-test\",\r\n      name: \"cdktfstorage\",\r\n      managedIdentities: null\r\n    });\r\n  }\r\n}\r\n\r\nconst app = new App();\r\nnew MyStack(app, \"cdktf-test\");\r\napp.synth();\r\n\r\n```\r\n","createdAt":"2024-08-14T08:38:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3697#issuecomment-2288177772","viewerDidAuthor":false}],"createdAt":"2024-08-09T08:08:23Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":3697,"title":"CLI: HCL synth fails on null value in module configuration","updatedAt":"2024-08-14T08:38:55Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjIzMTI3MzY=","is_bot":false,"login":"jdraymon","name":"Johnathan Raymond"},"body":"### Expected Behavior\r\n\r\nAwsProviderDefaultTags(tags) accepts as input a cdktf `StringMap`\r\n\r\n### Actual Behavior\r\n\r\nOutput of `ServicecatalogappregistryApplication.application_tag` is a `cdktf.StringMap`, but the `AwsProviderDefaultTags` only accepts `Mapping[str,str]` as input to `tags` attribute. The fixed string input precludes the use of any cross-stack / dynamic tag value in a provider.\r\n\r\nThe Python format documentation for use of `ServicecatalogappregistryApplication` is incorrect as a result\r\n\r\n### Steps to Reproduce\r\n\r\n1. Create a `ServicecatalogappregistryApplication`\r\n```\r\napplication = ServicecatalogappregistryApplication(\r\n            self,\r\n            \"aws-myapplication\",\r\n            name=config.network.domain_name,\r\n            description=\"Mojito monitoring application\",\r\n        )\r\n```\r\n2. Attempt to use the output of that application as a Tag on any AWS resource:\r\n```\r\nVpc(\r\n  self,\r\n  \"my-vpc\",\r\n  cidr_block=\"10.0.4.0/24\",\r\n  enable_dns_support=True,\r\n  enable_dns_hostnames=True,\r\n  tags=application.application_tag,\r\n)\r\n```\r\n\r\n### Versions\r\n\r\n```\r\ncdktf-cdktf-provider-aws (PREBUILT)\r\n        terraform provider version: 5.61.0 \r\n        prebuilt provider version: 19.29.0\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-helm (PREBUILT)\r\n        terraform provider version: 2.14.0 \r\n        prebuilt provider version: 10.2.0\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-kubernetes (PREBUILT)\r\n        terraform provider version: 2.31.0 \r\n        prebuilt provider version: 11.6.0\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-null (PREBUILT)\r\n        terraform provider version: 3.2.2 \r\n        prebuilt provider version: 10.0.0\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-random (PREBUILT)\r\n        terraform provider version: 3.6.2 \r\n        prebuilt provider version: 11.0.2\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-tls (PREBUILT)\r\n        terraform provider version: 4.0.5 \r\n        prebuilt provider version: 10.0.0\r\n        cdktf version: ^0.20.0\r\n```\r\n\r\n### Providers\r\n\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name     â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name                    â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ tailsdotcom/scram â”‚ 0.2.0            â”‚         â”‚ ~> 0.2     â”‚                                 â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ aws               â”‚ 5.61.0           â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-aws        â”‚ 19.29.0         â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ helm              â”‚ 2.14.0           â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-helm       â”‚ 10.2.0          â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ kubernetes        â”‚ 2.31.0           â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-kubernetes â”‚ 11.6.0          â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ null              â”‚ 3.2.2            â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-null       â”‚ 10.0.0          â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ random            â”‚ 3.6.2            â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-random     â”‚ 11.0.2          â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ tls               â”‚ 4.0.5            â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-tls        â”‚ 10.0.0          â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\n_No response_\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6HzZWN","author":{"login":"jdraymon"},"authorAssociation":"NONE","body":"Realistically I might want to use resolvables for any tag value, not just the AWS Default ones - and it's something I can do in HCL but not in the CDKTF","createdAt":"2024-08-09T17:18:42Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3696#issuecomment-2278397325","viewerDidAuthor":false}],"createdAt":"2024-08-08T01:29:53Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"}],"milestone":null,"number":3696,"title":"cdktf-provider-aws: `tags` fields should accept `IResolvable` values","updatedAt":"2024-08-12T20:33:34Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjMwNTk2MTY1","is_bot":false,"login":"eahrend","name":"Erik Ahrend"},"body":"### Expected Behavior\r\n\r\nIt should plan and apply without issue. This is the terraform resource Im using\r\nhttps://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/composer_environment#nested_ip_allocation_policy_c2\r\n\r\n### Actual Behavior\r\n\r\nWhen I set the composer node config to this, there is an error\r\n```GO\r\n\tcomposerNodeConfig := &cc.ComposerEnvironmentConfigNodeConfig{\r\n\t\tSubnetwork:     jsii.String(cloudComposerCluster.Subnetwork),\r\n\t\tNetwork:        jsii.String(cloudComposerCluster.Network),\r\n\t\tServiceAccount: cloudComposerServiceAccount.Email(),\r\n\t\tTags:           jsii.Strings(cloudComposerCluster.Tags...),\r\n\t\tIpAllocationPolicy: &cc.ComposerEnvironmentConfigNodeConfigIpAllocationPolicy{\r\n\t\t\tClusterSecondaryRangeName:  jsii.String(cloudComposerCluster.PodRangeName),\r\n\t\t\tServicesSecondaryRangeName: jsii.String(cloudComposerCluster.ServiceRangeName),\r\n\t\t},\r\n\t}\r\n```\r\n\r\nIt returns:\r\n\r\n\r\n```\r\n                        â•°â”€ Key 'ipAllocationPolicy': Unable to deserialize value as cdktf.IResolvable | array<@cdktf/provider-google.composerEnvironment.ComposerEnvironmentConfigNodeConfigIpAllocationPolicy> | undefined\r\n                            â”œâ”€â”€ ğŸ›‘ Failing value is an object\r\n                            â”‚      { '$jsii.struct': [Object] }\r\n                            â•°â”€â”€ ğŸ” Failure reason(s):\r\n                                â”œâ”€ [as array<@cdktf/provider-google.composerEnvironment.ComposerEnvironmentConfigNodeConfigIpAllocationPolicy>] Value is not an array\r\n                                â•°â”€ [as cdktf.IResolvable] Value does not have the \"$jsii.byref\" key\r\n```\r\nConverting it to an array will get past the synth, however a new error pops up\r\n\r\n```GO\r\n\tcomposerNodeConfig := &cc.ComposerEnvironmentConfigNodeConfig{\r\n\t\tSubnetwork:     jsii.String(cloudComposerCluster.Subnetwork),\r\n\t\tNetwork:        jsii.String(cloudComposerCluster.Network),\r\n\t\tServiceAccount: cloudComposerServiceAccount.Email(),\r\n\t\tTags:           jsii.Strings(cloudComposerCluster.Tags...),\r\n\t\tIpAllocationPolicy: &[]cc.ComposerEnvironmentConfigNodeConfigIpAllocationPolicy{\r\n\t\t\t{\r\n\t\t\t\tClusterSecondaryRangeName:  jsii.String(cloudComposerCluster.PodRangeName),\r\n\t\t\t\tServicesSecondaryRangeName: jsii.String(cloudComposerCluster.ServiceRangeName),\r\n\t\t\t},\r\n\t\t},\r\n\t}\r\n```\r\n\r\nWill result in a successful synth, however during the plan phase it'll say that I am missing the values for other resources in that block. Which is weird because in the provider having all of those fields will result in a conflict (and manually adding them causes this conflict as well)\r\nhttps://github.com/hashicorp/terraform-provider-google/blob/97596918928c1f6bccd6d53a10270f8465efe98a/google/services/composer/resource_composer_environment.go#L288-L344\r\n\r\n\r\nI looked at the issue for this provider with vanilla TF, and they suggest to just use a single ip_allocation_policy, but there isn't a way to do this in cdktf, as just having a single ip allocation policy fails on the synth\r\n\r\n### Steps to Reproduce\r\n\r\nCheck actual behavior, contains relevant code\r\n\r\n### Versions\r\n\r\nlanguage: go\r\ncdktf-cli: 0.20.8\r\nnode: v20.4.0\r\ncdktf: 0.20.8\r\nterraform:  v1.7.0\r\n\r\nThis is what I can get since doing `cdktf debug` has another error\r\n\r\n### Providers\r\n\r\nRunning this command gives an error:\r\n```\r\n% cdktf provider list\r\nPre-built provider information not found\r\nError: Pre-built provider information not found\r\n```\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\nN/A\r\n\r\n### Workarounds\r\nTried using an escape hatch, but that also gives an error\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\nRelated issue and suggested fix:\r\nhttps://github.com/hashicorp/terraform-provider-google/issues/15456\r\n\r\nCreated this PR to potentially fix\r\n\r\n### Help Wanted\r\n\r\n- [ x] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6HsMI1","author":{"login":"eahrend"},"authorAssociation":"NONE","body":"This looks like an issue with the base provider and the lack of a 1:1 from HCL to TF complaint JSON. Created a PR for the provider, which when tested locally it works:\r\nhttps://github.com/GoogleCloudPlatform/magic-modules/pull/11401","createdAt":"2024-08-08T19:26:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3695#issuecomment-2276508213","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6K36qL","author":{"login":"eahrend"},"authorAssociation":"NONE","body":"Confirmed this works with terraform compliant JSON in the 6.1.0 release of GCP's provider. @ansgarm any idea when that will be ported over to CDKTF?","createdAt":"2024-09-04T20:30:19Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3695#issuecomment-2329913995","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6K57Jx","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"You could try building the provider locally (https://developer.hashicorp.com/terraform/cdktf/concepts/providers#add-provider-to-cdktf-json) to verify that the provider is working as expected.\r\n\r\nIf it is, could make a PR against https://github.com/cdktf/cdktf-repository-manager/blob/main/provider.json to update the version that is being pre-built.\r\n\r\nIf it isn't, it may also be possible to fix by updating https://github.com/hashicorp/terraform-cdk/blob/main/packages/%40cdktf/provider-generator/lib/get/generator/custom-defaults.ts which exists because of a certain incompatibility in Terraform JSON.","createdAt":"2024-09-05T01:47:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3695#issuecomment-2330440305","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6K6AKR","author":{"login":"eahrend"},"authorAssociation":"NONE","body":"Oh nice, thank you @jsteinich , I'll give that a shot tomorrow.\r\n\r\nApologies, will need to test this week.","createdAt":"2024-09-05T02:08:48Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3695#issuecomment-2330460817","viewerDidAuthor":false}],"createdAt":"2024-08-07T21:25:48Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"},{"id":"LA_kwDODd1Amc8AAAABCgOQbg","name":"upstream/terraform-provider","description":"depending upstream work on a Terraform provider","color":"422DD8"}],"milestone":null,"number":3695,"title":"GCP: Composer Cluster IP Allocation Policy invalid on plan and apply","updatedAt":"2024-09-11T22:20:41Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE3NjI1OTk=","is_bot":false,"login":"so0k","name":"so0k"},"body":"### Description\n\nCurrently the `cdktf-cli` is able to run most terraform commands but does not support `test`.\r\n\r\nI think there is a progressive way to support this command:\r\n\r\n1. Allow users to write plain `*.tftest.hcl` next to typescript code which get copied over into the `app.manifest.forStack(..).workingDirectory`, simply run `terraform test` directly in the `synthesized` directory)\r\n1. Add Constructs for HCL tests which synth to the test directory for the stack\r\n\r\nThe first step is a simple(r) addition to the CLI without adding more complexity to the `lib`\r\n\r\nThe second step adds full Terraform tests support to the CDK and requires a more well designed proposal.\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [x] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-08-02T06:30:05Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3687,"title":"cli: Support `test` sub-command","updatedAt":"2024-08-02T06:30:10Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE3NjI1OTk=","is_bot":false,"login":"so0k","name":"so0k"},"body":"### Description\n\nTerraform Provider functions  were announced with Terraform 1.8 on [April 10, 2024](https://www.hashicorp.com/blog/terraform-1-8-adds-provider-functions-for-aws-google-cloud-and-kubernetes) and I don't see any information about supporting provider functions in terraform-for-cdk.\r\n\r\nFor example the `terraform-provider-aws`  [arn_parse](https://registry.terraform.io/providers/-/aws/latest/docs/functions/arn_parse?lang=typescript) function isn't available (searched using `grep` in the pre-generated Typescript code).\r\n\r\nI believe this affects several components, but it starts in `provider-schema` component.\r\n\r\nhttps://github.com/hashicorp/terraform-cdk/blob/6b78c57e4657da80a3c4be8df3c819d7172c28ac/packages/%40cdktf/provider-schema/src/provider-schema.ts#L245-L250\r\n\r\nand \r\nhttps://github.com/hashicorp/terraform-cdk/blob/6b78c57e4657da80a3c4be8df3c819d7172c28ac/packages/%40cdktf/commons/src/provider-schema.ts#L18-L22\r\n\r\nThen additional support will need to be `lib` component to actually use the Provider functions in target languages\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [X] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6P_7sH","author":{"login":"vincenthsh"},"authorAssociation":"NONE","body":"@ansgarm @DanielMSchmidt @xiehan  - should I attempt working on a PR for this or is this in the works within the cdktf team?","createdAt":"2024-10-16T07:01:38Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"CONFUSED","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3686#issuecomment-2415901447","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6ka3it","author":{"login":"bushong1"},"authorAssociation":"NONE","body":"This works in the pre-release version of npm's [hcl2json](https://www.npmjs.com/package/@cdktf/hcl2json), but there hasn't been an official release in a few months.","createdAt":"2025-03-27T15:38:06Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"LAUGH","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3686#issuecomment-2758506669","viewerDidAuthor":false}],"createdAt":"2024-08-02T06:22:29Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3686,"title":"provider-generator: Add support for provider functions","updatedAt":"2025-03-27T15:38:07Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE2MjA0NDUy","is_bot":false,"login":"benkeil","name":"Ben Keil"},"body":"### Description\n\nIn Kubernetes most classes are reused in many places. A `PodSpec` for example is valid in a `Pod`, but also in a `Deployment` or `StatefulSet`. Same e.g. with `Metadata`.\r\n\r\nThe actual behaviour of creating and naming classes makes it impossible to reuse code that creates constructs like e.g. a `PodSpec`.\r\n\r\nIt would be nice if properties that reference the same class in Kubernetes also have the same classes in the generated code (Java) to make it easier to build and reuse custom constructs and functions.\r\n\r\n```pseudo\r\nclass DeploymentV1 {\r\n  metadata: Metadata\r\n}\r\n\r\nclass SecretV1 {\r\n  metadata: Metadata\r\n}\r\n```\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-07-31T10:16:48Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3685,"title":"`cdktf-provider-kubernetes`: use correct Kubernetes classes for properties to allow reuse of custom constructs and builder","updatedAt":"2024-07-31T10:16:48Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjI5MDg3Mzk2","is_bot":false,"login":"anilkaliya","name":""},"body":"### Description\r\n\r\nI have cdktf code which provisions infra, I want to create ns1 record , As Documentation is very limited, i could not find how can i create ns1 record using cdktf. In terraform there is proper documentation of how to create ns1 record [Link](url) but the same is missing in cdktf.\r\nPlease help here\r\n\r\n### Links\r\n\r\nhttps://registry.terraform.io/providers/ns1-terraform/ns1/latest/docs/resources/record\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request","comments":[],"createdAt":"2024-07-22T07:56:44Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3681,"title":"NS1 Record creation","updatedAt":"2024-07-22T07:56:59Z"},{"assignees":[],"author":{"id":"U_kgDOBqX0Rg","is_bot":false,"login":"commiterate","name":"Kevin Su"},"body":"### Description\n\n#### Issue\n\n`cdktf-cli` currently uses `@cdktf/node-pty-prebuilt-multiarch` to spawn a child process that runs the Terraform CLI for `deploy` and `destroy` commands ([docs](https://developer.hashicorp.com/terraform/cdktf/cli-reference/cli-configuration#node-gyp-errors)). This is a fork of `node-pty` for providing pre-built binaries as it has native/C components.\n\nThis currently has some sharp edges:\n\n1. The Terraform CDK team needs to continuously maintain the fork and provide additional pre-built binaries for each combination of JavaScript runtime (Node.js, Electron) version, operating system (Linux w/ GNU libc, Linux w/ musl libc, macOS/Darwin, Windows), and ISA (IA-32/i386, x86-64, ARM32, ARM64).\n    * This currently produces 200+ assets per [release](https://github.com/cdktf/node-pty-prebuilt-multiarch/releases).\n    * Users trying to use the newest versions of Node.js may run into errors like in https://github.com/hashicorp/terraform-cdk/issues/3641 and https://github.com/hashicorp/terraform-cdk/issues/3896 if the compilation step done by the `postinstall` lifecycle script doesn't correctly trigger (may happen with alternative package managers like pnpm or Bun).\n        * [Bun (and potentially other package managers) purposefully does not execute lifecycle scripts (e.g. `postinstall`) by default](https://bun.sh/docs/cli/add#trusted-dependencies) because they're a security vulnerability (remote code execution).\n    * Users trying to use alternative JavaScript runtimes may run into errors with `node-gyp` like in https://github.com/microsoft/node-pty/issues/632.\n2. Pre-compiled binaries may contain hardcoded paths to the dynamic linker or expect specific versions of dynamically linked libraries.\n    * The former requires ELF patching for operating systems that don't place the dynamic linker in a conventional location like NixOS and Guix.\n    * The latter is a chronic inconvenience for people on usually older and the newest versions of Linux distributions which may have older/newer versions of GNU libc or musl libc than what's required.\n3. `node-pty` uses some V8-specific APIs which can cause problems for alternative runtimes that don't use V8 as the JavaScript engine.\n    * One example is Bun which uses JavaScriptCore (https://github.com/oven-sh/bun/issues/5306).\n\n`node-pty` effectively creates a hard dependency on the Node.js runtime (Node.js API + V8 JavaScript engine) and other pre-compiled binaries which creates a narrow compatibility window and an extra maintenance burden.\n\n#### Proposal\n\nOne option is to use Node's `child_process.spawn()` ([docs](https://nodejs.org/api/child_process.html#child_processspawncommand-args-options)) to spawn child processes. Setting the `stdio` option ([docs](https://nodejs.org/api/child_process.html#optionsstdio)) to `inherit` seems to allow use of interactive child processes like the Terraform CLI.\n\nThis removes the need for binaries outside of the JavaScript runtime, leaving only a dependency on the Node.js API.\n\nAlternative JavaScript runtimes typically provide polyfills for Node.js APIs. In particular, both [Bun](https://bun.sh/docs/runtime/nodejs-apis#node-child-process) and [Deno](https://docs.deno.com/runtime/reference/node_apis#node%3Achild_process) provide `node:child_process` polyfills, removing the need for `cdktf-cli` to use each runtime's idiomatic child process spawning APIs.\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n","comments":[{"id":"IC_kwDODd1Amc6JnxXr","author":{"login":"micchickenburger"},"authorAssociation":"NONE","body":"This would also allow the use of cdktf in environments that don't provide pseudo terminal support, like Lambda.","createdAt":"2024-08-25T15:54:32Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3675#issuecomment-2308904427","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6rvspj","author":{"login":"commiterate"},"authorAssociation":"NONE","body":"This is becoming a major pain point since `@cdktf/node-pty-prebuilt-multiarch` only started adding pre-built Node.js 22 LTS binaries in March 2025 (https://github.com/cdktf/node-pty-prebuilt-multiarch/pull/111) but Node.js 22 LTS was [released in October 2024](https://nodejs.org/en/blog/release/v22.11.0) (so an ~5 month delay to support an LTS release).\n\n(cc: @mutahhir @ansgarm)","createdAt":"2025-05-14T20:01:30Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":3}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3675#issuecomment-2881407587","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc69DvxU","author":{"login":"hugues-m"},"authorAssociation":"NONE","body":"this is also a pain point for us for node 24 which is the current version since may 06","createdAt":"2025-08-09T15:56:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3675#issuecomment-3171875924","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7PRKsR","author":{"login":"commiterate"},"authorAssociation":"NONE","body":"Node.js 24 transitioned to LTS near the end of October 2025. https://github.com/cdktf/node-pty-prebuilt-multiarch/pull/119, however, is still open. That PR seems to have run into similar problems with `node-gyp`.","createdAt":"2025-11-02T03:16:15Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3675#issuecomment-3477383953","viewerDidAuthor":false}],"createdAt":"2024-07-20T23:46:22Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3675,"title":"`cdktf-cli`: Invoke Terraform CLI with `node:child_process` instead of `node-pty`. (Bun + Deno support)","updatedAt":"2025-11-02T03:16:15Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM4NjAwMQ==","is_bot":false,"login":"giseburt","name":"Rob Giseburt"},"body":"### Expected Behavior\r\n\r\nWith this code:\r\n```terraform\r\nlocals {\r\n  baz_var  = \"baz_value\"\r\n  blah_var = \"blah_value\"\r\n  url_var = \"https://github.com/${local.baz_var}/example/${local.blah_var}${local.baz_var}/\"\r\n}\r\n\r\noutput \"terraform\" {\r\n  value = local.url_var\r\n}\r\n```\r\n\r\n`pbpaste | npx cdktf convert` **should** yield:\r\n\r\n```ts\r\nimport { Construct } from \"constructs\";\r\nimport { TerraformOutput } from \"cdktf\";\r\nclass MyConvertedCode extends Construct {\r\n  constructor(scope: Construct, name: string) {\r\n    super(scope, name);\r\n    const bazVar = \"baz_value\";\r\n    const blahVar = \"blah_value\";\r\n    // wrong\r\n    // const urlVar = \"https://github.com/${\" + bazVar + \"}/example/${\" + blahVar + \"${\" + bazVar + \"}/\";\r\n    // right\r\n    const urlVar = \"https://github.com/\" + bazVar + \"/example/\" + blahVar + \"\" + bazVar + \"/\";\r\n    // right (2) - remove redundant + \"\" + \r\n    // const urlVar = \"https://github.com/\" + bazVar + \"/example/\" + blahVar + bazVar + \"/\";\r\n    // right (3) - typescript only - note backticks\r\n    // const urlVar = `https://github.com/${bazVar}/example/${blahVar}${bazVar}/`;\r\n    new TerraformOutput(this, \"terraform\", {\r\n      value: urlVar,\r\n    });\r\n  }\r\n}\r\n```\r\n\r\nWhere `urlValue` would have a generated result equivalent to:\r\n\r\n```ts\r\n// âœ…\r\nconst urlVar = \"https://github.com/baz_value/example/blah_valuebaz_value/\";\r\n```\r\n\r\n### Actual Behavior\r\n\r\nWhat we get now:\r\n\r\n```ts\r\nimport { Construct } from \"constructs\";\r\nimport { TerraformOutput } from \"cdktf\";\r\nclass MyConvertedCode extends Construct {\r\n  constructor(scope: Construct, name: string) {\r\n    super(scope, name);\r\n    const bazVar = \"baz_value\";\r\n    const blahVar = \"blah_value\";\r\n    const urlVar =\r\n      \"https://github.com/${\" +\r\n      bazVar +\r\n      \"}/example/${\" +\r\n      blahVar +\r\n      \"${\" +\r\n      bazVar +\r\n      \"}/\";\r\n    new TerraformOutput(this, \"terraform\", {\r\n      value: urlVar,\r\n    });\r\n  }\r\n}\r\n```\r\n\r\nIf I remove the extra line endings on the problem line, we get:\r\n\r\n```ts\r\n// âŒ\r\nconst urlVar = \"https://github.com/${\" + bazVar + \"}/example/${\" + blahVar + \"${\" + bazVar + \"}/\";\r\n```\r\n\r\nWhich means the generated result would be the equivalent of:\r\n\r\n```ts\r\n// âš ï¸\r\nconst urlVar = \"https://github.com/${baz_value}/example/${blah_value${baz_value}/\";\r\n//                                 ^^         ^         ^^          ^^         ^\r\n//                                 ||         |         ||          ||         |\r\n```\r\n\r\nErrors highlighted:\r\n- `${` and `}` surrounding the intended **value** - not a token - these should not be here\r\n  - If those values where Tokens, then they would put in their own `${` and `}` on output\r\n- In the `${blah_value${baz_value}` case there's a missing `}` (which we don't want anyway)\r\n\r\n\r\n\r\n### Steps to Reproduce\r\n\r\nSee Expected Behavior ğŸ‘†ğŸ»\r\n\r\n### Versions\r\n\r\nlanguage: typescript\r\ncdktf-cli: 0.20.8\r\nnode: v20.13.1\r\nterraform: 1.7.5\r\narch: arm64\r\nos: darwin 23.5.0\r\n\r\n\r\n### Providers\r\n\r\nirrelevant in this case\r\n\r\n### Gist\r\n\r\nhttps://gist.github.com/giseburt/7d414af1fc583b844a5eb5f0052c7859\r\n\r\n### Possible Solutions\r\n\r\nAdjust how strings are converted to typescript (possibly other languages) - if the value is a token, then the `${`...`}` will be put in by the token interpolation on output, they should NOT be in the input.\r\n\r\n### Workarounds\r\n\r\n*none* - post-processing of the converted output, complicated by the fact that the `}` is occasionally lost\r\n\r\n### Anything Else?\r\n\r\nThis might be Typescript only, I have not tested to be sure\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [X] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-07-19T16:31:54Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTg1Mzg1NTQ2","name":"feature/convert","description":"","color":"d93f0b"}],"milestone":null,"number":3674,"title":"`cdktf convert` mangles string interpolation","updatedAt":"2024-07-29T07:54:12Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM4NDcyMDA0","is_bot":false,"login":"tenminus11","name":"Suraj Kanojia"},"body":"resource with \"\" empty string does not render in hcl\r\nvariable default value 0,false,\"\" does not render in hcl\r\nlocal with value 0,false,\"\" does not render in hcl\r\n\r\n### Expected Behavior\r\n\r\n```\r\nlocals {\r\n  local_bool: false,\r\n  local_num: 0,\r\n  local_str: \"\"\r\n}\r\n\r\nvariable \"var_str\" {\r\n  type = string\r\n  default: \"\",\r\n}\r\n\r\nvariable \"var_bool\" {\r\n  type = bool\r\n  default: false,\r\n}\r\n\r\nvariable \"var_num\" {\r\n  type = number\r\n  default: 0,\r\n}\r\nresource \"google_compute_network\" \"nw_vpc\" {\r\n  auto_create_subnetworks = false\r\n  description             = \"\"\r\n  mtu                     = 0\r\n  name                    = \"vpc-network\"\r\n}\r\n```\r\n\r\n### Actual Behavior\r\n\r\n```\r\nlocals {\r\n\r\n}\r\n\r\nvariable \"var_str\" {\r\n  type = string\r\n}\r\n\r\nvariable \"var_bool\" {\r\n  type = bool\r\n}\r\n\r\nvariable \"var_num\" {\r\n  type = number\r\n}\r\nresource \"google_compute_network\" \"nw_vpc\" {\r\n  auto_create_subnetworks = false\r\n  description             =\r\n  mtu                     = 0\r\n  name                    = \"vpc-network\"\r\n}\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n```\r\n\r\n        TerraformVariable(\r\n            self,\r\n            \"var_str\",\r\n            default=\"\",\r\n            type=\"string\",\r\n        )\r\n        TerraformVariable(\r\n            self,\r\n            \"var_bool\",\r\n            default=False,\r\n            type=\"bool\",\r\n        )\r\n        TerraformVariable(\r\n            self,\r\n            \"var_num\",\r\n            default=0,\r\n            type=\"number\",\r\n        )\r\n        TerraformLocal(\r\n            self,\r\n            \"local_str\",\r\n            \"\"\r\n        )\r\n        TerraformLocal(\r\n            self,\r\n            \"local_num\",\r\n            0\r\n        )\r\n        TerraformLocal(\r\n            self,\r\n            \"local_bool\",\r\n            False\r\n        )\r\n        ComputeNetwork(\r\n            self,\r\n            \"nw_vpc\",\r\n            name=\"vpc-network\",\r\n            description=\"\",\r\n            auto_create_subnetworks=False,\r\n            mtu=0\r\n        )\r\n\r\n```\r\n\r\n### Versions\r\n\r\ncdktf debug\r\nlanguage: python\r\ncdktf-cli: 0.20.8\r\nnode: v20.12.2\r\ncdktf: 0.20.8\r\nconstructs: 10.3.0\r\njsii: 1.101.0\r\nterraform: 1.9.2\r\narch: x64\r\nos: linux 6.6.15-2rodete2-amd64\r\npython: Python 3.11.8\r\npip: pip 24.0 from /xxx/.local/share/virtualenvs/cdktf-bug-xGaVuY_f/lib/python3.11/site-packages/pip (python 3.11)\r\npipenv: pipenv, version 2023.12.1\r\nproviders\r\ncdktf-cdktf-provider-google (PREBUILT)\r\n        terraform provider version: 5.38.0 \r\n        prebuilt provider version: 13.27.0\r\n        cdktf version: ^0.20.0\r\n\r\n### Providers\r\n\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name                â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ google        â”‚ 5.38.0           â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-google â”‚ 13.27.0         â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\n[removing might solve resource empty string](https://github.com/hashicorp/terraform-cdk/blob/8edf7c513983d1ab21a4c90b43e841c34fd9c467/packages/cdktf/lib/hcl/render.ts#L29-L31)\r\n\r\n### Workarounds\r\n\r\n_No response_\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n#3626\r\n#3621\r\n\r\n#3655 partly solved the issue, just for modules\r\n\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-07-18T16:34:23Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3673,"title":"cdktf: hcl render failing resource(\"\"); locals, variable in false(bool), 0(int), \"\"(str) value","updatedAt":"2025-05-30T12:31:42Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjI1MDQ5MjQ=","is_bot":false,"login":"rtrompier","name":"Remy"},"body":"### Description\n\nThe `Approve` choice should not be the first choice when running a `deploy` action.\r\nIn Terraform, when running an Apply, you must type `yes` to apply changes. This means the change will be canceled if you press enter accidentally. Here, with CDKTF, it will be applied, which can be very dangerous.\r\n\r\n<img width=\"617\" alt=\"image\" src=\"https://github.com/hashicorp/terraform-cdk/assets/2504924/bae5e2ae-4087-4661-953b-22c44628d69c\">\r\n\r\n\r\nIf you agree, I think we need to change the [choice order here](https://github.com/hashicorp/terraform-cdk/blob/main/packages/cdktf-cli/src/bin/cmds/ui/components/bottom-bars/approve.tsx#L20).\r\nI'll be happy to make a PR to improve it.\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [X] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-07-10T06:15:57Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3667,"title":"CDKTF-CLI: Options order during apply","updatedAt":"2024-07-10T06:15:57Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEwNTIzOTUw","is_bot":false,"login":"bmendric","name":"Brandon Mendrick"},"body":"### Description\r\n\r\nNot quite sure which component is/would be responsible for this, so apologies if this is being opened in the incorrect place.\r\n\r\nI am working on converting some of our Terraform over to Go CDKTF and came across a [Terraform crash](https://github.com/hashicorp/terraform/issues/35416). Poking at this a bit more, it appears CDKTF is validating the `to` field during synthesis, but not the `id` field when generating import blocks.\r\n\r\nFor example, doing the following produces an error during synthesis:\r\n```go\r\npackage main\r\n\r\nimport (\r\n  \"github.com/cdktf/cdktf-provider-vault-go/vault/v13/ldapauthbackend\"\r\n  vaultprovider \"github.com/cdktf/cdktf-provider-vault-go/vault/v13/provider\"\r\n  \"github.com/hashicorp/terraform-cdk-go/cdktf\"\r\n)\r\n\r\nfunc Ptr[T any](v T) *T {\r\n  return &v\r\n}\r\n\r\nfunc main() {\r\n  app := cdktf.NewApp(nil)\r\n  stack := cdktf.NewTerraformStack(app, Ptr(\"test\"))\r\n\r\n  // backend and provider setup\r\n\r\n  ldap := ldapauthbackend.NewLdapAuthBackend(stack, Ptr(\"ldap\"), &ldapauthbackend.LdapAuthBackendConfig{\r\n    // config values\r\n  })\r\n\r\n  _ = ldapauthbackend.LdapAuthBackend_GenerateConfigForImport(\r\n    stack,\r\n    ldap.Id(),\r\n    ldap.PathtInput(),\r\n    nil,\r\n  )\r\n\r\n  app.Synth()\r\n}\r\n```\r\n\r\nThe error output is along the lines of: `You cannot use a token (e.g., a reference to an attribute) as the id of a construct. Ids of constructs must be known at synthesis time, and token values are only known when Terraform runs.`\r\n\r\nHowever, doing the opposite (see below) does not cause an error during synthesis, instead it will cause Terraform to crash prior to 1.9.2 (per the related issue).\r\n\r\n```go\r\n  _ = ldapauthbackend.LdapAuthBackend_GenerateConfigForImport(\r\n    stack,\r\n    ldap.FriendlyUniqueId(),\r\n    ldap.Path(),\r\n    nil,\r\n  )\r\n```\r\n\r\nSince this is known bad behavior (i.e. not supported) it would be nice for that to be validated during synthesis.\r\n\r\n### References\r\n\r\nhttps://github.com/hashicorp/terraform/issues/35416\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-07-03T13:35:55Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3665,"title":"CDKTF: Validate referenced objects when generating imports","updatedAt":"2024-07-03T13:36:03Z"},{"assignees":[],"author":{"id":"U_kgDOBjqmvA","is_bot":false,"login":"josh-thisisbud","name":""},"body":"### Expected Behavior\r\n\r\nWhen writing code in Python for Terraform CDK, I would expect to be able to use the issensitive function from terraform to enable conditional logic at run/plan time.\r\n\r\n### Actual Behavior\r\n\r\nThe issensitive function is not available on `cdktf.Fn`\r\n\r\n### Steps to Reproduce\r\n\r\n```python\r\nfrom cdktf import Fn\r\nbool = Fn.issensitive(\"\")\r\n```\r\n\r\n### Versions\r\n\r\ncdktf debug\r\nlanguage: python\r\ncdktf-cli: 0.20.7\r\nnode: v22.3.0\r\ncdktf: 0.20.7\r\nconstructs: 10.3.0\r\njsii: 1.100.0\r\nterraform: 1.5.7\r\narch: arm64\r\nos: darwin 23.5.0\r\npython: Python 3.12.4\r\npip: pip 24.0 from /Users/joshharwood/.local/share/virtualenvs/platform-infra-definition-TF3Q1r-C/lib/python3.12/site-packages/pip (python 3.12)\r\npipenv: pipenv, version 2024.0.1\r\nproviders\r\ndatastax/astra@~> 2.3 (LOCAL)\r\n        terraform provider version: 2.3.4\r\nAckers-BUD/http2b64@~> 1.0.2 (LOCAL)\r\n        terraform provider version: 1.0.3\r\nAckers-BUD/zip2b64@~> 1.0.2 (LOCAL)\r\n        terraform provider version: 1.0.3\r\ncastai/castai@~> 6.2.5 (LOCAL)\r\n        terraform provider version: 6.2.7\r\nthisisbud/sql@~> 1.0.0 (LOCAL)\r\n        terraform provider version: 1.0.0\r\ngrafana/grafana@~> 1.36.1 (LOCAL)\r\n        terraform provider version: 1.36.1\r\n1Password/onepassword@~> 1.1.4 (LOCAL)\r\n        terraform provider version: 1.1.4\r\ncyrilgdn/postgresql@~> 1.22.0 (LOCAL)\r\n        terraform provider version: 1.22.0\r\nMastercard/restapi@~> 1.19.1 (LOCAL)\r\n        terraform provider version: 1.19.1\r\ncdktf-cdktf-provider-cloudflare (PREBUILT)\r\n        terraform provider version: 4.33.0 \r\n        prebuilt provider version: 11.11.0\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-google (PREBUILT)\r\n        terraform provider version: 5.29.1 \r\n        prebuilt provider version: 13.18.1\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-helm (PREBUILT)\r\n        terraform provider version: 2.13.2 \r\n        prebuilt provider version: 10.1.2\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-http (PREBUILT)\r\n        terraform provider version: 3.4.3 \r\n        prebuilt provider version: 9.0.2\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-kubernetes (PREBUILT)\r\n        terraform provider version: 2.30.0 \r\n        prebuilt provider version: 11.5.0\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-local (PREBUILT)\r\n        terraform provider version: 2.5.1 \r\n        prebuilt provider version: 10.1.0\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-null (PREBUILT)\r\n        terraform provider version: 3.2.2 \r\n        prebuilt provider version: 10.0.0\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-random (PREBUILT)\r\n        terraform provider version: 3.6.2 \r\n        prebuilt provider version: 11.0.2\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-template (PREBUILT)\r\n        terraform provider version: 2.2.0 \r\n        prebuilt provider version: 10.0.1\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-time (PREBUILT)\r\n        terraform provider version: 0.11.2 \r\n        prebuilt provider version: 10.1.1\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-tls (PREBUILT)\r\n        terraform provider version: 4.0.5 \r\n        prebuilt provider version: 10.0.0\r\n        cdktf version: ^0.20.0\r\n\r\n### Providers\r\n\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name         â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name                    â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ datastax/astra        â”‚ 2.3.4            â”‚         â”‚ ~> 2.3     â”‚                                 â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ Ackers-BUD/http2b64   â”‚ 1.0.3            â”‚         â”‚ ~> 1.0.2   â”‚                                 â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ Ackers-BUD/zip2b64    â”‚ 1.0.3            â”‚         â”‚ ~> 1.0.2   â”‚                                 â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ castai/castai         â”‚ 6.2.7            â”‚         â”‚ ~> 6.2.5   â”‚                                 â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ thisisbud/sql         â”‚ 1.0.0            â”‚         â”‚ ~> 1.0.0   â”‚                                 â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ grafana/grafana       â”‚ 1.36.1           â”‚         â”‚ ~> 1.36.1  â”‚                                 â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ 1Password/onepassword â”‚ 1.1.4            â”‚         â”‚ ~> 1.1.4   â”‚                                 â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ cyrilgdn/postgresql   â”‚ 1.22.0           â”‚         â”‚ ~> 1.22.0  â”‚                                 â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ Mastercard/restapi    â”‚ 1.19.1           â”‚         â”‚ ~> 1.19.1  â”‚                                 â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ cloudflare/cloudflare â”‚ 4.33.0           â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-cloudflare â”‚ 11.11.0         â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ google                â”‚ 5.29.1           â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-google     â”‚ 13.18.1         â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ helm                  â”‚ 2.13.2           â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-helm       â”‚ 10.1.2          â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ http                  â”‚ 3.4.3            â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-http       â”‚ 9.0.2           â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ kubernetes            â”‚ 2.30.0           â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-kubernetes â”‚ 11.5.0          â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ local                 â”‚ 2.5.1            â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-local      â”‚ 10.1.0          â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ null                  â”‚ 3.2.2            â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-null       â”‚ 10.0.0          â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ random                â”‚ 3.6.2            â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-random     â”‚ 11.0.2          â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ template              â”‚ 2.2.0            â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-template   â”‚ 10.0.1          â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ time                  â”‚ 0.11.2           â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-time       â”‚ 10.1.1          â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ tls                   â”‚ 4.0.5            â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-tls        â”‚ 10.0.0          â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\n_No response_\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6Ezo7f","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"This function was introduced in Terraform 1.8 and is currently not supported. https://developer.hashicorp.com/terraform/language/functions/issensitive  ","createdAt":"2024-07-15T10:01:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3660#issuecomment-2228129503","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6FFQ7B","author":{"login":"josh-thisisbud"},"authorAssociation":"NONE","body":"I may have missed this, but if you're not targeting the current TF language version, where would I find the one you are targeting?","createdAt":"2024-07-17T08:35:55Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3660#issuecomment-2232749761","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6Qekst","author":{"login":"so0k"},"authorAssociation":"NONE","body":"There's a lot of functions missing, you can clone locally and run \r\n\r\nhttps://github.com/hashicorp/terraform-cdk/blob/0642f23ad210c4c2fe740dbbccd4eeafb6a24478/tools/generate-function-bindings/scripts/fetch-metadata.ts#L16\r\n\r\nupdating `functions.json`","createdAt":"2024-10-19T14:51:49Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3660#issuecomment-2423933741","viewerDidAuthor":false}],"createdAt":"2024-06-27T10:50:32Z","labels":[{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"LA_kwDODd1Amc7nQOIC","name":"feature/terraform-functions","description":"","color":"A1C1CD"}],"milestone":null,"number":3660,"title":"Terraform Functions: issensitive function appears to be missing","updatedAt":"2024-10-19T14:51:50Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjk0MzU5Nw==","is_bot":false,"login":"icholy","name":"Ilia Choly"},"body":"### Description\r\n\r\nI have some private templates which I don't want to upload anywhere. The `--template` option allows providing a URL to a zip file. Ideally, I could point it at templates on my local filesystem.\r\n\r\n### References\r\n\r\nhttps://github.com/hashicorp/terraform-cdk/pull/3657\r\n\r\n### Help Wanted\r\n\r\n- [X] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6QipJr","author":{"login":"icholy"},"authorAssociation":"CONTRIBUTOR","body":"After some real-life experience with #3657, what I actually want to do is point it at a template directory. Having the template as a zip committed to the repo is pretty clunky. Also, the way I'm using the `file://` scheme is not correct. `file://` URIs do not support relative paths.\r\n\r\nIn light of this, I would like to change the design to work like this:\r\n\r\n* If the template string starts with `http(s)://` download the zip.\r\n* If the template string is an exact match to a built-in template, use that.\r\n* Otherwise treat it like a local directory.\r\n","createdAt":"2024-10-20T14:18:00Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3656#issuecomment-2425000555","viewerDidAuthor":false}],"createdAt":"2024-06-20T16:52:19Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3656,"title":"cdktf-cli: support local --template files","updatedAt":"2024-10-20T14:44:44Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM2MjI0NzM3","is_bot":false,"login":"Rom888","name":""},"body":"### Expected Behavior\n\nNo error\n\n### Actual Behavior\n\npnpm add --global cdktf-cli@0.20.7\r\n```\r\nâ€‰WARNâ€‰ 6 deprecated subdependencies found: coffee-script@1.12.7, har-validator@5.1.5, request@2.88.2, sourcemap-codec@1.4.8, uuid@3.4.0, xlsjs@0.7.6\r\nPackages: +260\r\n++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\r\nProgress: resolved 1069, reused 1068, downloaded 0, added 0, done\r\n.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch: Running install script, failed in 554ms\r\n.../@cdktf/node-pty-prebuilt-multiarch install$ node scripts/check-prebuild.jâ€¦\r\nâ”‚ Prebuild binary missing for platform linux\r\nâ”‚ prebuild-install warn install No prebuilt binaries found (target=22.2.0 runâ€¦\r\nâ”‚ node:events:498\r\nâ”‚       throw er; // Unhandled 'error' event\r\nâ”‚       ^\r\nâ”‚ Error: spawn node-gyp ENOENT\r\nâ”‚     at ChildProcess._handle.onexit (node:internal/child_process:286:19)\r\nâ”‚     at onErrorNT (node:internal/child_process:484:16)\r\nâ”‚     at process.processTicksAndRejections (node:internal/process/task_queuesâ€¦\r\nâ”‚ Emitted 'error' event on ChildProcess instance at:\r\nâ”‚     at ChildProcess._handle.onexit (node:internal/child_process:292:12)\r\nâ”‚     at onErrorNT (node:internal/child_process:484:16)\r\nâ”‚     at process.processTicksAndRejections (node:internal/process/task_queuesâ€¦\r\nâ”‚   errno: -2,\r\nâ”‚   code: 'ENOENT',\r\nâ”‚   syscall: 'spawn node-gyp',\r\nâ”‚   path: 'node-gyp',\r\nâ”‚   spawnargs: [ 'rebuild' ]\r\nâ”‚ }\r\nâ”‚ Node.js v22.2.0\r\nâ””â”€ Failed in 554ms at /home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch\r\nâ€‰ELIFECYCLEâ€‰ Command failed with exit code 1.\r\n```\n\n### Steps to Reproduce\n\npnpm add --global cdktf-cli@0.20.7\n\n### Versions\n\nlanguage: typescript\r\ncdktf-cli: 0.20.7\r\nnode: 22.2.0\r\nterraform: 1.8.4\r\narch: amd64\r\nos: ubuntu 23.10\r\n\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6AnFUE","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @Rom888 ğŸ‘‹\r\n\r\nThank you for raising this. It seems like you are using Node.js v22, for which we don't have prebuild bindings at this time at all in the [cdktf/node-pty-prebuilt-multiarch](https://github.com/cdktf/node-pty-prebuilt-multiarch) library. The simplest fix would be to use Node.js v20 for the CDKTF CLI.\r\n\r\nThat said, the package should build the binaries during post-install as a fallback but it seems like pnpm didn't run the postinstall script? We don't officially support pnpm at this time, so you might need to adjust some settings for it or use npm to install the CDKTF CLI.","createdAt":"2024-06-10T08:43:34Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"CONFUSED","users":{"totalCount":3}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3641#issuecomment-2157729028","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6U4J80","author":{"login":"surecloud-meason"},"authorAssociation":"NONE","body":"Prebuild has now been upgraded to node 22: https://github.com/homebridge/node-pty-prebuilt-multiarch/releases/tag/v0.11.14 please can we get an upgraded fork.\r\n\r\nThanks","createdAt":"2024-11-25T11:27:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":5}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3641#issuecomment-2497748788","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6Y0Kj8","author":{"login":"sbkg0002"},"authorAssociation":"NONE","body":"Any update on this @ansgarm ?","createdAt":"2024-12-27T15:38:59Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"EYES","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3641#issuecomment-2563811580","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6c0v4P","author":{"login":"tweltner"},"authorAssociation":"NONE","body":"I created a pull-request to add support for node 22 to fork with `node-pty-prebuilt`'s for cdktf.","createdAt":"2025-02-03T13:55:02Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3641#issuecomment-2631073295","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6fzv7e","author":{"login":"cybmonali"},"authorAssociation":"NONE","body":"> I created a pull-request to add support for node 22 to fork with `node-pty-prebuilt`'s for cdktf.\n\nIs node 22 support available now in cdktf?","createdAt":"2025-02-25T08:39:41Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3641#issuecomment-2681143006","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6oeSxz","author":{"login":"tweltner"},"authorAssociation":"NONE","body":"With *v.0.20.12* is node 21 and 22 supported. See release information: https://github.com/hashicorp/terraform-cdk/releases/tag/v0.20.12","createdAt":"2025-04-24T06:25:10Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HOORAY","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3641#issuecomment-2826513523","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6o4fiW","author":{"login":"Saaalih2g"},"authorAssociation":"NONE","body":"Ù…Ù…ÙƒÙ† ØªÙˆØ¶ÙŠØ­ Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹ ÙˆØ§Ù„Ù†ØªÙŠØ¬Ù‡ ÙˆØ§Ù„Ø­Ø§Ù„Ù‡ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠ\r\n\r\nSa77\r\n\r\n\r\nÙÙŠ Ø®Ù…ÙŠØ³ØŒ 24 Ø£Ø¨Ø±ÙŠÙ„ØŒ 2025 ÙÙŠ 9:25 ØµØŒ ÙƒØªØ¨ Thomas Weltner <\r\n***@***.***>:\r\n\r\n> *tweltner* left a comment (hashicorp/terraform-cdk#3641)\r\n> <https://github.com/hashicorp/terraform-cdk/issues/3641#issuecomment-2826513523>\r\n>\r\n> With *v.0.20.12* is node 21 and 22 supported. See release information:\r\n> https://github.com/hashicorp/terraform-cdk/releases/tag/v0.20.12\r\n>\r\n> â€”\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/hashicorp/terraform-cdk/issues/3641#issuecomment-2826513523>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/A5IDPXHUC75X5UIKQS3SOWD23B7WHAVCNFSM6AAAAABIYOFYVCVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDQMRWGUYTGNJSGM>\r\n> .\r\n> You are receiving this because you are subscribed to this thread.Message\r\n> ID: ***@***.***>\r\n>\r\n","createdAt":"2025-04-27T10:43:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3641#issuecomment-2833381526","viewerDidAuthor":false}],"createdAt":"2024-06-04T12:44:40Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"}],"milestone":null,"number":3641,"title":"Prebuild binary missing for platform linux","updatedAt":"2025-04-27T10:43:53Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM2MjI0NzM3","is_bot":false,"login":"Rom888","name":""},"body":"### Expected Behavior\r\n\r\nNo DeprecationWarning\r\n\r\n### Actual Behavior\r\n\r\nThere is DepricationWarning\r\ncdktf --version\r\n```\r\n0.20.7\r\n(node:529691) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.\r\n(Use `node --trace-deprecation ...` to show where the warning was created)\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\npnpm add --global cdktf-cli@0.20.7 --ignore-scripts\r\ncdktf --version\r\n\r\n### Versions\r\n\r\nlanguage: typescript\r\ncdktf-cli: 0.20.7\r\nnode: 22.2.0\r\nterraform: 1.8.4\r\narch: amd64\r\nos: ubuntu 23.10\r\n\r\ninnerError Error: Cannot find module '../build/Debug/pty.node'\r\nRequire stack:\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/prebuild-loader.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/unixTerminal.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/index.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/cdktf-cli@0.20.7_ink@3.2.0_react@17.0.2/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/cdktf-cli@0.20.7_ink@3.2.0_react@17.0.2/node_modules/cdktf-cli/bundle/bin/cdktf.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/cdktf-cli@0.20.7_ink@3.2.0_react@17.0.2/node_modules/cdktf-cli/bundle/bin/cdktf\r\n    at Module._resolveFilename (node:internal/modules/cjs/loader:1186:15)\r\n    at Module._load (node:internal/modules/cjs/loader:1012:27)\r\n    at Module.require (node:internal/modules/cjs/loader:1271:19)\r\n    at require (node:internal/modules/helpers:123:16)\r\n    at Object.<anonymous> (/home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/src/prebuild-loader.ts:9:11)\r\n    at Module._compile (node:internal/modules/cjs/loader:1434:14)\r\n    at Module._extensions..js (node:internal/modules/cjs/loader:1518:10)\r\n    at Module.load (node:internal/modules/cjs/loader:1249:32)\r\n    at Module._load (node:internal/modules/cjs/loader:1065:12)\r\n    at Module.require (node:internal/modules/cjs/loader:1271:19) {\r\n  code: 'MODULE_NOT_FOUND',\r\n  requireStack: [\r\n    '/home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/prebuild-loader.js',\r\n    '/home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/unixTerminal.js',\r\n    '/home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/index.js',\r\n    '/home/rom/.local/share/pnpm/global/5/.pnpm/cdktf-cli@0.20.7_ink@3.2.0_react@17.0.2/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js',\r\n    '/home/rom/.local/share/pnpm/global/5/.pnpm/cdktf-cli@0.20.7_ink@3.2.0_react@17.0.2/node_modules/cdktf-cli/bundle/bin/cdktf.js',\r\n    '/home/rom/.local/share/pnpm/global/5/.pnpm/cdktf-cli@0.20.7_ink@3.2.0_react@17.0.2/node_modules/cdktf-cli/bundle/bin/cdktf'\r\n  ]\r\n}\r\n(node:529917) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.\r\n(Use `node --trace-deprecation ...` to show where the warning was created)\r\nCannot find module '../build/Release/pty.node'\r\nRequire stack:\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/prebuild-loader.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/unixTerminal.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/index.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/cdktf-cli@0.20.7_ink@3.2.0_react@17.0.2/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/cdktf-cli@0.20.7_ink@3.2.0_react@17.0.2/node_modules/cdktf-cli/bundle/bin/cdktf.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/cdktf-cli@0.20.7_ink@3.2.0_react@17.0.2/node_modules/cdktf-cli/bundle/bin/cdktf\r\nError: Cannot find module '../build/Release/pty.node'\r\nRequire stack:\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/prebuild-loader.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/unixTerminal.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/index.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/cdktf-cli@0.20.7_ink@3.2.0_react@17.0.2/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/cdktf-cli@0.20.7_ink@3.2.0_react@17.0.2/node_modules/cdktf-cli/bundle/bin/cdktf.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/cdktf-cli@0.20.7_ink@3.2.0_react@17.0.2/node_modules/cdktf-cli/bundle/bin/cdktf\r\n    at Module._resolveFilename (node:internal/modules/cjs/loader:1186:15)\r\n    at Module._load (node:internal/modules/cjs/loader:1012:27)\r\n    at Module.require (node:internal/modules/cjs/loader:1271:19)\r\n    at require (node:internal/modules/helpers:123:16)\r\n    at Object.<anonymous> (/home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/src/prebuild-loader.ts:6:9)\r\n    at Module._compile (node:internal/modules/cjs/loader:1434:14)\r\n    at Module._extensions..js (node:internal/modules/cjs/loader:1518:10)\r\n    at Module.load (node:internal/modules/cjs/loader:1249:32)\r\n    at Module._load (node:internal/modules/cjs/loader:1065:12)\r\n    at Module.require (node:internal/modules/cjs/loader:1271:19)\r\nCollecting Debug Information...\r\nnode:internal/process/promises:391\r\n    triggerUncaughtException(err, true /* fromPromise */);\r\n    ^\r\n\r\nError: Cannot find module '../build/Release/pty.node'\r\nRequire stack:\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/prebuild-loader.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/unixTerminal.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/index.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/cdktf-cli@0.20.7_ink@3.2.0_react@17.0.2/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/cdktf-cli@0.20.7_ink@3.2.0_react@17.0.2/node_modules/cdktf-cli/bundle/bin/cdktf.js\r\n- /home/rom/.local/share/pnpm/global/5/.pnpm/cdktf-cli@0.20.7_ink@3.2.0_react@17.0.2/node_modules/cdktf-cli/bundle/bin/cdktf\r\n    at Module._resolveFilename (node:internal/modules/cjs/loader:1186:15)\r\n    at Module._load (node:internal/modules/cjs/loader:1012:27)\r\n    at Module.require (node:internal/modules/cjs/loader:1271:19)\r\n    at require (node:internal/modules/helpers:123:16)\r\n    at Object.<anonymous> (/home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/src/prebuild-loader.ts:6:9)\r\n    at Module._compile (node:internal/modules/cjs/loader:1434:14)\r\n    at Module._extensions..js (node:internal/modules/cjs/loader:1518:10)\r\n    at Module.load (node:internal/modules/cjs/loader:1249:32)\r\n    at Module._load (node:internal/modules/cjs/loader:1065:12)\r\n    at Module.require (node:internal/modules/cjs/loader:1271:19) {\r\n  code: 'MODULE_NOT_FOUND',\r\n  requireStack: [\r\n    '/home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/prebuild-loader.js',\r\n    '/home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/unixTerminal.js',\r\n    '/home/rom/.local/share/pnpm/global/5/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/index.js',\r\n    '/home/rom/.local/share/pnpm/global/5/.pnpm/cdktf-cli@0.20.7_ink@3.2.0_react@17.0.2/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js',\r\n    '/home/rom/.local/share/pnpm/global/5/.pnpm/cdktf-cli@0.20.7_ink@3.2.0_react@17.0.2/node_modules/cdktf-cli/bundle/bin/cdktf.js',\r\n    '/home/rom/.local/share/pnpm/global/5/.pnpm/cdktf-cli@0.20.7_ink@3.2.0_react@17.0.2/node_modules/cdktf-cli/bundle/bin/cdktf'\r\n  ]\r\n}\r\n\r\nNode.js v22.2.0\r\n\r\n### Providers\r\n\r\n_No response_\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\n_No response_\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6CwgIQ","author":{"login":"benkeil"},"authorAssociation":"NONE","body":"That's really serious. Node 21 reached end of life.","createdAt":"2024-06-27T05:26:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3640#issuecomment-2193752592","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6J3DTh","author":{"login":"eahrend"},"authorAssociation":"NONE","body":"Yeah, this got me too. I had to downgrade to node 20.","createdAt":"2024-08-27T15:40:06Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3640#issuecomment-2312910049","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6RqfkL","author":{"login":"RomeroGaliza"},"authorAssociation":"NONE","body":"Same behaviour detected on my end.\r\n\r\nReproducible with:\r\n\r\n```\r\n$ cdktf --version\r\n0.20.9\r\n(node:13247) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.\r\n(Use `node --trace-deprecation ...` to show where the warning was created)\r\n```\r\n**Versions**\r\nlanguage: typescript\r\ncdktf-cli: 0.20.9\r\nnode: tested with 22.10.0  **and** 21.7.3\r\nterraform: 1.9.8\r\narch: amd64\r\nos: macOS 14.6.1 (23G93)\r\n\r\nThis is forcing users to rely on older node versions (20.10.0) ğŸ˜¢","createdAt":"2024-10-29T10:31:14Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3640#issuecomment-2443835659","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6SbrsR","author":{"login":"troch"},"authorAssociation":"NONE","body":"The issue is not the warning on the use of `punycode` but `Cannot find module '../build/Debug/pty.node'`.\r\n`@cdktf/node-pty-prebuilt-multiarch` does not support node 22 prebuilds, which was added to the upstream repo https://github.com/homebridge/node-pty-prebuilt-multiarch/releases/tag/v0.11.14\r\n","createdAt":"2024-11-05T09:57:48Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3640#issuecomment-2456730385","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6TBQsB","author":{"login":"ManfredLange"},"authorAssociation":"NONE","body":"I've just upgraded to node js version 22.11.0 which the most recent LTS version. I'm using CDKTF for TypeScript version 0.20.9 and Terraform version 1.9.8. My TypeScript version is 5.6.3, in case that even matters. \"@cdktf/provider-aws\" is version 19.39.0.\r\n\r\nI first got nasty runtime errors as this one, which didn't permit me to continue:\r\n\r\n```\r\ninnerError Error: Cannot find module '../build/Debug/pty.node'\r\nRequire stack:\r\n- /work/src/node_modules/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/prebuild-loader.js\r\n- /work/src/node_modules/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/unixTerminal.js\r\n- /work/src/node_modules/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/index.js\r\n- /work/src/node_modules/.pnpm/cdktf-cli@0.20.9_ink@3.2.0_react@17.0.2__react@17.0.2/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js\r\n- /work/src/node_modules/.pnpm/cdktf-cli@0.20.9_ink@3.2.0_react@17.0.2__react@17.0.2/node_modules/cdktf-cli/bundle/bin/cdktf.js\r\n- /work/src/node_modules/.pnpm/cdktf-cli@0.20.9_ink@3.2.0_react@17.0.2__react@17.0.2/node_modules/cdktf-cli/bundle/bin/cdktf\r\n    at Function._resolveFilename (node:internal/modules/cjs/loader:1249:15)\r\n    at Function._load (node:internal/modules/cjs/loader:1075:27)\r\n    at TracingChannel.traceSync (node:diagnostics_channel:315:14)\r\n    at wrapModuleLoad (node:internal/modules/cjs/loader:218:24)\r\n    at Module.require (node:internal/modules/cjs/loader:1340:12)\r\n    at require (node:internal/modules/helpers:141:16)\r\n    at Object.<anonymous> (/work/src/node_modules/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/prebuild-loader.js:10:15)\r\n    at Module._compile (node:internal/modules/cjs/loader:1546:14)\r\n    at Object..js (node:internal/modules/cjs/loader:1689:10)\r\n    at Module.load (node:internal/modules/cjs/loader:1318:32) {\r\n  code: 'MODULE_NOT_FOUND',\r\n  requireStack: [\r\n    '/work/src/node_modules/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/prebuild-loader.js',\r\n    '/work/src/node_modules/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/unixTerminal.js',\r\n    '/work/src/node_modules/.pnpm/@cdktf+node-pty-prebuilt-multiarch@0.10.1-pre.11/node_modules/@cdktf/node-pty-prebuilt-multiarch/lib/index.js',\r\n    '/work/src/node_modules/.pnpm/cdktf-cli@0.20.9_ink@3.2.0_react@17.0.2__react@17.0.2/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js',\r\n    '/work/src/node_modules/.pnpm/cdktf-cli@0.20.9_ink@3.2.0_react@17.0.2__react@17.0.2/node_modules/cdktf-cli/bundle/bin/cdktf.js',\r\n    '/work/src/node_modules/.pnpm/cdktf-cli@0.20.9_ink@3.2.0_react@17.0.2__react@17.0.2/node_modules/cdktf-cli/bundle/bin/cdktf'\r\n  ]\r\n}\r\n(node:1704) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.\r\n(Use `node --trace-deprecation ...` to show where the warning was created)\r\n```\r\n\r\nThen I deleted the `node_modules` directory and reinstalled the package dependencies with ```pnpm install``` (\"npm ci\" or \"npm install\" should work as well if you use \"npm\"). This solved the first problem, but now it's showing this warning:\r\n\r\n```\r\n(node:2937) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.\r\n(Use `node --trace-deprecation ...` to show where the warning was created)\r\n```\r\nTo me it looks as if CDKTF is somewhat behind with keeping its dependencies up-to-date....\r\n\r\nI hope the above helps others to resolve the issue as it did for me. It'd be good, though, if the dependencies could be brought up-to-date. Thank you!","createdAt":"2024-11-10T04:34:38Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3640#issuecomment-2466581249","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6YTk6w","author":{"login":"iainbrux"},"authorAssociation":"NONE","body":"Unfortunately, this error has re-presented itself.\r\n\r\nlanguage: typescript\r\ncdktf-cli: 0.20.9\r\nnode: 22.12.0\r\nterraform: 1.8.5\r\narch: amd64\r\nos: MacOS Sonoma 14.3.1","createdAt":"2024-12-19T17:27:19Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3640#issuecomment-2555268784","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6tHKGj","author":{"login":"PetteriVaarala"},"authorAssociation":"NONE","body":"This is still a problem\n\n```\nâ¯ cdktf init\ninnerError Error: Cannot find module '../build/Debug/pty.node'\n```\n\ncdktf-cli: 0.20.12\nnode: v23.6.1\nterraform: v1.11.4\narch: linux_amd64\nos: Ubuntu","createdAt":"2025-05-23T12:55:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3640#issuecomment-2904334755","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7R6p0i","author":{"login":"LozanoMatheus"},"authorAssociation":"NONE","body":"I also get the `Cannot find module '../build/Release/pty.node'` error.\n\nI tried the same approach using npm and pnpm. This seems to be particular to pnpm because I tried to install it with `npm install --global cdktf-cli@latest`, then do `npx cdktf get` (or any other cdktf command), and it works fine. I tried the same thing with pnpm, `pnpm add -g cdktf-cli@latest`, then `cdktf init --template=typescript --providers=hashicorp/terraform-provider-aws --local` (I've the PNPM_HOME + PATH variables configured), and this throws me the error. I also tried to add the cdktf-cli in the package.json and got the same result.\n\nI'm using the latest node LTS `v24.11.1` and the latest pnpm `10.19.1-oidc-test.3`. So, for now, I'll just use npm/npx till this gets solved on pnpm.","createdAt":"2025-11-12T12:57:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3640#issuecomment-3521813794","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7SCdY6","author":{"login":"johanhammar"},"authorAssociation":"NONE","body":"I wonder if the problem with `Cannot find module '../build/Release/pty.node` error has  something to do whether npm build scripts are enabled or not\n\nInstalling cdktf-cli with `npm_config_ignore_scripts=true npm install -g cdktf-cli@latest` results in\n\n```\nâ¯ cdktf init --local\ninnerError Error: Cannot find module '../build/Debug/pty.node'\n...\n```\n\nHowever, installing it with `npm_config_ignore_scripts=false npm install -g cdktf-cli@latest` works\n\n```\nâ¯ cdktf init --local --template=typescript\nNote: By supplying '--local' option you have chosen local storage mode for storing the state of your stack.\nThis means that your Terraform state file will be stored locally on disk in a file 'terraform.<STACK NAME>.tfstate' in the root of your project.\n? Project Name cdktf\n...\n```\n\nI've seen this problem before and I think that for pnpm install scripts are disabled by default for dependencies. See https://github.com/pnpm/pnpm/pull/8897\n\nWhat ignore scripts does is that it prevents any lifecycle hooks for dependencies. There's different ways of ignoring scripts, some more info at https://www.nodejs-security.com/blog/npm-ignore-scripts-best-practices-as-security-mitigation-for-malicious-packages\n","createdAt":"2025-11-12T20:46:38Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3640#issuecomment-3523860026","viewerDidAuthor":false}],"createdAt":"2024-06-04T12:37:54Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTMwNzg0MDc0","name":"priority/important-soon","description":"High priority, to be worked on as part of our current release or the following one.","color":"CC56C1"}],"milestone":null,"number":3640,"title":"DeprecationWarning: The `punycode` module is deprecated","updatedAt":"2025-11-12T20:46:38Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjU5OTc4MjYx","is_bot":false,"login":"fathom-parth","name":"Parth Doshi"},"body":"### Description\n\nHCL supports `removed` blocks which allow you to orphan a resource managed by tf easily:\r\nhttps://developer.hashicorp.com/terraform/language/resources/syntax#removing-resources\r\n\r\nIf we had something similar in cdktf, it would allow importing resources across stacks much more easily than the method [the documentation](https://developer.hashicorp.com/terraform/cdktf/examples-and-guides/refactoring#moving-resources-from-one-stack-to-another) has you use by instead using something like `removed` and `importFrom` on the cdktf objects.\r\n\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-05-29T19:11:23Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3638,"title":"removed block: orphan resources managed by cdktf/terraform","updatedAt":"2024-05-29T19:11:23Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjMzMzQxNjM=","is_bot":false,"login":"tianweiliu","name":"Tianwei Liu"},"body":"### Description\n\nAccording to issue #3458, everything under `statement` block of `aws_wafv2_rule_group` or `aws_wafv2_web_acl` has been changed to snake case instead of camel case when using cdktf via typescript.\r\n\r\nAlthough this changed was done on Jan 11, it was not reflected in any documentation. Even the newest version of the documentation still use camel case in both argument reference and examples. It seems to also breaks the hashtag based quick navigation within the page.\r\n\r\nArgument Reference in current documentation (5.51.1):\r\n>The statement` block supports the following arguments:\r\n>\r\n>[andStatement](https://registry.terraform.io/providers/hashicorp/aws/5.51.1/docs/resources/wafv2_web_acl?lang=typescript#andStatement) - (Optional) Logical rule statement used to combine other rule statements with AND logic. See [andStatement](https://registry.terraform.io/providers/hashicorp/aws/5.51.1/docs/resources/wafv2_web_acl?lang=typescript#and_statement-block) below for details.\r\n...\r\n\r\nExpected:\r\n>The statement block supports the following arguments:\r\n>\r\n>[and_statement](https://registry.terraform.io/providers/hashicorp/aws/5.51.1/docs/resources/wafv2_web_acl?lang=typescript#and_statement) - (Optional) Logical rule statement used to combine other rule statements with AND logic. See [and_statement](https://registry.terraform.io/providers/hashicorp/aws/5.51.1/docs/resources/wafv2_web_acl?lang=typescript#and_statement-block) below for details.\r\n\r\n\r\nExample in current documentation (5.51.1):\r\n```\r\nstatement: {\r\n  managedRuleGroupStatement: {\r\n    name: \"AWSManagedRulesCommonRuleSet\",\r\n    ruleActionOverride: [\r\n      {\r\n        actionToUse: {\r\n          count: {},\r\n        },\r\n        name: \"SizeRestrictions_QUERYSTRING\",\r\n      },\r\n      {\r\n        actionToUse: {\r\n          count: {},\r\n        },\r\n        name: \"NoUserAgent_HEADER\",\r\n      },\r\n    ],\r\n    scopeDownStatement: {\r\n      geoMatchStatement: {\r\n        countryCodes: [\"US\", \"NL\"],\r\n      },\r\n    },\r\n    vendorName: \"AWS\",\r\n  },\r\n},\r\n```\r\n\r\nExpected:\r\n```\r\nstatement: {\r\n  managed_rule_group_statement: {\r\n    name: \"AWSManagedRulesCommonRuleSet\",\r\n    rule_action_override: [\r\n      {\r\n        action_to_use: {\r\n          count: {},\r\n        },\r\n        name: \"SizeRestrictions_QUERYSTRING\",\r\n      },\r\n      {\r\n        action_to_use: {\r\n          count: {},\r\n        },\r\n        name: \"NoUserAgent_HEADER\",\r\n      },\r\n    ],\r\n    scope_down_statement: {\r\n      geo_match_statement: {\r\n        country_codes: [\"US\", \"NL\"],\r\n      },\r\n    },\r\n    vendor_name: \"AWS\",\r\n  },\r\n},\r\n```\n\n### Links\n\n- https://registry.terraform.io/providers/hashicorp/aws/5.51.1/docs/resources/wafv2_web_acl?lang=typescript\r\n- https://registry.terraform.io/providers/hashicorp/aws/5.51.1/docs/resources/wafv2_rule_group?lang=typescript\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6CpoMC","author":{"login":"sabinayakc"},"authorAssociation":"CONTRIBUTOR","body":"Yeah, figured out the hard way. It's a bit of a mess since one part of your code is camelCased and the other portion which are your statements are snake_cased.  For now I am using the snake_cased, with the possibility that this will break in the future if anything changes. ","createdAt":"2024-06-26T15:07:41Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3637#issuecomment-2191950594","viewerDidAuthor":false}],"createdAt":"2024-05-29T02:12:04Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3637,"title":"CDKTF: AWS WAFv2 rule statement changed to snake case, yet documentation remained in camel case","updatedAt":"2024-06-26T15:08:08Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUxMDMw","is_bot":false,"login":"infowolfe","name":"Parker"},"body":"### Expected Behavior\n\nI should be able to copy an example stanza from the provider docs and have the relevant python code generated.\n\n### Actual Behavior\n\n```\r\nAdding package @cdktf/provider-cloudflare @ 11.11.0\r\nInternal Error: unexpected array\r\nError: unexpected array\r\n    at Parser.renderAttributeType (/usr/local/lib/node_modules/cdktf-cli/node_modules/@cdktf/provider-generator/lib/get/generator/resource-parser.js:205:23)\r\n    at Parser.renderAttributesForBlock (/usr/local/lib/node_modules/cdktf-cli/node_modules/@cdktf/provider-generator/lib/get/generator/resource-parser.js:264:31)\r\n    at Parser.resourceFrom (/usr/local/lib/node_modules/cdktf-cli/node_modules/@cdktf/provider-generator/lib/get/generator/resource-parser.js:124:31)\r\n    at ResourceParser.parse (/usr/local/lib/node_modules/cdktf-cli/node_modules/@cdktf/provider-generator/lib/get/generator/resource-parser.js:466:33)\r\n    at /usr/local/lib/node_modules/cdktf-cli/node_modules/@cdktf/provider-generator/lib/get/generator/provider-generator.js:94:121\r\n    at Array.map (<anonymous>)\r\n    at TerraformProviderGenerator.buildResourceModels (/usr/local/lib/node_modules/cdktf-cli/node_modules/@cdktf/provider-generator/lib/get/generator/provider-generator.js:94:75)\r\n    at /usr/local/lib/node_modules/cdktf-cli/node_modules/@cdktf/hcl2cdk/lib/index.js:93:31\r\n    at Array.reduce (<anonymous>)\r\n    at convertToTypescript (/usr/local/lib/node_modules/cdktf-cli/node_modules/@cdktf/hcl2cdk/lib/index.js:91:79)\r\nCollecting Debug Information...\r\n/usr/local/lib/node_modules/cdktf-cli/node_modules/yoga-layout-prebuilt/yoga-layout/build/Release/nbind.js:53\r\n        throw ex;\r\n        ^\r\n\r\nError: unexpected array\r\n    at Parser.renderAttributeType (/usr/local/lib/node_modules/cdktf-cli/node_modules/@cdktf/provider-generator/lib/get/generator/resource-parser.js:205:23)\r\n    at Parser.renderAttributesForBlock (/usr/local/lib/node_modules/cdktf-cli/node_modules/@cdktf/provider-generator/lib/get/generator/resource-parser.js:264:31)\r\n    at Parser.resourceFrom (/usr/local/lib/node_modules/cdktf-cli/node_modules/@cdktf/provider-generator/lib/get/generator/resource-parser.js:124:31)\r\n    at ResourceParser.parse (/usr/local/lib/node_modules/cdktf-cli/node_modules/@cdktf/provider-generator/lib/get/generator/resource-parser.js:466:33)\r\n    at /usr/local/lib/node_modules/cdktf-cli/node_modules/@cdktf/provider-generator/lib/get/generator/provider-generator.js:94:121\r\n    at Array.map (<anonymous>)\r\n    at TerraformProviderGenerator.buildResourceModels (/usr/local/lib/node_modules/cdktf-cli/node_modules/@cdktf/provider-generator/lib/get/generator/provider-generator.js:94:75)\r\n    at /usr/local/lib/node_modules/cdktf-cli/node_modules/@cdktf/hcl2cdk/lib/index.js:93:31\r\n    at Array.reduce (<anonymous>)\r\n    at convertToTypescript (/usr/local/lib/node_modules/cdktf-cli/node_modules/@cdktf/hcl2cdk/lib/index.js:91:79) {\r\n  language: 'python',\r\n  __type: 'Internal'\r\n}\r\n\r\nNode.js v20.13.1\r\n```\n\n### Steps to Reproduce\n\n1. add cloudflare/cloudflare to your providers in a cdktf project\r\n2. copy a stanza from here: https://registry.terraform.io/providers/cloudflare/cloudflare/latest/docs/resources/record\r\n3. `pbpaste | grep -v \"^#\" | cdktf convert --language python --provider cloudflare/cloudflare`\n\n### Versions\n\nlanguage: python\r\ncdktf-cli: 0.20.7\r\nnode: v20.13.1\r\ncdktf: 0.20.7\r\nconstructs: 10.3.0\r\njsii: 1.98.0\r\nterraform: 1.8.4\r\narch: x64\r\nos: darwin 21.6.0\r\npython: Python 3.12.3\r\npip: null\r\npipenv: pipenv, version 2023.12.1\r\nproviders\r\naws@undefined (LOCAL)\r\n        terraform provider version: 5.49.0\r\ncloudflare/cloudflare@undefined (LOCAL)\r\n        terraform provider version: 4.33.0\r\ncdktf-cdktf-provider-aws (PREBUILT)\r\n        terraform provider version: 5.43.0\r\n        prebuilt provider version: 19.12.0\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-cloudflare (PREBUILT)\r\n        terraform provider version: 4.33.0\r\n        prebuilt provider version: 11.11.0\r\n        cdktf version: ^0.20.0\n\n### Providers\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€        â”€â”€     â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€\r\n Provider Name   Provider   â”‚ CDKTFâ”‚ Constraâ”‚ Package Name          Package    â”‚\r\n                Version             nt                             Version\r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€        â”€â”€     â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€\r\n aws             5.49.0     â”‚      â”‚        â”‚                                  â”‚\r\n\r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€        â”€â”€     â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€\r\n cloudflare/clou 4.33.0     â”‚      â”‚        â”‚                                  â”‚\r\nflare\r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€        â”€â”€     â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€\r\n aws             5.43.0     â”‚      â”‚        â”‚ cdktf-cdktf-provider- 19.12.0    â”‚\r\n                             ^0.20.0         ws\r\n\r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€        â”€â”€     â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€\r\n cloudflare/clou 4.33.0     â”‚      â”‚        â”‚ cdktf-cdktf-provider- 11.11.0    â”‚\r\nflare                        ^0.20.0         loudflare\r\n\r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\nâ”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€        â”€â”€     â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€\r\n\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n- https://github.com/cloudflare/terraform-provider-cloudflare/issues/3331\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-05-27T02:12:06Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"}],"milestone":null,"number":3634,"title":"cloudflare: `cdktf convert` explodes when the cloudflare/cloudflare provider is present","updatedAt":"2024-05-27T02:12:06Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUxMDMw","is_bot":false,"login":"infowolfe","name":"Parker"},"body":"### Expected Behavior\n\nPython example code is printed to the console.\r\n\r\nI was trying to figure out how to actually do concatenation since cloudflare is sloppy (their provider breaks convert completely and you can't overwrite the same fqdn because they're gluing the record + zone together behind the scenes), which required doing a `Fn.trimsuffix()`.... and there's for some reason no way in cdktf to glue the name and zone back together again.\r\n\n\n### Actual Behavior\n\nI'm redirected to a bug that @DanielMSchmidt closed #842 instead of something helpful.\r\n```\r\nAdding package @cdktf/provider-aws @ 19.20.1\r\n[2024-05-26T20:53:26.803] [ERROR] default - Found a reference that is unknown: ${var.documents_path == \"\" ? format(\"%s/%s\",path.module,\"documents\") : var.documents_path} has reference \"var.documents_path\".The id was not found in [\"local.documents_path\"] with temporary values [].\r\nPlease leave a comment at https://cdk.tf/bugs/convert-expressions if you run into this issue.\r\n[2024-05-26T20:53:26.803] [ERROR] default - Found a reference that is unknown: ${var.documents_path == \"\" ? format(\"%s/%s\",path.module,\"documents\") : var.documents_path} has reference \"var.documents_path\".The id was not found in [\"local.documents_path\"] with temporary values [].\r\nPlease leave a comment at https://cdk.tf/bugs/convert-expressions if you run into this issue.\r\nfrom constructs import Construct\r\nclass MyConvertedCode(Construct):\r\n    def __init__(self, scope, name):\r\n        super().__init__(scope, name)\r\n```\n\n### Steps to Reproduce\n\ncopy this:\r\n```\r\nlocals {\r\n documents_path = \"${var.documents_path == \"\" ? format(\"%s/%s\",path.module,\"documents\") : var.documents_path}\" \r\n}\r\n``` \r\n(pbpaste is for mac user convenience)\r\n`pbpaste | cdktf convert --language python --provider hashicorp/aws`\n\n### Versions\n\nlanguage: python\r\ncdktf-cli: 0.20.7\r\nnode: v20.13.1\r\ncdktf: 0.20.7\r\nconstructs: 10.3.0\r\njsii: 1.98.0\r\nterraform: 1.5.7\r\narch: x64\r\nos: darwin 21.6.0\r\npython: Python 3.12.3\r\npip: null\r\npipenv: pipenv, version 2023.12.1\r\nproviders\r\naws@undefined (LOCAL)\r\n        terraform provider version: 5.49.0\r\ncloudflare/cloudflare@undefined (LOCAL)\r\n        terraform provider version: 4.33.0\r\ncdktf-cdktf-provider-aws (PREBUILT)\r\n        terraform provider version: 5.43.0\r\n        prebuilt provider version: 19.12.0\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-cloudflare (PREBUILT)\r\n        terraform provider version: 4.33.0\r\n        prebuilt provider version: 11.11.0\r\n        cdktf version: ^0.20.0\n\n### Providers\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€        â”€â”€     â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€\r\n Provider Name   Provider   â”‚ CDKTFâ”‚ Constraâ”‚ Package Name          Package    â”‚\r\n                Version             nt                             Version\r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€        â”€â”€     â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€\r\n aws             5.49.0     â”‚      â”‚        â”‚                                  â”‚\r\n\r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€        â”€â”€     â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€\r\n cloudflare/clou 4.33.0     â”‚      â”‚        â”‚                                  â”‚\r\nflare\r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€        â”€â”€     â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€\r\n aws             5.43.0     â”‚      â”‚        â”‚ cdktf-cdktf-provider- 19.12.0    â”‚\r\n                             ^0.20.0         ws\r\n\r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€        â”€â”€     â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€\r\n cloudflare/clou 4.33.0     â”‚      â”‚        â”‚ cdktf-cdktf-provider- 11.11.0    â”‚\r\nflare                        ^0.20.0         loudflare\r\n\r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\nâ”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€        â”€â”€     â”€â”€â”€      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€\r\n\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n@DanielMSchmidt please do not close bugs that have url shorteners pointed at them like [https://cdk.tf/bugs/convert-expressions](https://cdk.tf/bugs/convert-expressions)\n\n### References\n\n- #842 \r\n- https://github.com/cloudflare/terraform-provider-cloudflare/issues/2407\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5_MALM","author":{"login":"nbaju1"},"authorAssociation":"NONE","body":"As I see it, the error message is correct. You are referencing something that is unknown, i.e. the variable `documents_path`. \r\n\r\nConverting this succeeds:\r\n\r\n```hcl\r\nvariable \"documents_path\" {\r\n  type        = string\r\n  description = \"The path to the documents folder\"\r\n  default     = \"test\"\r\n\r\n}\r\n\r\nlocals {\r\n  documents_path = var.documents_path == \"\" ? format(\"%s/%s\", path.module, \"documents\") : var.documents_path\r\n}\r\n```\r\n```Python\r\nclass MyConvertedCode(Construct):\r\n    def __init__(self, scope, name):\r\n        super().__init__(scope, name)\r\n        # Terraform Variables are not always the best fit for getting inputs in the context of Terraform CDK.\r\n        #     You can read more about this at https://cdk.tf/variables\r\n        documents_path = TerraformVariable(self, \"documents_path\",\r\n            default=\"test\",\r\n            description=\"The path to the documents folder\",\r\n            type=VariableType.STRING\r\n        )\r\n```","createdAt":"2024-05-27T17:17:40Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3633#issuecomment-2133852876","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5_MBQ0","author":{"login":"infowolfe"},"authorAssociation":"NONE","body":"> ```python\r\n> class MyConvertedCode(Construct):\r\n>     def __init__(self, scope, name):\r\n>         super().__init__(scope, name)\r\n>         # Terraform Variables are not always the best fit for getting inputs in the context of Terraform CDK.\r\n>         #     You can read more about this at https://cdk.tf/variables\r\n>         documents_path = TerraformVariable(self, \"documents_path\",\r\n>             default=\"test\",\r\n>             description=\"The path to the documents folder\",\r\n>             type=VariableType.STRING\r\n>         )\r\n> ```\r\n\r\nIf you review, the `format` function isn't referenced here, so it's still a failure.\r\n\r\nThe main reason for this bug is because the terraform version of format takes any number of arguments you'd like but the cdktf version does not, which means that if someone wants to figure out how to concat 2 generated values (I forget the specific terminology), think something like a cloudflare_record.name + cloudflare_zone.name... there aren't really any options to do that.","createdAt":"2024-05-27T17:22:12Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3633#issuecomment-2133857332","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5_MDf3","author":{"login":"nbaju1"},"authorAssociation":"NONE","body":"I think the issue here is that `locals` isn't being converted at all. Setting\r\n\r\n```hcl\r\nvariable \"documents_path\" {\r\n  type        = string\r\n  description = \"The path to the documents folder\"\r\n  default     = \"test\"\r\n}\r\nlocals {\r\n  documents_path = var.documents_path\r\n}\r\n```\r\n\r\nstill results in the same Python code as above. Interestingly, setting it to a static string while still keeping the variable results in an empty class.","createdAt":"2024-05-27T17:32:25Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3633#issuecomment-2133866487","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5_MEFx","author":{"login":"infowolfe"},"authorAssociation":"NONE","body":"I guess this is probably going to get backlogged then.\r\n\r\nIt's always funny when you file a bug because you can't figure out how to do something (`Fn.format()` expects 3 arguments) and run into something completely unrelated.","createdAt":"2024-05-27T17:35:10Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3633#issuecomment-2133868913","viewerDidAuthor":false}],"createdAt":"2024-05-27T01:11:49Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3633,"title":"COMPONENT: convert doesn't convert locals {}","updatedAt":"2024-05-27T17:35:11Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM4NDcyMDA0","is_bot":false,"login":"tenminus11","name":"Suraj Kanojia"},"body":"### Expected Behavior\n\nkey value pair \"ip_addddress\": \"8.8.4.4\" is missing in cdk.tf.json and cdk.hcl\r\n  ```\r\n  \"resource\": {\r\n    \"google_compute_external_vpn_gateway\": {\r\n      \"ext_vpn_gtw_vpn-ext-gw1\": {\r\n        \"//\": {\r\n          \"metadata\": {\r\n            \"path\": \"FoundationStack/ext_vpn_gtw_vpn-ext-gw1\",\r\n            \"uniqueId\": \"ext_vpn_gtw_vpn-ext-gw1\"\r\n          }\r\n        },\r\n        \"interface\": [\r\n          {\r\n            \"id\": 0,\r\n            \"ip_addddress\": \"8.8.4.4\"\r\n          }\r\n        ],\r\n        \"name\": \"vpn-ext-gw1\",\r\n        \"project\": \"vpc-host-hub\",\r\n        \"redundancy_type\": \"SINGLE_IP_INTERNALLY_REDUNDANT\"\r\n      },\r\n```\n\n### Actual Behavior\n\n  \r\n  ```\r\n  \"resource\": {\r\n    \"google_compute_external_vpn_gateway\": {\r\n      \"ext_vpn_gtw_vpn-ext-gw1\": {\r\n        \"//\": {\r\n          \"metadata\": {\r\n            \"path\": \"FoundationStack/ext_vpn_gtw_vpn-ext-gw1\",\r\n            \"uniqueId\": \"ext_vpn_gtw_vpn-ext-gw1\"\r\n          }\r\n        },\r\n        \"interface\": [\r\n          {\r\n            \"id\": 0\r\n          }\r\n        ],\r\n        \"name\": \"vpn-ext-gw1\",\r\n        \"project\": \"vpc-host-hub\",\r\n        \"redundancy_type\": \"SINGLE_IP_INTERNALLY_REDUNDANT\"\r\n      },\r\n```\n\n### Steps to Reproduce\n\nCode sample\r\n```\r\n        ComputeExternalVpnGateway(\r\n                self,\r\n                \"ext_vpn_gtw_vpn-ext-gw1\",\r\n                project=\"vpc-host-hub\",\r\n                name=\"vpn-ext-gw1\",\r\n                redundancy_type=\"SINGLE_IP_INTERNALLY_REDUNDANT\",\r\n                interface=[{\r\n                    \"id\":0,\r\n                    \"ip_address\":\"8.8.8.8\",\r\n                }],\r\n            )\r\n```\n\n### Versions\n\nlanguage: python\r\ncdktf-cli: 0.20.7\r\nnode: v20.12.2\r\ncdktf: 0.20.7\r\nconstructs: 10.3.0\r\njsii: 1.98.0\r\nterraform: 1.5.6\r\narch: x64\r\nos: linux 6.6.15-2rodete2-amd64\r\npython: Python 3.11.8\r\npip: pip 24.0 from /xxxxx/lib/python3.11/site-packages/pip (python 3.11)\r\npipenv: pipenv, version 2023.12.1\r\nproviders\r\ngoogle@~> 5.30.0 (LOCAL)\r\n        terraform provider version: 5.30.0\r\ngoogleworkspace@~> 0.7.0 (LOCAL)\r\n        terraform provider version: 0.7.0\r\ncdktf-cdktf-provider-google (PREBUILT)\r\n        terraform provider version: 5.27.0 \r\n        prebuilt provider version: 13.16.0\r\n        cdktf version: ^0.20.0\n\n### Providers\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name   â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name                â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ google          â”‚ 5.30.0           â”‚         â”‚ ~> 5.30.0  â”‚                             â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ googleworkspace â”‚ 0.7.0            â”‚         â”‚ ~> 0.7.0   â”‚                             â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ google          â”‚ 5.27.0           â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-google â”‚ 13.16.0         â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\nhttps://developer.hashicorp.com/terraform/plugin/framework/handling-data/blocks/list-nested\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5_K1Fc","author":{"login":"nbaju1"},"authorAssociation":"NONE","body":"Will work if you use the appropriate object corresponding to the interface:\r\n\r\n\r\n```Python\r\nComputeExternalVpnGateway(\r\n    self,\r\n    \"ext_vpn_gtw_vpn-ext-gw1\",\r\n    project=\"vpc-host-hub\",\r\n    name=\"vpn-ext-gw1\",\r\n    redundancy_type=\"SINGLE_IP_INTERNALLY_REDUNDANT\",\r\n    interface=[\r\n        ComputeExternalVpnGatewayInterface(\r\n            id=0,\r\n            ip_address=\"8.8.8.8\",\r\n        )\r\n    ],\r\n)\r\n```\r\n\r\n```json\r\n  \"resource\": {\r\n    \"google_compute_external_vpn_gateway\": {\r\n      \"ext_vpn_gtw_vpn-ext-gw1\": {\r\n        \"//\": {\r\n          \"metadata\": {\r\n            \"path\": \"example/ext_vpn_gtw_vpn-ext-gw1\",\r\n            \"uniqueId\": \"ext_vpn_gtw_vpn-ext-gw1\"\r\n          }\r\n        },\r\n        \"interface\": [\r\n          {\r\n            \"id\": 0,\r\n            \"ip_address\": \"8.8.8.8\"\r\n          }\r\n        ],\r\n        \"name\": \"vpn-ext-gw1\",\r\n        \"project\": \"vpc-host-hub\",\r\n        \"redundancy_type\": \"SINGLE_IP_INTERNALLY_REDUNDANT\"\r\n      }\r\n    }\r\n  },","createdAt":"2024-05-27T13:58:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3631#issuecomment-2133545308","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5_LTHa","author":{"login":"tenminus11"},"authorAssociation":"NONE","body":"Thanks a lot!\r\nIs this documented, was not able to find in documentation","createdAt":"2024-05-27T15:08:34Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3631#issuecomment-2133668314","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6rgxFt","author":{"login":"nepshshsh"},"authorAssociation":"NONE","body":"Today, I encountered a similar situation. In my case, the list was nested several levels deep, which made it quite difficult to writeâ€”especially since its necessary to present. My use case involves creating multiple resources based on a configuration files (some kind interface). While I can add validation for each nested structure, the challenge is that I'm using a Terraform provider that's still under active development. This means any changes to the provider often require time-consuming updates to my code. I'm wondering if there's a more dynamic or better approach to handle such situations?","createdAt":"2025-05-13T18:04:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3631#issuecomment-2877493613","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc618NEW","author":{"login":"tenminus11"},"authorAssociation":"NONE","body":"@nepshshsh \nkey of dic(here dic is a part of a list value) if its camelCase, then it works\nyou can pass the data nested_list_keys_to_camel fun to generate the data which you can send to **data to the resource function\n\n```\ndef camel_case(snake_str):\n    components = snake_str.split(\"_\")\n    return components[0] + \"\".join(x.title() for x in components[1:])\n\ndef nested_list_keys_to_camel(data):\n    def process_item(item, in_list=False):\n        if isinstance(item, dict):\n            new_item = {}\n            for key, value in item.items():\n                if in_list:\n                    new_key = camel_case(key)\n                else:\n                    new_key = key\n                new_item[new_key] = process_item(value, in_list)\n            return new_item\n        elif isinstance(item, list):\n            return [process_item(v, True) for v in item]\n        else:\n            return item\n\n    if not isinstance(data, dict):\n        return data\n\n    result = process_item(data)\n    return result\n```\n","createdAt":"2025-07-09T12:21:50Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3631#issuecomment-3052458262","viewerDidAuthor":false}],"createdAt":"2024-05-22T15:32:22Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3631,"title":"hcl synth: cdk.tf.json only one attribute of List Nested Block getting populated","updatedAt":"2025-07-09T12:21:50Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUxMDMw","is_bot":false,"login":"infowolfe","name":"Parker"},"body":"### Description\n\nWhen run, the python code linked below runs into an issue addressed in [terraform!30838](https://github.com/hashicorp/terraform/issues/30838)\r\n```\r\n[2024-05-19T14:13:19.104] [ERROR] default - â•·\r\nâ”‚ Error: Invalid for_each argument\r\nâ”‚\r\nâ”‚   on cdk.tf.json line 180, in resource.aws_route53_record.redacted:\r\nâ”‚  180:         \"for_each\": \"${{ for key, val in tolist(aws_acm_certificate.redacted_B0655DA5.domain_validation_options): val.domain_name => val }}\",\r\nâ”‚     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r\nâ”‚     â”‚ aws_acm_certificate.redacted_B0655DA5.domain_validation_options is set of object with 2 elements\r\nâ”‚\r\nâ”‚ The \"for_each\" map includes keys derived from resource attributes that\r\nâ”‚ cannot be determined until apply, and so Terraform cannot determine the\r\nâ”‚ full set of keys that will identify the instances of this resource.\r\nâ”‚\r\nâ”‚ When working with unknown values in for_each, it's better to define the map\r\nâ”‚ keys statically in your configuration and place apply-time results only in\r\nâ”‚ the map values.\r\nâ”‚\r\nâ”‚ Alternatively, you could use the -target planning option to first apply\r\nâ”‚ only the resources that the for_each value depends on, and then apply a\r\nâ”‚ second time to fully converge\r\n```\r\n\r\nThis is compounded by [terraform-provider-aws!33613](https://github.com/hashicorp/terraform-provider-aws/issues/33613) also having invalid example code.\n\n### Links\n\n- https://github.com/hashicorp/terraform-cdk/blob/main/website/docs/cdktf/concepts/iterators.mdx#using-iterators-on-complex-lists\r\n- https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/acm_certificate_validation?lang=python#dns-validation-with-route-53\r\n- https://github.com/hashicorp/terraform/issues/30838\r\n- https://github.com/hashicorp/terraform-provider-aws/issues/33613\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6aFfKH","author":{"login":"kerwanp"},"authorAssociation":"NONE","body":"The problem occurs aswell with the documentation given for Typescript. I've been able to make it work using the following:\r\n```ts\r\n    const iterator = TerraformIterator.fromMap(\r\n      Token.asAny(\r\n        `\\${{ for dvo in ${Fn.lookup(this.certificate, 'domain_validation_options')} : dvo.domain_name => { name = dvo.resource_record_name, record = dvo.resource_record_value, type = dvo.resource_record_type }}}`,\r\n      ),\r\n    );\r\n\r\n    const records = new Route53Record(this, 'dns-record', {\r\n      forEach: iterator,\r\n      allowOverwrite: true,\r\n      name: iterator.getString('name'),\r\n      records: [iterator.getString('record')],\r\n      type: iterator.getString('type'),\r\n      ttl: 60,\r\n      zoneId: zone.id,\r\n      provider: config.provider,\r\n    });\r\n\r\n```\r\n\r\nYou should be able to reproduce in python","createdAt":"2025-01-11T07:19:03Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3627#issuecomment-2585129607","viewerDidAuthor":false}],"createdAt":"2024-05-19T18:25:37Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3627,"title":"COMPONENT: example for iterators on complex lists","updatedAt":"2025-01-11T07:19:34Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM4NDcyMDA0","is_bot":false,"login":"tenminus11","name":"Suraj Kanojia"},"body":"### Expected Behavior\r\n\r\nfalse should come as a parameter instead it is empty in hcl, it is present in .json\r\n\"\" empty string in resource and module also fails to render\r\n0 value also fails to render in module\r\n```\r\nmodule \"prj_vpc-host-hub\" {\r\n  billing_account                = \"${var.billing_id}\"\r\n  enable_shared_vpc_host_project = false\r\n  folder_id                      = \"${google_folder.fldr_Common.name}\"\r\n  name                           = \"vpc-host-hub\"\r\n  org_id                         = \"${var.organization_id}\"\r\n  source                         = \"terraform-google-modules/project-factory/google\"\r\n  version                        = \"~> 15.0\"\r\n}\r\n```\r\n\r\n### Actual Behavior\r\n\r\n\r\n```\r\nmodule \"prj_vpc-host-hub\" {\r\n  billing_account                = \"${var.billing_id}\"\r\n  enable_shared_vpc_host_project =\r\n  folder_id                      = \"${google_folder.fldr_Common.name}\"\r\n  name                           = \"vpc-host-hub\"\r\n  org_id                         = \"${var.organization_id}\"\r\n  source                         = \"terraform-google-modules/project-factory/google\"\r\n  version                        = \"~> 15.0\"\r\n}\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n```\r\nprojects_arg = {\r\n                \"name\": project,\r\n                \"org_id\": organization_id.string_value,\r\n                \"billing_account\": billing_id.string_value,\r\n                \"enable_shared_vpc_host_project\": False,\r\n                **proj_param,\r\n            }\r\nProjectFactory(self, f\"prj_{project}\", **projects_arg)\r\n```\r\n\r\n### Versions\r\n\r\nanguage: python\r\ncdktf-cli: 0.20.7\r\nnode: v20.12.2\r\ncdktf: 0.20.7\r\nconstructs: 10.3.0\r\njsii: 1.98.0\r\nterraform: 1.5.6\r\narch: x64\r\nos: linux 6.6.15-2rodete2-amd64\r\npython: Python 3.11.8\r\npip: pip 24.0 from xxxxxxx/lib/python3.11/site-packages/pip (python 3.11)\r\npipenv: pipenv, version 2023.12.1\r\nproviders\r\ngoogle@~> 5.28.0 (LOCAL)\r\n        terraform provider version: 5.28.0\r\ncdktf-cdktf-provider-google (PREBUILT)\r\n        terraform provider version: 5.27.0 \r\n        prebuilt provider version: 13.16.0\r\n        cdktf version: ^0.20.0\r\n\r\n### Providers\r\n\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name                â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ google        â”‚ 5.28.0           â”‚         â”‚ ~> 5.28.0  â”‚                             â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ google        â”‚ 5.27.0           â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-google â”‚ 13.16.0         â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\n_No response_\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5-IsKs","author":{"login":"tenminus11"},"authorAssociation":"NONE","body":"false fails to render in module\r\n\"\" empty string fails to render in resource and module\r\n0 value also fails to render in module","createdAt":"2024-05-16T21:20:19Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3621#issuecomment-2116207276","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6FVrz8","author":{"login":"tenminus11"},"authorAssociation":"NONE","body":"@mutahhir  Thanks for fixing falsy value hcl render issue in modules\r\nI observed similar bug in locals, variable and resource\r\nresource with \"\" empty string does not render in hcl\r\nvariable default  0,false,\"\" does not render in hcl\r\nlocal with value 0,false,\"\" does not render in hcl\r\n#3673","createdAt":"2024-07-18T16:39:55Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3621#issuecomment-2237054204","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6uLjRn","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"I'm not sure what's going on here. We actually have [a test around this exact thing](https://github.com/hashicorp/terraform-cdk/blob/main/packages/cdktf/test/json-to-hcl.test.ts#L594-L642) which is passing right now. Can you give me exact reproduction steps for this?","createdAt":"2025-05-30T12:27:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3621#issuecomment-2922263655","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6yeGFA","author":{"login":"XIAOLONGLII"},"authorAssociation":"NONE","body":"Still seeing this issue.... \n(For `cdktf synth --hcl` only. `cdktf synth` works since it is generating json) \n\nCDKTF code: \n```\nnew TerraformVariable(this, \"A\", {\n  type: \"string\",\n  default: false\n});\n\nnew TerraformVariable(this, \"B\", {\n  type: \"bool\",\n  default: false\n});\n```\n\nNone of this will generate the default value, it will be no default when generated the Terraform HCL: \n\nHCL: \n ```\nvariable \"A\" {\n  type = string\n}\n\nvariable \"B\" {\n  type = bool\n}\n\n# default is not being generated\n```\n\n\n\n@mutahhir \n@tenminus11 ","createdAt":"2025-06-22T14:05:06Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3621#issuecomment-2994233664","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6yeHir","author":{"login":"XIAOLONGLII"},"authorAssociation":"NONE","body":"> I'm not sure what's going on here. We actually have [a test around this exact thing](https://github.com/hashicorp/terraform-cdk/blob/main/packages/cdktf/test/json-to-hcl.test.ts#L594-L642) which is passing right now. Can you give me exact reproduction steps for this?\n\nso at your test:\n```\n module \"test\" {\n    false_boolean = false\n    true_boolean = true\n    zero_number = 0\n    empty_string = \"\"\n    module_parameter = \"myParam\"\n    source = \"my-module\"\n    version = \"1.0\"\n    providers = {\n    test = \"test.provider1\"\n    }\n```\n\n**_So you only tested within the module_**, when it is inside of module, it will work!\n`false_boolean` will get `false` generated. \n\nHowever, when it is a standalone variable (outside of module), it won't get generated... \n\ni haven't tested the terraformlocal yet....but `TerraformVariable` for `default` definitely not working...... for the newest version: `v0.21.0` or older.","createdAt":"2025-06-22T14:15:50Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3621#issuecomment-2994239659","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6yeIqJ","author":{"login":"XIAOLONGLII"},"authorAssociation":"NONE","body":"Fixed here:\n\nhttps://github.com/hashicorp/terraform-cdk/pull/3907\n","createdAt":"2025-06-22T14:23:32Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3621#issuecomment-2994244233","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7GeSA5","author":{"login":"tenminus11"},"authorAssociation":"NONE","body":"@mutahhir @DanielMSchmidt \nAny update on this issue @XIAOLONGLII has provided a fix","createdAt":"2025-09-24T16:44:58Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3621#issuecomment-3329826873","viewerDidAuthor":false}],"createdAt":"2024-05-15T20:44:16Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMDEzOTU1NjM5","name":"needs-reproduction","description":"","color":"B29CB7"}],"milestone":null,"number":3621,"title":"cdktf: synth --hcl fails to render false(bool), 0(int), \"\"(empty string) ","updatedAt":"2025-09-24T16:44:58Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjQwNDUyNTU5","is_bot":false,"login":"mimozell","name":""},"body":"### Description\n\nTrying to understand how to work with cdktf when using a newer version of terraform. My current experience is that when doing the TF upgrade and running a cdktf deploy, I get this error:\r\n\r\n              â”‚ Error: Backend configuration changed\r\n              â”‚ \r\n              â”‚ A change in the backend configuration has been detected, which may require\r\n              â”‚ migrating existing state.\r\n              â”‚ \r\n              â”‚ If you wish to attempt automatic migration of the state, use \"terraform init\r\n              â”‚ -migrate-state\".\r\n              â”‚ If you wish to store the current configuration with no changes to the state,\r\n              â”‚ use \"terraform init -reconfigure\".\r\nIs there some way to handle this without going to each cdktf.out folder and running terraform? That is very cumbersome to do and should be handled at the cdktf stack level. In the documentation I don't see any information related to this.\n\n### Links\n\nDocs don't exist\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6CTxgo","author":{"login":"starbuggx"},"authorAssociation":"NONE","body":"I ran this command, and the migration didn't work, instead, so many resources were created.\r\ncdktf deploy --migrate-state","createdAt":"2024-06-24T10:30:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3615#issuecomment-2186221608","viewerDidAuthor":false}],"createdAt":"2024-05-06T08:39:29Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2MjkzOTA4","name":"core-parity","description":"Better experience in Terraform Core than CDKTF","color":"1A80B6"}],"milestone":null,"number":3615,"title":"COMPONENT: Running terraform --reconfigure --upgrade through cdktf","updatedAt":"2024-06-24T10:30:37Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE1OTU3Njg=","is_bot":false,"login":"woutervb","name":"Wouter van Bommel"},"body":"### Description\n\nWhen running checkov over the generated tf file(s), it's sometimes needed to skip certain checks. This normally can be done by inserting a comment line like:\r\n`#checkov:skip:CKV2_AWS_62:No need for notifications` at strategic locations in the file.\r\n\r\nFor the aws-cdk, cloudformation, the trick is to add lines like:\r\n```\r\nbucket.add_override(\"//\", {\r\n            \"checkov\": {\r\n                \"skip\": [\r\n                    {\"id\": \"CKV2_AWS_62\",\r\n                        \"comment\": \"No need for notifications\"\r\n                    }\r\n                ]\r\n            }\r\n        })\r\n```\r\n\r\nUsing this code in the terraform cdk, does inject the lines, but checkov does ignore them.\r\n\r\nIf the terraform code is generated with the `--hcl` flag, then the added override is completely ignored.\r\n\r\nSo, I'm basically asking for a way to insert skips for checkov tests that works both with either version of the synth.\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc58cJhS","author":{"login":"woutervb"},"authorAssociation":"NONE","body":"This is also discussed on the cdk.dev slack channel https://cdk-dev.slack.com/archives/C017XMM5L7N/p1714518985544069","createdAt":"2024-05-01T00:14:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3609#issuecomment-2087753810","viewerDidAuthor":false}],"createdAt":"2024-05-01T00:12:14Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3609,"title":"Add support for inline comments compatible with tools like checkov","updatedAt":"2024-05-01T00:14:34Z"},{"assignees":[],"author":{"id":"U_kgDOCf_mGQ","is_bot":false,"login":"anilkaliya123","name":""},"body":"### Expected Behavior\r\n\r\n-  I am trying to create a vpc and subnet and assign amazon-provided ipv6 to vpc. \r\n-   The second resource is subnet which uses the ipv6 cidr_block of vpc but has smaller subnet (\"/64\"). \r\n- I assumed this should have worked, since subnet is dependent on vpc, \r\n-   it should be able to read the ipv6 cidr block of vpc and truncate to /64.\r\n\r\n      \r\n      \r\n     ```\r\n    test_vpc = Vpc(\r\n                self,\r\n                \"cmc-vpc\",\r\n                cidr_block=\"10.10.0.0/16\",\r\n                enable_dns_hostnames=True,\r\n                tags={**DEFAULT_TAGS, \"Name\": f\"{stack_id}-test\"},\r\n                assign_generated_ipv6_cidr_block=true\r\n            )\r\n                  test_subnet = Subnet(\r\n                self,\r\n                \"test-subnet-external\",\r\n                tags={**DEFAULT_TAGS_CMC, \"Name\": f\"{stack_id}-test-external\"},\r\n                cidr_block=\"10.10.0.0/16\",\r\n                availability_zone=REGION_AZ_MAPPING[region][0],\r\n                vpc_id=test_vpc.id,\r\n                map_public_ip_on_launch=False,\r\n                depends_on =[cmc_vpc],\r\n                ipv6_cidr_block = test_vpc.ipv6_cidr_block.split(\"/\")[0] + \"/64\"\r\n            )\r\n```\r\n\r\n\r\n### Actual Behavior\r\n\r\n> The ipv6_cidr_block of vpc is /56 (amazon provided ipv6), \r\n> Subnet is not able to get the /64 cidr_block and it throws an error like \r\n> invalid cidr block  2600:1f18:7fb:9600::/56/64\r\n> seems like  ipv6 of subnet is getting appended with /64 , and truncation is not happening . \r\n> Any suggestion here, how can i achieve the same\r\n\r\n### Steps to Reproduce\r\n\r\n1. create stack \r\n```\r\nclass DbVpcStack(TerraformStack):\r\n    def __init__(\r\n        self,\r\n        scope: Construct,\r\n        stack_id: str,\r\n        region: str,\r\n        dbvpc_cidr_block: str,\r\n    ):\r\n        super().__init__(scope, stack_id)\r\n            test_vpc = Vpc(\r\n                self,\r\n                \"cmc-vpc\",\r\n                cidr_block=\"10.10.0.0/16\",\r\n                enable_dns_hostnames=True,\r\n                tags={**DEFAULT_TAGS, \"Name\": f\"{stack_id}-test\"},\r\n                assign_generated_ipv6_cidr_block=true\r\n            )\r\n                  test_subnet = Subnet(\r\n                self,\r\n                \"test-subnet-external\",\r\n                tags={**DEFAULT_TAGS_CMC, \"Name\": f\"{stack_id}-test-external\"},\r\n                cidr_block=\"10.10.0.0/16\",\r\n                availability_zone=REGION_AZ_MAPPING[region][0],\r\n                vpc_id=test_vpc.id,\r\n                map_public_ip_on_launch=False,\r\n                depends_on =[cmc_vpc],\r\n                ipv6_cidr_block = test_vpc.ipv6_cidr_block.split(\"/\")[0] + \"/64\"\r\n            )\r\n\r\n```\r\n\r\n2. run terrform init and terraform apply\r\n\r\n### Versions\r\n\r\n0.16.3\r\n\r\n### Providers\r\n\r\n_No response_\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\n_No response_\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5_L9v4","author":{"login":"nbaju1"},"authorAssociation":"NONE","body":"Pythonic string manipulation only happens when you synthesize the stack. The ipv6 block is resolved on deploy. You need to use the objects that corresponds with hcl string manipulation, which is resolved on deploy:\r\n\r\n```Python\r\nfrom cdktf import StringConcat, FnGenerated\r\n\r\nstr_concat = StringConcat()\r\ntest_vpc = Vpc(self, \"cmc-vpc\", cidr_block=\"10.10.0.0/16\", enable_dns_hostnames=True, assign_generated_ipv6_cidr_block=True)\r\ntest_subnet = Subnet(\r\n    self,\r\n    \"test-subnet-external\",\r\n    cidr_block=\"10.10.0.0/16\",\r\n    vpc_id=test_vpc.id,\r\n    map_public_ip_on_launch=False,\r\n    ipv6_cidr_block=str_concat.join(FnGenerated.element(FnGenerated.split(\"/\", test_vpc.ipv6_cidr_block), 0), \"/64\"),\r\n)\r\n```\r\n\r\nConverted into JSON:\r\n```json\r\n  \"resource\": {\r\n    \"aws_subnet\": {\r\n      \"test-subnet-external\": {\r\n        \"//\": {\r\n          \"metadata\": {\r\n            \"path\": \"example/test-subnet-external\",\r\n            \"uniqueId\": \"test-subnet-external\"\r\n          }\r\n        },\r\n        \"cidr_block\": \"10.10.0.0/16\",\r\n        \"ipv6_cidr_block\": \"${element(split(\\\"/\\\", aws_vpc.cmc-vpc.ipv6_cidr_block), 0)}/64\",\r\n        \"map_public_ip_on_launch\": false,\r\n        \"vpc_id\": \"${aws_vpc.cmc-vpc.id}\"\r\n      }\r\n    },\r\n    \"aws_vpc\": {\r\n      \"cmc-vpc\": {\r\n        \"//\": {\r\n          \"metadata\": {\r\n            \"path\": \"example/cmc-vpc\",\r\n            \"uniqueId\": \"cmc-vpc\"\r\n          }\r\n        },\r\n        \"assign_generated_ipv6_cidr_block\": true,\r\n        \"cidr_block\": \"10.10.0.0/16\",\r\n        \"enable_dns_hostnames\": true\r\n      }\r\n    }\r\n  },\r\n  ```","createdAt":"2024-05-27T17:07:20Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3603#issuecomment-2133842936","viewerDidAuthor":false}],"createdAt":"2024-04-23T06:31:56Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"}],"milestone":null,"number":3603,"title":"issue with referencing ipv6 cidr block in subnet","updatedAt":"2024-05-27T17:07:50Z"},{"assignees":[],"author":{"id":"U_kgDOCFQc0w","is_bot":false,"login":"shanye997","name":""},"body":"### Expected Behavior\n\ncompile successfully\n\n### Actual Behavior\n\n<img width=\"668\" alt=\"image\" src=\"https://github.com/hashicorp/terraform-cdk/assets/139730131/504a19c3-a59c-40c1-b18b-963634a26235\">\r\n\n\n### Steps to Reproduce\n\n1.  cdktf init --template=go --providers=aliyun/alicloud --local    \r\n2. cdktf get\n\n### Versions\n\ncdktf debug\r\nlanguage: go\r\ncdktf-cli: 0.20.7\r\nnode: v20.10.0\r\ncdktf: 0.20.6\r\nconstructs: 10.1.167\r\njsii: 1.95.0\r\nterraform: 1.7.5\r\narch: arm64\r\nos: darwin 23.1.0\r\ngo: go version go1.20.6 darwin/arm64\r\nproviders\r\naliyun/alicloud@~> 1.220 (LOCAL)\r\n        terraform provider version: 1.221.0\n\n### Providers\n\nalicloud-go cdktf provider list\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name   â”‚ Provider Version â”‚ CDKTF â”‚ Constraint â”‚ Package Name â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ aliyun/alicloud â”‚ 1.221.0          â”‚       â”‚ ~> 1.220   â”‚              â”‚                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc57Xiwz","author":{"login":"shanye997"},"authorAssociation":"NONE","body":"Besides, I have some problems with cdktf convert in Go version. I need to update the name of packages, structs and attributes before I use it to manage some resources. Please give me some guidance on how I can batch convert terraform templates and use them for testing.\r\nThe command I use is `cat main.tf| cdktf convert --language go  --provider hashicorp/alicloud  > main.go`\r\nThe HCL code is as followings.\r\n```\r\ndata \"alicloud_zones\" \"foo\" {\r\n  available_resource_creation = \"VSwitch\"\r\n}\r\n\r\nresource \"alicloud_vpc\" \"foo\" {\r\n  vpc_name   = \"terraform-example\"\r\n  cidr_block = \"172.16.0.0/12\"\r\n}\r\n\r\nresource \"alicloud_vswitch\" \"foo\" {\r\n  vswitch_name = \"terraform-example\"\r\n  cidr_block   = \"172.16.0.0/21\"\r\n  vpc_id       = alicloud_vpc.foo.id\r\n  zone_id      = data.alicloud_zones.foo.zones.0.id\r\n}\r\n```\r\n<img width=\"919\" alt=\"image\" src=\"https://github.com/hashicorp/terraform-cdk/assets/139730131/518bff87-e3ce-4338-8a1a-eec7df2d39a1\">\r\n","createdAt":"2024-04-22T14:56:28Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3601#issuecomment-2069769267","viewerDidAuthor":false}],"createdAt":"2024-04-22T14:54:01Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"}],"milestone":null,"number":3601,"title":"aliyun/alicloud: some compile error with resource alicloud_alb_listener","updatedAt":"2024-04-22T15:01:17Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjc1NTcwNzM=","is_bot":false,"login":"zoonage","name":"Aaron George"},"body":"### Description\n\nI'd like to be able to define a variable like this in cdktf, where `a` is optional but `b` is not.\r\n\r\n```\r\nvariable \"complex\" {\r\n  type = object({\r\n    a = optional(number, 1)\r\n    b = string\r\n  })\r\n  default = {}\r\n}\r\n```\r\n\r\nBackground context: I'm looking into cdktf adoption to try and simplify a large existing Terraform codebase.\r\n\r\nThe first area I'm looking at is removing duplicated complex variable type signatures. These can be up to ~30 lines that we manually keep in sync to work around [this issue](https://github.com/hashicorp/terraform/issues/34298). \r\n\r\nI'm planning on doing this by synthesising a bit of the module (such as specific variable definitions) by using a shared library but keeping the rest of the existing Terraform in place.\r\n\r\nHappy to try and implement this\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [X] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc57J3iS","author":{"login":"zoonage"},"authorAssociation":"NONE","body":"Happy to have a shot at implementing this. The only question I have is I'm not sure if there is a way to build a complex type for a default like\r\n\r\n```\r\n{\r\n  otel-agent = { image = \"quay.io/zoonage/otel-agent:latest\" }\r\n  some-sidecar = { image = \"quay.io/zoonage/otel-agent:latest\", resources = { cpu = 1 } }\r\n}\r\n```\r\n\r\nor if that's some extra functionality that'll be needed for this","createdAt":"2024-04-19T09:25:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3595#issuecomment-2066184338","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6Hbj6q","author":{"login":"chrcaleb"},"authorAssociation":"NONE","body":"I am extremely interested in this feature as well. I am hoping by providing the example Hashi provides for HCL [here](https://developer.hashicorp.com/terraform/language/expressions/type-constraints#example-nested-structures-with-optional-attributes-and-defaults), the complexity is less than you think. \r\n\r\nThe optional modifier takes one or two arguments.\r\n\r\nType: (Required) The first argument specifies the type of the attribute.\r\nDefault: (Optional) The second argument defines the default value that Terraform should use if the attribute is not present. This must be compatible with the attribute type. If not specified, Terraform uses a null value of the appropriate type as the default.\r\n\r\n\r\n```hcl\r\nvariable \"buckets\" {\r\n  type = list(object({\r\n    name    = string\r\n    enabled = optional(bool, true)\r\n    website = optional(object({\r\n      index_document = optional(string, \"index.html\")\r\n      error_document = optional(string, \"error.html\")\r\n      routing_rules  = optional(string)\r\n    }), {})\r\n  }))\r\n}\r\n```\r\n","createdAt":"2024-08-06T21:03:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3595#issuecomment-2272149162","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6Kcc24","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"I don't think it would be too difficult to add a simple version of this. If you look at https://github.com/hashicorp/terraform-cdk/blob/main/packages/cdktf/lib/terraform-variable.ts there are some static functions meant for building complex types. A new method for `optional` could be created as a quick version. Building better default support would take some more thought.\r\n\r\nActually using complex variables effectively within cdktf is another issue, but having basic support may help make things easier.","createdAt":"2024-08-31T01:45:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3595#issuecomment-2322714040","viewerDidAuthor":false}],"createdAt":"2024-04-19T00:51:33Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3595,"title":"COMPONENT: Add support for optional objects in variable definitions with non-trivial default values","updatedAt":"2024-08-31T01:45:29Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjY4MTE5MzM=","is_bot":false,"login":"yuriy-yarosh","name":"Yuriy Yarosh"},"body":"### Description\n\nIt would've been nice to support OpenTofu as a Terraform replacement, due to the recent Terraform licensing issue.\r\n\r\nI'm glad that tfcdk stayed Mozilla, but people need viable options, especially when HashiCorp shoot itself in the foot.\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [X] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6TS-YN","author":{"login":"commiterate"},"authorAssociation":"NONE","body":"I haven't been following the split closely but if Terraform and OpenTofu are still interchangeable, you can use the existing `TERRAFORM_BINARY_NAME` environment variable to make CDKTF use the `tofu` binary instead.\r\n\r\nhttps://developer.hashicorp.com/terraform/cdktf/create-and-deploy/environment-variables","createdAt":"2024-11-12T18:03:11Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3593#issuecomment-2471224845","viewerDidAuthor":false}],"createdAt":"2024-04-16T09:39:01Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3593,"title":"COMPONENT: opentofu support for terraform-cdk","updatedAt":"2024-11-12T20:24:58Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjIyODc1MTY2","is_bot":false,"login":"gmeligio","name":"Eligio MariÃ±o"},"body":"### Expected Behavior\n\nI expected cdktf to follow the  [cloud block documentation](https://developer.hashicorp.com/terraform/cli/cloud/settings#tf_cloud_organization) \r\n\r\n> [TF_CLOUD_ORGANIZATION](https://developer.hashicorp.com/terraform/cli/cloud/settings#tf_cloud_organization) - The name of the organization. Terraform reads this variable when organization omitted from the cloud block`. If both are specified, the configuration takes precedence.\r\n\r\nHopefully the other environment variables mentioned in those docs can be supported as well. The current list is:\r\n- [TF_CLOUD_ORGANIZATION](https://developer.hashicorp.com/terraform/cli/cloud/settings#tf_cloud_organization)\r\n- [TF_CLOUD_HOSTNAME](https://developer.hashicorp.com/terraform/cli/cloud/settings#tf_cloud_hostname)\r\n- [TF_CLOUD_PROJECT](https://developer.hashicorp.com/terraform/cli/cloud/settings#tf_cloud_project)\r\n- [TF_WORKSPACE](https://developer.hashicorp.com/terraform/cli/cloud/settings#tf_workspace)\n\n### Actual Behavior\n\nIt turns out that `organization` is a required prop for `CloudBackend`.  \r\n\r\n```log\r\nProperty 'organization' is missing in type '{ workspaces: NamedCloudWorkspace; }' but required in type 'CloudBackendConfig'.ts(2345)\r\n```\r\n\n\n### Steps to Reproduce\n\n1. Create a CloudBackend.\r\n2. Don't declare the prop `organization`.\n\n### Versions\n\ncdktf debug\r\nlanguage: typescript\r\ncdktf-cli: 0.20.6\r\nnode: v20.10.0\r\ncdktf: 0.20.6\r\nconstructs: 10.3.0\r\njsii: null\r\nterraform: 1.8.0\r\narch: x64\r\nos: linux 6.5.0-27-generic\r\nproviders\r\n@cdktf/provider-tfe (PREBUILT)\r\n        terraform provider version: 0.53.0 \r\n        prebuilt provider version: 11.2.0\r\n        cdktf version: ^0.20.0\n\n### Providers\n\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”€â”€â”€â”€â”€      â”€â”€â”€â”€â”€â”€       â”€â”€â”€   â”€â”€â”€â”€     â”€â”€â”€â”€â”€â”€â”€        â”€â”€â”€â”€â”€\r\n Provider â”‚ Provider   â”‚ CDKTF Constraâ”‚ Package Name â”‚ Package   â”‚\r\nName       Version            int                     Version \r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”€â”€â”€â”€â”€      â”€â”€â”€â”€â”€â”€       â”€â”€â”€   â”€â”€â”€â”€     â”€â”€â”€â”€â”€â”€â”€        â”€â”€â”€â”€â”€\r\n tfe      â”‚ 0.53.0     â”‚ ^0.20        â”‚ @cdktf/providâ”‚ 11.2.0    â”‚\r\n                        .0             er-tfe\r\nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\nâ”€â”€â”€â”€â”€      â”€â”€â”€â”€â”€â”€       â”€â”€â”€   â”€â”€â”€â”€     â”€â”€â”€â”€â”€â”€â”€        â”€â”€â”€â”€â”€\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n1. Set fields that are supported to be passed as environment variables to optional in the TypeScript declaration.\n\n### Workarounds\n\n1. Set organization to \"hardcoded-name-of-organization\".\n\n### Anything Else?\n\n_No response_\n\n### References\n\n- https://developer.hashicorp.com/terraform/cli/cloud/settings\n\n### Help Wanted\n\n- [X] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc56i3_a","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @gmeligio ğŸ‘‹\r\n\r\nThis probably stems from the times when the CDKTF CLI would create workspaces for you and thus required these to be set.\r\n\r\nIn the meantime you can use an override to empty the cloud block:\r\n```ts\r\nconst stack = new MyStack(app, \"test\");\r\nnew CloudBackend(stack, {organization: \"dummy\", workspaces: new NamedCloudWorkspace(\"dummy\")});\r\nstack.addOverride(\"terraform.cloud\", {organization: undefined, workspaces: undefined});\r\n```\r\nwill result in:\r\n```jsonc\r\n// ...\r\n\"terraform\": {\r\n    \"cloud\": {\r\n    }\r\n  }\r\n// ...\r\n```","createdAt":"2024-04-15T07:48:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3586#issuecomment-2055962586","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc56jSMZ","author":{"login":"gmeligio"},"authorAssociation":"CONTRIBUTOR","body":"Hi @ansgarm . Thank you so much for providing a workaround! I'll use it. ","createdAt":"2024-04-15T08:09:06Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3586#issuecomment-2056069913","viewerDidAuthor":false}],"createdAt":"2024-04-14T18:03:17Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjIzNTI1MzY0","name":"terraform cloud","description":"","color":"4ed354"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":3586,"title":"CloudBackend: support environment variables like TF_CLOUD_ORGANIZATION","updatedAt":"2024-04-15T08:09:07Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEwNDY0NDk3","is_bot":false,"login":"garysassano","name":"Gary Sassano"},"body":"### Expected Behavior\n\nCurrently, it's not possible to directly deploy your CDKTF application from the CLI if you're using the HCL output.\r\n\r\nYou're left with two options:\r\n- `cdktf deploy`, but you get JSON output\r\n- `cdktf synth --hcl` followed by `cdktf deploy --skip-synth`, but you need to use two commands\r\n\r\nIt should be possible to execute `cdktf deploy --hcl` directly.\n\n### Actual Behavior\n\nSee above.\n\n### Steps to Reproduce\n\nSee above.\n\n### Versions\n\n0.20.5\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc55u5j6","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Could you expand on why the format is important to you? The content of both versions should be the same, so if you deploy right away there should be no difference between the JSON and HCL from Terraforms point of view.","createdAt":"2024-04-08T09:56:57Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3582#issuecomment-2042337530","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc55v34w","author":{"login":"garysassano"},"authorAssociation":"NONE","body":"It would be useful for validating the resulting configuration when debugging, since HCL is easier to read for a human.","createdAt":"2024-04-08T12:15:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3582#issuecomment-2042592816","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc58MkAI","author":{"login":"oieduardorabelo"},"authorAssociation":"NONE","body":"sharing my notes here:\r\n\r\nanother thing I noticed,\r\n\r\ntools like [aquasecurity/trivy](https://github.com/aquasecurity/trivy), [aquasecurity/tfsec](https://github.com/aquasecurity/tfsec) and [bridgecrewio/checkov](https://github.com/bridgecrewio/checkov)\r\n\r\nthey all work better with HCL than with JSON\r\n\r\nin my case, i do execute `cdktf synth --hcl` and `cdktf deploy --skip-synth` separately","createdAt":"2024-04-29T21:09:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3582#issuecomment-2083667976","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6C-3Ue","author":{"login":"sescotti"},"authorAssociation":"NONE","body":"as a workaround you could use `SYNTH_HCL_OUTPUT=true cdktf deploy` as used [here](https://github.com/hashicorp/terraform-cdk/blob/4fd0a65ae698e999d3ba2590257fd770793dcf36/packages/cdktf/lib/terraform-stack.ts#L93-L94)\r\n\r\ndisclosure: in my case it doesn't work properly since it's not printing any of the attributes (json output works fine)","createdAt":"2024-06-28T19:36:53Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3582#issuecomment-2197517598","viewerDidAuthor":false}],"createdAt":"2024-04-04T11:06:37Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"}],"milestone":null,"number":3582,"title":"CLI: Missing `--hcl` option for `cdktf deploy`","updatedAt":"2024-06-28T19:37:06Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUyMDkzOTU=","is_bot":false,"login":"MartinLoeper","name":"Martin LÃ¶per"},"body":"### Description\n\nI am a fairly new cdktf user and try to add a validation condition on the env variable s.t. it can only be set to \"staging\" or \"production\". However, no matter what I try, cdktf refuses to evaluate my expression.\r\n\r\nI searched the docs and could not find any information on how to specify the condition property.\r\n\r\nWhat I expected to work:\r\n\r\n```python\r\nenv = TerraformVariable(self, \"env\", type=\"string\")\r\n\r\nenv.add_validation(\r\n    condition=f\"contains(['production', 'staging'], {env.string_value})\",\r\n    error_message=\"ERROR: Valid types are production and staging\"\r\n)\r\n```\r\n\r\nHowever, it failed with:\r\n\r\n```\r\n Error: Invalid variable validation result\r\n   â”‚ \r\n   â”‚   on cdk.tf.json line 81, in variable.env.validation[0]:\r\n   â”‚   81:           \"condition\": \"contains(['production', 'staging'], ${var.env})\",\r\n   â”‚     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r\n   â”‚     â”‚ var.env is \"staging\"\r\n   â”‚ \r\n   â”‚ Invalid validation condition result value: a bool is required.\r\n```\r\n\r\nI also tried to reference the input variable as follows:\r\n\r\n```python\r\nenv.add_validation(\r\n    condition=f\"contains(['production', 'staging'], var.env)\",\r\n    error_message=\"ERROR: Valid types are production and staging\"\r\n)\r\n```\r\n\r\n... which failed with:\r\n\r\n```\r\nâ”‚ Error: Invalid validation expression\r\n   â”‚ \r\n   â”‚   on cdk.tf.json line 81, in variable.env.validation[0]:\r\n   â”‚   81:           \"condition\": \"contains(['production', 'staging'], var.env)\",\r\n   â”‚ \r\n   â”‚ The condition expression must refer to at least one object from elsewhere in\r\n   â”‚ the configuration, or else its result would not be checking anything.\r\n\r\nâ”‚ Error: Invalid variable validation condition\r\n   â”‚ \r\n   â”‚   on cdk.tf.json line 81, in variable.env.validation[0]:\r\n   â”‚   81:           \"condition\": \"contains(['production', 'staging'], var.env)\",\r\n   â”‚ \r\n   â”‚ The condition for variable \"env\" must refer to var.env in order to test\r\n   â”‚ incoming values.\r\n```\r\n\r\nDoes not make sense to me, as I included `var.env` into the condition and it looks similar as examples in the [non-cdk docs](https://developer.hashicorp.com/terraform/language/expressions/custom-conditions#input-variable-validation).\r\n\r\nCould someone please shed some light on that topic?\n\n### Links\n\n- https://developer.hashicorp.com/terraform/cdktf/concepts/variables-and-outputs#input-variables\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5_JT48","author":{"login":"nbaju1"},"authorAssociation":"NONE","body":"If you check your resulting configuration, you see that the `condition` parameter is synthesized as a string, not a hcl boolean. \r\n \r\nEither add expression syntax to the condition string:\r\n\r\n```Python\r\nenv = TerraformVariable(self, \"env\", type=\"string\")\r\n\r\nenv.add_validation(\r\n    condition=f\"${{contains(['production', 'staging'], {env.string_value})}}\",\r\n    error_message=\"ERROR: Valid types are production and staging\"\r\n)\r\n```\r\nor use the CDKTF equivalent of the `contains` function. \r\n\r\n```Python\r\nfrom cdktf import TerraformVariable, FnGenerated\r\nenv = TerraformVariable(self, \"env\", type=\"string\")\r\n\r\nenv.add_validation(\r\n    condition=FnGenerated.contains([\"production\", \"staging\"], env.string_value),\r\n    error_message=\"ERROR: Valid types are production and staging\"\r\n)\r\n```","createdAt":"2024-05-27T10:13:16Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3571#issuecomment-2133147196","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5_Yt0s","author":{"login":"MartinLoeper"},"authorAssociation":"NONE","body":"I'll give it a try! Thanks @nbaju1 !!","createdAt":"2024-05-29T11:29:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3571#issuecomment-2137185580","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5_bkRq","author":{"login":"Saaalih2g"},"authorAssociation":"NONE","body":"Ø§Ø±Ø¬Ùˆ Ø§Ù„Ø­Ù„\r\n\r\nÙÙŠ Ø£Ø±Ø¨Ø¹Ø§Ø¡ØŒ 29 Ù…Ø§ÙŠÙˆØŒ 2024 ÙÙŠ 2:29 Ù…ØŒ ÙƒØªØ¨ Martin LÃ¶per <\r\n***@***.***>:\r\n\r\n> I'll give it a try! Thanks @nbaju1 <https://github.com/nbaju1> !!\r\n>\r\n> â€”\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/hashicorp/terraform-cdk/issues/3571#issuecomment-2137185580>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/A5IDPXF6UFP7LJARUQVRMS3ZEW3ZRAVCNFSM6AAAAABFPPVPVWVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDCMZXGE4DKNJYGA>\r\n> .\r\n> You are receiving this because you are subscribed to this thread.Message\r\n> ID: ***@***.***>\r\n>\r\n","createdAt":"2024-05-29T17:34:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"CONFUSED","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3571#issuecomment-2137932906","viewerDidAuthor":false}],"createdAt":"2024-03-30T11:45:53Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3571,"title":"TerraformVariable: unclear how to use validation conditions in python","updatedAt":"2024-05-29T17:34:27Z"},{"assignees":[],"author":{"id":"U_kgDOCUN2iQ","is_bot":false,"login":"acastlemilk","name":""},"body":"### Expected Behavior\r\n\r\nwith a `terraform.rc` as follows:\r\n\r\n```\r\nplugin_cache_may_break_dependency_lock_file = true\r\nprovider_installation {\r\n  filesystem_mirror {\r\n    path = \"<insert-some-local-path>/providers/\"\r\n    include = [\"registry.terraform.io/atlassian/tome\"]\r\n  }\r\n\r\n  direct {\r\n      exclude = [\"registry.terraform.io/atlassian/tome\"]\r\n    }\r\n}\r\n```\r\n\r\non `cdktf deploy ...` it should create the lock file during `terraform init` and proceed with deployment of resources.\r\n\r\n### Actual Behavior\r\n\r\nIt errors with:\r\n\r\n```\r\nInitializing the backend...\r\nInitializing provider plugins...\r\nFinding atlassian/tome versions matching \"1.4.7\"...\r\nUsing atlassian/tome v1.4.7 from the shared cache directory\r\nTerraform has created a lock file .terraform.lock.hcl to record the provider\r\n                            selections it made above. Include this file in your version control repository\r\n                            so that Terraform can guarantee to make the same selections by default when\r\n                            you run \"terraform init\" in the future.\r\n  â•·\r\n                            â”‚ Warning: Incomplete lock file information for providers\r\n                            â”‚ \r\n                            â”‚ Due to your customized provider installation methods, Terraform was forced to\r\n                            â”‚ calculate lock file checksums locally for the following providers:\r\n                            â”‚   - atlassian/tome\r\n                            â”‚ \r\n                            â”‚ The current .terraform.lock.hcl file only includes checksums for\r\n                            â”‚ darwin_arm64, so Terraform running on another platform will fail to install\r\n                            â”‚ these providers.\r\n                            â”‚ \r\n                            â”‚ To calculate additional checksums for another platform, run:\r\n                            â”‚   terraform providers lock -platform=linux_amd64\r\n                            â”‚ (where linux_amd64 is the platform to generate)\r\n                            â•µ\r\n                            \r\n                            Terraform has been successfully initialized!\r\n                            \r\n                            You may now begin working with Terraform. Try running \"terraform plan\" to see\r\n                            any changes that are required for your infrastructure. All Terraform commands\r\n                            should now work.\r\n\r\n                            If you ever set or change modules or backend configuration for Terraform,\r\n                            rerun this command to reinitialize your working directory. If you forget, other\r\n                            commands will detect it and remind you to do so if necessary.\r\n\r\n\r\n0 Stacks deploying     0 Stacks done     1 Stack waiting\r\n[2024-03-26T10:12:32.808] [ERROR] default - â•·\r\nâ”‚ Error: Could not retrieve providers for locking\r\nâ”‚ \r\nâ”‚ Terraform failed to fetch the requested providers for linux_amd64 in order\r\nâ”‚ to calculate their checksums: some providers could not be installed:\r\nâ”‚ - registry.terraform.io/atlassian/tome: provider registry\r\nâ”‚ registry.terraform.io does not have a provider named\r\nâ”‚ registry.terraform.io/atlassian/tome.\r\nmicros-server-capabilities  â•·\r\n                            â”‚ Error: Could not retrieve providers for locking\r\n                            â”‚ \r\n                            â”‚ Terraform failed to fetch the requested providers for linux_amd64 in order\r\n                            â”‚ to calculate their checksums: some providers could not be installed:\r\n                            â”‚ - registry.terraform.io/atlassian/tome: provider registry\r\n                            â”‚ registry.terraform.io does not have a provider named\r\n                            â”‚ registry.terraform.io/atlassian/tome.\r\n                            â•µ\r\n                           \r\n0 Stacks deploying     0 Stacks done     1 Stack waiting\r\nError: non-zero exit code 1\r\n```\r\n\r\nRe-running `cdktf deploy` then works, as the lock file now exists.\r\n\r\n### Steps to Reproduce\r\n\r\n1. use a custom/local provider with the above setup `terraform.rc`\r\n2. create a stack which uses the provider\r\n3. run `cdktf deploy` which will fail due to incomplete lock warning\r\n4. re-run `cdktf deploy` and it will work as expected\r\n\r\n### Versions\r\n\r\nlanguage: java\r\ncdktf-cli: 0.20.1\r\nnode: v21.6.0\r\ncdktf: 0.20.4\r\nconstructs: 10.3.0\r\njsii: 1.96.0\r\nterraform: 1.5.7\r\narch: arm64\r\nos: darwin 23.4.0\r\njava: \r\nmaven: [MVNVM] Using maven: 3.9.6Apache Maven 3.9.6 (bc0240f3c744dd6b6ec2920b3cd08dcc295161ae)Maven home: /Users/bebsworth/.mvnvm/apache-maven-3.9.6Java version: 21.0.1, vendor: Homebrew, runtime: /opt/homebrew/Cellar/openjdk/21.0.1/libexec/openjdk.jdk/Contents/HomeDefault locale: en_AU, platform encoding: UTF-8OS name: \"mac os x\", version: \"14.4\", arch: \"aarch64\", family: \"mac\"\r\ngradle: ------------------------------------------------------------Gradle 8.5------------------------------------------------------------Build time:   2023-11-29 14:08:57 UTCRevision:     28aca86a7180baa17117e0e5ba01d8ea9feca598Kotlin:       1.9.20Groovy:       3.0.17Ant:          Apache Ant(TM) version 1.10.13 compiled on January 4 2023JVM:          21.0.1 (Homebrew 21.0.1)OS:           Mac OS X 14.4 aarch64\r\nproviders\r\nsplunk-terraform/signalfx@undefined (LOCAL)\r\n        terraform provider version: 9.1.1\r\natlassian/tome@undefined (LOCAL)\r\n        terraform provider version: 1.4.7\r\n\r\n\r\n\r\n### Providers\r\n\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name             â”‚ Provider Version â”‚ CDKTF â”‚ Constraint â”‚ Package Name â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ splunk-terraform/signalfx â”‚ 9.1.1            â”‚       â”‚            â”‚              â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ atlassian/tome            â”‚ 1.4.7            â”‚       â”‚            â”‚              â”‚                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\nIt seems it might be taking the lock file warning from terraform init as non-empty stderr output and exiting early. Perhaps the error handling can be improve as to allow `cdktf deploy` to continue even after getting the warning about the lock file\r\n\r\n### Workarounds\r\n\r\nrunning `cdktf deploy twice` \r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\nsimilar issue in https://github.com/hashicorp/terraform/issues/32906\r\n\r\n### Help Wanted\r\n\r\n- [X] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-03-25T23:32:24Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMDEzNzM4ODIw","name":"needs-research","description":"","color":"709F22"}],"milestone":null,"number":3568,"title":"error when using local providers due to incomplete lock file","updatedAt":"2025-05-19T13:54:43Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM4OTAyNDU=","is_bot":false,"login":"elruwen","name":""},"body":"### Expected Behavior\n\nNo error message. I am not using escape sequences anywhere explicitly. I believe this is a false positive.\n\n### Actual Behavior\n\nGiven the following example application:\r\n\r\n```typescript\r\nimport {Construct} from \"constructs\";\r\nimport {App, Fn, TerraformStack, TerraformVariable} from \"cdktf\";\r\nimport {File} from \"@cdktf/provider-local/lib/file\";\r\nimport {LocalProvider} from \"@cdktf/provider-local/lib/provider\";\r\n\r\nclass MyStack extends TerraformStack {\r\n    constructor(scope: Construct, id: string) {\r\n        super(scope, id);\r\n\r\n        new LocalProvider(this, \"p\")\r\n\r\n        const myvar = new TerraformVariable(this, \"prefix\", {\r\n            type: \"string\",\r\n            default: \"rwn-\",\r\n            description: \"prefix\",\r\n        })\r\n\r\n        const resources = [\r\n            {\r\n                foo: myvar.stringValue + \"bar\",\r\n            },\r\n            {\r\n                bar: myvar.stringValue + \"foo\"\r\n            }\r\n        ]\r\n\r\n        new File(this, \"ruwen\", {\r\n            filename: `ruwen.yaml`,\r\n            content: Fn.yamlencode(resources)\r\n        })\r\n    }\r\n}\r\n\r\nconst app = new App();\r\nnew MyStack(app, \"cdktf-playground\");\r\napp.synth();\r\n```\r\nThis generates successfully the following yaml file without warnings:\r\n```yaml\r\n- \"foo\": \"rwn-bar\"\r\n- \"bar\": \"rwn-foo\"\r\n```\r\n\r\nBut if I use the result from the Fn.yamlencode in another function, I am getting an error.\r\n```typescript\r\nimport {Construct} from \"constructs\";\r\nimport {App, Fn, TerraformStack, TerraformVariable} from \"cdktf\";\r\nimport {File} from \"@cdktf/provider-local/lib/file\";\r\nimport {LocalProvider} from \"@cdktf/provider-local/lib/provider\";\r\n\r\nclass MyStack extends TerraformStack {\r\n    constructor(scope: Construct, id: string) {\r\n        super(scope, id);\r\n\r\n        new LocalProvider(this, \"p\")\r\n\r\n        const myvar = new TerraformVariable(this, \"prefix\", {\r\n            type: \"string\",\r\n            default: \"rwn-\",\r\n            description: \"prefix\",\r\n        })\r\n\r\n        const resources = [\r\n            {\r\n                foo: myvar.stringValue + \"bar\",\r\n            },\r\n            {\r\n                bar: myvar.stringValue + \"foo\"\r\n            }\r\n        ]\r\n\r\n        new File(this, \"ruwen\", {\r\n            filename: `ruwen.yaml`,\r\n            content: Fn.join(\"\", [Fn.yamlencode(resources)])\r\n        })\r\n    }\r\n}\r\n\r\nconst app = new App();\r\nnew MyStack(app, \"cdktf-playground\");\r\napp.synth();\r\n\r\n```\r\n\r\n```text\r\n[2024-03-22T11:35:57.800] [ERROR] default - You're using escape sequences (${...}) with CDKTF Built-in functions. This is not supported yet, and the output may be incorrect.\r\n\r\n[2024-03-22T11:35:57.800] [ERROR] default - yamlencode([{\"foo\" = \"${${TfToken[TOKEN.0]}}bar\"}, {\"bar\" = \"${${TfToken[TOKEN.1]}}foo\"}])\r\nYou're using escape sequences (${...}) with CDKTF Built-in functions. This is not supported yet, and the output may be incorrect.\r\nyamlencode([{\"foo\" = \"${${TfToken[TOKEN.0]}}bar\"}, {\"bar\" = \"${${TfToken[TOKEN.1]}}foo\"}])\r\n\r\n[2024-03-22T11:35:57.801] [ERROR] default - You're using escape sequences (${...}) with CDKTF Built-in functions. This is not supported yet, and the output may be incorrect.\r\nyamlencode([{\"foo\" = \"${${TfToken[TOKEN.0]}}bar\"}, {\"bar\" = \"${${TfToken[TOKEN.1]}}foo\"}])\r\n\r\n[2024-03-22T11:35:57.803] [ERROR] default - You're using escape sequences (${...}) with CDKTF Built-in functions. This is not supported yet, and the output may be incorrect.\r\nyamlencode([{\"foo\" = \"${${TfToken[TOKEN.0]}}bar\"}, {\"bar\" = \"${${TfToken[TOKEN.1]}}foo\"}])\r\n\r\n[2024-03-22T11:35:57.803] [ERROR] default - You're using escape sequences (${...}) with CDKTF Built-in functions. This is not supported yet, and the output may be incorrect.\r\nyamlencode([{\"foo\" = \"${${TfToken[TOKEN.0]}}bar\"}, {\"bar\" = \"${${TfToken[TOKEN.1]}}foo\"}])\r\n\r\n[2024-03-22T11:35:57.803] [ERROR] default - You're using escape sequences (${...}) with CDKTF Built-in functions. This is not supported yet, and the output may be incorrect.\r\n\r\n```\r\n\r\nThe file still gets generated correctly.\r\n\r\nIf I do something wrong, then the error message should point to the spot where I use Fn.join. Because the yamlencode without the join works.\r\nIf it is a false positive, then the warning shouldn't be there.\n\n### Steps to Reproduce\n\nSee above\n\n### Versions\n\ncdktf debug\r\nlanguage: typescript\r\ncdktf-cli: 0.20.4\r\nnode: v18.15.0\r\ncdktf: 0.20.5\r\nconstructs: 10.3.0\r\njsii: null\r\nterraform: 1.7.5\r\narch: x64\r\nos: linux 6.1.0-17-amd64\r\nproviders\r\n@cdktf/provider-local (PREBUILT)\r\n        terraform provider version: 2.5.1 \r\n        prebuilt provider version: 10.1.0\r\n        cdktf version: ^0.20.0\r\n\n\n### Providers\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name          â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ local         â”‚ 2.5.1            â”‚ ^0.20.0 â”‚            â”‚ @cdktf/provider-local â”‚ 10.1.0          â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc54QVAp","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"I think the root of the problem might lie in this code:\r\n\r\n```\r\n                foo: myvar.stringValue + \"bar\",\r\n```\r\n\r\nIf you were to replace this with `Fn.join(\"\", [myvar.stringValue, \"bar\"])`, and try again, does the error go away?","createdAt":"2024-03-25T09:22:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3562#issuecomment-2017546281","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc54WlbK","author":{"login":"elruwen"},"authorAssociation":"NONE","body":"That works. But I think it is a bit tedious to use. Especially when it comes to format strings. And the generated code looks good. Do you have currently cases where it doesn't work?","createdAt":"2024-03-26T00:43:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3562#issuecomment-2019186378","viewerDidAuthor":false}],"createdAt":"2024-03-22T01:09:33Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":3562,"title":"core: \"You're using escape sequences (${...}) with CDKTF Built-in functions\" - false positive?","updatedAt":"2024-03-26T00:43:44Z"},{"assignees":[],"author":{"id":"U_kgDOBnpBQA","is_bot":false,"login":"pablodmngz98","name":"Pablo Dominguez Camacho"},"body":"### Expected Behavior\r\n\r\ncdktf path shouldn't change.\r\n\r\n### Actual Behavior\r\n\r\nAfter upgrading from version 0.19.2 to version 0.20.0 the import path for cdktf has changed in main.js from:\r\n```\r\nconst _cdktf = require(\"cdktf\");\r\n```\r\nto:\r\n```\r\nconst _cdktf = require(\"../cdktf\");\r\n```\r\n\r\nError message:\r\n```\r\n[ERROR] default - node:internal/modules/cjs/loader:1080\r\n  throw err;\r\n  ^\r\n\r\nError: Cannot find module '../cdktf'\r\nRequire stack:\r\n- /../dist/full-stack/main.js\r\n    [...] {\r\n  code: 'MODULE_NOT_FOUND',\r\n  requireStack: [\r\n    '/../dist/full-stack/main.js'\r\n  ]\r\n}\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n1. npm cache clean --force\r\n2. rm -rf node_modules\r\n3. rm package-lock.json\r\n4. npm install -g cdktf-cli@0.20.0\r\n5. cdktf get\r\n6. npm install\r\n7. cdktf synth\r\n\r\n### Versions\r\n\r\nlanguage: typescript\r\ncdktf-cli: 0.20.0\r\nnode: v18.18.2\r\ncdktf: 0.19.2\r\nconstructs: null\r\njsii: null\r\nterraform: 1.7.4\r\narch: x64\r\nos: linux 6.5.0-25-generic\r\n\r\n### Providers\r\n\r\ngavinbunney/kubectl@undefined (LOCAL)         terraform provider version: 1.14.0\r\nhttp@undefined (LOCAL)                                    terraform provider version: 3.4.2\r\nloafoe/ssh@undefined (LOCAL)                          terraform provider version: 2.7.0\r\nMastercard/restapi@undefined (LOCAL)             terraform provider version: 1.19.1\r\nparagor/jks@undefined (LOCAL)                         terraform provider version: 0.8.0\r\nrandom@undefined (LOCAL)                               terraform provider version: 3.6.0\r\n","comments":[{"id":"IC_kwDODd1Amc52tjPh","author":{"login":"pablodmngz98"},"authorAssociation":"NONE","body":"## Workaround\r\nWe change the base url of the .swcrc file.\r\n`baseUrl: .` --> `baseUrl: ./dist`","createdAt":"2024-03-12T13:27:32Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3547#issuecomment-1991652321","viewerDidAuthor":false}],"createdAt":"2024-03-12T13:15:51Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMTEzNjU2OTEz","name":"language/typescript","description":"","color":"a5ccff"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":3547,"title":"Module names/import paths: issue with main.js","updatedAt":"2024-03-18T08:12:06Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjMwNTk2MTY1","is_bot":false,"login":"eahrend","name":"Erik Ahrend"},"body":"### Expected Behavior\r\n\r\nI should be able to create a replaceTriggeredBy lifecycle rule by specifying the FQN of the resource that I want to cause a replacement trigger for, like:\r\n\r\n\r\n```GO\r\n\ttriggersMap := map[string]*string{\r\n\t\t\"databases\": jsii.String(strings.Join(dbNames, \",\")), // trigger on database changes\r\n\t}\r\n\tresourceId := jsii.Sprintf(\"cloud-sql-user-%s-%s-%s-trigger\", h.ProjectName, h.Struct.Name, userName)\r\n\tuserReplacementTrigger := nr.NewResource(h.Stack, resourceId, &nr.ResourceConfig{Triggers: &triggersMap})\r\n\tlifecycle := cdktf.TerraformResourceLifecycle{\r\n\t\tReplaceTriggeredBy: &[]interface{}{\r\n\t\t\tuserReplacementTrigger.Fqn(),\r\n\t\t},\r\n\t}\r\n```\t\r\n\r\n### Actual Behavior\r\n\r\nI get an invalid expression. The cdktf.json file shows:\r\n\r\n```JSON\r\n    \"google_sql_user\": {\r\n        ###REDACTED###\r\n        \"lifecycle\": {\r\n          \"replace_triggered_by\": [\r\n            \"${null_resource.cloud-sql-user-my-instance-default-user-trigger}\"\r\n          ]\r\n        },\r\n        ###REDACTED###\r\n      },\r\n  ```\r\n\r\n### Steps to Reproduce\r\n\r\nApply the stack with the relevant code.\r\n\r\n### Versions\r\n\r\nCouldn't get the info from cdktf debug\r\n\r\nnpm list -g\r\n/Users/erik/.local/lib\r\nâ”œâ”€â”€ cdktf-cli@0.20.1\r\nâ””â”€â”€ cdktf@0.20.1\r\ngo version\r\ngo version go1.21.6 darwin/arm64\r\nterraform version\r\nTerraform v1.7.0\r\non darwin_arm64\r\nNode.js v20.11.0\r\n\r\nRunning this command fails with this error:\r\n```\r\nError: Pre-built provider information not found\r\n    at Bnr (/Users/erik/.local/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:171:2225)\r\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\r\n    at async zU (/Users/erik/.local/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:171:1716)\r\n    at async lde (/Users/erik/.local/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:171:4004)\r\n    at async /Users/erik/.local/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:176:3945\r\n    at async Promise.all (index 2)\r\n    at async Kk.allProviders (/Users/erik/.local/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:176:3854)\r\n    at async Object.L8r (/Users/erik/.local/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:551:1832)\r\n    at async JZ.handleCommand (/Users/erik/.local/lib/node_modules/cdktf-cli/bundle/bin/cdktf.js:85:887)\r\n    at async Object.handler (/Users/erik/.local/lib/node_modules/cdktf-cli/bundle/bin/cdktf.js:84:15344)\r\n```\r\n\r\n### Providers\r\n\r\nRunning this command fails with this error:\r\n```\r\nError: Pre-built provider information not found\r\n    at Bnr (/Users/erik/.local/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:171:2225)\r\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\r\n    at async zU (/Users/erik/.local/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:171:1716)\r\n    at async lde (/Users/erik/.local/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:171:4004)\r\n    at async /Users/erik/.local/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:176:3945\r\n    at async Promise.all (index 2)\r\n    at async Kk.allProviders (/Users/erik/.local/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:176:3854)\r\n    at async Object.L8r (/Users/erik/.local/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:551:1832)\r\n    at async JZ.handleCommand (/Users/erik/.local/lib/node_modules/cdktf-cli/bundle/bin/cdktf.js:85:887)\r\n    at async Object.handler (/Users/erik/.local/lib/node_modules/cdktf-cli/bundle/bin/cdktf.js:84:15344)\r\n```\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\nWorkaround is to write it like this:\r\n```GO\r\n\tlifecycle := cdktf.TerraformResourceLifecycle{\r\n\t\tReplaceTriggeredBy: &[]interface{}{\r\n\t\t\t// Workaround for https://github.com/hashicorp/terraform-cdk/issues/3196\r\n\t\t\tfmt.Sprintf(\"%s.%s\", *userReplacementTrigger.TerraformResourceType(), *userReplacementTrigger.FriendlyUniqueId()),\r\n\t\t},\r\n\t}\r\n```\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\nhttps://github.com/hashicorp/terraform-cdk/issues/3196\r\nhttps://github.com/hashicorp/terraform-cdk/issues/1866#issuecomment-1155160808\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc52lJEt","author":{"login":"TylerJGabb"},"authorAssociation":"NONE","body":"I am interested in working on this issue.","createdAt":"2024-03-11T21:08:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3546#issuecomment-1989447981","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc533tt5","author":{"login":"MWS-TAI"},"authorAssociation":"NONE","body":"I am also experiencing this issue with Python, have tried providing just the resource variable and using .fqn as [3322](https://github.com/hashicorp/terraform-cdk/pull/3322) code changes suggest. \r\n\r\nThe workaround by @eahrend seems to work \r\n```python\r\nlifecycle=TerraformResourceLifecycle(\r\n    replace_triggered_by=[\r\n        f\"{self.__redshift_namespace.terraform_resource_type}.{self.__redshift_namespace.friendly_unique_id}\",\r\n    ]\r\n)\r\n```\r\n```json\r\n\"lifecycle\": {\r\n      \"replace_triggered_by\": [\r\n          \"aws_redshiftserverless_namespace.redshift__redshift_namespace\"\r\n      ]\r\n    },\r\n```\r\n\r\nI believe the underlying issue is that the fqn property includes the hcl templating syntax as shown below in the cdktf.json when I use fqn:\r\n```python\r\nlifecycle=TerraformResourceLifecycle(\r\n    replace_triggered_by=[\r\n        f\"{self.__redshift_namespace.fqn}\",\r\n    ]\r\n)\r\n```\r\n```json\r\n\"lifecycle\": {\r\n      \"replace_triggered_by\": [\r\n          \"${aws_redshiftserverless_namespace.redshift__redshift_namespace}\"\r\n      ]\r\n    },\r\n```\r\n\r\nI am not sure if fqn including the syntax is by design, but that seems to be the underlying issue.","createdAt":"2024-03-21T02:52:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3546#issuecomment-2011093881","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6DAqjn","author":{"login":"benkeil"},"authorAssociation":"NONE","body":"any progress on this?","createdAt":"2024-06-29T05:27:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3546#issuecomment-2197989607","viewerDidAuthor":false}],"createdAt":"2024-03-11T20:54:40Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMDMwODE1NTQy","name":"language/golang","description":"","color":"22ED90"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":3546,"title":"ReplaceTriggeredBy: Still not working in Golang","updatedAt":"2024-06-29T05:27:48Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjY3NDkxNg==","is_bot":false,"login":"Danielku15","name":"Daniel Kuschny"},"body":"### Description\r\n\r\nThe cdktf-cli and components have no support for the `-refresh=false` option of terraform but we want to use it. \r\n\r\nBackground is that some providers like the one for GitHub are very slow and spend minutes over minutes in refreshing the state. We want to introduce a workflow where we regularly update our state to have it up-to-date (also via `cdktf-cli apply`) but do not do any refresh on incremental changes done as part of PRs and PR merges. \r\n\r\nWe are aware of any risks this implies.  \r\n\r\nAs an alternative we could also allow users to specify any plain parameters which should be forwarded to terraform. A typical pattern I've seen for this (dotnet, npm) would be a syntax where any arguments after a `--` are forwarded directly to the underlying executable: \r\n\r\n`npx cdktf-cli@latest apply Stack --auto-approve -- -refresh=false`\r\n\r\n### References\r\n\r\n- https://developer.hashicorp.com/terraform/cli/commands/plan#planning-options\r\n\r\n### Help Wanted\r\n\r\n- [X] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc53ZbKn","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @Danielku15 ğŸ‘‹\r\n\r\nYou should be able to use `TF_CLI_ARGS_plan=\"-refresh=false\"` which is a feature of Terraform ([docs](https://developer.hashicorp.com/terraform/cli/config/environment-variables#tf_cli_args-and-tf_cli_args_name)).","createdAt":"2024-03-18T08:07:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3539#issuecomment-2003153575","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5350tm","author":{"login":"Danielku15"},"authorAssociation":"NONE","body":"Thanks for this hint. This certainly helps as a workaround. I assume as other arguments like `--refresh-only` are also available within CDKTF directly, it is intended to allow specifying the same arguments as TF itself? ","createdAt":"2024-03-21T08:41:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3539#issuecomment-2011646822","viewerDidAuthor":false}],"createdAt":"2024-03-07T10:32:03Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"}],"milestone":null,"number":3539,"title":"CDKTF: Support `-refresh=false` on plan/diff and apply","updatedAt":"2024-03-21T08:41:26Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE0OTk3ODA=","is_bot":false,"login":"Hi-Fi","name":"Juho Saarinen"},"body":"### Expected Behavior\r\n\r\nWhen stack generated has incoming stack references, I would expect those to be correct even stack is generated with `fullSynth` (to be utilized with `toBeValidTerraform`)\r\n\r\n### Actual Behavior\r\n\r\nError:\r\n``` \r\n\"severity\": \"error\",\r\n\"summary\": \"Reference to undeclared resource\",\r\n\"detail\": \"A managed resource \\\"azurerm_container_registry\\\" \\\"acr_containerRegistry_94E5FAA8\\\" has not been declared in the root module.\",\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n1. Create 2 stacks with cross-stack reference\r\n2. Generate `testStack` that uses the value from other stack\r\n3. Create tests with `expect(fullSynth(testStack)).toBeValidTerraform();`\r\n\r\n### Versions\r\n\r\nlanguage: typescript\r\ncdktf-cli: 0.20.3\r\nnode: v18.17.1\r\ncdktf: 0.20.3\r\nconstructs: 10.3.0\r\njsii: null\r\nterraform: 1.7.4\r\narch: x64\r\nos: win32 10.0.19044\r\n\r\n### Providers\r\n\r\n``` \r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name            â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ azure/azapi   â”‚ 1.12.1           â”‚         â”‚ ~> 1.12    â”‚                         â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ azurerm       â”‚ 3.92.0           â”‚ ^0.20.0 â”‚            â”‚ @cdktf/provider-azurerm â”‚ 12.6.0          â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\nSynth should somehow be able to generate references from the code, as I at least expect fullSynth to be ~same than with CLI synth.\r\n\r\nIt could allow also multiple stacks to be done on one go, and that way to understand that there are references\r\n\r\n### Workarounds\r\n\r\nMake full synth and check those from file system:\r\n```\r\nconst app = Testing.app();\r\nconst stack = generateStack(app);\r\napp.synth();\r\nexpect(app.outdir).toBeValidTerraform();\r\n```\r\n\r\n### Anything Else?\r\n\r\nIn tests `fullSynth` currently generates \"empty\" manifest:\r\n```\r\n{\r\n  \"version\": \"stubbed\",\r\n  \"stacks\": {\r\n    \"aca\": {\r\n      \"name\": \"aca\",\r\n      \"constructPath\": \"aca\",\r\n      \"workingDirectory\": \"stacks\\\\aca\",\r\n      \"synthesizedStackPath\": \"stacks\\\\aca\\\\cdk.tf.json\",\r\n      \"stackMetadataPath\": \"stacks\\\\aca\\\\metadata.json\",\r\n      \"annotations\": [],\r\n      \"dependencies\": []\r\n    }\r\n  }\r\n}\r\n```\r\nAnd refers to that specific value like:\r\n```\r\n        \"scope\": \"${azurerm_container_registry.acr_containerRegistry_94E5FAA8.id}\"\r\n```\r\n\r\nCompared to normal `synth`, manifest has 2 stacks\r\n```\r\n{\r\n  \"version\": \"0.20.3\",\r\n  \"stacks\": {\r\n    \"acr\": {\r\n      \"name\": \"acr\",\r\n      \"constructPath\": \"acr\",\r\n      \"workingDirectory\": \"stacks\\\\acr\",\r\n      \"synthesizedStackPath\": \"stacks\\\\acr\\\\cdk.tf.json\",\r\n      \"stackMetadataPath\": \"stacks\\\\acr\\\\metadata.json\",\r\n      \"annotations\": [],\r\n      \"dependencies\": []\r\n    },\r\n    \"aca\": {\r\n      \"name\": \"aca\",\r\n      \"constructPath\": \"aca\",\r\n      \"workingDirectory\": \"stacks\\\\aca\",\r\n      \"synthesizedStackPath\": \"stacks\\\\aca\\\\cdk.tf.json\",\r\n      \"stackMetadataPath\": \"stacks\\\\aca\\\\metadata.json\",\r\n      \"annotations\": [],\r\n      \"dependencies\": [\r\n        \"acr\"\r\n      ]\r\n    }\r\n  }\r\n} \r\n```\r\nAnd reference to other stack value looks like:\r\n```\r\n\"scope\": \"${data.terraform_remote_state.cross-stack-reference-input-acr.outputs.cross-stack-output-azurerm_container_registryacr_containerRegistry_94E5FAA8id}\"\r\n\r\n```\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-03-06T10:13:33Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyNTcwMTY0OTY5","name":"testing","description":"","color":"456cc6"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":3538,"title":"Testing: fullSynth generated incorrect stack is having incoming cross-stack references","updatedAt":"2024-03-11T06:37:10Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjI2MTg4ODY3","is_bot":false,"login":"AlastairMiller","name":"Alastair Miller"},"body":"### Expected Behavior\r\n\r\nI have an cdktf app with multiple environments and providers.  The native terraform way to inject these values is by using a .tfvars file. Currently all values are stored in a single file as a single point of truth. This causes variable values that are not consumed in that stack to be flagged as undeclared.\r\n\r\nThe compact warning flag also appears to not decrease the verboseness of the warnings either?\r\n\r\n```\r\nanother-example-prod-stack  â•·\r\n                            â”‚ Warning: Value for undeclared variable\r\n                            â”‚ \r\n                            â”‚ The root module does not declare a variable named \"DEV_EXAMPLE_VARIABLE\"\r\n                            â”‚ but a value was found in file\r\n                            â”‚ \"/cdktf-undeclared-var-bug-replication/terraform.tfvars\".\r\n                            â”‚ If you meant to use this value, add a \"variable\" block to the\r\n                            â”‚ configuration.\r\n                            â”‚ \r\n                            â”‚ To silence these warnings, use TF_VAR_... environment variables to provide\r\n                            â”‚ certain \"global\" settings to all configurations in your organization. To\r\n                            â”‚ reduce the verbosity of these warnings, use the -compact-warnings option.\r\n                            â•µ\r\n                            â•·\r\n                            â”‚ Warning: Value for undeclared variable\r\n                            â”‚ \r\n                            â”‚ The root module does not declare a variable named \"PROD_EXAMPLE_VARIABLE\"\r\n                            â”‚ but a value was found in file\r\n                            â”‚ \"./cdktf-undeclared-var-bug-replication/terraform.tfvars\".\r\n                            â”‚ If you meant to use this value, add a \"variable\" block to the\r\n                            â”‚ configuration.\r\n                            â”‚ \r\n                            â”‚ To silence these warnings, use TF_VAR_... environment variables to provide\r\n                            â”‚ certain \"global\" settings to all configurations in your organization. To\r\n                            â”‚ reduce the verbosity of these warnings, use the -compact-warnings option.\r\n                            â•µ\r\n                            â•·\r\n                            â”‚ Warning: Values for undeclared variables\r\n                            â”‚ \r\n                            â”‚ In addition to the other similar warnings shown, 1 other variable(s)\r\n                            â”‚ defined without being declared.\r\n                            â•µ\r\n\r\n```\r\n\r\n\r\n### Actual Behavior\r\n\r\nThere seems to be no way to suppress this warning even using the HCL approach of explicitly defining the variables in a .tf file. This feel like an anti-pattern in CDK TF as well, as I am declaring the variables in ts.  \r\n\r\n### Steps to Reproduce\r\n\r\nI have created a minimal replication. https://github.com/AlastairMiller/cdktf-undeclared-var-bug-replication\r\n\r\n### Versions\r\n\r\nlanguage: typescript\r\ncdktf-cli: 0.20.4\r\nnode: v20.11.0\r\ncdktf: 0.20.4\r\nconstructs: 10.3.0\r\njsii: null\r\nterraform: 1.7.4\r\n\r\n\r\n### Providers\r\n\r\nN/A\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\nI assume using TF_VAR_ environment variables would resolve this, but AFAIK there is no elegant implementation in Multiplatform scenarios. I think this would involve running a prescript which would suitable permissions to set environment variables.\r\n\r\nUsing a .tfvars file per stack I suspect would also satisfy the error. Again this is not elegant as some secrets are not environment dependent so would be duplicated between files. Also not sure how scalable this is considering a stack per provider and environment.\r\n\r\n### Workarounds\r\n\r\n_No response_\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-03-04T17:49:07Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3537,"title":"cdktf: Cannot suppress undeclared variables warning without making a bad refactor","updatedAt":"2024-03-04T17:50:54Z"},{"assignees":[],"author":{"id":"U_kgDOCC1AiQ","is_bot":false,"login":"wayneslabs","name":"Wayne"},"body":"### Expected Behavior\n\nWhen a value is provided for lifecycle.replaceTriggeredBy, it should not use string interpolation in the final terraform code. \r\n\r\nFor example:\r\n```\r\n\"lifecycle\": {\r\n    \"replace_triggered_by\": [\r\n      \"google_firebaserules_ruleset.MainRuleSet\"\r\n    ]\r\n  }\r\n```\n\n### Actual Behavior\n\nCurrently, it creates a string interpolation\r\n\r\nFor example:\r\n```\r\n\"lifecycle\": {\r\n    \"replace_triggered_by\": [\r\n      \"${google_firebaserules_ruleset.MainRuleSet}\"\r\n    ]\r\n  }\r\n```\r\n\r\nThis throws an error:\r\n```\r\nâ•·\r\nâ”‚ Error: Invalid character\r\nâ”‚\r\nâ”‚   on  line 33:\r\nâ”‚   (source code not available)\r\nâ”‚\r\nâ”‚ This character is not used within the language.\r\nâ•µ\r\n\r\nâ•·\r\nâ”‚ Error: Invalid expression\r\nâ”‚\r\nâ”‚   on  line 33:\r\nâ”‚   (source code not available)\r\nâ”‚\r\nâ”‚ Expected the start of an expression, but found an invalid expression token.\r\n```\n\n### Steps to Reproduce\n\nCreate a resource with replaceTriggeredBy\r\n```\r\nlifecycle: { replaceTriggeredBy: [mainRuleSet] }\r\n```\r\n\r\nI got the error while following the steps for creating firebase rules, which requires replaceTriggeredBy: [docs](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/firebaserules_release)\n\n### Versions\n\nlanguage: typescript\r\ncdktf-cli: 0.20.4\r\nnode: v20.10.0\r\ncdktf: 0.20.4\r\nconstructs: 10.3.0\r\njsii: null\r\nterraform: 1.7.4\r\narch: x64\r\nos: MacOS Monterey\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\nCurrently, it can be solved by manually constructing it, as noted at: [issue comment](https://github.com/hashicorp/terraform-cdk/issues/3196#issuecomment-1812986423)\r\n\r\n```\r\nrelease.addOverride(\"lifecycle.replace_triggered_by\", [\r\n  mainRuleSet.terraformResourceType +\r\n    \".\" +\r\n    mainRuleSet.friendlyUniqueId,\r\n]);\r\n```\n\n### Anything Else?\n\n_No response_\n\n### References\n\n- #3196\r\n- #2082\r\n- https://github.com/hashicorp/terraform-cdk/pull/3322\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc6Cmran","author":{"login":"DJAlPee"},"authorAssociation":"NONE","body":"`replaceTriggeredBy` should behave the same way like `dependsOn`:\r\nhttps://github.com/hashicorp/terraform-cdk/blob/4fd0a65ae698e999d3ba2590257fd770793dcf36/packages/cdktf/lib/terraform-resource.ts#L160-L164\r\n\r\nvs.\r\nhttps://github.com/hashicorp/terraform-cdk/blob/4fd0a65ae698e999d3ba2590257fd770793dcf36/packages/cdktf/lib/terraform-resource.ts#L78-L88\r\n\r\nSo would changing from `return x.fqdn;` to `return dependable(x);` fix the issue?\r\nAs a workaround, I'm doing it like this in my code:\r\n```typescript\r\nimport { TerraformResource, dependable } from 'cdktf';\r\n\r\nconst monitoredResources: TerraformResource = [];\r\n\r\n// Add relevant resources to array\r\n\r\nnew ApiGatewayDeployment(this, 'service_api_deployment', {\r\n  restApiId: apiGateway.id,\r\n  lifecycle: {\r\n    replaceTriggeredBy: monitoredResources.map(dependable),\r\n  },\r\n});\r\n```","createdAt":"2024-06-26T08:58:11Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3532#issuecomment-2191177383","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6Fw8te","author":{"login":"wayneslabs"},"authorAssociation":"NONE","body":"I've confirmed that using `dependable` does work. It's also cleaner than the previous workaround I mentioned in the description above.","createdAt":"2024-07-23T03:56:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3532#issuecomment-2244201310","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6OZ0Xi","author":{"login":"kharigardner"},"authorAssociation":"NONE","body":"With Python, i've used `Token.as_any(<my_resource_instance>)` -- is this intended as the drop in since `dependable` is not available in python from what I can tell?","createdAt":"2024-10-02T16:44:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"EYES","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3532#issuecomment-2389132770","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6cSolk","author":{"login":"benkeil"},"authorAssociation":"NONE","body":"Can we fix that? Lost 30 min of my life","createdAt":"2025-01-29T16:30:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":4}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3532#issuecomment-2622130532","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6hGXIl","author":{"login":"jnawk"},"authorAssociation":"NONE","body":"Speaking about python, note that Token.as_any returns IResolvable, not ITerraformDependable (nor str), so one who cares about type checking would need a cast.\n","createdAt":"2025-03-06T04:51:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3532#issuecomment-2702799397","viewerDidAuthor":false}],"createdAt":"2024-03-03T16:34:56Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":3532,"title":"lifecycle: replaceTriggeredBy should not be a string interpolation","updatedAt":"2025-03-06T04:51:09Z"},{"assignees":[],"author":{"id":"U_kgDOBeRRDQ","is_bot":false,"login":"acwl-aiq","name":""},"body":"### Expected Behavior\n\nlocals {\r\n  x                = \"x\"\r\n  y                =  local.x\r\n}\n\n### Actual Behavior\n\nlocals {\r\n  x                = \"x\"\r\n  y                = \"${local.x}\"\r\n}\n\n### Steps to Reproduce\n\n1. Declare some local variables\r\n\r\n```\r\nx = TerraformLocal(self, \"x\", \"x\")\r\ny = TerraformLocal(self, \"y\", x.as_string)\r\n```\r\n\r\n2. Run `cdktf synth --hcl`\r\n\r\n3. Check `cdktf.out`\n\n### Versions\n\ncdktf debug\r\nlanguage: python\r\ncdktf-cli: 0.20.4\r\nnode: v21.5.0\r\ncdktf: 0.20.4\r\nconstructs: 10.3.0\r\njsii: 1.94.0\r\nterraform: 1.7.2\r\narch: x64\r\nos: linux 5.10.102.1-microsoft-standard-WSL2\r\npython: Python 3.8.10\r\npip: pip 24.0 from /home/andylai/.local/lib/python3.8/site-packages/pip (python 3.8)\r\npipenv: pipenv, version 2023.11.17\r\nproviders\r\naws@~> 4.63 (LOCAL)\r\n        terraform provider version: 4.67.0\r\ncdktf-cdktf-provider-aws (PREBUILT)\r\n        terraform provider version: 5.39.0\r\n        prebuilt provider version: 19.8.0\r\n        cdktf version: ^0.20.0\n\n### Providers\n\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name             â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ aws           â”‚ 4.67.0           â”‚         â”‚ ~> 4.63    â”‚                          â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ aws           â”‚ 5.39.0           â”‚ ^0.20.0 â”‚            â”‚ cdktf-cdktf-provider-aws â”‚ 19.8.0          â”‚\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\nHardcode the values\n\n### Anything Else?\n\nThis behaviour causes issues with the terraform linters which are blocking PRs.\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc51xn9X","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Hi there,\r\nCould you specify the \"bad syntax\" part? Wrapping this property in quotes is not necessary, but I checked the snippet and it's definitely valid.","createdAt":"2024-03-04T08:05:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3531#issuecomment-1975942999","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc54e8L2","author":{"login":"acwl-aiq"},"authorAssociation":"NONE","body":"It is still allowed for now, but it is not advised by mainstream conventions. Notably, quoted references are officially considered deprecated by Hashicorp a few years ago. And as a result, it wouldn't be ideal to continue to use such a syntax: https://discuss.hashicorp.com/t/terraform-0-12-14-released/3898\r\n\r\nThis also runs the risk of generated TF to be flagged by TF style checkers without additional intervention, which happens in my case.\r\n\r\nHere's a similar ticket cut in another project:\r\nhttps://github.com/terraform-google-modules/terraform-google-kubernetes-engine/issues/373","createdAt":"2024-03-26T20:12:00Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3531#issuecomment-2021376758","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6j-YeB","author":{"login":"OfficerKoo"},"authorAssociation":"NONE","body":"Is this gonna be fixed? I use cdktf alongside normal tf in terraform cloud and clutter in plan is really distracting.","createdAt":"2025-03-25T12:05:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3531#issuecomment-2751039361","viewerDidAuthor":false}],"createdAt":"2024-03-01T18:43:13Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":3531,"title":"[Python] `cdktf synh --hcl` produces unnecessary quotes and bad syntax","updatedAt":"2025-03-25T12:05:25Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE1ODY5MTA=","is_bot":false,"login":"sonatard","name":"sonatard"},"body":"### Description\n\nI can't find import block documents for Go.\n\n### Links\n\n- https://developer.hashicorp.com/terraform/cdktf/concepts/resources#importing-resources\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-02-28T08:53:56Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3527,"title":"cdktf-go: CDK for Terraform Go import block","updatedAt":"2024-02-28T08:53:56Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM4OTAyNDU=","is_bot":false,"login":"elruwen","name":""},"body":"### Expected Behavior\r\n\r\nGiven the following short example:\r\n\r\n```typescript\r\nimport {Construct} from \"constructs\";\r\nimport {App, Fn, TerraformStack} from \"cdktf\";\r\nimport {File} from \"@cdktf/provider-local/lib/file\";\r\nimport {LocalProvider} from \"@cdktf/provider-local/lib/provider\";\r\n\r\nclass MyStack extends TerraformStack {\r\n    constructor(scope: Construct, id: string) {\r\n        super(scope, id);\r\n\r\n\r\n        new LocalProvider(this, \"localprovider\")\r\n\r\n        new File(this, \"ruwentest\", {\r\n            filename: \"ruwentest.json\",\r\n            content: Fn.jsonencode({\r\n                    [Fn.join(\"\", [\"foo\", \"bar\"])]: \"baz\"\r\n                }\r\n            )\r\n        })\r\n\r\n    }\r\n}\r\n```\r\n\r\nI would expect to have a json file\r\n```json\r\n{\"foobar\":\"baz\"}\r\n```\r\nsince the Fn.join function should join foo and bar together.\r\n\r\nThe relevant line in the cdk json should look like this:\r\n```json\r\n\"content\": \"${jsonencode({join(\\\"\\\", [\\\"foo\\\", \\\"bar\\\"]) = \\\"baz\\\"})}\",\r\n```\r\n\r\n### Actual Behavior\r\n\r\nWhen I run cdktf synth, it is successful. But the generated json looks like this:\r\n\r\n```json\r\n{\r\n  \"resource\": {\r\n    \"local_file\": {\r\n      \"ruwentest\": {\r\n        \"//\": {\r\n          \"metadata\": {\r\n            \"path\": \"cdktf/ruwentest\",\r\n            \"uniqueId\": \"ruwentest\"\r\n          }\r\n        },\r\n        \"content\": \"${jsonencode({\\\"join(\\\"\\\", [\\\"foo\\\", \\\"bar\\\"])\\\" = undefined})}\",\r\n        \"filename\": \"ruwentest.json\"\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nWhen I run it with --hcl, it is also broken, but slightly worse:\r\n```hcl\r\nresource \"local_file\" \"ruwentest\" {\r\n  content  = \"${jsonencode({ \"join(\" \", [\" foo \", \" bar \"])\" = undefined })}\"\r\n  filename = \"ruwentest.json\"\r\n}\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n1. Create a new typescript project.\r\n2. Make sure you got the local provider installed.\r\n3. Make this the main.ts\r\n```typescript\r\nimport {Construct} from \"constructs\";\r\nimport {App, Fn, TerraformStack} from \"cdktf\";\r\nimport {File} from \"@cdktf/provider-local/lib/file\";\r\nimport {LocalProvider} from \"@cdktf/provider-local/lib/provider\";\r\n\r\nclass MyStack extends TerraformStack {\r\n    constructor(scope: Construct, id: string) {\r\n        super(scope, id);\r\n\r\n\r\n        new LocalProvider(this, \"localprovider\")\r\n\r\n        new File(this, \"ruwentest\", {\r\n            filename: \"ruwentest.json\",\r\n            content: Fn.jsonencode({\r\n                    [Fn.join(\"\", [\"foo\", \"bar\"])]: \"baz\"\r\n                }\r\n            )\r\n        })\r\n\r\n    }\r\n}\r\n\r\nconst app = new App();\r\nnew MyStack(app, \"cdktf\");\r\napp.synth();\r\n```\r\n\r\n### Versions\r\n\r\n\r\nlanguage: typescript\r\ncdktf-cli: 0.20.4\r\nnode: v18.15.0\r\ncdktf: 0.20.4\r\nconstructs: 10.3.0\r\njsii: null\r\nterraform: 1.7.2\r\narch: x64\r\nos: linux 6.1.0-17-amd64\r\nproviders\r\n@cdktf/provider-aws (PREBUILT)\r\n        terraform provider version: 5.33.0 \r\n        prebuilt provider version: 19.2.0\r\n        cdktf version: ^0.20.0\r\n@cdktf/provider-kubernetes (PREBUILT)\r\n        terraform provider version: 2.25.2 \r\n        prebuilt provider version: 11.0.0\r\n        cdktf version: ^0.20.0\r\n@cdktf/provider-local (PREBUILT)\r\n        terraform provider version: 2.4.1 \r\n        prebuilt provider version: 10.0.0\r\n        cdktf version: ^0.20.0\r\n\r\n\r\n### Providers\r\n\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name               â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ aws           â”‚ 5.33.0           â”‚ ^0.20.0 â”‚            â”‚ @cdktf/provider-aws        â”‚ 19.2.0          â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ kubernetes    â”‚ 2.25.2           â”‚ ^0.20.0 â”‚            â”‚ @cdktf/provider-kubernetes â”‚ 11.0.0          â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ local         â”‚ 2.4.1            â”‚ ^0.20.0 â”‚            â”‚ @cdktf/provider-local      â”‚ 10.0.0          â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\n_No response_\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc51xrb-","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"> I would expect to have a json file\r\n>\r\n> `{\"foobar\":\"baz\"}`\r\n\r\nThat expectation is off, by using `Fn.join` you are invoking the terraform function `join` that you can see rendered in your output. If you want `foobar` you need to use the programming language join, so e.g. `[\"foo\", \"bar\"].join(\"\")`. ","createdAt":"2024-03-04T08:12:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3525#issuecomment-1975957246","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc51y0MC","author":{"login":"elruwen"},"authorAssociation":"NONE","body":"Argh I realised I actually didn't past the error message :man_facepalming: \r\n\r\nLet me put the steps again:\r\n\r\n1. On the above typescript code, run `terraform synth`\r\n2. `cd cdktf.out/stacks/cdktf`\r\n3. `cat cdk.tf.json\r\n{\r\n  \"//\": {\r\n    \"metadata\": {\r\n      \"backend\": \"local\",\r\n      \"stackName\": \"cdktf\",\r\n      \"version\": \"0.20.4\"\r\n    },\r\n    \"outputs\": {\r\n    }\r\n  },\r\n  \"provider\": {\r\n    \"local\": [\r\n      {\r\n      }\r\n    ]\r\n  },\r\n  \"resource\": {\r\n    \"local_file\": {\r\n      \"ruwentest\": {\r\n        \"//\": {\r\n          \"metadata\": {\r\n            \"path\": \"cdktf/ruwentest\",\r\n            \"uniqueId\": \"ruwentest\"\r\n          }\r\n        },\r\n        \"content\": \"${jsonencode({\\\"join(\\\"\\\", [\\\"foo\\\", \\\"bar\\\"])\\\" = undefined})}\",\r\n        \"filename\": \"ruwentest.json\"\r\n      }\r\n    }\r\n  },\r\n  \"terraform\": {\r\n    \"backend\": {\r\n      \"local\": {\r\n        \"path\": \"xxx/cdktf/terraform.cdktf.tfstate\"\r\n      }\r\n    },\r\n    \"required_providers\": {\r\n      \"local\": {\r\n        \"source\": \"hashicorp/local\",\r\n        \"version\": \"2.4.1\"\r\n      }\r\n    }\r\n  }\r\n}`\r\n(See the undefined there?)\r\n4. `terraform apply\r\nâ•·\r\nâ”‚ Error: Missing key/value separator\r\nâ”‚ \r\nâ”‚   on cdk.tf.json line 26, in resource.local_file.ruwentest:\r\nâ”‚   26:         \"content\": \"${jsonencode({\\\"join(\\\"\\\", [\\\"foo\\\", \\\"bar\\\"])\\\" = undefined})}\",\r\nâ”‚ \r\nâ”‚ Expected an equals sign (\"=\") to mark the beginning of the attribute value.\r\nâ•µ\r\n`\r\n\r\nLet me add a bit of context:\r\n\r\nI am using cdktf as a glorified terraform code generator. I just generate the code and then use the generated terraform json in my various environments.\r\n\r\nAs part of that I am generating IAM policies from various outputs of other resources. \r\n\r\nIn general the join works. If I use Fn.join to generate the value side of a json object, it works. Just not on the keyside.\r\n\r\n```typescript\r\n        new File(this, \"ruwentest\", {\r\n            filename: \"ruwentest.json\",\r\n            content: Fn.jsonencode({\r\n                    \"baz\": [Fn.join(\"\", [\"foo\", \"bar\"])]\r\n                }\r\n            )\r\n        })\r\n```\r\nworks as expected","createdAt":"2024-03-04T10:26:36Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3525#issuecomment-1976255234","viewerDidAuthor":false}],"createdAt":"2024-02-27T11:17:10Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":3525,"title":"cdktf: computed object key leads to broken terraform code","updatedAt":"2024-03-04T10:27:33Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjU2MTY5NjA4","is_bot":false,"login":"TreehouseFalcon","name":"Juniper"},"body":"### Expected Behavior\r\n\r\nThe Tailscale Terraform provider should allow me to manage my Tailscale resources from Terraform CDK.\r\n\r\n### Actual Behavior\r\n\r\nThe resources and provider for Tailscale I have defined in my infrastructure code are completely ignored. AWS works just fine.\r\n\r\n### Steps to Reproduce\r\n\r\n1. Run `cdktf providers add tailscale/tailscale` successfully\r\n2. Add a TailscaleProvider block to the entrypoint in your code\r\n3. Add a TailscaleDeviceKey resource afterwards\r\n4. `cdktf plan` completely ignores installing the provider, doesn't recognize any of the Tailscale resources/provider, completely ignores changes to AWS resources changed at the same time?\r\n\r\n### Versions\r\n\r\ncdktf 0.20.4\r\ntailscale/tailscale 0.14\r\n\r\n### Providers\r\n\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name       â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name        â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ tailscale/tailscale â”‚ 0.14.0           â”‚         â”‚ ~> 0.14    â”‚                     â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ aws                 â”‚ 5.25.0           â”‚ ^0.19.0 â”‚            â”‚ @cdktf/provider-aws â”‚ 18.0.5          â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\nNode.js v18.16.0\r\n\r\n### Gist\r\n\r\nOutput of `cdktf debug --experimental-provider-schema-cache-path`\r\nhttps://gist.github.com/TreehouseFalcon/7bbc591f38ec86b8893580533329699f\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\nNone\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc51RdPz","author":{"login":"TreehouseFalcon"},"authorAssociation":"NONE","body":"Updated issue with attempt on 0.20.4.","createdAt":"2024-02-27T20:09:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3524#issuecomment-1967510515","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc51xpG3","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"The debug output indicates that the provider has been added to your `cdktf.json` and I would assume you have the bindings if you were able to add the provider and a resource to your config. Could you share the relevant parts of your code?","createdAt":"2024-03-04T08:08:30Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3524#issuecomment-1975947703","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc514MD8","author":{"login":"TreehouseFalcon"},"authorAssociation":"NONE","body":"@DanielMSchmidt Here is a gist showing the file setting up the AWS and Tailscale providers. The TailscaleDeviceKey resource never gets noticed by Terraform and until I delete tailscale from the .gen and purge the dist folder, no other resource changes are noticed as well. It's very odd behavior and only happens with the autogenerated Tailscale provider present. This file is part of a much larger infrastructure configuration and I won't be able to send all of the source code.\r\n\r\nhttps://gist.github.com/TreehouseFalcon/ba7362a125dbb3a24ded44f57b6e314f","createdAt":"2024-03-04T23:44:54Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3524#issuecomment-1977663740","viewerDidAuthor":false}],"createdAt":"2024-02-27T01:34:17Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTMwODE3ODU1","name":"needs-priority","description":"Issue has not yet been prioritized; this will prompt team review","color":"217A90"}],"milestone":null,"number":3524,"title":"CDKTF: Tailscale provider isn't registered","updatedAt":"2024-03-04T23:46:40Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE2MjA0NDUy","is_bot":false,"login":"benkeil","name":"Ben Keil"},"body":"### Expected Behavior\n\nWhen using a logger, the output should not be logged to stderr\n\n### Actual Behavior\n\nwith `info` logged messages where logged as errors\n\n### Steps to Reproduce\n\n// using Kotlin (Java)\r\n\r\n```kotlin\r\nprivate val logger = io.github.oshai.kotlinlogging.KotlinLogging.logger {}\r\n\r\nfun main() {\r\n    logger.info { \"Using stage: $stage\" }\r\n    val app = App()\r\n    app.synth()\r\n}\r\n```\r\n\r\nproduces\r\n\r\n```\r\n[2024-02-25T20:44:44.430] [ERROR] default - [main] INFO de.benkeil.platform.eks.Application - Using stage: sandbox\r\n```\n\n### Versions\n\nlanguage: java\r\ncdktf: 0.20.3\r\nconstructs: 10.3.0\r\nnode: v20.11.1\r\nTerraform: v1.5.7\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-02-25T19:45:21Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"}],"milestone":null,"number":3515,"title":"cdktf: when using a logger, everything gets logged as error","updatedAt":"2024-02-26T07:33:50Z"},{"assignees":[],"author":{"id":"U_kgDOCPCG2w","is_bot":false,"login":"MWS-TAI","name":"Mikey"},"body":"### Expected Behavior\n\nWhen overriding getLogicalId (get_logical_id py func) to simply return the node id (as per [3433](https://github.com/hashicorp/terraform-cdk/issues/3433)'s solution), I would expect for cross-stack output's to also have correctly formatted resource IDs just like the rest of the resources.\r\n\r\nOverride function is below:\r\n```python\r\ndef get_logical_id(self, tf_element: Union[Construct, TerraformElement]) -> str:\r\n        return tf_element.node.id\r\n```\n\n### Actual Behavior\n\nThe outputted cdk.tf.json correctly has a passable resource name, however, the following error is produced.\r\n\r\ncdk.tf.json:\r\n<img width=\"817\" alt=\"Screenshot 2024-02-20 at 1 03 08â€¯pm\" src=\"https://github.com/hashicorp/terraform-cdk/assets/149980891/54f9a795-6bd8-4bca-9739-e8901fba5a74\">\r\n\r\nterminal output:\r\n<img width=\"719\" alt=\"Screenshot 2024-02-20 at 1 02 17â€¯pm\" src=\"https://github.com/hashicorp/terraform-cdk/assets/149980891/17fec468-30d4-435b-8a63-cce540d1f4cf\">\r\n\n\n### Steps to Reproduce\n\n1. Create cross stack dependency by reference a resource from a seperate stack\r\n2. Override getLogicalId as per #4334 \r\n3. Execute a cdktf command that invokes backend initialisation (diff, deploy)\n\n### Versions\n\nlanguage: python\r\ncdktf-cli: 0.19.2\r\nnode: v21.5.0\r\ncdktf: 0.20.3\r\nconstructs: 10.3.0\r\njsii: 1.94.0\r\nterraform: 1.6.5\r\narch: arm64\r\nos: darwin 23.2.0\r\npython: Python 3.11.7\r\npip: pip 24.0 from /Users/mikeyscott/Documents/traffyk-ai-data-platform/.venv/lib/python3.11/site-packages/pip (python 3.11)\r\npipenv: null\n\n### Providers\n\ncdktf-cdktf-provider-archive (PREBUILT)\r\n        terraform provider version: 2.4.2 \r\n        prebuilt provider version: 10.0.1\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-aws (PREBUILT)\r\n        terraform provider version: 5.37.0 \r\n        prebuilt provider version: 19.6.0\r\n        cdktf version: ^0.20.0\r\ncdktf-cdktf-provider-tls (PREBUILT)\r\n        terraform provider version: 4.0.5 \r\n        prebuilt provider version: 10.0.0\r\n        cdktf version: ^0.20.0\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\nWhilst not the best solution, adding a simple if condition to return the usual allocateLogicalId where the node id contains \"cross-stack-output\" (this doesn't seem to effect the \"cross-stack-reference\" id). \r\n\r\n```python\r\ndef get_logical_id(self, tf_element: Union[Construct, TerraformElement]) -> str:\r\n        if \"cross-stack-output\" in tf_element.node.id:\r\n            return self._allocate_logical_id(tf_element)\r\n        return tf_element.node.id\r\n```\n\n### Anything Else?\n\nI am using node 21 which throws the \"untested node version warning\". I don't suspect this would cause this issue.\r\n\r\nThis is also my first issue here so please let me know if I haven't don't anything correctly.\n\n### References\n\n#3433\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc51CIMJ","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @MWS-TAI ğŸ‘‹\r\n\r\nIt seems like there are dots introduced into the name by cross stack references (which is not valid Terraform). Normally they'd be replaced by the built-in logical id logic I suppose â€“ so that would be something that would need to be replaced in your `get_logical_id` implementation.\r\n\r\nI did not test cross stack references when I looked into how to solve the outputs id request, so it seems that they require some more adjustment there.","createdAt":"2024-02-26T07:43:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3512#issuecomment-1963492105","viewerDidAuthor":false}],"createdAt":"2024-02-20T02:12:21Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":3512,"title":"Overriding getLogicalId causes disallowed characters in the cross-stack-output ID","updatedAt":"2024-02-26T07:43:15Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExODAxMDU=","is_bot":false,"login":"dhilgarth","name":"Daniel Hilgarth"},"body":"### Expected Behavior\r\n\r\nThe output of `cdktf deploy` should use all available width of my console\r\n\r\n### Actual Behavior\r\n\r\nThe output is wrapped making it unusable.\r\n\r\n![image](https://github.com/hashicorp/terraform-cdk/assets/1180105/4bc62d5e-294d-47c4-ac7d-ea05d662c862)\r\n\r\n\r\n### Steps to Reproduce\r\n\r\n1. Create a new CDKTF project and name it `docker-swarm-on-hetzner`\r\n2. Add the local file provider\r\n3. Add a local file resource, execute `cdktf deploy`\r\n4. Change the file contents, execute `cdktf deploy` again\r\n\r\n### Versions\r\n```\r\nlanguage: typescript\r\ncdktf-cli: 0.20.3\r\nnode: v20.10.0\r\ncdktf: 0.20.3\r\nconstructs: 10.3.0\r\njsii: null\r\nterraform: 1.5.3\r\narch: x64\r\nos: win32 10.0.22631\r\nproviders\r\nhetznercloud/hcloud@~> 1.45 (LOCAL)\r\n        terraform provider version: 1.45.0\r\nansible/ansible@~> 1.1 (LOCAL)\r\n        terraform provider version: 1.1.0\r\n@cdktf/provider-docker (PREBUILT)\r\n        terraform provider version: 3.0.2\r\n        prebuilt provider version: 11.0.0\r\n        cdktf version: ^0.20.0\r\n@cdktf/provider-local (PREBUILT)\r\n        terraform provider version: 2.4.1\r\n        prebuilt provider version: 10.0.0\r\n        cdktf version: ^0.20.0\r\n@cdktf/provider-tls (PREBUILT)\r\n        terraform provider version: 4.0.5\r\n        prebuilt provider version: 10.0.0\r\n        cdktf version: ^0.20.0\r\n```\r\n\r\n### Providers\r\n\r\n_No response_\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\n_No response_\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-02-18T08:34:40Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3503,"title":"CLI: Fixed width output on deploy is unusable","updatedAt":"2024-02-18T08:43:21Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjY1NTI1MjE=","is_bot":false,"login":"klemmchr","name":"Christian Klemm"},"body":"### Description\n\n`local-exec` allows to set the [failure behavior](https://developer.hashicorp.com/terraform/language/resources/provisioners/syntax#failure-behavior). Adding support for this would be great.\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc50WGxP","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @klemmchr ğŸ‘‹\r\n\r\nThank you for raising this! Until we add support for this, you can use an override to set this attribute:\r\n\r\n```ts\r\n    const pwd = new Password(this, \"password\", {length: 12});\r\n    pwd.provisioners = [{\r\n      type: 'local-exec',\r\n      command: `echo \"The generated password is ${pwd.result}\"`,\r\n    }];\r\n\r\n    pwd.addOverride(\"provisioner.0.on_failure\", \"continue\");\r\n```","createdAt":"2024-02-19T08:40:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3502#issuecomment-1951951951","viewerDidAuthor":false}],"createdAt":"2024-02-18T03:28:27Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwODE3ODU1","name":"needs-priority","description":"Issue has not yet been prioritized; this will prompt team review","color":"217A90"}],"milestone":null,"number":3502,"title":"cdktf: add support for on_failure for local exec provider","updatedAt":"2024-02-19T08:40:16Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE5ODEwMDg2","is_bot":false,"login":"tpanza","name":""},"body":"### Expected Behavior\n\nPython bindings for prebuilt providers can be installed from non-standard locations.\r\n\r\nFor example, if you are in a corporate environment and cannot access pypi.org directly and must go through a proxy/mirror of it, such as JFrog Artifactory or Sonatype Nexus, then users would typically write a `~/.config/pip/pip.conf` or set `PIP_INDEX_URL` environment variable. Users may also want to [set `PIPENV_PYPI_MIRROR` environment variable](https://pipenv.pypa.io/en/latest/indexes.html#using-a-pypi-mirror).\r\n\r\nOnce these custom config files / env vars are set, then Python packages for bindings for prebuilt providers, such as `cdktf-cdktf-provider-docker` should use the package manager's custom configuration. It should not attempt to contact `pypi.org`.\n\n### Actual Behavior\n\nWith both `python` and `python-pip` Python templates, the Python bindings for prebuilt providers are attempted to be downloaded from `pypi.org`, even though `PIP_INDEX_URL` and `PIPENV_PYPI_MIRROR` are set to point to a custom proxy.\n\n### Steps to Reproduce\n\n1. Set  `PIP_INDEX_URL` and `PIPENV_PYPI_MIRROR` env vars to point to an internal mirror of `pypi.org`. E.g., `export PIP_INDEX_URL =https://nexus.example.com/repository/pypi/simple`\r\n2. Attempt to init a project with a Python template. E.g., `cdktf init --template=python-pip --providers=kreuzwerker/docker --local`\n\n### Versions\n\n[2024-02-17T02:47:56.034] [ERROR] default - Creating a virtualenv for this project...\r\n\r\nCreating a virtualenv for this project...\r\n[2024-02-17T02:47:56.054] [ERROR] default - Pipfile: /home/ec2-user/Pipfile\r\n\r\nPipfile: /home/ec2-user/Pipfile\r\n[2024-02-17T02:47:56.074] [ERROR] default - Using /usr/bin/python3 (3.9.16) to create virtualenv...\r\n\r\nUsing /usr/bin/python3 (3.9.16) to create virtualenv...\r\n[2024-02-17T02:47:56.513] [ERROR] default - created virtual environment CPython3.9.16.final.0-64 in 207ms\r\n  creator CPython3Posix(dest=/home/ec2-user/.local/share/virtualenvs/ec2-user-zzkNbF-x, clear=False, no_vcs_ignore=False, global=False)\r\n  seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/home/ec2-user/.local/share/virtualenv)\r\n    added seed packages: pip==23.3.1, setuptools==69.0.2, wheel==0.42.0\r\n  activators BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator\r\n\r\nâœ” Successfully created virtual environment!\r\n\r\ncreated virtual environment CPython3.9.16.final.0-64 in 207ms\r\n  creator CPython3Posix(dest=/home/ec2-user/.local/share/virtualenvs/ec2-user-zzkNbF-x, clear=False, no_vcs_ignore=False, global=False)\r\n  seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/home/ec2-user/.local/share/virtualenv)\r\n    added seed packages: pip==23.3.1, setuptools==69.0.2, wheel==0.42.0\r\n  activators BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator\r\n\r\nâœ” Successfully created virtual environment!\r\n[2024-02-17T02:47:56.552] [ERROR] default - Virtualenv location: /home/ec2-user/.local/share/virtualenvs/ec2-user-zzkNbF-x\r\n\r\nVirtualenv location: /home/ec2-user/.local/share/virtualenvs/ec2-user-zzkNbF-x\r\n[2024-02-17T02:47:57.385] [ERROR] default - WARNING: Package(s) not found: cdktf\r\n\r\nWARNING: Package(s) not found: cdktf\r\n[2024-02-17T02:48:02.834] [ERROR] default - WARNING: Package(s) not found: cdktf\r\n\r\nWARNING: Package(s) not found: cdktf\r\n[2024-02-17T02:48:02.842] [ERROR] default - WARNING: Package(s) not found: jsii\r\n\r\nWARNING: Package(s) not found: jsii\r\n[2024-02-17T02:48:02.856] [ERROR] default - WARNING: Package(s) not found: constructs\r\n\r\nWARNING: Package(s) not found: constructs\r\ncdktf debug\r\nlanguage: python\r\ncdktf-cli: 0.20.3\r\nnode: v18.17.1\r\ncdktf: 0.20.3\r\nconstructs: 10.3.0\r\njsii: 1.93.0\r\nterraform: 1.7.3\r\narch: x64\r\nos: linux 6.1.49-70.116.amzn2023.x86_64\r\npython: Python 3.9.16\r\npip: pip 23.3.2 from /home/ec2-user/.local/lib/python3.9/site-packages/pip (python 3.9)\r\npipenv: pipenv, version 2023.12.0\r\nproviders\r\n\n\n### Providers\n\n[2024-02-17T02:49:16.801] [ERROR] default - WARNING: Package(s) not found: cdktf\r\n\r\nWARNING: Package(s) not found: cdktf\r\nâ”Œâ”\r\nâ”‚â”‚\r\nâ””â”˜\r\n\n\n### Gist\n\nhttps://gist.github.com/tpanza/7160a0b21a5fb48799225757c60067d1\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc50NTJc","author":{"login":"tpanza"},"authorAssociation":"NONE","body":"This line might be the issue:\r\n\r\nhttps://github.com/hashicorp/terraform-cdk/blob/main/packages/%40cdktf/cli-core/src/lib/dependencies/package-manager.ts#L343\r\n\r\nLooks like it is always hard-coded to use `pypi.org`.\r\n\r\nBut there is another complication. AFAIK, on both Artifactory and Nexus, a pypi-typed repository that proxies to pypi.org will _not_ necessarily expose the [PyPI's JSON API endpoints](https://warehouse.pypa.io/api-reference/json.html).\r\n\r\nAll we get is the _index_ itself. E.g., `https://artifactory.example.com/artifactory/api/pypi/pypi-releases/simple` and `https://nexus.example.com/repository/pypi/simple`\r\n\r\nFurthermore, `pip search` is deprecated and [will not work on proxied repositories](https://help.sonatype.com/en/pypi-repositories.html#browsing-pypi-repositories-and-searching-packages). Ideally, this would be resolved by just calling `pip` (which would then pick up whatever custom config exists).\r\n\r\nAt the moment, however, it appears that this piece of cdktf is architected to make low-level `GET` requests to the PyPI JSON API endpoints.","createdAt":"2024-02-17T04:33:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3501#issuecomment-1949643356","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc50NUdh","author":{"login":"tpanza"},"authorAssociation":"NONE","body":"Maybe something like `pip install --dry-run ${packageName}==${packageVersion} --report -` ?","createdAt":"2024-02-17T04:56:54Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3501#issuecomment-1949648737","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc503CVl","author":{"login":"tpanza"},"authorAssociation":"NONE","body":"Any thoughts on this? Would you accept a PR that solves this?","createdAt":"2024-02-23T00:48:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3501#issuecomment-1960584549","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc58GgW0","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Sorry for the late reply, we would accept a PR that solves this ğŸ‘ ","createdAt":"2024-04-29T07:46:40Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3501#issuecomment-2082080180","viewerDidAuthor":false}],"createdAt":"2024-02-17T02:59:53Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":3501,"title":"Python templates: Cannot install bindings to prebuilt providers when behind mirror or proxy of pypi.org","updatedAt":"2024-04-29T07:46:43Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE1NzAwODE3","is_bot":false,"login":"NemanjaMilenkovic","name":"Nemanja Milenkovic"},"body":"### Expected Behavior\r\n\r\nGenerated Terraform code without errors. \r\nIs transforming snake_case to camelCase expected? \r\n\r\n\r\n\r\n### Actual Behavior\r\n\r\n CDKTF tranfforms snake_case to camelCase which creates duplicates in schema:\r\n\r\n\r\n\r\n```\r\n> tsc -p tsconfig.build.json\r\n\r\n.gen/providers/fivetran/connector/index.ts:7605:12 - error TS2300: Duplicate identifier 's3Bucket'.\r\n\r\n7605   readonly s3Bucket?: string;\r\n                ~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:7634:12 - error TS2300: Duplicate identifier 's3RoleArn'.\r\n\r\n7634   readonly s3RoleArn?: string;\r\n                ~~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:7642:12 - error TS2300: Duplicate identifier 's3Bucket'.\r\n\r\n7642   readonly s3Bucket?: string;\r\n                ~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:7671:12 - error TS2300: Duplicate identifier 's3RoleArn'.\r\n\r\n7671   readonly s3RoleArn?: string;\r\n                ~~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:18667:14 - error TS2300: Duplicate identifier 's3Bucket'.\r\n\r\n18667   public get s3Bucket() {\r\n                   ~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:18670:14 - error TS2300: Duplicate identifier 's3Bucket'.\r\n\r\n18670   public set s3Bucket(value: string) {\r\n                   ~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:18673:10 - error TS2393: Duplicate function implementation.\r\n\r\n18673   public resetS3Bucket() {\r\n               ~~~~~~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:18677:14 - error TS2300: Duplicate identifier 's3BucketInput'.\r\n\r\n18677   public get s3BucketInput() {\r\n                   ~~~~~~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:18731:14 - error TS2300: Duplicate identifier 's3RoleArn'.\r\n\r\n18731   public get s3RoleArn() {\r\n                   ~~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:18734:14 - error TS2300: Duplicate identifier 's3RoleArn'.\r\n\r\n18734   public set s3RoleArn(value: string) {\r\n                   ~~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:18737:10 - error TS2393: Duplicate function implementation.\r\n\r\n18737   public resetS3RoleArn() {\r\n               ~~~~~~~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:18741:14 - error TS2300: Duplicate identifier 's3RoleArnInput'.\r\n\r\n18741   public get s3RoleArnInput() {\r\n                   ~~~~~~~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:18746:11 - error TS2300: Duplicate identifier '_s3Bucket'.\r\n\r\n18746   private _s3Bucket?: string;\r\n                ~~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:18747:14 - error TS2300: Duplicate identifier 's3Bucket'.\r\n\r\n18747   public get s3Bucket() {\r\n                   ~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:18750:14 - error TS2300: Duplicate identifier 's3Bucket'.\r\n\r\n18750   public set s3Bucket(value: string) {\r\n                   ~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:18753:10 - error TS2393: Duplicate function implementation.\r\n\r\n18753   public resetS3Bucket() {\r\n               ~~~~~~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:18757:14 - error TS2300: Duplicate identifier 's3BucketInput'.\r\n\r\n18757   public get s3BucketInput() {\r\n                   ~~~~~~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:18810:11 - error TS2300: Duplicate identifier '_s3RoleArn'.\r\n\r\n18810   private _s3RoleArn?: string;\r\n                ~~~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:18811:14 - error TS2300: Duplicate identifier 's3RoleArn'.\r\n\r\n18811   public get s3RoleArn() {\r\n                   ~~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:18814:14 - error TS2300: Duplicate identifier 's3RoleArn'.\r\n\r\n18814   public set s3RoleArn(value: string) {\r\n                   ~~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:18817:10 - error TS2393: Duplicate function implementation.\r\n\r\n18817   public resetS3RoleArn() {\r\n               ~~~~~~~~~~~~~~\r\n\r\n.gen/providers/fivetran/connector/index.ts:18821:14 - error TS2300: Duplicate identifier 's3RoleArnInput'.\r\n\r\n18821   public get s3RoleArnInput() {\r\n                   ~~~~~~~~~~~~~~\r\n\r\n.gen/providers/fivetran/data-fivetran-connector/index.ts:2958:14 - error TS2300: Duplicate identifier 's3Bucket'.\r\n\r\n2958   public get s3Bucket() {\r\n                  ~~~~~~~~\r\n\r\n.gen/providers/fivetran/data-fivetran-connector/index.ts:2978:14 - error TS2300: Duplicate identifier 's3RoleArn'.\r\n\r\n2978   public get s3RoleArn() {\r\n                  ~~~~~~~~~\r\n\r\n.gen/providers/fivetran/data-fivetran-connector/index.ts:2983:14 - error TS2300: Duplicate identifier 's3Bucket'.\r\n\r\n2983   public get s3Bucket() {\r\n                  ~~~~~~~~\r\n\r\n.gen/providers/fivetran/data-fivetran-connector/index.ts:3003:14 - error TS2300: Duplicate identifier 's3RoleArn'.\r\n\r\n3003   public get s3RoleArn() {\r\n                  ~~~~~~~~~\r\n\r\n\r\nFound 26 errors in 2 files.\r\n\r\nErrors  Files\r\n    22  .gen/providers/fivetran/connector/index.ts:7605\r\n     4  .gen/providers/fivetran/data-fivetran-connector/index.ts:2958\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\nimport { Construct } from 'constructs';\r\nimport * as fivetran from '../../../.gen/providers/fivetran';\r\n\r\nexport class FivetranGroup extends Construct {\r\n  constructor(\r\n    scope: Construct,\r\n    id: string,\r\n  ) {\r\n    super(scope, id);\r\n  }\r\n\r\n  readonly group = new fivetran.group.Group(this, 'example-group', {\r\n    name: \"example-group\",\r\n  });\r\n\r\n}\r\n\r\n\r\n### Versions\r\n\r\nFivetran version: 1.1.11\r\ncdktf version: 0.18.0\r\n\r\n### Providers\r\n\r\n_No response_\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\n_No response_\r\n\r\n### Anything Else?\r\n\r\nIs there any tool, or setting that allows CDKTF to handle such cases on schema mapping?\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5zhpHb","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @NemanjaMilenkovic ğŸ‘‹\r\n\r\nThanks for raising this! I just tried to replicate your problem with the latest CDKTF version (`0.20.3`) and was unable to do so. It seemed to work for me.\r\n\r\n> Is transforming snake_case to camelCase expected?\r\n\r\nYes that is expected as CDKTF tries to match the common casing for each target language.\r\n\r\nCan you try whether upgrading to CDKTF 0.20.3 fixes your problem? There have been recent fixes related to the problem you are seeing. Although, I think they were related to modules ğŸ¤”\r\n\r\nIf the problem persists, could you post more of your configuration (`cdktf.json`) or even a link to a reproducible example? ğŸ˜Š\r\n\r\nThat said, there seems to be `s3Bucket` and `s3_bucket` in the `fivetran_connector` resource and they seem to do different things. This will cause problems in CDKTF, if the `s3Bucket` needs to be set as they collide as far as CDKTF is concerned. To solve this, a manual override could be used (e.g. `myConnectorResource.addOverride(\"s3Bucket\", \"my-bucket\")`) â€“ but I haven't tested that. In general CDKTF assumes snake_cased attribute names, which is why this Terraform provider might not be 100% supported currently.","createdAt":"2024-02-12T08:03:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3488#issuecomment-1938199003","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5zpRl5","author":{"login":"NemanjaMilenkovic"},"authorAssociation":"NONE","body":"Hi @ansgarm ğŸ‘‹\r\nThank you for looking into this! \r\n\r\nYes, as you noticed - that is correct - CDKTF 0.20.3 works as expected. Also, every CDKTF version higher than 0.19 works with no issues.\r\n\r\nOur main question was about the difference in CDKTF behaviour in versions before CDKTF version 0.19 and after where schema might be mapped differently but I can't seem to find a reason why or a documented breaking change that would explain it.\r\n\r\nThis is an example configuration where it is noticed:\r\n\r\n\r\n> Fivetran version: 1.1.11\r\n> cdktf version: 0.18.0 (or any version < 0.19.0)\r\n> \r\n> Note: in our current use case, we need to use Fivetran version: 1.1.11 but we would prefer not upgrading CDKTF above version 0.19.0 at this moment.\r\n> \r\n\r\nIf CDKTF version > 0.19.0 is used, including the latest CDKTF 0.20.3, there are no issues.\r\n\r\nIs there a difference in how CDKTF is handling casing before version 0.19.0 and after?\r\n","createdAt":"2024-02-13T01:56:34Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3488#issuecomment-1940199801","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc55XGfU","author":{"login":"NemanjaMilenkovic"},"authorAssociation":"NONE","body":"Hi @ansgarm \r\nJust in case you've missed this - is there any additional information needed?","createdAt":"2024-04-04T03:17:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3488#issuecomment-2036099028","viewerDidAuthor":false}],"createdAt":"2024-02-06T02:55:37Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTM2MjAxMTE5","name":"provider get / generation","description":"","color":"CC3938"}],"milestone":null,"number":3488,"title":"CDKTF version <0.19 creates duplicates in schema with new Fivetran provider","updatedAt":"2024-04-04T03:17:02Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjY1NTI1MjE=","is_bot":false,"login":"klemmchr","name":"Christian Klemm"},"body":"### Description\r\n\r\nCurrently `Testing.ToBeValidTerraform` only returns a boolean to indicate the validity. No errors are shown or returned and no exception is thrown. This makes it really hard to debug the error. `ToBeValidTerraform` should either return error messages or just throw an exception directly. This has already been implemented for Typescript in #1953.\r\n\r\nEssentially this test is completely useless right now. While my code deploys absolutely fine, the tests are failing and I cannot tell why this happens. I couldn't even create a bug report if there is any.\r\n\r\n### References\r\n\r\n- #1953\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2024-02-06T01:11:00Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY4OTA0OTk5","name":"new","description":"Un-triaged issue","color":"3A7F17"}],"milestone":null,"number":3487,"title":"Testing: ToBeValidTerraform for C# should output errors","updatedAt":"2024-02-10T20:14:40Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjQ2NTk5Mw==","is_bot":false,"login":"jesseward","name":"Jesse Ward"},"body":"### Expected Behavior\r\n\r\nThe bindings generated for the https://github.com/Azure/terraform-azurerm-naming module do not correctly reference the output maps defined in their module..\r\n\r\nFor this module, the outputs function should return a map instead of a string. Or some other function that provides access to the output (that contains 8 keys). See https://github.com/Azure/terraform-azurerm-naming/blob/8a1c8616d4cd05423e53c3260a016919ce0df33d/main.tf#L1869-L1878\r\n\r\n### Actual Behavior\r\n\r\nThe creation of the cdktf bindings for the \"Azure/naming/azurerm\" module (https://github.com/Azure/terraform-azurerm-naming) do not properly handle their `map` output values.\r\n\r\nThe root of the issue is that the language specific functions generated for this module yields a token that references a key->value map type, and not the actual output (string) value.\r\n\r\nFor example, calling `ResourceGroupOutput()` yields `${module.resourceNaming.resource_group}`, where the `resource_group` output value is actually a map. When running tf plan, we're greeted with the error `module.resourceNaming.resource_group is object with 8 attributes`\r\n\r\nThe module reference in question can be found at [main.tf](https://github.com/Azure/terraform-azurerm-naming/blob/8a1c8616d4cd05423e53c3260a016919ce0df33d/main.tf#L1869-L1878) and [output.tf](https://github.com/Azure/terraform-azurerm-naming/blob/8a1c8616d4cd05423e53c3260a016919ce0df33d/outputs.tf#L924-L927)\r\n\r\n### Steps to Reproduce\r\n\r\nI have created an example repo that provides guidance on how to reproduce this behaviour. See https://github.com/jesseward/cdktf-aznaming-output-failure-example for details.\r\n\r\n\r\n\r\n### Versions\r\n\r\n**language: go**\r\n\r\n- cdktf-cli: 0.20.2\r\n- node: v21.6.1\r\n- cdktf: 0.20.3\r\n- constructs: 10.3.0\r\n- jsii: 1.94.0\r\n- terraform: 1.7.1\r\n- arch: arm64\r\n- os: darwin 23.3.0\r\n- go: go version go1.21.6 darwin/arm64\r\n\r\n**providers**\r\n- azurerm@~>3 (LOCAL)\r\n- terraform provider version: 3.89.0\r\n\r\n### Providers\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF â”‚ Constraint â”‚ Package Name â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ azurerm       â”‚ 3.89.0           â”‚       â”‚ ~>3        â”‚              â”‚                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n### Gist\r\n\r\nhttps://github.com/jesseward/cdktf-aznaming-output-failure-example\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\nModify the `cdktf.json` that references the module output, to specify the key in question. For example\r\n\r\n```json\r\n        \"name\": \"${module.resourceNaming.resource_group[\\\"name\\\"]}\"\r\n```\r\n\r\n### Anything Else?\r\n\r\nI am not sure if this is a bug or expected behaviour due to an unsupported model of mapping output values within a module.\r\n\r\n### References\r\n\r\nLooks like others have encountered similar issues as well and raised the following in the `Azure/terraform-azurerm-naming` repo.\r\n\r\n- https://github.com/Azure/terraform-azurerm-naming/issues/64\r\n- https://github.com/Azure/terraform-azurerm-naming/issues/107\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5y0ZYC","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @jesseward ğŸ‘‹\r\n\r\nThank you for raising this. It is true that all outputs are currently typed as strings. This is a current shortcoming that happens because types of outputs are inferred by Terraform and not part of the configuration as its written. This means that a future version of `cdktf get` has to invoke parts of Terraform to parse and evaluate the module in order to get the types right.\r\n\r\nFor your case it should be possible to use `Fn.Lookup(someModule.ResourceGroupOutput(), \"name\")` to get to the right value. There is also `Token.AsList()` which can be used to turn the string output into a list token which would be the correct output type we'd expect.","createdAt":"2024-02-05T06:56:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3477#issuecomment-1926338050","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5y6_gu","author":{"login":"jesseward"},"authorAssociation":"NONE","body":"hey @ansgarm, thanks for the pointer here. I tested the `Fn_Lookup(..)` function and it works as advertised ğŸ™‡ \r\n\r\nI have added some notes to [README.md](https://github.com/jesseward/cdktf-aznaming-output-failure-example/tree/main?tab=readme-ov-file#workaround) and I updated my sample code at [main.go](https://github.com/jesseward/cdktf-aznaming-output-failure-example/blob/main/main.go#L40-L57).\r\n\r\nDoes it make sense to document this scenario? Or is this something that could be easily inferred from the `cdktf` docs in general. This was my first rodeo with `cdktf` and hit this early on, so admittedly haven't dove through the entirety of the gotchas/usage oddities.\r\n\r\n","createdAt":"2024-02-05T20:47:27Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3477#issuecomment-1928067118","viewerDidAuthor":false}],"createdAt":"2024-01-29T15:00:12Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":3477,"title":"Incorrect bindings generated for the `Azure/naming/azurerm` module. ","updatedAt":"2024-02-06T02:14:10Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjI0NzA2NDk=","is_bot":false,"login":"lkleen","name":"Lars Kleen"},"body":"### Description\n\nThe detection of the usage of pnpm is based on the assumption that there is a pnpm.lock.yaml file in the same directory as the cdktf configuration. In a monorepo project which has a separate folder for infrastructure code this is not the case. pnpm usage is not correctly detected as the pnpm lock file is located in the root directory of the project by default.\r\n\r\nI would suggest to avoid automatic detection based on assumptions and add a packageManager parameter to cdktf.json. This would ensure the correct package manager is utilized in every case and provides a clearly spcified and visible configuration. It would also simplify the implementation.\n\n### References\n\nhttps://github.com/hashicorp/terraform-cdk/pull/2959/commits/69b13becd5244bac348cd0e7b39ef02144ccf2e5#\n\n### Help Wanted\n\n- [X] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5xRkWC","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"> I would suggest to avoid automatic detection based on assumptions and add a packageManager parameter to cdktf.json.\r\n\r\nI would fear this adding a point of confusion since it is one more thing people could misconfigure. I'd vote for fixing the bug at hand and see if similar issues arise in the future.","createdAt":"2024-01-19T13:30:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3441#issuecomment-1900430722","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6PK9LB","author":{"login":"lewisloofis"},"authorAssociation":"NONE","body":"Hi, any update on this issue? I also experienced this problem","createdAt":"2024-10-09T11:05:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3441#issuecomment-2402013889","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6VpBDy","author":{"login":"vincenthsh"},"authorAssociation":"NONE","body":"I added a dummy `pnpm-lock.yaml` file in the sub directory to work around these errors.. seems to trick cdktf-cli.\r\n\r\nA nice set of pkgs to handle tool detection is available in https://github.com/Thinkmill/manypkg/blob/main/packages/find-root\r\n","createdAt":"2024-12-02T04:32:06Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3441#issuecomment-2510557426","viewerDidAuthor":false}],"createdAt":"2024-01-19T08:00:22Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":3441,"title":"CLI: pnpm detection in a subdirectory of a mopnorepo does not work","updatedAt":"2024-12-04T01:42:23Z"},{"assignees":[],"author":{"id":"U_kgDOBfirOw","is_bot":false,"login":"nikpivkin","name":"Nikita Pivkin"},"body":"### Description\n\nRunning the `cdktf synth` command with the [example](https://developer.hashicorp.com/terraform/tutorials/cdktf/cdktf-build?in=terraform%2Fcdktf&variants=cdk-language%3Ago#define-your-cdk-for-terraform-application) from the documentation returns an error:\r\n\r\n```bash\r\ncdktf synth\r\n(node:49956) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.\r\n(Use `node --trace-deprecation ...` to show where the warning was created)\r\n\r\nâ ™  Synthesizing\r\n[2024-01-18T16:15:58.781] [ERROR] default - # github.com/cdktf/cdktf-provider-aws-go/aws/v10/instance\r\n../../../go/pkg/mod/github.com/cdktf/cdktf-provider-aws-go/aws/v10@v10.0.12/instance/instance_Instance.go:14:2: duplicate method Count\r\n        ../../../go/pkg/mod/github.com/cdktf/cdktf-provider-aws-go/aws/v10@v10.0.12/instance/instance_Instance.go:36:2: other declaration of Count\r\n../../../go/pkg/mod/github.com/cdktf/cdktf-provider-aws-go/aws/v10@v10.0.12/instance/instance_Instance.go:14:2: duplicate method SetCount\r\n        ../../../go/pkg/mod/github.com/cdktf/cdktf-provider-aws-go/aws/v10@v10.0.12/instance/instance_Instance.go:38:2: other declar\r\nERROR: cdktf encountered an error while synthesizing\r\n\r\nSynth command: go run main.go\r\nError:         non-zero exit code 1\r\n\r\nCommand output on stderr:\r\n\r\n    # github.com/cdktf/cdktf-provider-aws-go/aws/v10/instance\r\n    ../../../go/pkg/mod/github.com/cdktf/cdktf-provider-aws-go/aws/v10@v10.0.12/instance/instance_Instance.go:14:2: duplicate method Count\r\n        ../../../go/pkg/mod/github.com/cdktf/cdktf-provider-aws-go/aws/v10@v10.0.12/instance/instance_Instance.go:36:2: other declaration of Count\r\n    ../../../go/pkg/mod/github.com/cdktf/cdktf-provider-aws-go/aws/v10@v10.0.12/instance/instance_Instance.go:14:2: duplicate method SetCount\r\n        ../../../go/pkg/mod/github.com/cdktf/cdktf-provider-aws-go/aws/v10@v10.0.12/instance/instance_Instance.go:38:2: other declaration of SetCount\r\n\r\n\r\n\r\n\r\nâ ‡  Synthesizing\r\n```\r\n\r\n----\r\n```\r\ncdktf --version\r\n0.20.1\r\n(node:50111) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.\r\n(Use `node --trace-deprecation ...` to show where the warning was created)\r\n\r\ngo version\r\ngo version go1.21.2 darwin/arm64\r\n````\r\n\n\n### Links\n\nhttps://developer.hashicorp.com/terraform/tutorials/cdktf/cdktf-build?in=terraform%2Fcdktf&variants=cdk-language%3Ago\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5xKPlC","author":{"login":"xiehan"},"authorAssociation":"MEMBER","body":"I think you're running into a duplicate/combination of both #3188 and #2907.\r\n\r\nThere are two issues:\r\n1. The tutorial currently asks users to run the command `cdktf init --template=\"typescript\" --providers=\"aws@~>4.0\"` when it should be asking users to run the command `cdktf init --template=\"typescript\" --providers=\"aws\"` (i.e. no version constraint). The issue is that there is no prebuilt provider available for the combination of CDKTF 0.20 and AWS 4.x, we only have a prebuilt package available for the combination of CDKTF 0.20 and AWS 5.x. Since it can't find a prebuilt provider, what it's _actually_ doing is installing locally-built bindings, yet the rest of the tutorial assumes the prebuilt provider is installed, which causes conflicts. I've submitted a PR in the tutorials repo (HashiCorp internal only so I can't link to it here) and will get it shepherded through ASAP because you're not the first to get tripped up by this.\r\n2. For Go specifically, the issue is that the prebuilt providers have to have the version number in the `import` statements, i.e.:\r\n\r\n```\r\nimport (\r\n    \"github.com/cdktf/cdktf-provider-aws-go/aws/v10/instance\"\r\n    awsprovider \"github.com/cdktf/cdktf-provider-aws-go/aws/v10/provider\"\r\n)\r\n```\r\n\r\nThe problem is that these version numbers get incremented relatively frequently, at minimum with every new feature release of CDKTF. The tutorials were written at the time when CDKTF was at v0.13 and the corresponding AWS prebuilt provider was at v10. Now CDKTF is at v0.20 and the corresponding AWS prebuilt provider is at v19, so the import statements should _instead_ read:\r\n\r\n```\r\nimport (\r\n    \"github.com/cdktf/cdktf-provider-aws-go/aws/v19/instance\"\r\n    awsprovider \"github.com/cdktf/cdktf-provider-aws-go/aws/v19/provider\"\r\n)\r\n```\r\n\r\nBecause the tutorials live in an entirely different repo managed by the Education team and not by us, we don't have any way to automate updating these when we do releases, unfortunately, which is why there's this regression.\r\n\r\nIn any case, I've also included updating these to v19 in my PR on the tutorial, which should address the issue for anyone trying the tutorial today, but I can't guarantee this problem won't reoccur in the future. For Go users, we may have no choice but to add a note of some kind to double-check the version numbers in the import statements because they may become outdated in the future.","createdAt":"2024-01-18T13:45:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3436#issuecomment-1898510658","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5xKkYF","author":{"login":"nikpivkin"},"authorAssociation":"NONE","body":"@xiehan Thank you for such a detailed response!\r\n\r\nI tried to initialise the project without specifying the aws provider version, but got an error:\r\n```bash\r\ncdktf init --template=\"go\" --providers=\"aws\" --local\r\n...\r\n[2024-01-18T21:23:33.016] [INFO] default - Checking whether pre-built provider exists for the following constraints:\r\n  provider: aws\r\n  version : latest\r\n  language: go\r\n  cdktf   : 0.20.1\r\n\r\n[2024-01-18T21:23:36.472] [INFO] default - Found pre-built provider.\r\nAdding package github.com/cdktf/cdktf-provider-aws-go/aws @ 19.1.1\r\n[2024-01-18T21:24:25.965] [ERROR] default - go: downloading github.com/cdktf/cdktf-provider-aws-go/aws/v19 v19.1.1\r\n\r\ngo: downloading github.com/cdktf/cdktf-provider-aws-go/aws/v19 v19.1.1\r\n[2024-01-18T21:24:36.972] [ERROR] default - go: github.com/cdktf/cdktf-provider-aws-go/aws/v19@v19.1.1: create zip: module source tree too large (max size is 524288000 bytes)\r\n\r\ngo: github.com/cdktf/cdktf-provider-aws-go/aws/v19@v19.1.1: create zip: module source tree too large (max size is 524288000 bytes)\r\nnon-zero exit code 1\r\nError: non-zero exit code 1\r\n    at ChildProcess.<anonymous> (/opt/homebrew/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:99:8179)\r\n    at Object.onceWrapper (node:events:634:26)\r\n    at ChildProcess.emit (node:events:519:28)\r\n    at ChildProcess.emit (node:domain:488:12)\r\n    at maybeClose (node:internal/child_process:1105:16)\r\n    at Socket.<anonymous> (node:internal/child_process:457:11)\r\n    at Socket.emit (node:events:519:28)\r\n    at Socket.emit (node:domain:488:12)\r\n    at Pipe.<anonymous> (node:net:337:12)\r\n    at Pipe.callbackTrampoline (node:internal/async_hooks:130:17)\r\nCollecting Debug Information...\r\n/opt/homebrew/lib/node_modules/cdktf-cli/node_modules/yoga-layout-prebuilt/yoga-layout/build/Release/nbind.js:53\r\n        throw ex;\r\n        ^\r\n\r\nError: non-zero exit code 1\r\n    at ChildProcess.<anonymous> (/opt/homebrew/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:99:8179)\r\n    at Object.onceWrapper (node:events:634:26)\r\n    at ChildProcess.emit (node:events:519:28)\r\n    at ChildProcess.emit (node:domain:488:12)\r\n    at maybeClose (node:internal/child_process:1105:16)\r\n    at Socket.<anonymous> (node:internal/child_process:457:11)\r\n    at Socket.emit (node:events:519:28)\r\n    at Socket.emit (node:domain:488:12)\r\n    at Pipe.<anonymous> (node:net:337:12)\r\n    at Pipe.callbackTrampoline (node:internal/async_hooks:130:17) {\r\n  stderr: 'go: downloading github.com/cdktf/cdktf-provider-aws-go/aws/v19 v19.1.1\\n' +\r\n    'go: github.com/cdktf/cdktf-provider-aws-go/aws/v19@v19.1.1: create zip: module source tree too large (max size is 524288000 bytes)\\n'\r\n}\r\n```\r\nI found a related [issue](https://github.com/hashicorp/terraform-cdk/issues/3358), but it's closed as solved.\r\n\r\n\r\n\r\n","createdAt":"2024-01-18T14:34:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3436#issuecomment-1898595845","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5xLsbK","author":{"login":"xiehan"},"authorAssociation":"MEMBER","body":"It's closed as solved because it will be fixed the next time the AWS provider does a release, which will trigger a new release of our prebuilt provider for AWS. The AWS provider does weekly releases on Thursday nights, so a new version should be out and this should be resolved by tomorrow morning.","createdAt":"2024-01-18T17:13:06Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3436#issuecomment-1898890954","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5xQs_m","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @nikpivkin ğŸ‘‹ There's a [new release](https://github.com/cdktf/cdktf-provider-aws/releases/tag/v19.2.0) out now of the pre-built provider that fixes this. I just checked and was able to install the latest package locally ğŸ‘","createdAt":"2024-01-19T11:06:49Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3436#issuecomment-1900204006","viewerDidAuthor":false}],"createdAt":"2024-01-18T09:19:38Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyOTY3ODY2NzMy","name":"documentation/learn-tutorials","description":"","color":"29D75B"},{"id":"MDU6TGFiZWwzMDMwODE1NTQy","name":"language/golang","description":"","color":"22ED90"}],"milestone":null,"number":3436,"title":"cdktf-go: Error when following the examples in the documentation","updatedAt":"2024-01-19T11:06:50Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUwMDg5ODc=","is_bot":false,"login":"Chriscbr","name":"Chris Rybicki"},"body":"### Description\r\n\r\nSupport lazy string values for the \"path\" option in TerraformAsset.\r\n\r\nToday it's possible to provide a concrete string path to `TerraformAsset`, but if you provide a token string, you'll get an error like `Error: ENOENT: no such file or directory, stat '${TfToken[TOKEN.0]}'`:\r\n\r\n```ts\r\nclass MyStack extends TerraformStack {\r\n  constructor(scope: Construct, id: string) {\r\n    super(scope, id);\r\n\r\n    let lazyStr = Lazy.stringValue({ produce: () => path.join(__dirname, \"setup.js\") });\r\n\r\n    new TerraformAsset(this, \"MyAsset1\", {\r\n      path: path.join(__dirname, \"main.js\"), // ok\r\n    })\r\n\r\n    new TerraformAsset(this, \"MyAsset2\", {\r\n      path: lazyStr, // error!\r\n    })\r\n  }\r\n}\r\n```\r\n\r\nI think supporting token values as shown in the example above should be straightforward to support since the implementation of [TerraformAsset](https://github.com/hashicorp/terraform-cdk/blob/main/packages/cdktf/lib/terraform-asset.ts) does not appear to use the path functionally (i.e. reading it, copying it, or zipping it) until the app is actually synthesized with `_onSynthesize()`.\r\n\r\nThe value of the `type` option in TerraformAsset is currently inferred based on the file type, but a token string, we could simply throw an error requiring that the user specifies which kind it is in advance (or perhaps change onSynthesize to figure it out adhoc).\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [X] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5w-eEx","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"I'd be okay with throwing an error if the type is not specified if a token is passed. Seems like a good trade-off to me.","createdAt":"2024-01-17T09:31:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3429#issuecomment-1895424305","viewerDidAuthor":false}],"createdAt":"2024-01-16T23:27:20Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMjM2NDcwNTQ1","name":"feature/tokens","description":"","color":"58CF13"}],"milestone":null,"number":3429,"title":"TerraformAsset: support lazy / token value for path","updatedAt":"2024-01-17T09:31:42Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjY2NDY3NjE1","is_bot":false,"login":"doctor-house","name":""},"body":"### Expected Behavior\r\n\r\nThere should be no error when using `Fn.Strcontains()`\r\n\r\n### Actual Behavior\r\n\r\n`cdktf synth` produces the following error:\r\n```\r\n[2024-01-10T17:52:38.960] [ERROR] default - Unhandled exception.\r\n[2024-01-10T17:52:38.974] [ERROR] default - System.ArgumentException: Could not infer JSII type for .NET type '_Proxy' (Parameter 'type')\r\n   at Amazon.JSII.Runtime.Services.Converters.FrameworkToJsiiConverter.InferType(IReferenceMap referenceMap, Type type)\r\n   at Amazon.JSII.Runtime.Services.Converters.FrameworkToJsiiConverter.InferType(IReferenceMap referenceMap, Object value)\r\n   at Amazon.JSII.Runtime.Services.Converters.ValueConverter.ConvertAny(Type type, IReferenceMap referenceMap, Object value)\r\n   at Amazon.JSII.Runtime.Services.Converters.ValueConverter.TryConvertPrimitive(Type type, IReferenceMap referenceMap, Object value, Boolean isOptional, PrimitiveType primitiveType, Object& result)\r\n   at Amazon.JSII.Runtime.Services.Converters.ValueConverter.TryConvert(IOptionalValue optionalValue, Type type, IReferenceMap referenceMap, Object value, Object& result)\r\n   at Amazon.JSII.Runtime.Services.Converters.FrameworkToJsiiConverter.TryConvert(IOptionalValue optionalValue, IReferenceMap referenceMap, Object value, Object& result)\r\n   at Amazon.JSII.Runtime.Deputy.DeputyBase.<>c__DisplayClass20_0.<ConvertArguments>b__0(Parameter parameter, Object frameworkArgument)\r\n   at System.Linq.Enumerable.ZipIterator[TFirst,TSecond,TResult](IEnumerable`1 first, IEnumerable`1 second, Func`3 resultSelector)+MoveNext()\r\n   at System.Collections.Generic.LargeArrayBuilder`1.AddRange(IEnumerable`1 items)\r\n   at System.Collections.Generic.EnumerableHelpers.ToArray[T](IEnumerable`1 source)\r\n   at Amazon.JSII.Runtime.Deputy.DeputyBase.ConvertArguments(Parameter[] parameters, Object[] arguments)\r\n   at Amazon.JSII.Runtime.Deputy.DeputyBase..ctor(DeputyProps props)\r\n   at Constructs.Construct..ctor(DeputyProps props)\r\n   at HashiCorp.Cdktf.TerraformElement..ctor(DeputyProps props)\r\n   at HashiCorp.Cdktf.TerraformLocal..ctor(Construct scope, String id, Object expression)\r\n   at MyCompany.MyApp.MainStack..ctor(Construct scope, String id) in C:\\work\\cdktf-test\\MainStack.cs:line 12\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n1. Run `cdktf init --template=csharp` to make a new project\r\n2. Add the following to `MainStack.cs`\r\n```csharp\r\nvar fooBar = new TerraformLocal(this, \"foo_bar\", Fn.Strcontains(\"foo\", \"bar\"));\r\n```\r\n3. Run `cdktf synth` to see the error.\r\n\r\n### Versions\r\n\r\nlanguage: csharp\r\ncdktf-cli: 0.20.0\r\nnode: v18.12.0\r\ncdktf: 0.20.0\r\nconstructs: 10.0.25\r\njsii: 1.93.0\r\nterraform: 1.2.6\r\narch: x64\r\nos: win32 10.0.22621\r\ndotnet: 6.0.320\r\n\r\n### Providers\r\n\r\nâ”Œâ”\r\nâ”‚â”‚\r\nâ””â”˜\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\n_No response_\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5xtzZM","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @doctor-house ğŸ‘‹\r\n\r\nPlease excuse the late reply! I was able to confirm the bug you're running into and it seems like JSII (the underlying library translating between the CDK supported languages) has problems with Terraform functions that return a boolean value (which is modeled as an `IResolvable` as there are no boolean tokens in the CDKs). This makes this problem hard to quickly fix.\r\n\r\nHowever, in the meantime, it is possible to work around this by using strings containing raw expressions (e.g. `\"${some_function()}\"`). Below is a C# example for the function you encountered the bug for.\r\n\r\n```csharp\r\nvar str = new TerraformVariable(this, \"str\", new TerraformVariableConfig\r\n{\r\n    Type = \"string\",\r\n    Default = \"foo\"\r\n});\r\nvar fooBar = new TerraformLocal(this, \"foo_bar\", $\"${{strcontains({str.Fqn}, \\\"bar\\\")}}\");\r\n```\r\n\r\nThis synthesizes the following Terraform JSON for the local:\r\n```jsonc\r\n// ...\r\n\"locals\": {\r\n  \"foo_bar\": \"${strcontains(var.str, \\\"bar\\\")}\"\r\n},\r\n// ...\r\n```","createdAt":"2024-01-24T10:21:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3408#issuecomment-1907832396","viewerDidAuthor":false}],"createdAt":"2024-01-11T00:10:18Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTM1OTYzMTU0","name":"language/c#","description":"C# language issues","color":"c5def5"},{"id":"MDU6TGFiZWwzMjM2NDcwNTQ1","name":"feature/tokens","description":"","color":"58CF13"},{"id":"LA_kwDODd1Amc7nQOIC","name":"feature/terraform-functions","description":"","color":"A1C1CD"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":3408,"title":"Fn.Strcontains() produces error in C#","updatedAt":"2024-01-24T10:23:07Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjg3NDM3Nzc=","is_bot":false,"login":"Zman94","name":"Zach Gleason"},"body":"### Expected Behavior\n\n`cdktf init --template=` should allow more methods to use a remote template including a local path.\n\n### Actual Behavior\n\n`cdktf init --template` requires a zip file which, I presume, uses `curl` or `wget` under the hood to pull. This prevents users from using repositories that they have access to, but can't authenticate with using curl or wget\n\n### Steps to Reproduce\n\n* Fork [python poetry remote template](https://github.com/johnfraney/cdktf-remote-template-python-poetry/tree/main/python-poetry).\r\n* make the repo private\r\n* Create a release\r\n* `cdktf init --template='<path to release' --local`\r\n* Observe the following error\r\n```\r\nExtracting zip file\r\nError: end of central directory record signature not found\r\n    at /usr/local/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:110:448419\r\n    at /usr/local/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:110:456137\r\n    at /usr/local/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:110:438097\r\n    at FSReqCallback.wrapper [as oncomplete] (node:fs:682:5)\r\n```\n\n### Versions\n\ncdktf debug\r\nlanguage: null\r\ncdktf-cli: 0.17.1\r\nnode: v18.16.0\r\nterraform: 1.4.6\r\narch: x64\r\nos: linux 6.2.0-1016-azure\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5tdLJE","author":{"login":"Zman94"},"authorAssociation":"NONE","body":"Additional info:\r\nThe line that would need to change to support a local ref is here\r\nhttps://github.com/hashicorp/terraform-cdk/blob/49558e5435c7858851eb102dddc788f8d4b6e640/packages/cdktf-cli/src/bin/cmds/helper/init.ts#L464.\r\n\r\nAlso, when I wget my file, I get an html page directing me to a single sign on.","createdAt":"2023-12-01T16:05:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3320#issuecomment-1836364356","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5uFWTx","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"I understand when you write `<path to release>` that it would refer to something like `../my-cloned-dir/` which is not the intended usage. Instead [you should be using an URL to the GitHub repo, e.g. `https://github.com/<user or organization>/<repo>/archive/refs/heads/main.zip`](https://developer.hashicorp.com/terraform/cdktf/create-and-deploy/remote-templates#distribute-remote-templates). If you would want local files to work that would change the interface. You could create a for that PR if you like :)","createdAt":"2023-12-08T10:04:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3320#issuecomment-1846895857","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5uGql5","author":{"login":"Zman94"},"authorAssociation":"NONE","body":"Is there guidance to running this with a private repo or an enterprise repo? There's no authentication that I could find in the code, so I was only ever able to download an HTML file pointing to a single sign on page\r\n","createdAt":"2023-12-08T14:16:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3320#issuecomment-1847241081","viewerDidAuthor":false}],"createdAt":"2023-12-01T15:46:03Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"LA_kwDODd1Amc7x0kYM","name":"feature/init","description":"cdktf init related features","color":"C1E24A"}],"milestone":null,"number":3320,"title":"Can't use remote template on private repo","updatedAt":"2023-12-18T09:56:58Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjU5NzgxMg==","is_bot":false,"login":"wandergeek","name":"Nick Clark"},"body":"### Description\r\n\r\nThe example provided in the npm docs is broken: https://www.npmjs.com/package/@cdktf/hcl2cdk. \r\n\r\nI got the simple inline example working like so. I'm unsure if this can be further simplified.\r\n```typescript\r\nimport * as hcl2cdk from \"@cdktf/hcl2cdk\";\r\nimport {readSchema} from \"@cdktf/provider-schema\";\r\nimport { ConstructsMakerProviderTarget, LANGUAGES, TerraformProviderConstraint } from \"@cdktf/commons\";\r\n\r\nconst hcl = `\r\n  variable \"name\" {\r\n    description = \"Name to be used on all the resources as identifier\"\r\n    type        = string\r\n    default     = \"\"\r\n  }\r\n`;\r\n\r\n(async () => {\r\n    const providerRequirements = await hcl2cdk.parseProviderRequirements(hcl);\r\n    const targets = Object.entries(providerRequirements).map(([name, version]) =>\r\n    ConstructsMakerProviderTarget.from(\r\n      new TerraformProviderConstraint(`${name}@ ${version}`),\r\n      LANGUAGES[0]\r\n    )\r\n  );\r\n  const { providerSchema } = await readSchema(targets);\r\n  const ts = await hcl2cdk.convert(hcl, { \r\n    language: \"typescript\",\r\n    providerSchema: providerSchema\r\n   });\r\n  console.log(ts.imports); // just the necessary imports\r\n  console.log(ts.code); // just the constructs\r\n  console.log(ts.all); // code with imports\r\n})();\r\n```\r\n\r\n\r\nIt'd be excellent to update the docs indicating the split/rename of some of these fields and exports. I'm unsure how the project conversion works at this time, would appreciate some guidance here. \r\n\r\n### Links\r\n\r\nhttps://www.npmjs.com/package/@cdktf/hcl2cdk\r\n\r\n### Help Wanted\r\n\r\n- [x] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5uFT5_","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Hey, good point, if you got the capacity we'd love to receive a PR on this topic. [This section](https://github.com/hashicorp/terraform-cdk/blob/main/packages/cdktf-cli/src/bin/cmds/helper/init.ts#L176C28-L202) is what is used for the project conversion :)","createdAt":"2023-12-08T09:56:57Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3292#issuecomment-1846886015","viewerDidAuthor":false}],"createdAt":"2023-11-27T00:42:28Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTg1Mzg1NTQ2","name":"feature/convert","description":"","color":"d93f0b"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":3292,"title":"hcl2cdk: example is broken","updatedAt":"2023-12-08T09:57:20Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjMwOTE1NTg=","is_bot":false,"login":"shinebayar-g","name":"Shinebayar G."},"body":"### Description\r\n\r\nCurrently Construct naming experience is not consistent with Terraform. Consider the following example:\r\n\r\n```ts\r\nclass DevStack extends TerraformStack {\r\n    constructor(scope: Construct, id: string) {\r\n        super(scope, id);\r\n\r\n        new GoogleProvider(this, \"dev\", {\r\n            project: \"foo\",\r\n        });\r\n\r\n        const vpc = new ComputeNetwork(this, \"main\", {\r\n            name: \"main\",\r\n            routingMode: \"REGIONAL\",\r\n            autoCreateSubnetworks: false,\r\n        });\r\n\r\n        new ComputeRoute(this, \"main\", {\r\n            name: \"egress-internet\",\r\n            description: \"route through IGW to access internet\",\r\n            destRange: \"0.0.0.0/0\",\r\n            network: vpc.id,\r\n            nextHopGateway: \"default-internet-gateway\",\r\n        });\r\n    }\r\n}\r\n```\r\n\r\nAbove code will give an error:\r\n\r\n```node\r\nthrow new Error(`There is already a Construct with name '${childName}' in ${typeName}${name.length > 0 ? ' [' + name + ']' : ''}`);\r\nError: There is already a Construct with name 'main' in DevStack [dev]\r\n```\r\n\r\nIdeally resource names shouldn't include resource types. In Terraform, we just name it as  `google_compute_network.main` and `google_compute_route.main` as described in https://developer.hashicorp.com/terraform/language/resources/syntax#resource-syntax\r\n\r\nBecause of this we're forced to duplicate the resource type in the name to get around the error.\r\n```ts\r\nclass DevStack extends TerraformStack {\r\n    constructor(scope: Construct, id: string) {\r\n        super(scope, id);\r\n\r\n        new GoogleProvider(this, \"dev\", {\r\n            project: \"foo\",\r\n        });\r\n\r\n        const vpc = new ComputeNetwork(this, \"main-vpc\", {\r\n            name: \"main\",\r\n            routingMode: \"REGIONAL\",\r\n            autoCreateSubnetworks: false,\r\n        });\r\n\r\n        new ComputeRoute(this, \"main-route\", {\r\n            name: \"egress-internet\",\r\n            description: \"route through IGW to access internet\",\r\n            destRange: \"0.0.0.0/0\",\r\n            network: vpc.id,\r\n            nextHopGateway: \"default-internet-gateway\",\r\n        });\r\n    }\r\n}\r\n```\r\n\r\nwhich ultimately leaks to the terraform resource names:\r\n\r\n```tf\r\n     Terraform will perform the following actions:\r\ndev    # google_compute_network.main-vpc (main-vpc) will be created\r\n       + resource \"google_compute_network\" \"main-vpc\" {\r\n           + auto_create_subnetworks                   = false\r\n           + delete_default_routes_on_create           = false\r\n           + gateway_ipv4                              = (known after apply)\r\n           + id                                        = (known after apply)\r\n           ...\r\n\r\n       # google_compute_route.main-route (main-route) will be created\r\n       + resource \"google_compute_route\" \"main-route\" {\r\n           + description            = \"route through IGW to access internet\"\r\n           + dest_range             = \"0.0.0.0/0\"\r\n           + id                     = (known after apply)\r\n           + name                   = \"egress-internet\"\r\n           + network                = (known after apply)\r\n           ...\r\n```\r\n\r\nResources declared inside `Construct`s even have random suffix attached to them which makes this constraint even more meaningless.\r\n\r\n### References\r\n\r\nhttps://developer.hashicorp.com/terraform/language/resources/syntax#resource-syntax\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5szXjV","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @shinebayar-g ğŸ‘‹\r\n\r\nThank you for raising this. I agree from a Terraform point of view â€“ unfortunately, we can't control this, as the underlying [construct](https://github.com/aws/constructs) package (which is used by all CDKs), makes no distinction between types of constructs and requires a unique name within each scope.\r\n\r\nHowever, you can work around this by using `.overrideLocalId()`:\r\n\r\n```ts\r\nnew RandomProvider(this, \"random\");\r\n\r\nnew Password(this, \"password\", { length: 16 });\r\nconst pet = new Pet(this, \"pet-password\", {});\r\npet.overrideLogicalId(\"password\");\r\n```\r\n\r\nproduces:\r\n```json\r\n\"resource\": {\r\n    \"random_password\": {\r\n      \"password\": {\r\n        \"//\": {\r\n          \"metadata\": {\r\n            \"path\": \"test-override/password\",\r\n            \"uniqueId\": \"password\"\r\n          }\r\n        },\r\n        \"length\": 16\r\n      }\r\n    },\r\n    \"random_pet\": {\r\n      \"password\": {\r\n        \"//\": {\r\n          \"metadata\": {\r\n            \"path\": \"test-override/pet-password\",\r\n            \"uniqueId\": \"password\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n```","createdAt":"2023-11-24T09:48:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3290#issuecomment-1825405141","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5szZK_","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"If you feel strongly about keeping the terraform naming conventions in place in your CDKTF application you can extend the existing resources:\r\n\r\n```ts\r\nimport { S3Bucket, S3BucketConfig } from \"./.gen/providers/aws/s3-bucket\"\r\n\r\nclass BetterS3Bucket extends S3Bucket {\r\n  constructor(scope: Construct, name: string, config: S3BucketConfig) {\r\n    super(scope, `${S3Bucket.tfResourceType}-${name}`, config);\r\n    this.overrideLogicalId(name)\r\n  }\r\n}\r\n```\r\n\r\nFor this class the same constraints as in Terraform would apply.","createdAt":"2023-11-24T09:52:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3290#issuecomment-1825411775","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5s1hrw","author":{"login":"shinebayar-g"},"authorAssociation":"NONE","body":"Thanks for the explanation and workarounds.\r\n\r\n> as the underlying [construct](https://github.com/aws/constructs) package (which is used by all CDKs), makes no distinction between types of constructs and requires a unique name within each scope.\r\n\r\nIt looks like every resource is extended from `cdktf.TerraformResource` class and has `tfResourceType` property. Maybe using this information it might be doable.\r\nI hope this limitation will be improved in the future.","createdAt":"2023-11-24T18:09:40Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3290#issuecomment-1825970928","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc573dsz","author":{"login":"StefanTheWiz"},"authorAssociation":"NONE","body":"> If you feel strongly about keeping the terraform naming conventions in place in your CDKTF application \r\n\r\nErr... we do feel strongly about this. CDKTF will be a tough sell in any organisation unless it saves us time writing code.\r\n\r\n> Thank you for raising this. I agree from a Terraform point of view â€“ unfortunately, we can't control this, as the underlying [construct](https://github.com/aws/constructs) package (which is used by all CDKs), makes no distinction between types of constructs and requires a unique name within each scope.\r\n\r\nI don't fully agree with the \"we can't control this\" part.\r\n\r\nChild classes of `Construct` that are defined in the `cdktf` package have access to the element type so one of these classes that's closest to the `Construct` class in terms of hierarchy could prefix the id with the element/resource type before passing it to the parent class, no?\r\n\r\n\r\nIn terms of practical solutions for people who might have wasted time looking into a nice hack for this, I just gave up and used `uuid` for now ğŸ˜„ \r\n```js\r\nimport { S3BucketServerSideEncryptionConfigurationA } from \"@cdktf/provider-aws/lib/s3-bucket-server-side-encryption-configuration\";\r\nimport { v4 as uuid } from \"uuid\";\r\n\r\nnew S3BucketServerSideEncryptionConfigurationA(this, uuid(), {\r\n      bucket: \"my-bucket\",\r\n      rule: [{ applyServerSideEncryptionByDefault: { sseAlgorithm: \"aws:kms\" } }],\r\n    }).overrideLogicalId(id);\r\n```\r\n\r\nCode brevity is really appreciated, especially for long resource names like `S3BucketServerSideEncryptionConfiguration`...\r\n","createdAt":"2024-04-25T20:40:49Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3290#issuecomment-2078137139","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6KzVev","author":{"login":"MiguelAraCo"},"authorAssociation":"NONE","body":"The following patches seem to be working on my side (haven't done extensive testing):\r\n\r\n`constructs`\r\n\r\n```patch\r\ndiff --git a/lib/construct.js b/lib/construct.js\r\nindex 4bb61d6c0c27e4fcd5a3abcd4fbd762827804890..cbe28b328b94660a8c58be1cbc8a0d339d1dd2aa 100644\r\n--- a/lib/construct.js\r\n+++ b/lib/construct.js\r\n@@ -20,7 +20,9 @@ class Node {\r\n     static of(construct) {\r\n         return construct.node;\r\n     }\r\n-    constructor(host, scope, id) {\r\n+    // Store originalId to allow constructs with different types to have the same id\r\n+    // See: https://github.com/hashicorp/terraform-cdk/issues/3290\r\n+    constructor(host, scope, id, originalId) {\r\n         this.host = host;\r\n         this._locked = false; // if this is \"true\", addChild will fail\r\n         this._children = {};\r\n@@ -30,6 +32,7 @@ class Node {\r\n         this._validations = new Array();\r\n         id = id ?? ''; // if undefined, convert to empty string\r\n         this.id = sanitizeId(id);\r\n+        this.originalId = originalId !== undefined ? sanitizeId(originalId) : undefined;\r\n         this.scope = scope;\r\n         if (scope && !this.id) {\r\n             throw new Error('Only root constructs may have an empty ID');\r\n@@ -422,8 +425,8 @@ class Construct {\r\n      * the ID includes a path separator (`/`), then it will be replaced by double\r\n      * dash `--`.\r\n      */\r\n-    constructor(scope, id) {\r\n-        this.node = new Node(this, scope, id);\r\n+    constructor(scope, id, originalId) {\r\n+        this.node = new Node(this, scope, id, originalId);\r\n         // implement IDependable privately\r\n         dependency_1.Dependable.implement(this, {\r\n             dependencyRoots: [this],\r\n\r\n```\r\n\r\n`cdktf`\r\n\r\n```patch\r\ndiff --git a/lib/terraform-element.js b/lib/terraform-element.js\r\nindex 7c142f61c501b2072959219daaafa3b744c7d3fe..bf61f1b5f24e17e66f90938b0216613244117962 100644\r\n--- a/lib/terraform-element.js\r\n+++ b/lib/terraform-element.js\r\n@@ -12,10 +12,20 @@ const terraform_stack_1 = require(\"./terraform-stack\");\r\n const tfExpression_1 = require(\"./tfExpression\");\r\n const errors_1 = require(\"./errors\");\r\n const TERRAFORM_ELEMENT_SYMBOL = Symbol.for(\"cdktf/TerraformElement\");\r\n+\r\n+function sanitize(prefix) {\r\n+  return prefix.replaceAll(/[^a-z0-9-_]/ig, \"_\");\r\n+}\r\n+\r\n // eslint-disable-next-line jsdoc/require-jsdoc\r\n class TerraformElement extends constructs_1.Construct {\r\n     constructor(scope, id, elementType) {\r\n-        super(scope, id);\r\n+        // Store originalId to allow constructs with different types to have the same id\r\n+        // See: https://github.com/hashicorp/terraform-cdk/issues/3290\r\n+        const originalId = id;\r\n+        id = sanitize(`${elementType ?? new.target.name}_${id}`);\r\n+\r\n+        super(scope, id, originalId);\r\n         this.rawOverrides = {};\r\n         Object.defineProperty(this, TERRAFORM_ELEMENT_SYMBOL, { value: true });\r\n         this._elementType = elementType;\r\ndiff --git a/lib/terraform-stack.js b/lib/terraform-stack.js\r\nindex 4fa973fda6420cb134dc14650cd5e7cdc4bd4e7f..9eceee623995a5fd247a47b009adfe6e2958c49e 100644\r\n--- a/lib/terraform-stack.js\r\n+++ b/lib/terraform-stack.js\r\n@@ -136,7 +136,9 @@ class TerraformStack extends constructs_1.Construct {\r\n             ? tfElement.cdktfStack\r\n             : this;\r\n         const stackIndex = node.scopes.indexOf(stack);\r\n-        const components = node.scopes.slice(stackIndex + 1).map((c) => c.node.id);\r\n+        // Store originalId to allow constructs with different types to have the same id\r\n+        // See: https://github.com/hashicorp/terraform-cdk/issues/3290\r\n+        const components = node.scopes.slice(stackIndex + 1).map((c) => c.node.originalId ?? c.node.id);\r\n         return components.length > 0 ? (0, unique_1.makeUniqueId)(components) : \"\";\r\n     }\r\n     allProviders() {\r\n\r\n```\r\n\r\nAfter applying those patches, internally `cdktf` should use an id that has the element type baked into it, and use the defined id when generating the terraform state, so this should work as expected:\r\n\r\n```typescript\r\nclass DevStack extends TerraformStack {\r\n    constructor(scope: Construct, id: string) {\r\n        super(scope, id);\r\n\r\n        new GoogleProvider(this, \"dev\", {\r\n            project: \"foo\",\r\n        });\r\n\r\n        // cdktf id = ComputeNetwork_main\r\n        // state id = google_compute_network.main\r\n        const vpc = new ComputeNetwork(this, \"main\", {\r\n            name: \"main\",\r\n            routingMode: \"REGIONAL\",\r\n            autoCreateSubnetworks: false,\r\n        });\r\n\r\n        // cdktf id = ComputeRoute_main\r\n        // state id = google_compute_route.main\r\n        new ComputeRoute(this, \"main\", {\r\n            name: \"egress-internet\",\r\n            description: \"route through IGW to access internet\",\r\n            destRange: \"0.0.0.0/0\",\r\n            network: vpc.id,\r\n            nextHopGateway: \"default-internet-gateway\",\r\n        });\r\n    }\r\n}\r\n```","createdAt":"2024-09-04T11:38:02Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":3}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3290#issuecomment-2328713135","viewerDidAuthor":false}],"createdAt":"2023-11-23T03:01:01Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"}],"milestone":null,"number":3290,"title":"cdktf: construct name should be unique per resource type [same as terraform]","updatedAt":"2024-09-04T12:00:07Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzNTM0MDE=","is_bot":false,"login":"MJohnson459","name":"Michael Johnson"},"body":"### Expected Behavior\n\nI am running `cdktf destroy` via a python using `subprocess.run`. The exact command is \r\n```python\r\nimport subprocess\r\nsubprocess.run([\"cdktf\", \"destroy\", \"--auto-approve\"], check=True)\r\n```\r\n\r\nWhen this is destroying instances, pressing `ctrl +c` should stop the destroy and leave the `terraform.<stack>.tfstate` file with an accurate list of state.\r\n\n\n### Actual Behavior\n\nThe `terraform.<stack>.tfstate` file is empty.\n\n### Steps to Reproduce\n\nI did a fair bit of testing to try and narrow down what exactly is happening here and get it to the smallest repeatable unit. It seems like the `python` subprocess call is required for the state to be emptied permanently, however using a raw `cdktf destroy` I noticed that the state file is briefly emptied and then recreated. This seems dependent on the size of the state.\r\n\r\nI suspect what is happening is when the subprocess is cancelled, there isn't enough time given for the `cdktf` process to recreate the state file. Normally the `cdktf` process would be given about 10 seconds before the kill is escalated. \r\n\r\n1. Start an instance with a lot of resources. For example many files.\r\n2. Run `cdktf destroy` via python\r\n```python\r\nimport subprocess\r\nsubprocess.run([\"cdktf\", \"destroy\", \"--auto-approve\"], check=True)\r\n```\r\n4. When the resources are being destroyed, press `ctrl +c`.\r\n\r\nI can reliably reproduce this with a ~5MB state file.\n\n### Versions\n\n```\r\n$ cdktf debug\r\nlanguage: python\r\ncdktf-cli: 0.18.0\r\nnode: v18.12.0\r\ncdktf: 0.18.0\r\nconstructs: 10.2.70\r\njsii: 1.89.0\r\nterraform: 1.6.4\r\narch: x64\r\nos: linux 5.15.0-88-generic\r\npython: Python 3.9.6\r\npip: pip 21.1.3 from /home/michael/.pyenv/versions/3.9.6/envs/locus3.9/lib/python3.9/site-packages/pip (python 3.9)\r\npipenv: null\r\n```\n\n### Providers\n\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name                â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ aws           â”‚ 5.19.0           â”‚ ^0.18.0 â”‚            â”‚ cdktf-cdktf-provider-aws    â”‚ 17.0.8          â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ random        â”‚ 3.5.1            â”‚ ^0.18.0 â”‚            â”‚ cdktf-cdktf-provider-random â”‚ 9.0.0           â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ tls           â”‚ 4.0.4            â”‚ ^0.18.0 â”‚            â”‚ cdktf-cdktf-provider-tls    â”‚ 8.0.0           â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\nIt might be possible to write the state to a temporary file and then swap instead of emptying the existing state and rewriting it.\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5sQ6K4","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Hey, could you try to run this outside of python through CDKTF CLI and see if the problem persists? We are using the [AbortController](https://developer.mozilla.org/en-US/docs/Web/API/AbortController) API under the hood and are forwarding the abort signal to the Terraform CLI. If you abort on CDKTF CLI directly I would assume it takes a few seconds for the abort inside Terraform CLI to be processed. If the python package aborts hard directly or after a certain grace period I think a possibly corrupted state file might be a possibility.","createdAt":"2023-11-17T12:54:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3269#issuecomment-1816371896","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5sRKMm","author":{"login":"MJohnson459"},"authorAssociation":"NONE","body":"Hey. Running the `cdktf` directly doesn't _permanently_ remove the state however it is still temporarily in a corrupted state. Do you know why the state file is cleaned at all during the process? I had a look through the code but couldn't find where that happens. Is the state file managed by terraform directly or by the CDK?\r\n\r\nGiven that the updating the state is not being done atomically, it seems likely that other workflows outside the specific python case could also corrupt the state. I'm happy to look into a fix if you can point me in the right direction.\r\n\r\n","createdAt":"2023-11-17T13:31:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3269#issuecomment-1816437542","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5sRK68","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"The state file is managed by terraform directly, I think it's most likely somewhere in terraform. ","createdAt":"2023-11-17T13:33:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3269#issuecomment-1816440508","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5sRU2K","author":{"login":"MJohnson459"},"authorAssociation":"NONE","body":"It looks like there is already a TODO comment in terraform for this issue\r\nhttps://github.com/hashicorp/terraform/blob/1f9734619f953ecc7252d7b98a6d40d751b4ea1e/internal/states/statemgr/filesystem.go#L124C1-L129C18","createdAt":"2023-11-17T13:59:38Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3269#issuecomment-1816481162","viewerDidAuthor":false}],"createdAt":"2023-11-16T17:39:30Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"},{"id":"MDU6TGFiZWwzMjA1MTIxODAz","name":"enhancement/new-workflow","description":"Proposed new workflow","color":"4A1023"}],"milestone":null,"number":3269,"title":"cdktf: Large `terraform.<stack>.tfstate` file is cleaned when `destroy` is cancelled","updatedAt":"2023-11-17T13:59:39Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjU5OTc4MjYx","is_bot":false,"login":"fathom-parth","name":"Parth Doshi"},"body":"### Expected Behavior\n\nThe stacks that did not fail should continue and complete. Once this is complete the error message for the stack that failed should be printed at the end. Also no other new stacks then should run. At the end of a failure the state file should not be locked for any of the stacks.\n\n### Actual Behavior\n\nRemote state file gets locked for the stacks that were running in parallel but did not fail.\r\nAt the end of the debug logs linked below, I would've expected it to end with:\r\n```\r\nStep #2: 1 Stack deploying     4 Stacks done     0 Stacks waiting\r\n--\r\nStep #2: Invoking Terraform CLI failed with exit code 1\r\n```\n\n### Steps to Reproduce\n\n1. Setup cdktf project with multiple stacks which can run in parallel\r\n2. Make sure one of the stack fails while other stacks are not complete\r\n3. Run the stacks in parallel\r\n4. Look at the state file of the stacks that did not fail\n\n### Versions\n\ncdktf debug\r\nlanguage: python\r\ncdktf-cli: 0.18.0\r\nnode: v18.17.1\r\ncdktf: 0.18.0\r\nconstructs: 10.3.0\r\njsii: 1.91.0\r\nterraform: 1.4.6\r\narch: x64\r\nos: linux 5.15.49-linuxkit\r\npython: Python 3.7.16\r\npip: pip 21.3.1 from /usr/local/lib/python3.7/site-packages/pip (python 3.7)\r\npipenv: null\n\n### Providers\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name                     â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ google        â”‚ 4.83.0           â”‚ ^0.18.0 â”‚            â”‚ cdktf-cdktf-provider-google      â”‚ 9.0.4           â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ google-beta   â”‚ 4.83.0           â”‚ ^0.18.0 â”‚            â”‚ cdktf-cdktf-provider-google-beta â”‚ 9.0.4           â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ kubernetes    â”‚ 2.23.0           â”‚ ^0.18.0 â”‚            â”‚ cdktf-cdktf-provider-kubernetes  â”‚ 9.0.0           â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n### Gist\n\nhttps://gist.github.com/fathom-parth/9c14c7e54028560c06d300a5484f0f7b\n\n### Possible Solutions\n\nNot sure :(\n\n### Workarounds\n\nNone that we know of\n\n### Anything Else?\n\n_No response_\n\n### References\n\nThis is supposedly fixed in https://github.com/hashicorp/terraform-cdk/issues/1836 but we're still seeing this issue (most of the above text for expected behavior and actual behavior is copied/pasted).\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5qThe_","author":{"login":"fathom-parth"},"authorAssociation":"NONE","body":"I think what's happening is that we have cross-stack dependencies here that are running into this issue:\r\nhttps://github.com/hashicorp/terraform-cdk/issues/3023\r\n\r\nwhich then causes all the stacks to fail because it's an unhandled exception and makes all the stacks locked","createdAt":"2023-10-27T20:55:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3206#issuecomment-1783502783","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5sQ8NG","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Hey, would you be so kind to create a minimal example for this? The tests we have for this behaviour work just fine so we must be missing a detail here when building the reproduction case.","createdAt":"2023-11-17T12:58:55Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3206#issuecomment-1816380230","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5tgzBh","author":{"login":"github-actions"},"authorAssociation":"CONTRIBUTOR","body":"Hi there! ğŸ‘‹ We haven't heard from you in 15 days and would like to know if the problem has been resolved or if you still need help. If we don't hear from you before then, I'll auto-close this issue in 30 days.","createdAt":"2023-12-03T02:30:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3206#issuecomment-1837314145","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5yvY1p","author":{"login":"github-actions"},"authorAssociation":"CONTRIBUTOR","body":"Hi there! ğŸ‘‹ We haven't heard from you in 15 days and would like to know if the problem has been resolved or if you still need help. If we don't hear from you before then, I'll auto-close this issue in 30 days.","createdAt":"2024-02-03T02:24:41Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3206#issuecomment-1925025129","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5yzxVF","author":{"login":"loozhengyuan"},"authorAssociation":"NONE","body":"Just wanted to add that our team experienced this issue as well","createdAt":"2024-02-05T03:35:56Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3206#issuecomment-1926174021","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7JJMwP","author":{"login":"aong-atlassian"},"authorAssociation":"NONE","body":"We've experienced this behaviour as well - we're running up many stacks in parallel and AWS failures have caused our deployment runs to mess up quite badly.\n\nI think I've got a fix - please see the [PR](https://github.com/hashicorp/terraform-cdk/pull/3934)","createdAt":"2025-10-06T23:28:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3206#issuecomment-3374631951","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7JJY_W","author":{"login":"aong-atlassian"},"authorAssociation":"NONE","body":"Note: for anyone reading, there is a workaround I believe if you set your cdktf `--parallelism` > number of stacks (infinity is the default?), I don't think you run into the affected bit of code.","createdAt":"2025-10-07T00:01:01Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3206#issuecomment-3374682070","viewerDidAuthor":false}],"createdAt":"2023-10-27T20:54:43Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTQ2NjcxNDUz","name":"feature/multi-stack","description":"","color":"6589C9"}],"milestone":null,"number":3206,"title":"One stack failure when deploying multiple stack in parallel causes other stacks state to remain locked","updatedAt":"2025-10-07T00:01:29Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjQ5OTg3NDI1","is_bot":false,"login":"felixmagnus","name":"Felix Magnus"},"body":"### Expected Behavior\n\nAll dependencies used by a package should be declared in that packages `package.json` file.\r\nThis ensures a safe package resolution & install process independent from the used package manager.\n\n### Actual Behavior\n\nCertain dependencies in different packages are missing an explicit declaration in their respective `package.json`.\r\n\r\nComplete List of missing dependencies by package:\r\n\r\n### `packages/@cdktf/cli-core`\r\n\r\n- `ci-info` is missing (usage is in ` ./src/lib/error-reporting.ts`)\r\n\r\n### `packages/@cdktf/commons`\r\n\r\n- `strip-ansi` is missing (usage is in `./src/util.ts`)\r\n\r\n### `packages/@cdktf/hcl2cdk`\r\n\r\n- `fs-extra` is missing (usage is in `./test/helpers/convert.ts` --> so should be a `devDependency` probably?)\r\n- `execa` is missing (usage is in `./test/helpers/convert.ts` --> so should be a `devDependency` probably?)\r\n- `codemaker` is missing (usage is in `./lib/coerceType.ts`)\r\n\r\n### `packages/@cdktf/provider-generator`\r\n\r\n- `glob` is missing (usage is in `./lib/get/constructs-maker.ts`)\r\n\r\n### `packages/@cdktf/provider-schema`\r\n\r\n- `deepmerge` is missing (usage is in `./src/read.ts`)\r\n\r\n---\r\n\r\nI stumbled across this issue due to our pipeline sometimes failing during a `cdktf deploy` with error messages like:\r\n\r\n```\r\nCannot find module 'strip-ansi'\r\n...\r\nCannot find module 'glob'\r\n...\r\netc.\r\n```\r\n\r\nAs we use turborepo + pnpm (which I know is not officially supported by cdktf) and you have not stumbled over those missing dependency declarations so far my guess is that yarn / lerna workspaces are in some way more forgiving wrt. these declarations (compared to pnpm).\r\n\r\nBesides fixing the issue for our (to be fair unsupported pnpm) usecase I nevertheless think it would be sensible to declare the dependencies explicitly as mentioned above.\n\n### Steps to Reproduce\n\n- Clone the repository.\r\n- Go into any of the mentioned packages:\r\n    - `packages/@cdktf/cli-core`\r\n    - `packages/@cdktf/commons`\r\n    - `packages/@cdktf/hcl2cdk`\r\n    - `packages/@cdktf/provider-generator`\r\n    - `packages/@cdktf/provider-schema`\r\n - Run `npx depcheck` (See [depcheck](https://github.com/depcheck/depcheck)) and look at the \"Missing dependencies\" section\n\n### Versions\n\nI cloned the repository on commit: `e207a50aae198ac7cc78dc40356b35946c9d1ad8` (`origin/main` at that time)\r\nTags: `v0.19.0-pre.34`,  `v0.19.0`\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\nAdd the missing dependencies as explicit declarations in the respective `package.json` files.\n\n### Workarounds\n\n-\n\n### Anything Else?\n\nPlease let me know if you need anything else from me, I'll be glad to support further to get the issue resolved.\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [X] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5pqf6K","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Thank you for pointing this out, I opened a PR to fix this and added one that runs `depcheck` on PRs so we don't run into this issue again :) yarn is very convenient, but it makes it easy to forget adding the dependencies when everything runs as expected","createdAt":"2023-10-20T13:32:15Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3199#issuecomment-1772748426","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5pqiIx","author":{"login":"felixmagnus"},"authorAssociation":"NONE","body":"No worries! Great to hear, thanks for reacting so quickly ğŸ™‚ ","createdAt":"2023-10-20T13:38:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3199#issuecomment-1772757553","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5qUp25","author":{"login":"koshic"},"authorAssociation":"NONE","body":"> yarn is very convenient, but it makes it easy to forget adding the dependencies when everything runs as expected\r\n\r\nJust enable Yarn PnP and you will see all possible dependency issues, including require / dynamic imports )\r\n\r\nBTW, there is additional missed dependency `@cdktf/node-pty-prebuilt-multiarch` in `cdktf-cli`. It's not a direct dependency, so you can't find any import / require in code. But, it present in the compiled `bundle/bin/cmds/handlers.js`:\r\n<img width=\"458\" alt=\"image\" src=\"https://github.com/hashicorp/terraform-cdk/assets/20106607/eeb57b33-d53b-41e8-8610-0c7cbde26d26\">\r\n\r\nThe root cause is:\r\nhttps://github.com/hashicorp/terraform-cdk/blob/e207a50aae198ac7cc78dc40356b35946c9d1ad8/packages/cdktf-cli/build.ts#L72-L82\r\npackage.json doesn't contains that dependency.\r\n","createdAt":"2023-10-28T12:43:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/3199#issuecomment-1783799225","viewerDidAuthor":false}],"createdAt":"2023-10-19T12:09:39Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"}],"milestone":null,"number":3199,"title":"workspace: missing dependencies","updatedAt":"2023-10-28T12:43:36Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjg4Njc0NTY=","is_bot":false,"login":"ScionOfDesign","name":"Scion"},"body":"### Expected Behavior\n\nI expect that my [custom provider](https://github.com/StudioWhyNot/terraform-provider-installer) I have specified a developer override for via a `.terraformrc` file will be generated properly.\n\n### Actual Behavior\n\nThe `cdktf get` command fails, either from typescript errors in WSL or and invalid character error on windows. It is trying to put the `:` character into type names and file paths. `:` is an invalid file path character on windows.\n\n### Steps to Reproduce\n\n1. Make and install the custom provider [here](https://github.com/StudioWhyNot/terraform-provider-installer) the `make install` command will work on WSL or use the .exe from `make build` on Windows.\r\n2. Create a new `.terraformrc` file such as the following to override the \"installer\" provider with a local dev one:\r\n```\r\nprovider_installation {\r\n  dev_overrides {\r\n    \"registry.terraform.io/shihanng/installer\" = \"/tmp/tfproviders/\"\r\n  }\r\n  direct {}\r\n}\r\n```\r\n3. Set the environment variable: `TF_CLI_CONFIG_FILE=%cd%\\.terraformrc` or for WSL `TF_CLI_CONFIG_FILE=$(pwd)/.terraformrc`\r\n4. Generate a new cdktf project using the `shihanng/installer` provider. (I used C# as the language)\r\n5. Observe a bunch of typescript errors in WSL or the following error on Windows:\r\n```\r\nError: Path contains invalid characters: C:\\Users\\Scion\\AppData\\Local\\Temp\\cdktf.fHeGbu\\providers\\installer\\data-apt:installer\r\n    at Xue.exports.checkPath (C:\\Users\\Scion\\AppData\\Roaming\\npm\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:39:8584)\r\n    at Vj.exports.makeDir (C:\\Users\\Scion\\AppData\\Roaming\\npm\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:39:8836)\r\n    at Object.<anonymous> (C:\\Users\\Scion\\AppData\\Roaming\\npm\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:39:6954)\r\n    at tU.save (C:\\Users\\Scion\\AppData\\Roaming\\npm\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:44:4597)\r\n    at C:\\Users\\Scion\\AppData\\Roaming\\npm\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:44:5210\r\n    at Array.map (<anonymous>)\r\n    at iU.save (C:\\Users\\Scion\\AppData\\Roaming\\npm\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:44:5201)\r\n    at C:\\Users\\Scion\\AppData\\Roaming\\npm\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:116:14610\r\n    at Xvt (C:\\Users\\Scion\\AppData\\Roaming\\npm\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:88:71624)\r\n    at async i9e (C:\\Users\\Scion\\AppData\\Roaming\\npm\\node_modules\\cdktf-cli\\bundle\\bin\\cmds\\handlers.js:116:14571) {\r\n  code: 'EINVAL'\r\n}\r\nâ ¦ downloading and generating modules and providers...\r\nError: Path contains invalid characters: C:\\Users\\Scion\\AppData\\Local\\Temp\\cdktf.fHeGbu\\providers\\installer\\data-apt:installer\r\n```\n\n### Versions\n\nlanguage: C#\r\ncdktf: 0.19.0\r\nnode: 20.8.1\r\nterraform: 1.6.1\r\narch: x64\r\nos: Ubuntu 22.04.3 WSL and Windows 11\n\n### Providers\n\nshihanng/installer (developer override)\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2023-10-18T20:06:18Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjE4NTU2NzE0","name":"windows","description":"","color":"839ad1"},{"id":"MDU6TGFiZWwyMjQ2NzM1NDk1","name":"providers","description":"","color":"2bd8cd"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"LA_kwDODd1Amc7WpEvS","name":"ux/integration","description":"","color":"D670CB"}],"milestone":null,"number":3197,"title":"`cdktf get` with a custom provider attempts to generate paths with the invalid character `:`","updatedAt":"2023-11-17T13:00:19Z"},{"assignees":[],"author":{"id":"U_kgDOBvd4sw","is_bot":false,"login":"xxjt123xx","name":"Josh Thornes"},"body":"### Description\n\nthe rule and target is not documented in typescript \n\n### Links\n\nhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_event_target?lang=typescript\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5sQ-Zq","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"The page looks correct to me, can you clarify what is missing? ","createdAt":"2023-11-17T13:05:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3189#issuecomment-1816389226","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5tgzBu","author":{"login":"github-actions"},"authorAssociation":"CONTRIBUTOR","body":"Hi there! ğŸ‘‹ We haven't heard from you in 15 days and would like to know if the problem has been resolved or if you still need help. If we don't hear from you before then, I'll auto-close this issue in 30 days.","createdAt":"2023-12-03T02:30:34Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3189#issuecomment-1837314158","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5yxaTr","author":{"login":"github-actions"},"authorAssociation":"CONTRIBUTOR","body":"Hi there! ğŸ‘‹ We haven't heard from you in 15 days and would like to know if the problem has been resolved or if you still need help. If we don't hear from you before then, I'll auto-close this issue in 30 days.","createdAt":"2024-02-04T02:27:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3189#issuecomment-1925555435","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5yxcfq","author":{"login":"xxjt123xx"},"authorAssociation":"NONE","body":"It looks like it is updated for the most part but the top section is still pointing at non TS \r\nhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudwatch_event_target?lang=typescript#kinesis-usage","createdAt":"2024-02-04T03:18:21Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3189#issuecomment-1925564394","viewerDidAuthor":false}],"createdAt":"2023-10-13T17:58:56Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"}],"milestone":null,"number":3189,"title":"Provider docs: event bridge docs not updated for ts","updatedAt":"2024-02-05T02:29:37Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjY3NzQ0NDc=","is_bot":false,"login":"howdoicomputer","name":"Tyler Hampton"},"body":"### Expected Behavior\r\n\r\nWhen specifying an AWS provider constraint in `cdktf.json` then that provider version should be respected during `cdktf deploy`\r\n\r\n```\r\n{\r\n  \"language\": \"typescript\",\r\n  \"app\": \"npx ts-node main.ts\",\r\n  \"projectId\": \"30757798-f725-4911-93f3-408b04e39e77\",\r\n  \"sendCrashReports\": \"false\",\r\n  \"terraformProviders\": [\"aws@~> 4.0\"],\r\n  \"terraformModules\": [],\r\n  \"context\": {}\r\n}\r\n```\r\n\r\n### Actual Behavior\r\n\r\n`cdktf` will resolve the latest provider version and use that instead to deploy. When `cdktf provider list` is ran, two versions of the same provider are installed.\r\n\r\n### Steps to Reproduce\r\n\r\n1. Run through the `Build AWS infrastructure with CDK for Terraform` tutorial\r\n2. Edit `cdktf.json` so that there is a version constraint locking the AWS provider to anything with the `4.0` range.\r\n\r\nExample:\r\n\r\n```\r\n{\r\n  \"language\": \"typescript\",\r\n  \"app\": \"npx ts-node main.ts\",\r\n  \"projectId\": \"30757798-f725-4911-93f3-408b04e39e77\",\r\n  \"sendCrashReports\": \"false\",\r\n  \"terraformProviders\": [\"aws@~> 4.0\"],\r\n  \"terraformModules\": [],\r\n  \"context\": {}\r\n}\r\n```\r\n\r\n3. Run `cdktf provider get`\r\n4. Run `cdktf deploy`\r\n5. Observe that the AWS provider being used to deploy resources is `~> 5.0`\r\n\r\n### Versions\r\n\r\nlanguage: typescript\r\ncdktf-cli: 0.18.2\r\nnode: v18.18.0\r\ncdktf: 0.18.2\r\nconstructs: 10.3.0\r\njsii: null\r\nterraform: 1.6.0-dev\r\narch: x64\r\nos: linux 6.1.56\r\n\r\n### Providers\r\n\r\n[howdoicomputer@framework:~/workspace/aws-cdktf-example]$ cdktf provider list\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name        â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ aws           â”‚ 4.67.0           â”‚         â”‚ ~> 4.0     â”‚                     â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ aws           â”‚ 5.20.1           â”‚ ^0.18.0 â”‚            â”‚ @cdktf/provider-aws â”‚ 17.0.10         â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\n\r\n\r\n### Gist\r\nhttps://gist.github.com/howdoicomputer/601137636cdc079799e1c2c7daee2b64\r\n\r\n### Possible Solutions\r\n\r\nNone.\r\n\r\n### Workarounds\r\n\r\nNone.\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [X] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5o-MIV","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"[The tutorial](https://developer.hashicorp.com/terraform/tutorials/cdktf/cdktf-build) you are following is using the [pre-built provider](https://github.com/cdktf/cdktf-provider-aws) as you can see by the imports being `@cdktf/provider-aws/...` instead of `./.gen/providers/aws/...`. You added the 4.x aws provider as a local provider binding so `cdktf provider list` shows both being installed, one in version 4 with local bindings and one in version 5 with pre-built ones. If you want to switch which one is used you can change your imports to the local format (and also remove the pre-built provider from your package.json)","createdAt":"2023-10-13T08:35:30Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3188#issuecomment-1761133077","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5pDxzR","author":{"login":"howdoicomputer"},"authorAssociation":"CONTRIBUTOR","body":"@DanielMSchmidt You are right but the tutorial probably should be updated. So following the tutorial from absolute scratch by making a `learn-tf` directory, cding into it, generating scaffolding, copy and pasting the tutorial code, and then running `cdktf deploy` I get:\r\n\r\n```\r\n[howdoicomputer@framework:~/workspace/learn-cdktf]$ cdktf deploy\r\n\r\nâ ‹  Synthesizing\r\n[2023-10-13T21:44:12.908] [ERROR] default - /home/howdoicomputer/workspace/learn-cdktf/node_modules/ts-node/src/index.ts:859\r\n    return new TSError(diagnosticText, diagnosticCodes, diagnostics);\r\n           ^\r\n\r\n[2023-10-13T21:44:12.908] [ERROR] default - TSError: â¨¯ Unable to compile TypeScript:\r\nmain.ts(3,29): error TS2307: Cannot find module '@cdktf/provider-aws/lib/provider' or its corresponding type declarations.\r\nmain.ts(4,26): error TS2307: Cannot find module '@cdktf/provider-aws/lib/instance' or its corresponding type declarations.\r\nmain.ts(28,5): error TS2304: Cannot find name 'RemoteBackend'.\r\n```\r\n\r\nThis is after following every step to-the-letter in of the tutorial. However, I had missed this message from the scaffolding:\r\n\r\n```\r\n[2023-10-13T21:42:00.423] [INFO] default - Checking whether pre-built provider exists for the following constraints:\r\n  provider: aws\r\n  version : ~>4.0\r\n  language: typescript\r\n  cdktf   : 0.18.2\r\n\r\n[2023-10-13T21:42:01.505] [INFO] default - Pre-built provider does not exist for the given constraints.\r\n[2023-10-13T21:42:01.505] [INFO] default - Adding local provider registry.terraform.io/hashicorp/aws with version constraint ~>4.0 to cdktf.json\r\nLocal providers have been updated. Running cdktf get to update...\r\nGenerated typescript constructs in the output directory: .gen\r\n```\r\n\r\nThe code that is in the tutorial assumes a pre-built provider. However, a pre-built provider wasn't matched for the constraint passed into the command line: `cdktf init --template=\"typescript\" --providers=\"aws@~>4.0\"`. I initially fixed this by just using yarn to install an older prebuilt for the provider version that matched the tutorial.\r\n\r\nYeah, it's fixed if I change the import paths to the locally built provider but, like, it's the tutorial. I don't mind drafting a PR for this. Maybe just change the import statements in the tutorial code?","createdAt":"2023-10-14T05:02:25Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3188#issuecomment-1762598097","viewerDidAuthor":false}],"createdAt":"2023-10-12T21:01:02Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"}],"milestone":null,"number":3188,"title":"cdktf forces latest aws provider","updatedAt":"2023-10-14T05:03:25Z"},{"assignees":[{"id":"MDQ6VXNlcjU3MzUzMQ==","login":"mutahhir","name":"Mutahhir Hayat","databaseId":0}],"author":{"id":"MDQ6VXNlcjY3NzQ0NDc=","is_bot":false,"login":"howdoicomputer","name":"Tyler Hampton"},"body":"### Expected Behavior\n\n`cdktf deploy` is able to resolve `~/.aws/credentials` and `~/.aws/config` when ran\n\n### Actual Behavior\n\nI encountered an error while going through the tutorial for deploying applications to AWS. This one here: https://developer.hashicorp.com/terraform/tutorials/cdktf/cdktf-build\r\n\r\nWhen running `cdktf deploy` cdktf is unable to resolve the location to my `~/.aws/credentials` and `~/.aws/config` files.\r\n\r\nFor example:\r\n\r\n```\r\naws-cdktf-example  â•·\r\n                   â”‚ Error: No valid credential sources found\r\n                   â”‚ \r\n                   â”‚   with provider[\"registry.terraform.io/hashicorp/aws\"],\r\n                   â”‚   on cdk.tf.json line 24, in provider.aws[0]:\r\n                   â”‚   24:\r\n```\r\n\r\nI validated that my credentials are correct as I'm able to use the `awscli` to query resources.\r\n\r\nI also created a simple, plain Terraform setup and it was able to run just fine:\r\n\r\n```\r\nprovider \"aws\" {}\r\n\r\ndata \"aws_ami\" \"ubuntu\" {\r\n  most_recent = true\r\n\r\n  filter {\r\n    name   = \"name\"\r\n    values = [\"ubuntu/images/hvm-ssd/ubuntu-focal-20.04-amd64-server-*\"]\r\n  }\r\n\r\n  filter {\r\n    name   = \"virtualization-type\"\r\n    values = [\"hvm\"]\r\n  }\r\n\r\n  owners = [\"099720109477\"] # Canonical\r\n}\r\n\r\nresource aws_instance \"foobar\" {\r\n  ami           = data.aws_ami.ubuntu.id\r\n  instance_type = \"t2.micro\"\r\n}\r\n```\r\n\r\nI also tried setting `AWS_SHARED_CREDENTIALS_FILE` and `AWS_SHARED_CONFIG_FILE` environment variables and that didn't work either. I also tried setting the file locations for the provider in my cdktf code and that also didn't work. I also tried to force cdktf to use the version 4 of the AWS provider but couldn't get it to do that either - it just installed both 4 and 5 alongside each other and defaulted to 5. The above Terraform example used the same AWS provider version: `5.20.1`.\n\n### Steps to Reproduce\n\n1. Create an AWS user and generate keys for that user.\r\n2. Run `aws configure` and specify those keys.\r\n3. Go through the `Build AWS Infrastructure with CDK for Terraform` tutorial.\r\n4. Watch it fail when it can't find `~/.aws/credentials` or `~/.aws/config`.\n\n### Versions\n\nlanguage: typescript\r\ncdktf-cli: 0.18.2\r\nnode: v18.18.0\r\ncdktf: 0.18.2\r\nconstructs: 10.3.0\r\njsii: null\r\nterraform: 1.6.0-dev\r\narch: x64\r\nos: linux 6.1.56\n\n### Providers\n\n[howdoicomputer@framework:~/workspace/aws-cdktf-example]$ cdktf provider list\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name        â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ aws           â”‚ 4.67.0           â”‚         â”‚ ~> 4.0     â”‚                     â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ aws           â”‚ 5.20.1           â”‚ ^0.18.0 â”‚            â”‚ @cdktf/provider-aws â”‚ 17.0.10         â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\nThere are two providers because I was trying to use the previous provider but couldn't figure out how to force `cdktf` to use version 4 of the AWS provider.\n\n### Gist\n\nhttps://gist.github.com/howdoicomputer/601137636cdc079799e1c2c7daee2b64\n\n### Possible Solutions\n\nI haven't tried hard coding secrets in cdktf yet but I really don't want to do that.\n\n### Workarounds\n\nNo.\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [X] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5o7f-_","author":{"login":"howdoicomputer"},"authorAssociation":"CONTRIBUTOR","body":"I went further down the rabbit hole with this.\r\n\r\nI was able to figure out how to lock the AWS provider. I needed to lock the package version for the AWS provider bindings to `14.0.4` - otherwise the latest version of the bindings just does its own thing without bubbling up an error to the user.\r\n\r\nSo with an older, hopefully more stable version of the AWS provider:\r\n\r\n```\r\naws-cdktf-example  Initializing provider plugins...\r\n                   - Finding hashicorp/aws versions matching \"4.66.1\"...\r\naws-cdktf-example  - Installing hashicorp/aws v4.66.1...\r\naws-cdktf-example  - Installed hashicorp/aws v4.66.1 (signed by HashiCorp)\r\n```\r\n\r\nAnd with my provider config statically set:\r\n\r\n```\r\n    new AwsProvider(this, \"AWS\", {\r\n      region: \"us-west-2\",\r\n      profile: \"default\",\r\n      sharedConfigFiles: [\"$HOME/.aws/config\"],\r\n      sharedCredentialsFiles: [\"$HOME/.aws/credentials\"],\r\n    });\r\n```\r\n\r\nI'm getting:\r\n\r\n```\r\n                   â”‚ Error: configuring Terraform AWS Provider: failed to get shared config profile, default\r\n                   â”‚ \r\n                   â”‚   with provider[\"registry.terraform.io/hashicorp/aws\"],\r\n                   â”‚   on cdk.tf.json line 31, in provider.aws[0]:\r\n                   â”‚   31: \r\n```\r\n\r\nAgain, this works with standard terraform and the awscli so it *has* to be cdktf that is doing something weird. Or something is *incredibly* wacky about my local dev environment.","createdAt":"2023-10-12T21:58:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3187#issuecomment-1760427967","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5o7iPd","author":{"login":"howdoicomputer"},"authorAssociation":"CONTRIBUTOR","body":"Contents of `~/.aws/credentials`\r\n\r\n```\r\n[default]\r\naws_access_key_id = REDACTED\r\naws_secret_access_key = REDACTED\r\n```\r\n\r\nContents of `~/.aws/config`:\r\n\r\n```\r\n[howdoicomputer@framework:~/workspace/aws-cdktf-example]$ cat ~/.aws/config\r\n[default]\r\nregion = us-west-2\r\n```","createdAt":"2023-10-12T22:04:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3187#issuecomment-1760437213","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5o7sAM","author":{"login":"howdoicomputer"},"authorAssociation":"CONTRIBUTOR","body":"Setting environment variables also doesn't work; the only way I've gotten cdktf to read in my secret keys is by specifying them in my code and ehhhhhhhhh","createdAt":"2023-10-12T22:53:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3187#issuecomment-1760477196","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6BQ_Ic","author":{"login":"aleksclark"},"authorAssociation":"NONE","body":"experiencing the same issue - tf and awscli use my credentials fine, cdktf does not","createdAt":"2024-06-14T20:24:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3187#issuecomment-2168713756","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6BRAhC","author":{"login":"aleksclark"},"authorAssociation":"NONE","body":"man no sooner do a I comment....\r\n@howdoicomputer I resolved this by specifying `AWS_PROFILE=dev` when calling cdktf (matching my configured profile) - maybe specifying `default` would resolve?","createdAt":"2024-06-14T20:29:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3187#issuecomment-2168719426","viewerDidAuthor":false}],"createdAt":"2023-10-12T20:35:44Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMDEzOTU1NjM5","name":"needs-reproduction","description":"","color":"B29CB7"}],"milestone":null,"number":3187,"title":"cdktf is unable to resolve AWS local credentials","updatedAt":"2024-06-14T20:29:05Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE0MDMyNzE=","is_bot":false,"login":"pauldraper","name":"Paul Draper"},"body":"### Description\r\n\r\nThe @cdktf/provider-aws package is **342MB.**\r\n\r\nRemoving the inline source maps would reduce that by ~35%.\r\n\r\n---\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5u3Sx9","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"We added the source maps a while back on request of a user wo wanted to improve the jump to definition experience during development. I can see that the size is quite big but so is the underlying provider. By using specific imports one can reduce the compile time, so this improvement would most likely be only affecting the raw size of the package. \n\nI can see the size being an annoyance but the missing source maps would be one as well, therefore we are awaiting evidence here that this is a worthwhile investment. ","createdAt":"2023-12-18T10:02:48Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3178#issuecomment-1859988605","viewerDidAuthor":false}],"createdAt":"2023-10-06T17:51:40Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"}],"milestone":null,"number":3178,"title":"Remove source maps from providers","updatedAt":"2023-12-18T10:03:05Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjg1NTExNQ==","is_bot":false,"login":"xiehan","name":"Nara Kasbergen Kwon"},"body":"### Description\n\n> Thinking about this: It would be really cool, if `cdktf provider add` had a flag like `--force-remote` that would make the command fail, if e.g. there's no pre-built provider for Github for the new CDKTF version yet ğŸ¤” Would be simple to implement as well ğŸ˜„            \n\n### References\n\n_Originally posted by @ansgarm in https://github.com/cdktf/cdktf-repository-manager/pull/222#discussion_r1345826299_\r\n\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2023-10-04T15:16:21Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"},{"id":"LA_kwDODd1Amc78phHg","name":"cli/provider-subcommands","description":"cdktf provider <verb> commands","color":"4CBCB0"}],"milestone":null,"number":3168,"title":"cdktf provider add --force-remote","updatedAt":"2023-10-04T15:16:21Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"### Description\n\nThere are a some things we sometimes stumble upon in PR reviews, which we could automate for PRs that are ready for review. They all probably can go into lint rules.\r\n\r\n* Using `.only` in tests. We've had instances where these snuck past PR reviews and tests weren't run for some time\r\n* `TODO:`s in new code. Most of us use them for taking notes that only rarely intend to stay in the code that is to be merged\r\n* `console.log` statements. They make sometimes sense but if we're e.g. debugging CI with them, it would be helpful if our linter would help us to remove them again\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [X] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2023-10-02T13:58:10Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTU1MzExNDc0","name":"dev-process","description":"Improvements to how CDK for Terraform is developed and built","color":"F6A4ED"}],"milestone":null,"number":3165,"title":"PRs: Add more linting / automatic review","updatedAt":"2023-10-12T15:30:53Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEwNDAxNzk4","is_bot":false,"login":"zmully","name":"Zack Mully"},"body":"### Description\n\nTesting for the presence of a resource in a construct either requires using a snapshot, or onerously matching the object with `.toHaveResourceWithProperties`. While the CDKTF testing matchers have `.toHaveResource` available, this isnâ€™t helpful when you have many of a single type resource, it only tests that a resource of type X is present. Additionally, using native Jest matchers doesnâ€™t help because CDKTF resources are suffixed with a unique id, so instead of `pool_userPoolRecord` itâ€™s `pool_userPoolRecord_FFA0D2E2`, and this unique id can change if the tests are changed.\r\n\r\nTo simplify testing, especially when a construct calls another construct, and you just want to make sure that the child construct resources are present, itâ€™d be nice to be able to write a test like `.toHaveResourceWithName('pool_userPoolRecord')` and have it match the `pool_userPoolRecord_FFA0D2E2` resource.\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2023-09-29T16:20:03Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyNTcwMTY0OTY5","name":"testing","description":"","color":"456cc6"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"}],"milestone":null,"number":3158,"title":".toHaveResourceWithName matcher","updatedAt":"2023-10-12T15:30:07Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjU3NTA0NjIz","is_bot":false,"login":"gkaskonas","name":"Giedrius Kaskonas"},"body":"### Expected Behavior\r\n\r\nShould install using pnp and work\r\n\r\n### Actual Behavior\r\n\r\n```\r\nError: @cdktf/provider-generator tried to access glob, but it isn't declared in its dependencies; this makes the require call ambiguous and unsound.\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n1. Create a new cdktf project\r\n2. install dependencies\r\n3. run cdktf diff\r\n\r\n### Versions\r\n\r\nlanguage: typescript\r\ncdktf-cli: 0.18.0\r\nnode: v20.5.0\r\ncdktf: null\r\nconstructs: null\r\njsii: null\r\nterraform: 1.3.7\r\narch: arm64\r\nos: darwin 22.6.0\r\n\r\n### Providers\r\n\r\n_No response_\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\nFix package.json dependencies\r\n\r\n### Workarounds\r\n\r\n```\r\npackageExtensions:\r\n  \"@cdktf/hcl2cdk@*\":\r\n    dependencies:\r\n      cdktf: 0.18.0\r\n      codemaker: 1.89.0\r\n  \"@cdktf/provider-generator@*\":\r\n    dependencies:\r\n      glob: 10.3.10\r\n  cdktf-cli@*:\r\n    dependencies:\r\n      \"@cdktf/node-pty-prebuilt-multiarch\": \"0.10.1-pre.10\"\r\n```\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2023-09-28T11:12:34Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":3149,"title":"Yarn  pnp support","updatedAt":"2023-10-12T15:25:58Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM4Njg3NTQ=","is_bot":false,"login":"jsteinich","name":"Jon Steinich"},"body":"### Description\n\nThe generated module bindings for boolean variables currently only accept `boolean`. This causes issues when trying to pass other values or use functions.\r\nAll of the generated provider code uses `boolean | IResolvable`, so it makes sense to match that behavior (granted it isn't well supported in some languages).\n\n### References\n\n- https://discuss.hashicorp.com/t/token-asboolean/57589\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2023-09-14T01:31:02Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"}],"milestone":null,"number":3130,"title":"Module generation for boolean variable should also accept `IResolvable`","updatedAt":"2023-09-14T10:40:49Z"},{"assignees":[{"id":"MDQ6VXNlcjU3MzUzMQ==","login":"mutahhir","name":"Mutahhir Hayat","databaseId":0}],"author":{"id":"U_kgDOCAF8QA","is_bot":false,"login":"Ducky4023","name":""},"body":"### Expected Behavior\n\n`cdktf synth` successful.\n\n### Actual Behavior\n\n`cdktf synth` output:\r\n\r\n```â ‡  Synthesizing\r\n[2023-08-23T20:41:11.761] [ERROR] default - jsii.errors.JavaScriptError: \r\n  TypeError: Cannot read properties of undefined (reading 'TlsProvider')\r\n      at Kernel._Kernel_findSymbol (/tmp/tmpq5zjack7/lib/program.js:10304:28)\r\n      at Kernel._Kernel_findCtor (/tmp/tmpq5zjack7/lib/program.js:10045:100)\r\n      at Kernel._Kernel_create (/tmp/tmpq5zjack7/lib/program.js:10069:103)\r\n      at Kernel.create (/tmp/tmpq5zjack7/lib/program.js:9742:93)\r\n      at KernelHost.processRequest (/tmp/tmpq5zjack7/lib/program.js:11658:36)\r\n      at KernelHost.run (/tmp/tmpq5zjack7/lib/program.js:11618:22)\r\n      at Immediate._onImmediate (/tmp/tmpq5zjack7/lib/program.js:11619:46)\r\n      at process.processImmediate (node:internal/timers:478:21)\r\n\r\nThe above exception was the direct cause of the following exception:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/username/git/personal/cdktf-test/main.py\", line 16, in <module>\r\n    MyStack(app, \"cdktf-test\")\r\n  File \"/home/username/git/personal/cdktf-test/.venv/lib/python3.10/site-packages/jsii/_runtime.py\", line 118, in __call__\r\n    inst = super(JSIIMeta, cast(JSIIMeta, cls)).__call__(*args, **kwargs)\r\n  File \"/home/username/git/personal/cdktf-test/main.py\", line 12, in __init__\r\n    TlsProvider(self, \"blah\")\r\n  File \"/home/username/git/personal/cdktf-test/.venv/lib/python3.10/site-packages/jsii/_runtime.py\", line 118, in __call__\r\n    inst = super(JSIIMeta, cast(JSIIMeta, cls)).__call__(*args, **kwargs)\r\n  File \"/home/username/git/personal/cdktf-test/imports/tls/provider/__init__.py\", line 52, in __init__\r\n    jsii.create(self.__class__, self, [scope, id, config])\r\n  File \"/home/username/git/personal/cdktf-test/.venv/lib/python3.10/site-packages/jsii/_kernel/__init__.py\", line 334, in create\r\n    response = self.provider.create(\r\n  File \"/home/username/git/personal/cdktf-test/.venv/lib/python3.10/site-packages/jsii/_kernel/providers/process.py\", line 365, in create\r\n    return self._process.send(request, CreateResponse)\r\n  File \"/home/username/git/personal/cdktf-test/.venv/lib/python3.10/site-packages/jsii/_kernel/providers/process.py\", line 342, in send\r\n    raise RuntimeError(resp.error) from JavaScriptError(resp.stack)\r\nERROR: cdktf encountered an error while synthesizing\r\n```\n\n### Steps to Reproduce\n\nCreate python project and add TLS provider\r\n\r\nSample code that chokes on `cdktf synth`\r\n\r\n```python\r\n#!/usr/bin/env python\r\nfrom cdktf import App, TerraformStack\r\nfrom constructs import Construct\r\n\r\nfrom imports.tls.provider import TlsProvider\r\n\r\n\r\nclass MyStack(TerraformStack):\r\n    def __init__(self, scope: Construct, name: str):\r\n        super().__init__(scope, name)\r\n\r\n        TlsProvider(self, \"tls\")\r\n\r\n\r\napp = App()\r\nMyStack(app, \"cdktf-test\")\r\n\r\napp.synth()\r\n\r\n```\n\n### Versions\n\nlanguage: python\r\ncdktf-cli: 0.18.0\r\nnode: 20.5.1\r\ncdktf: 0.18.0\r\nconstructs: 10.2.69\r\njsii: 1.87.0\r\nterraform: 1.5.6\r\narch: x86_64\r\nos: Linux Mint 21.2 (kernel 6.2.0-26-generic)\n\n### Providers\n\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF â”‚ Constraint â”‚ Package Name â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ tls           â”‚ 4.0.4            â”‚       â”‚            â”‚              â”‚                 â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\nThis occurs with existing projects and as well as new ones.\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5_DtWn","author":{"login":"schlegel11"},"authorAssociation":"NONE","body":"Hello :smile: \r\nI can reproduce the same issue and this ticket is open for half a year. Is there any progress?","createdAt":"2024-05-25T23:32:45Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3106#issuecomment-2131678631","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5_EdO3","author":{"login":"schlegel11"},"authorAssociation":"NONE","body":"Ok the workaround is to use the prebuild binding directly from PyPI\r\nhttps://github.com/cdktf/cdktf-provider-tls\r\nhttps://pypi.org/project/cdktf-cdktf-provider-tls/","createdAt":"2024-05-26T01:16:51Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3106#issuecomment-2131874743","viewerDidAuthor":false}],"createdAt":"2023-08-24T03:05:33Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMDEzOTU1NjM5","name":"needs-reproduction","description":"","color":"B29CB7"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"}],"milestone":null,"number":3106,"title":"TLS: RuntimeError: Cannot read properties of undefined","updatedAt":"2024-05-26T12:52:31Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE3MjAyMDk=","is_bot":false,"login":"kination","name":"K.I. (Dennis) Jung"},"body":"### Expected Behavior\n\nWhen generator creates code based on template, if parameter is array, guide in code should show parameter as array.\n\n### Actual Behavior\n\nArray parameter in code is just showing raw value, without any square bracket.\n\n### Steps to Reproduce\n\nIt is related with following comment:\r\nhttps://github.com/hashicorp/terraform-cdk/pull/2964#issuecomment-1630767380\n\n### Versions\n\nlanguage: null\r\ncdktf-cli: 0.0.0\r\nnode: v16.14.2\r\nterraform: 1.4.2\r\narch: arm64\r\nos: darwin 22.5.0\r\n\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\n_No response_\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [X] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2023-08-18T03:24:45Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2MjAxMTE5","name":"provider get / generation","description":"","color":"CC3938"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":3095,"title":"Display correct data format inside document","updatedAt":"2023-08-18T09:04:18Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjU3MzUzMQ==","is_bot":false,"login":"mutahhir","name":"Mutahhir Hayat"},"body":"Windows integration tests were disabled due to them blocking the 0.18 release. The only failing ones were the java integration tests for windows.\r\n\r\nWe need to investigate, and re-enable the tests before making any further releases","comments":[],"createdAt":"2023-08-17T09:57:46Z","labels":[{"id":"MDU6TGFiZWwyMjE4NTU2NzE0","name":"windows","description":"","color":"839ad1"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"},{"id":"LA_kwDODd1Amc7Kmmfc","name":"feature/integration-test","description":"","color":"4F6FA8"}],"milestone":null,"number":3087,"title":"Re-enable Windows Integration tests","updatedAt":"2024-01-12T13:47:08Z"},{"assignees":[{"id":"MDQ6VXNlcjQxNjg0OQ==","login":"robin-norwood","name":"Robin Norwood","databaseId":0}],"author":{"id":"U_kgDOBfirOw","is_bot":false,"login":"nikpivkin","name":"Nikita Pivkin"},"body":"### Description\n\nIn the first example of this [section](https://developer.hashicorp.com/terraform/tutorials/cdktf/cdktf-build?variants=cdk-language%3Atypescript#define-your-cdk-for-terraform-application), the `RemoteBackend` class is used, but there is no import of it:\r\n\r\n```ts\r\nimport { App, TerraformStack, TerraformOutput } from \"cdktf\";\r\n```\r\n\r\nHow it should be:\r\n```ts\r\nimport { App, TerraformStack, TerraformOutput, RemoteBackend } from \"cdktf\";\r\n```\r\n\r\nI tried to find the source code of the documentation of this section to open the PR, but I didn't find it.\n\n### Links\n\n- https://developer.hashicorp.com/terraform/tutorials/cdktf/cdktf-build?variants=cdk-language%3Atypescript#define-your-cdk-for-terraform-application\n\n### Help Wanted\n\n- [X] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2023-08-13T11:11:27Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyOTY3ODY2NzMy","name":"documentation/learn-tutorials","description":"","color":"29D75B"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"}],"milestone":null,"number":3071,"title":"Missing import in the example of using `cdktf` for `typescript`","updatedAt":"2023-10-12T15:20:28Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"### Description\n\nIn languages like Python where there are no strong types users with invalid configuration (e.g. camel cased vs snake cased attribute keys) might not spot their mistake if they are new to CDKTF and perceive the behaviour as a bug.\r\n\r\nWe can (potentially) look out for some common mistakes like wrong casing, passing an array instead of an item of the list, etc and throw more helpful errors. This might need to be done in JSII\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5jvpAQ","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"See also #1898","createdAt":"2023-08-10T15:18:56Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3061#issuecomment-1673433104","viewerDidAuthor":false}],"createdAt":"2023-08-10T12:10:31Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMTEzNjU3MzA2","name":"language/python","description":"","color":"5c2596"},{"id":"MDU6TGFiZWwyMjQ2NzM3OTc1","name":"upstream/jsii","description":"Pending upstream work on JSII","color":"f9a2cf"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM1OTU1Nzk1","name":"ux/debugging","description":"","color":"2703FD"}],"milestone":null,"number":3061,"title":"Library: improve debugging for untyped languages and incorrect naming","updatedAt":"2023-08-10T15:18:57Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMDgwOTY1","is_bot":false,"login":"Almenon","name":"Almenon"},"body":"### Description\n\nThe docs say \"The following example creates three different S3 buckets\" but the following example only has two different S3 buckets. A third would be useful to show when you might want to use a different scope. I'm currently unclear on when you would use a different scope than the usual `new App()` scope.\n\n### Links\n\nhttps://developer.hashicorp.com/terraform/cdktf/concepts/constructs#scope\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5wV2df","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @Almenon ğŸ‘‹\r\n\r\nI just checked this and it seems like there are three S3 buckets in total (one in the root stack and two in the nested construct).\r\n\r\nCould you elaborate some more on what you'd like to have clarified in regards to the app scope?","createdAt":"2024-01-10T12:39:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3042#issuecomment-1884776287","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5wbdIt","author":{"login":"Almenon"},"authorAssociation":"NONE","body":"where is the root stack? is that \"mystack\"?","createdAt":"2024-01-11T04:58:45Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3042#issuecomment-1886245421","viewerDidAuthor":false}],"createdAt":"2023-08-01T18:12:05Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzg0MDc0","name":"priority/important-soon","description":"High priority, to be worked on as part of our current release or the following one.","color":"CC56C1"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":3042,"title":"Documentation: Constructs page scope text not in alignment with code","updatedAt":"2024-01-11T04:58:55Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjIwNTg3NTYy","is_bot":false,"login":"OliverWessels","name":""},"body":"### Expected Behavior\n\nIf a module references a git repository for its source (https://developer.hashicorp.com/terraform/language/modules/sources#generic-git-repository), you may be be prompted during CDKTF commands to enter a passphrase for your SSH key or add to the list of known hosts if you have not cloned from that repo before.\r\n\r\nRunning a command such as `yarn run cdktf get` (with CDKTF set up for an npm package) should pause and show the input prompts to the user.\n\n### Actual Behavior\n\nThe input prompts do very briefly appear (for maybe a single frame) but then get written over by the line `downloading and generating modules and providers...`. Trying to type in values does not work either. The CLI hangs as a result.\r\n\r\nThis appears similar to https://github.com/hashicorp/terraform-cdk/issues/398 where the CLI hangs because it never displays a prompt and receives input from the user.\n\n### Steps to Reproduce\n\n1. Set up the CDKTF CLI with TypeScript\r\n2. Create a Terraform module in a `.tf` file e.g. something like `module \"my_module\" { ... }` with `source` set to a git repository that contains a source module (https://developer.hashicorp.com/terraform/language/modules/sources#generic-git-repository)\r\n3. Remove the repository from `~/.ssh/known_hosts` so that you will be prompted to confirm that you trust the repo.\r\n4. Run `yarn run cdktf get`\n\n### Versions\n\nlanguage: typescript\r\ncdktf-cli: 0.16.3\r\nnode: v19.9.0\r\ncdktf: 0.16.3\r\nconstructs: 10.2.43\r\njsii: null\r\nterraform: 1.4.6\r\narch: arm64\r\nos: linux 5.15.49-linuxkit\n\n### Providers\n\nWe are using SignalFX provider `6.24` and a provider for our own in-house tool. However this is not provider-specific because the CLI is hanging before reaching anything provider-specific.\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\nI suspect that the CDKTF CLI is not properly passing along stdin / allowing the process to pause and receive input from the user.\n\n### Workarounds\n\nI had to manually run SSH commands before CDKTF, e.g. to try and prevent the case where CDKTF needs input mid-way through. There are still cases where this is not possible though.\n\n### Anything Else?\n\n_No response_\n\n### References\n\n- https://github.com/hashicorp/terraform-cdk/issues/398\r\n- https://developer.hashicorp.com/terraform/language/modules/sources#generic-git-repository\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5jQMnT","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"That's an unfortunate bug, I think as a workaround you could use e.g. [git submodule](https://git-scm.com/book/en/v2/Git-Tools-Submodules) to download the module and reference it as a local module in your `cdktf.json` file.","createdAt":"2023-08-04T08:06:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3041#issuecomment-1665190355","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5jXR3M","author":{"login":"OliverWessels"},"authorAssociation":"NONE","body":"Thanks for the suggestion @DanielMSchmidt! One other thing I forgot to mention is that we reference different tags of the git repo e.g. using `?ref=7.1.1` and `?ref=7.2.0`, so I think we'd have to to something like checking out each different tag, or cloning the target repo, including tags, and then reference it with git locally somehow (I haven't tried this, would need to dig into feasibility).\r\n\r\nI think it would still be good to address the root cause, in case anything else needs an interactive input during CDKTF commands (e.g. the linked issue about hanging on terraform input).","createdAt":"2023-08-07T01:18:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3041#issuecomment-1667046860","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5yBvzF","author":{"login":"razine-bensari"},"authorAssociation":"CONTRIBUTOR","body":"@OliverWessels  I stumbled upon a similar issue with `cdktf login` or `cdktf init` and we need standard input (say terraform cloud api token).\r\n\r\nWhat worked for me is the following:\r\n\r\n`cat \"your-standard-input\" | cdktf login`\r\n\r\n\r\nI created an issue here: https://github.com/hashicorp/terraform-cdk/issues/3470\r\nPlanning on raising a fix, hopefully soon","createdAt":"2024-01-27T07:51:51Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3041#issuecomment-1913060549","viewerDidAuthor":false}],"createdAt":"2023-07-31T23:57:46Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":3041,"title":"CDKTF CLI: CLI hangs if in interactive input is required during CDKTF commands","updatedAt":"2024-01-27T07:53:33Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjg1NTExNQ==","is_bot":false,"login":"xiehan","name":"Nara Kasbergen Kwon"},"body":"We are excited to announce CDK for Terraform multi-language provider docs in the [Terraform Registry](https://registry.terraform.io/). This helps you simplify infrastructure provisioning and improve productivity by offering provider configuration options and code samples for the programming languages supported by CDKTF alongside the HCL documentation in the registry.\r\n\r\nIf you are new to working with a particular resource in your preferred programming language, such as TypeScript, for example, you can copy-paste the code samples from the multi-language provider docs in the registry and then adapt them for your needs. This is especially useful when starting a new project â€” no mental translation required.\r\n\r\nWe are launching this feature with the following set of providers and resources and plan to gradually expand the documentation over time:\r\n\r\n- [Amazon Web Services (AWS) provider documentation](https://registry.terraform.io/providers/hashicorp/aws/latest/docs) (available in TypeScript and Python)\r\n    - Services: EC2, Lambda, VPC, and EKS\r\n- [Terraform Cloud/Enterprise provider documentation](https://registry.terraform.io/providers/hashicorp/tfe/latest) (available in TypeScript and Python)\r\n\r\nTo view the new documentation, navigate to the Terraform Registry and then to the particular [resource page](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ec2_host?lang=typescript) you want to provision in your CDKTF project. For example, if youâ€™d want to provision an Amazon EC2 Dedicated Host in TypeScript, you can now find the translated snippet in the Registry by selecting â€œTypeScriptâ€ in the language selection dropdown.\r\n\r\n![Terraform multi-language provider docs provide code samples in TypeScript and Python.](https://github.com/hashicorp/terraform-cdk/assets/855115/df48502a-df9a-4858-b122-bb4c69ff804d)\r\n\r\nIf you notice a problem with any of the TypeScript or Python code snippets, please [file a documentation bug report](https://github.com/hashicorp/terraform-cdk/issues/new?assignees=&labels=documentation%2Cnew&template=documentation.yml) and we'll investigate. Otherwise, feel free to comment on this issue with your feedback on the feature as well as requests for resources or providers you'd like us to add documentation to next. Note that for the foreseeable future, we're prioritizing adding documentation to [the official HashiCorp providers](https://registry.terraform.io/browse/providers?tier=official); Partner and Community providers are not (yet) on the roadmap.\r\n\r\nAdding code samples in Java, C# and Go is on the roadmap, but we do not currently have an ETA on when we'll be rolling that out. We need to do more work to ensure that the generated code in those languages is accurate and good-quality; we do not want to provide code snippets that are incorrect and won't work when copy-pasted into your project. We'll keep the community updated once we have an estimated timeline for when this support will be added.\r\n\r\nIn the meantime, we hope that for many of you, this will vastly improve your developer experience when working with CDKTF, and we look forward to hearing your feedback!","comments":[{"id":"IC_kwDODd1Amc5iuhJV","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"Really nice to see this integration. A few initial thoughts:\r\n\r\n- Would be nice to reference the pre-built provider imports rather than locally generated since using pre-built providers is recommended\r\n- I'd prefer not having the full stack generated\r\n  - It adds verbosity that makes the examples appear more complicated\r\n  - It isn't actually the full code required since you need an app defined\r\n  - Subclassing stacks isn't necessarily the recommended approach. At the very least it can lead to testing complications: https://github.com/hashicorp/terraform-cdk/issues/1850\r\n- Having the root provider page translated seems like a natural starting point. Ideally the use provider button would also switch","createdAt":"2023-07-28T21:41:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3032#issuecomment-1656361557","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6NFENo","author":{"login":"evanstachowiak"},"authorAssociation":"NONE","body":"This has been really helpful. Glad to see CDKTF development continuing.","createdAt":"2024-09-22T18:51:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3032#issuecomment-2366915432","viewerDidAuthor":false}],"createdAt":"2023-07-25T10:58:42Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"LA_kwDODd1Amc8AAAABEqTZcQ","name":"notice","description":"Internal use only. An issue being used by the maintainers to flag something for the community.","color":"E1A241"}],"milestone":null,"number":3032,"title":"[Notice] Provider documentation on registry.terraform.io","updatedAt":"2024-09-22T18:51:04Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjU5OTc4MjYx","is_bot":false,"login":"fathom-parth","name":"Parth Doshi"},"body":"### Expected Behavior\r\n\r\nI expect to be able to pass a terraform resource from one stack to another to be used within a resource's `depends_on` argument.\r\n\r\n### Actual Behavior\r\n\r\nInstead, the cross-stack reference errors when running a command like `cdktf diff` or `cdktf deploy` (though succeeds with `synth`) complaining that the resource in `depends_on` is invalid and must be a reference to a \"whole object\".\r\n\r\n### Steps to Reproduce\r\n\r\n1. Create 2 stacks, `stack1` and `stack2`\r\n2. Set an instance variable of `stack1` to a terraform resource. In our case, this is a [`service_networking_connection`](https://registry.terraform.io/providers/hashicorp/google/4.70.0/docs/resources/service_networking_connection).\r\n3. Pass `stack1.service_networking_connection` to `stack2` and have `stack2` pass it to a construct. In that construct define a terraform resource (in our case a [`notebooks_runtime`](https://registry.terraform.io/providers/hashicorp/google/4.70.0/docs/resources/notebooks_runtime)) that adds the `service_networking_connection` to its `depends_on`.\r\n4. Run `cdktf diff 'stack1'`\r\n5. Run `cdktf deploy 'stack2'`\r\n6. Verify this errors with an invalid `depends_on` error.\r\n\r\n### Versions\r\n\r\nlanguage: python\r\ncdktf-cli: 0.17.1\r\nnode: v18.16.1\r\ncdktf: 0.17.1\r\nconstructs: 10.2.69\r\njsii: 1.85.0\r\nterraform: 1.4.6\r\narch: x64\r\nos: linux 5.15.49-linuxkit\r\npython: Python 3.7.16\r\npip: pip 21.3.1 from /usr/local/lib/python3.7/site-packages/pip (python 3.7)\r\npipenv: null\r\n\r\n### Providers\r\n\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name                     â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ google        â”‚ 4.72.1           â”‚ ^0.17.0 â”‚            â”‚ cdktf-cdktf-provider-google      â”‚ 8.0.4           â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ google-beta   â”‚ 4.72.1           â”‚ ^0.17.0 â”‚            â”‚ cdktf-cdktf-provider-google-beta â”‚ 8.0.4           â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n\r\n### Gist\r\n\r\nhttps://gist.github.com/fathom-parth/b98e9e5c451e1da0e6a5d4494275554b\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\nCurrently, rather than granularly passing the `TerraformResource` to the relevant resource's `depends_on` argument, I instead set the 2nd stack to be on dependent on the 1st by running\r\n\r\n```python\r\nstack2.add_dependency(stack1)\r\n```\r\n\r\n### Anything Else?\r\n\r\nIt's possible that passing complete `TerraformResource` objects isn't supported since cross-stack references look at remote state? However, I don't see anything in the [documentation](https://developer.hashicorp.com/terraform/cdktf/concepts/stacks#cross-stack-references) that states this.\r\n\r\nPlease let me know if I missed something very obvious.\r\n\r\n### References\r\n\r\n- https://developer.hashicorp.com/terraform/cdktf/concepts/stacks#cross-stack-references\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5irFZb","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Hey there, there problem seems to be the usage of cross stack references within custom constructs, the workaround you mentioned is the correct thing to do, although it should ideally not be necessary.","createdAt":"2023-07-28T10:34:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3023#issuecomment-1655461467","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5irGz5","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"We might not have the capacity for a permanent fix soon, but we are open for community PRs on this topic ğŸ‘ ","createdAt":"2023-07-28T10:39:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3023#issuecomment-1655467257","viewerDidAuthor":false}],"createdAt":"2023-07-21T15:19:01Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzMxMzA4","name":"confirmed","description":"independently reproduced by an engineer on the team","color":"4B830E"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"MDU6TGFiZWwzMTQ2NjcxNDUz","name":"feature/multi-stack","description":"","color":"6589C9"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":3023,"title":"Cross-stack dependencies: When referring to a terraform resource across stacks, I receive an invalid reference error","updatedAt":"2023-09-21T21:46:13Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"### Description\n\nTerraform template strings and heredocs support `%{}` directives ([docs](https://developer.hashicorp.com/terraform/language/expressions/strings#directives)).\r\n\r\nFor example:\r\n```tf\r\n\"Hello, %{ if var.name != \"\" }${var.name}%{ else }unnamed%{ endif }!\"\r\n```\r\n\r\nWe should ensure we handle them properly in convert as well. Furthermore we also need to support their escape sequences (`%%{`)\n\n### References\n\nThis came up when diving into the handling of escape sequences for string interpolation sequences (`$${`) when working on #2911\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2023-07-21T14:46:23Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTg1Mzg1NTQ2","name":"feature/convert","description":"","color":"d93f0b"}],"milestone":null,"number":3022,"title":"convert: Support handling template directives (`%{}`)","updatedAt":"2023-07-21T14:47:40Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE3MDkyOTI=","is_bot":false,"login":"BrentSouza","name":"Brent Souza"},"body":"### Description\n\nI raise this issue with constructive intent, and I realize it may not align with the priority or direction for the overall project, but since C# is a supported language, and this is the internet afterall, I wanted to share my thoughts.\r\n\r\nI think it's prudent to note that the C# developer experience is not great, but there are some quality of life changes that could be made to improve it. I am not sure if these improvements need to be made in cdktf or some of the dependent libraries like\r\nconstructs or jsii. I'll happily open issues in all locations where appropriate and contribute where supported.\r\n\r\nOverall, the topics discussed below come from the following mindset:\r\n\r\nIf cdktf is a development oriented approach to managing terraform resources, it makes sense to align with the typical developer experience in the target language.\r\n\r\nTo contextualize my opinions below, I have been using terraform since 0.11 and devloping in C# for 15 years. My organization controls all of our infrastructure with terraform and we've done a few experiments with cdktf in TypeScript, Python, and C#. I\r\nam not saying this to brag. I don't think it's that special. I just want to share that I do have relevant experience using the tooling.\r\n\r\n## Linting\r\n\r\n`# pragma warning disable CA1806` is required in order to avoid warnings about new'ing up objects without assignment. I know this has been reported and is part of the underlying pattern for constructs. However, I think this warning exists for a good\r\nreason and ignoring it feels off for the developer experience.\r\n\r\nA quick fix would be to provide a default suppression of the warning with the project template. I don't think this is the only solution, and I'll touch upon that in other sections.\r\n\r\n## Incomplete Typing\r\n\r\nA lot of the types are incomplete or incorrect, which looks to be a side effect of IResolvable as from what I have seen, these properties in TypeScript are all unions of `<someType> | cdktf.IResolvable`\r\n\r\n```c#\r\nvar zoneConfig = new DataAwsRoute53ZoneConfig\r\n{\r\n    Name = \"foo.com.\",\r\n    PrivateZone = false // PrivateZone is typed as an object\r\n}\r\n\r\nvar policyConfig = new DataAwsIamPolicyDocumentConfig\r\n{\r\n    Version = \"2012-10-17\",\r\n    Statement = new DataAwsIamPolicyDocumentStatement // Statement is typed as object\r\n    {\r\n        Sid = \"SomeThingDescriptive\",\r\n        Actions = new[]{ ... },\r\n        Effect = \"Allow\",\r\n        Resources = new[]{ ... }\r\n    }\r\n};\r\n```\r\n\r\nThere are no unions in C# so maybe object is the only choice if this capability is needed. If it's possible to make `IResolvable` a generic interface, that might allow you to translate into C# with something like:\r\n\r\n```c#\r\npublic class Intrinsic<T> : IResolvable<T>\r\n{\r\n    private readonly T _value;\r\n    public Intrinsic(T value)\r\n    {\r\n        _value = value;\r\n    }\r\n    public T Resolve(IResolveContext context) => _value;\r\n}\r\n\r\npublic static class Resolvable\r\n{\r\n    public static IResolvable<T> FromValue<T>(T value) => new Intrinsic<T>(value);\r\n}\r\n\r\npublic class SomeConfig\r\n{\r\n    public IResolvable<bool> SomeProp { get; init; }\r\n    public IResolvable<DataAwsIamPolicyDocumentStatement> AnotherProp { get; init; }\r\n}\r\n\r\npublic class Program\r\n{\r\n    public static int Main()\r\n    {\r\n        SomeConfig config = new()\r\n        {\r\n            SomeProp = Resolvable.FromValue(true),\r\n            AnotherProp = Resolvable.FromValue(new()\r\n            {\r\n                ...\r\n            })\r\n        };\r\n        ...\r\n    }\r\n}\r\n```\r\n\r\nThe above keeps the desired type visible and gives the developer a reasonable chance at knowing allowed values without digging into any external documentation.\r\n\r\nIt could be less verbose if there's a concrete expression type that could be used for properties. That would allow for an implict cast:\r\n\r\n```c#\r\npublic class AttributeExpression<T> : IResolvable<T>\r\n{\r\n    private readonly Lazy<T> _value;\r\n\r\n    public AttributeExpression(Lazy<T> value)\r\n    {\r\n        _value = value;\r\n    }\r\n\r\n    public T Resolve(IResolveContext context) => _value.Value;\r\n\r\n    public static implicit operator AttributeExpression<T>(T value) => new(new Lazy<T>(value));\r\n}\r\n\r\npublic class SomeConfig\r\n{\r\n    public AttributeExpression<bool> SomeProp { get; init; }\r\n    public AttributeExpression<DataAwsIamPolicyDocumentStatement> AnotherProp { get; init; }\r\n}\r\n\r\npublic class Program\r\n{\r\n    public static int Main()\r\n    {\r\n        SomeConfig config = new()\r\n        {\r\n            SomeProp = true,\r\n            AnotherProp = new DataAwsIamPolicyDocumentStatement()\r\n            {\r\n                ...\r\n            }\r\n        };\r\n        ...\r\n    }\r\n}\r\n```\r\n\r\n## Namespaces\r\n\r\nThe namespacing is pretty verbose. I read the pinned issue about how this was changed in cdktf 0.13 and understand the reasoning around performance.\r\n\r\nIn addition to pulling the schema from the provider, would it make sense to use the registry api to pull the doc navigation and use the subcategory field to drive the namespacing? It seems like there is some existing metadata that could be used to scope the nodes within a namespace without requiring lots of effort.\r\n\r\n## Surprising Implementations\r\n\r\nFor example List types don't implement list semantics. If we look at `AcmCertificate`, it has a property `DomainValidationOptions` which is of the type `AcmCertificateDomainValidationOptionsList`. This is indeed a list in terraform, where a common pattern of consumption is to use a for expression to create corresponding route53 records to validate the domains on the cert, as in the example from the [tf docs](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/acm_certificate_validation#dns-validation-with-route-53).\r\n\r\nThis is not a list in C#. I can't get a count, I can't use any of the `System.Linq` extension methods, and I can't evaluate it in a loop. I can only index into it via the `Get` method:\r\n\r\n```c#\r\nvar dvo0 = cert.DomainValidationOptions.Get(0);\r\nvar dvo1 = cert.DomainValidationOptions.Get(1);\r\n```\r\n\r\nIdeally this would implement `IList<AcmCertificateDomainValidationOptionsOutputReference>`, and we could use it like a typical list in C#.\r\n\r\n## Interfaces for Configs\r\n\r\nI understand that the interfaces make sense in TypeScript since they are evaluated against an anonymous object. This is not the case in C#, which makes the resource creation more explicit. This could be better if the resource constructors used the\r\nconcrete type, e.g.:\r\n\r\n```c#\r\npublic class FooResource\r\n{\r\n    public FooResource(Construct scope, string id, FooResourceConfig config)\r\n    {\r\n        ...\r\n    }\r\n}\r\n// versus\r\npublic class BarResource\r\n{\r\n    public BarResource(Construct scope, string id, IBarResourceConfig config)\r\n    {\r\n        ...\r\n    }\r\n}\r\n```\r\n\r\nNewer versions of C# allow you to omit the class when the type is inferred. So that would allow us to do:\r\n\r\n```c#\r\nFooResource foo = new(scope, id, new(){ ... });\r\n// versus\r\nBarResource bar = new(scope, id, new BarResourceConfig(){ ... });\r\n```\r\n\r\nAdmitidly, the above syntax is controversial in terms of readability, but it's nice to have the option to take advantage of the language features.\r\n\r\n## Patterns\r\n\r\nComing back to the pattern of new'ing up resources...\r\n\r\nIt seems more natural to think of the stack as an object to which you are adding resources. Likewise, I would expect to add stacks to an App. I think the inversion of control in place right now drives the awkward experience. I realize this is just\r\nfollowing the Constructs library but I it could be masked with a little syntax:\r\n\r\n```c#\r\n// Interface to mark any object that has a configuration object as part of its constuctor\r\npublic interface IConfigurable<TConfig> {}\r\n\r\n// Interface to mark the configuration object and relate it to the object it configures\r\npublic interface IConfigure<TElement> {}\r\n\r\n// Make TerraformElement generic on the config type\r\npublic class TerraformElement<TConfig> : Construct, IConfigurable<TConfig> {}\r\n\r\n// Concrete objects can just add the interface directly\r\npublic class TerraformAsset : Construct, IConfigurable<TerraformAssetConfig> {}\r\n\r\n// Objects meant to be inherited should just be generic on the config as well \r\npublic class TerraformProvider<TConfig> : TerraformElement<TConfig> {}\r\n\r\n// Add a new method to TerraformStack to create and add related Elements and\r\n// Configuration objects. The type constraints will help enforce safety of this method\r\n// so you can't use a FooConfig with a BarProvider\r\npublic class TerraformStack\r\n{  \r\n    public TElement Add<TElement, TConfig>(string id, TConfig config)\r\n        where TElement : IConfigurable<TConfig>\r\n        where TConfig : IConfigure<TElement>\r\n    {\r\n        var element = (TElement)Activator.CreateInstance(typeof(TElement), this, id, config);\r\n        return element;\r\n    }\r\n}\r\n\r\n// Likewise add a new method to App to create and add a stack\r\npublic class App\r\n{\r\n    public App AddStack<T>(string id) where T : TerraformStack\r\n    {\r\n        var _ = Activator.CreateInstance(typeof(T), this, id);\r\n        return this;\r\n    }\r\n}\r\n\r\n// Imagine this is a configuration object for my custom Some provider\r\n// It is linked to the provider via the interface\r\npublic class SomeConfig : IConfigure<SomeProvider> {}\r\n\r\n// And this is the provider object itself, also linked back to it's config type\r\npublic class SomeProvider : TerraformProvider<SomeConfig> {}\r\n\r\n// Now a stack implementation could look something like this\r\n// You can still new things up directly if you wanted\r\npublic class SomeStack : TerraformStack\r\n{\r\n    public SomeStack(Construct scope, string id) : base(scope, id)\r\n    {\r\n        var someProvider = Add<SomeProvider, SomeConfig>(\"some\", new(){});\r\n        var someResource = Add<SomeResource, SomeResourceConfig>(\"some\", new()\r\n        {\r\n            Provider = someProvider,\r\n            ...,\r\n        });\r\n\r\n        Add<SomeDependentResource, SomeDependentResourceConfig>(\"some\", new()\r\n        {\r\n            Provider = someProvider,\r\n            SomeResourceId = someResource.Id,\r\n            ...\r\n        });\r\n    }\r\n}\r\n\r\npublic class Program\r\n{\r\n    var app = new App();\r\n    app.AddStack<SomeStack>(\"foo\").Synth();\r\n}\r\n```\r\n\r\nIf you read this far, I appreciate it and I hope you consider some of the feedback above. As I mentioned at the beginning of the post, I'm happy to contribute if any of this is possible/acceptable to do within the scope of the project.\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [X] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5ijwRh","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @BrentSouza :wave:\r\n\r\nFirst: Wow, thank you for this extensive feedback. We truly appreciate it and are thankful for the time you spent on this ğŸ‘\r\n\r\n## Linting\r\n\r\nWe'd be open to a PR for a quick fix disabling that lint rule. And yes, this had been brought up before (for cross reference: [my reply back then](https://github.com/hashicorp/terraform-cdk/issues/1682#issuecomment-1095016395)).\r\n\r\n## Incomplete Typing\r\n\r\nThis is an interesting proposal and I did a bit of digging and it seems that it aligns with an [RFC](https://github.com/aws/aws-cdk-rfcs/issues/193) on JSII that intends to fix the type union problem ğŸ˜„\r\n\r\nSmall excerpt from their proposal: `LoggingConfigurationPropertyValue.fromIResolvable(lazyValue)`\r\n\r\nOne current limitation to note: JSII doesn't support generics today.\r\n\r\n## Namespaces\r\n\r\nWe agree about the verbosity with having one namespace per resource. When we worked on the performance improvement, we also considered using the grouping from the Terraform Registry docs sidebar for provider namespaces. The reason we decided against that, was that changes to that grouping are not a breaking change for Terraform Providers since they are only reflected in docs but not in the Terraform config written while they would be a breaking change for CDKTF provider bindings, unfortunately.\r\n\r\n## Surprising Implementations\r\n\r\nThis is due to the fact that the length and contents of these list properties will only be known at \"apply-time\" which is when Terraform runs and after synth finished. This means that we can't know the length of a list at \"synth-time\" and the `.Get(0)` access will actually return a `Reference` token which will eventually render `domain_validation_options[0]`. While we could implement `length` on that same list interface and make it a number token that eventually renders `length(xy.domain_validation_options)` this could lead to some false sense of security since number tokens are a very large negative number that not actually represents the length but rather a reference in a lookup map.\r\n\r\nFor list values that can be known at synth time (think inputs to resources), it is possible to access them using the `.someAttributeInput` property and use native loops with them.\r\n\r\nFor dynamic values, we added the [Iterators feature](https://developer.hashicorp.com/terraform/cdktf/concepts/iterators), but I agree that a simple for-loop would be nicer to use.\r\n\r\n## Interfaces for Configs\r\n\r\nI think this would be something to raise in JSII â€“ but everything that makes code easier to write (even if it might be a bit controversial) is something that has my support.\r\n\r\n## Patterns\r\n\r\nWhile I don't know much on how the currently used pattern for defining stacks and resources came to be, I suspect that one aspect was also to not have vastly different code across languages (at the expense of being slightly less idiomatic). And with generics being not available in JSII, I suspect that the `new` pattern might be one common denominator that works across all languages and doesn't require generics.\r\n\r\n\r\nThanks again for all that valuable feedback!","createdAt":"2023-07-27T12:38:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3019#issuecomment-1653539937","viewerDidAuthor":false}],"createdAt":"2023-07-21T04:13:20Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwzMDEzNzM4ODIw","name":"needs-research","description":"","color":"709F22"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMTM1OTYzMTU0","name":"language/c#","description":"C# language issues","color":"c5def5"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"}],"milestone":null,"number":3019,"title":"Improvements to C# Ergonomics","updatedAt":"2023-10-12T15:17:51Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjYzMDQ0OQ==","is_bot":false,"login":"blimmer","name":"Ben Limmer"},"body":"### Description\r\n\r\nAs an experienced CDK (CloudFormation) user, I was surprised that the layout of the CDKTF application was so \"flat\":\r\n\r\n```\r\n# CDKTF\r\n> tree . -L 2 -I 'node_modules'\r\n.\r\nâ”œâ”€â”€ __tests__\r\nâ”‚Â Â  â””â”€â”€ main-test.ts\r\nâ”œâ”€â”€ cdktf.json\r\nâ”œâ”€â”€ help\r\nâ”œâ”€â”€ jest.config.js\r\nâ”œâ”€â”€ main.ts\r\nâ”œâ”€â”€ package-lock.json\r\nâ”œâ”€â”€ package.json\r\nâ”œâ”€â”€ setup.js\r\nâ””â”€â”€ tsconfig.json\r\n```\r\n\r\n```\r\n# CDK\r\ntree . -L 2 -I 'node_modules'\r\n.\r\nâ”œâ”€â”€ README.md\r\nâ”œâ”€â”€ bin\r\nâ”‚Â Â  â””â”€â”€ test-cdk.ts\r\nâ”œâ”€â”€ cdk.json\r\nâ”œâ”€â”€ jest.config.js\r\nâ”œâ”€â”€ lib\r\nâ”‚Â Â  â””â”€â”€ test-cdk-stack.ts\r\nâ”œâ”€â”€ package-lock.json\r\nâ”œâ”€â”€ package.json\r\nâ”œâ”€â”€ test\r\nâ”‚Â Â  â””â”€â”€ test-cdk.test.ts\r\nâ””â”€â”€ tsconfig.json\r\n```\r\n\r\nI think it'd be nice to emulate the exact same layout, as I believe there will be a good amount of crossover between CloudFormation CDK and CDKTF. Specifically:\r\n\r\n- move `new App()` to `bin/{{app-name}}.ts`\r\n- move initial stack to `lib/{{app-name}}-stack.ts`\r\n- rename `__tests__` to `test`\r\n\r\n### References\r\n\r\nhttps://github.com/aws/aws-cdk/tree/main/packages/aws-cdk/lib/init-templates/app/typescript\r\n\r\n### Help Wanted\r\n\r\n- [X] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5iGygl","author":{"login":"fathom-parth"},"authorAssociation":"NONE","body":"We do something like this for cdktf python. Our folder structure looks like\r\n```\r\nterraform\r\nâ”œâ”€â”€ README.md\r\nâ”œâ”€â”€ environments\r\nâ”‚   â””â”€â”€ dev\r\nâ”‚   â”‚   â””â”€â”€ main.py\r\nâ”‚   â””â”€â”€ prod\r\nâ”‚   â”‚   â””â”€â”€ main.py\r\nâ”œâ”€â”€ cdktf.json\r\nâ”œâ”€â”€ constructs\r\nâ”‚   â””â”€â”€ network\r\nâ”‚   â”‚   â””â”€â”€ __init__.py\r\nâ”‚   â”‚   â””â”€â”€ test_network.py\r\nâ”œâ”€â”€ stacks\r\nâ”‚   â””â”€â”€ network\r\nâ”‚   â”‚   â””â”€â”€ __init__.py\r\nâ”‚   â”‚   â””â”€â”€ test_network.py\r\nâ””â”€â”€ common_apps.py\r\n```\r\n\r\nWe then set `PYTHONPATH` to `terraform` and run\r\n```shell\r\ncdktf deploy '*' --app=environments/dev/main.py\r\n```\r\nfor each environment to deploy.\r\n\r\nOur constructs live in the constructs folder and our stacks live in the stacks folder. Our common multi-stack configurations live in `common_apps.py`.\r\n\r\nSo our `new App` lives in the `main.py` files.\r\n\r\nHope this helps someone!","createdAt":"2023-07-21T16:28:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/3006#issuecomment-1645946917","viewerDidAuthor":false}],"createdAt":"2023-07-13T11:33:05Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"}],"milestone":null,"number":3006,"title":"cli: match cdk file structure","updatedAt":"2023-07-21T16:28:27Z"},{"assignees":[],"author":{"id":"U_kgDOBjqmvA","is_bot":false,"login":"josh-thisisbud","name":""},"body":"### Description\n\nWhenever I'm attempting to load the Python API reference pages for Terraform CDK, I experience long periods of the page struggling to load and very poor performance in Chrome. \r\n\r\nI believe that this is partly due to the length of the generated content and would like to suggest that the individual sections were split into sub pages with cross-referencing links.\n\n### Links\n\nhttps://developer.hashicorp.com/terraform/cdktf/api-reference/python\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5hgW9F","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @josh-thisisbud ğŸ‘‹\n\nWe agree this should be addressed! Unfortunately it's not something we'll have capacity to work on soon, but we welcome any community contributions.","createdAt":"2023-07-14T13:32:32Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2995#issuecomment-1635872581","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5hl7o2","author":{"login":"kination"},"authorAssociation":"CONTRIBUTOR","body":"Agree with this. Maybe it could be better to separate pages for each subtitles (Constructs/Structs/Classes...) into subpages ğŸ‘€ ","createdAt":"2023-07-17T03:44:15Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2995#issuecomment-1637333558","viewerDidAuthor":false}],"createdAt":"2023-07-07T15:20:10Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"}],"milestone":null,"number":2995,"title":"API Reference Docs: Python API docs cause my browser to hang on less powerful machines","updatedAt":"2023-07-17T03:44:16Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"### Description\n\n`export type TerraformResourceBlock = unknown;` leads to uncertainty within converts code base, we should improve the type. \n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2023-07-05T07:49:07Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"}],"milestone":null,"number":2985,"title":"Convert: Some types are typed as `unknown` internally","updatedAt":"2023-07-14T13:28:09Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"### Description\n\nAs of https://github.com/hashicorp/terraform-cdk/pull/2920 we can handle missing attributes / blocks in HCL. The missing properties are typed as `any` in TS, this cold be more precise.\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2023-07-05T07:39:18Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTg1Mzg1NTQ2","name":"feature/convert","description":"","color":"d93f0b"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":2984,"title":"Convert: Use precise TS type for partial configuration","updatedAt":"2023-07-14T13:30:03Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjQwOTczOTIx","is_bot":false,"login":"ahitchin","name":"Adam"},"body":"### Expected Behavior\n\n# Overview\r\nWhen deploying a multi-stack application whose stacks are created within a surrounding construct, you should be able to share cross-stack references. \r\n\r\n# Pseudo-Code\r\n```typescript\r\n/** ./main.ts */\r\n\r\nimport { App } from 'cdktf';\r\n\r\nimport { MultiStackApp } from './multi-stack-app';\r\n\r\n/** Entry point for the terraform application. */\r\nfunction main(): void {\r\n    // Create a cdk app to encapsulate the project\r\n    const app: App = new App();\r\n\r\n    // Create a multi-stack service\r\n    new MultiStackApp(app, 'MultiStackApp');\r\n\r\n    return app.synth();\r\n}\r\n```\r\n\r\n---\r\n\r\n```typescript\r\n/** ./multi-stack-app.ts */\r\n\r\nimport { App, TerraformStack } from 'cdktf';\r\nimport { Construct } from 'constructs';\r\n\r\n/** Creates multiple stacks a part of a single service. */\r\nexport class MultiStackApp extends Construct {\r\n    /** Stacks created by this construct. */\r\n    public readonly stackOne: TerraformStack;\r\n    public readonly stackTwo: TerraformStack;\r\n\r\n    /**\r\n     * Constructor.\r\n     *\r\n     * @param scope - Parent app construct.\r\n     * @param id - Construct identifier.\r\n     */\r\n    public constructor(app: App, id: string) {\r\n        // Inherit from the base construct\r\n        super(app, id);\r\n\r\n        // Create the dependency stack\r\n        this.stackOne = TerraformStack(this, 'StackOne');\r\n\r\n        // Create the dependent stack\r\n        this.stackTwo = TerraformStack(this, 'StackTwo', {\r\n            crossStackValue: this.stackOne.resource.id,\r\n        });\r\n\r\n        return;\r\n    }\r\n}\r\n```\r\n\r\n# Manifest File (`cdktf.out/manifest.json`)\r\n```json\r\n{\r\n   \"version\":\"0.17.0\",\r\n   \"stacks\":{\r\n      \"StackOne\":{\r\n         \"name\":\"StackOne\",\r\n         \"constructPath\":\"MultiStackApp/StackOne\",\r\n         \"workingDirectory\":\"stacks/StackOne\",\r\n         \"synthesizedStackPath\":\"stacks/StackOne/cdk.tf.json\",\r\n         \"annotations\":[\r\n            \r\n         ],\r\n         \"dependencies\":[\r\n            \r\n         ]\r\n      },\r\n      \"StackTwo\":{\r\n         \"name\":\"StackTwo\",\r\n         \"constructPath\":\"MultiStackApp/StackTwo\",\r\n         \"workingDirectory\":\"stacks/StackTwo\",\r\n         \"synthesizedStackPath\":\"stacks/StackTwo/cdk.tf.json\",\r\n         \"annotations\":[\r\n            \r\n         ],\r\n         \"dependencies\":[\r\n            \"StackOne\"\r\n         ]\r\n      }\r\n   }\r\n}\r\n```\n\n### Actual Behavior\n\n# Overview\r\nThe CDKTF deployment fails, since it can not find its cross-stack dependency in the `cdktf.out/manifest.json` file. This is because a manifest's name points to `stack.node.id`, whereas the dependencies point to `dependencyStack.node.path`. This results in the dependency stack's manifest name being `StackId`, and the dependent stack's dependency reference being `ParentConstructId/StackId`.\r\n\r\n# Error Example\r\n```\r\n0 Stacks deploying     0 Stacks done     0 Stacks waiting\r\nError: Usage Error: The following dependencies are not included in the stacks to run: MultiStackApp/StackOne. Either add them or add the --ignore-missing-stack-dependencies flag.\r\n```\r\n# Manifest File (`cdktf.out/manifest.json`)\r\n```json\r\n{\r\n   \"version\":\"0.17.0\",\r\n   \"stacks\":{\r\n      \"StackOne\":{\r\n         \"name\":\"StackOne\",\r\n         \"constructPath\":\"MultiStackApp/StackOne\",\r\n         \"workingDirectory\":\"stacks/StackOne\",\r\n         \"synthesizedStackPath\":\"stacks/StackOne/cdk.tf.json\",\r\n         \"annotations\":[\r\n            \r\n         ],\r\n         \"dependencies\":[\r\n            \r\n         ]\r\n      },\r\n      \"StackTwo\":{\r\n         \"name\":\"StackTwo\",\r\n         \"constructPath\":\"MultiStackApp/StackTwo\",\r\n         \"workingDirectory\":\"stacks/StackTwo\",\r\n         \"synthesizedStackPath\":\"stacks/StackTwo/cdk.tf.json\",\r\n         \"annotations\":[\r\n            \r\n         ],\r\n         \"dependencies\":[\r\n            \"MultiStackApp/StackOne\"\r\n         ]\r\n      }\r\n   }\r\n}\r\n```\n\n### Steps to Reproduce\n\n1. Create a CDKTF package.\r\n2. Create a construct that contains your deployment stacks.\r\n3. Create two or more stacks.\r\n4. Introduce cross-stack dependencies.\r\n5. Deploy your scaffolding stack.\r\n6. Deploy the stacks that depend on the initial scaffolding stack.\r\n7. Encounter error.\n\n### Versions\n\nlanguage: typescript\r\ncdktf-cli: 0.15.5\r\nnode: v18.16.0\r\ncdktf: 0.17.0\r\nconstructs: 10.2.61\r\njsii: null\r\nterraform: 1.4.5\r\narch: x64\r\nos: linux 5.10.16.3-microsoft-standard-WSL2\n\n### Providers\n\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name            â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ archive       â”‚ 2.4.0            â”‚ ^0.17.0 â”‚            â”‚ @cdktf/provider-archive â”‚ 7.0.0           â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ aws           â”‚ 4.67.0           â”‚ ^0.17.0 â”‚            â”‚ @cdktf/provider-aws     â”‚ 15.0.0          â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ local         â”‚ 2.4.0            â”‚ ^0.17.0 â”‚            â”‚ @cdktf/provider-local   â”‚ 7.0.0           â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ null          â”‚ 3.2.1            â”‚ ^0.17.0 â”‚            â”‚ @cdktf/provider-null    â”‚ 7.0.0           â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ random        â”‚ 3.5.1            â”‚ ^0.17.0 â”‚            â”‚ @cdktf/provider-random  â”‚ 8.0.0           â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n# Overview\r\nUpdate the `Manifest` class so `StackManifest` names are equal to `stack.node.path`, or so that dependencies are equal to `stack.node.id`\r\n\r\n**Relevant Code:**\r\nhttps://github.com/hashicorp/terraform-cdk/blob/main/packages/cdktf/lib/manifest.ts#L41-L64\r\n\r\n# Possible Code Solution\r\n```typescript\r\nexport class Manifest implements IManifest {\r\n    public forStack(stack: TerraformStack): StackManifest {\r\n        const node = stack.node;\r\n        const name = node.path;  // <-------\r\n\r\n        if (this.stacks[name]) {\r\n            return this.stacks[name];\r\n        }\r\n\r\n        const manifest: StackManifest = {\r\n            name,\r\n            constructPath: node.path,\r\n            workingDirectory: path.join(Manifest.stacksFolder, node.id),\r\n            synthesizedStackPath: path.join(\r\n                Manifest.stacksFolder,\r\n                node.id,\r\n                Manifest.stackFileName\r\n            ),\r\n            annotations: [], // will be replaced later when processed in App\r\n            dependencies: stack.dependencies.map((item) => item.node.path),\r\n        };\r\n        this.stacks[name] = manifest;\r\n\r\n    return manifest;\r\n}\r\n```\n\n### Workarounds\n\n# Overview\r\nCurrently, I am using a custom synthesis function to create the manifest, then using a type modifier to create a mutable copy. After this, I override the `dependencies` attribute.\r\n\r\n# Example Code\r\n```typescript\r\nimport { ISynthesisSession, StackManifest, TerraformStack } from 'cdktf';\r\nimport { addCustomSynthesis } from 'cdktf/lib/synthesize/synthesizer';\r\nimport { Construct } from 'constructs';\r\n\r\n/** Custom synthesis manifest override example stack. */\r\nexport class ExampleStack extends TerraformStack {\r\n    /**\r\n     * Constructor.\r\n     *\r\n     * @param scope - Parent construct.\r\n     * @param id - Construct identifier.\r\n     * @param props - Properties needed to create this construct.\r\n     */\r\n    public constructor(scope: Construct, id: string) {\r\n        // Inherit from the base terraform stack\r\n        super(scope, id);\r\n\r\n        // Inject a custom synthesis function\r\n        addCustomSynthesis(this, {\r\n            onSynthesize: this.customSynthesis.bind(this),\r\n        });\r\n\r\n        return;\r\n    }\r\n\r\n    /**\r\n     * Overrides the stack manifest's dependencies attribute.\r\n     *\r\n     * @param session - Single session of synthesis.\r\n     */\r\n    private customSynthesis(session: ISynthesisSession): void {\r\n        // Create a type modifier and make the stack manifest mutable\r\n        type MutableStackManifest = {\r\n            -readonly [K in keyof StackManifest]: StackManifest[K]\r\n        }\r\n\r\n        // Get the manifest and make a mutable shallow copy\r\n        const manifestImmutable: StackManifest = session.manifest.forStack(this);\r\n        const manifestMutable: MutableStackManifest = manifestImmutable;\r\n\r\n        // Override the manifest's dependency references\r\n        manifestMutable.dependencies = this.dependencies.map((item) => item.node.id)\r\n\r\n        return;\r\n    }\r\n}\r\n```\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [X] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5kVrN6","author":{"login":"Mejato"},"authorAssociation":"NONE","body":"Yes, would be great to have the issue fixed.\r\n\r\n@ahitchin, great write up of the issue!","createdAt":"2023-08-18T06:12:04Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":3}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2976#issuecomment-1683403642","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5teF0W","author":{"login":"asmith432"},"authorAssociation":"NONE","body":"Will this be fixed in the next release? I am running into this issue as well.","createdAt":"2023-12-01T18:43:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":4}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2976#issuecomment-1836604694","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6eF5Ep","author":{"login":"guywilsonjr"},"authorAssociation":"NONE","body":"At a minimum it should get documented that you can't nest a stack in another construct, until the beautiful day when that feature is added","createdAt":"2025-02-12T00:15:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2976#issuecomment-2652344617","viewerDidAuthor":false}],"createdAt":"2023-07-01T11:13:05Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzMxMzA4","name":"confirmed","description":"independently reproduced by an engineer on the team","color":"4B830E"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTQ2NjcxNDUz","name":"feature/multi-stack","description":"","color":"6589C9"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":2976,"title":"CDKTF: Cross stack dependencies fail if placed within a wrapper construct.","updatedAt":"2025-02-12T00:15:47Z"},{"assignees":[],"author":{"id":"U_kgDOBjqmvA","is_bot":false,"login":"josh-thisisbud","name":""},"body":"### Expected Behavior\r\n\r\nRunning cdktf get should allow me to _eventually_ end up with an imports folder with a series of existing terrafom modules, converted to cd CDKTF compatible.\r\n\r\n### Actual Behavior\r\n\r\nRunning cdktf get spawns hundreds of node instances, each of which appears to be working in parallel forever. Each node instance takes 200-500MB of ram, which quickly overwhelms the 16GB physical which is available.\r\n\r\n### Steps to Reproduce\r\n\r\n1. Create a git based monorepo of terraform modules\r\n2. Use that monorepo in TFCDK via the terraformModules section in cdktf.json\r\n3. Specify a value of `\"google@=4.65.2\"` in terraformProviders in cdktf.json in attempt to match version in TF modules \r\n4.  and ensure use of that module version in CDKTF native code\r\n\r\n### Versions\r\n\r\nlanguage: python\r\ncdktf-cli: 0.17.0\r\nnode: v18.16.0\r\ncdktf: 0.17.0\r\nconstructs: 10.2.55\r\njsii: 1.84.0\r\nterraform: 1.5.0\r\narch: x64\r\nos: darwin 22.5.0\r\npython: Python 3.11.4\r\npip: pip 23.1.2 from /Users/<redacted>/.local/share/virtualenvs/<redacted>/lib/python3.11/site-packages/pip (python 3.11)\r\npipenv: pipenv, version 2023.6.12\r\n\r\n\r\n### Providers\r\n\r\n```\r\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\r\nâ”‚ Provider Name         â”‚ Provider Version â”‚ CDKTF   â”‚ Constraint â”‚ Package Name                    â”‚ Package Version â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ google                â”‚                  â”‚         â”‚ =4.65.2    â”‚                                 â”‚                 â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ cloudflare/cloudflare â”‚ 4.8.0            â”‚ ^0.17.0 â”‚            â”‚ cdktf-cdktf-provider-cloudflare â”‚ 7.0.0           â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ google                â”‚ 4.69.1           â”‚ ^0.17.0 â”‚            â”‚ cdktf-cdktf-provider-google     â”‚ 8.0.0           â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ helm                  â”‚ 2.10.1           â”‚ ^0.17.0 â”‚            â”‚ cdktf-cdktf-provider-helm       â”‚ 7.0.0           â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ kubernetes            â”‚ 2.21.1           â”‚ ^0.17.0 â”‚            â”‚ cdktf-cdktf-provider-kubernetes â”‚ 7.0.0           â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ random                â”‚ 3.5.1            â”‚ ^0.17.0 â”‚            â”‚ cdktf-cdktf-provider-random     â”‚ 8.0.0           â”‚\r\nâ”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\r\nâ”‚ template              â”‚ 2.2.0            â”‚ ^0.17.0 â”‚            â”‚ cdktf-cdktf-provider-template   â”‚ 7.0.0           â”‚\r\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\r\n```\r\n\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\n_No response_\r\n\r\n### Workarounds\r\n\r\nRemove the fixed version constraint - Not really viable because I come up against a further issue when I attempt to use native CDKTF providers and resources due to mismatched versions\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5fyzLh","author":{"login":"josh-thisisbud"},"authorAssociation":"NONE","body":"For context, if I don't provide the constraint. I get this when running cdktf apply:\r\n```\r\n<redacted>-europe-west1  â•·\r\n                           â”‚ Error: Failed to query available provider packages\r\n                           â”‚ \r\n                           â”‚ Could not retrieve the list of available versions for provider\r\n                           â”‚ hashicorp/google: no available releases match the given constraints 4.65.2,\r\n                           â”‚ 4.69.1\r\n                           â•µ\r\n```","createdAt":"2023-06-26T10:14:16Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2968#issuecomment-1607152353","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5g4-rG","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"You can improve the stability by limiting the performance: `cdktf get --parallelism=3` for example. Regarding the fixed version: we came from an open version range, leading to accidental upgrades of the version. Due to these complaints we switched to a fixed version. Is there a reason you need to match a very specific of the google provider? In general Terraform Modules tend to have wide version ranges so normally the same major version would be sufficient","createdAt":"2023-07-07T15:04:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2968#issuecomment-1625549510","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5g5ari","author":{"login":"josh-thisisbud"},"authorAssociation":"NONE","body":"Our modules are pinned to specific provider versions due to a caching step\r\nin our build pipeline. We previously leveraged Terragrunt in CI and we\r\nneeded to ensure that we pre-populated a local directory with all our\r\nproviders before running it. The process to migrate over is ongoing and we\r\nneed the two to run in parallel for a while ğŸ˜…\r\n\r\nThanks for the tip wrt parallelism, but would it make sense to\r\nautomatically limit the parallelism for CPU intensive steps to near CPU\r\ncore count and avoid this issue in future?\r\n\r\nOn Fri, 7 Jul 2023, 16:04 Daniel Schmidt, ***@***.***> wrote:\r\n\r\n> You can improve the stability by limiting the performance: cdktf get\r\n> --parallelism=3 for example. Regarding the fixed version: we came from an\r\n> open version range, leading to accidental upgrades of the version. Due to\r\n> these complaints we switched to a fixed version. Is there a reason you need\r\n> to match a very specific of the google provider? In general Terraform\r\n> Modules tend to have wide version ranges so normally the same major version\r\n> would be sufficient\r\n>\r\n> â€”\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/hashicorp/terraform-cdk/issues/2968#issuecomment-1625549510>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/AY5KNPFE45ZK5LQKMZYEO3LXPAQPZANCNFSM6AAAAAAZT5EPH4>\r\n> .\r\n> You are receiving this because you authored the thread.Message ID:\r\n> ***@***.***>\r\n>\r\n","createdAt":"2023-07-07T16:32:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2968#issuecomment-1625664226","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5hNbCm","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"The problem is that this task is more often then not memory bound, so CPUs is not really a good measurement. It also heavily depends on the providers (you could run 50 small providers easily, but aws and google at the same time would cause an explosion without enough memory in place)","createdAt":"2023-07-11T14:11:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2968#issuecomment-1630908582","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5hYzbE","author":{"login":"josh-thisisbud"},"authorAssociation":"NONE","body":"I see, well that certainly makes things harder to manage nicely.\r\n\r\nOn Tue, 11 Jul 2023, 15:11 Daniel Schmidt, ***@***.***> wrote:\r\n\r\n> The problem is that this task is more often then not memory bound, so CPUs\r\n> is not really a good measurement. It also heavily depends on the providers\r\n> (you could run 50 small providers easily, but aws and google at the same\r\n> time would cause an explosion without enough memory in place)\r\n>\r\n> â€”\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/hashicorp/terraform-cdk/issues/2968#issuecomment-1630908582>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/AY5KNPDCXW6XZRFLF3EJOKTXPVNJLANCNFSM6AAAAAAZT5EPH4>\r\n> .\r\n> You are receiving this because you authored the thread.Message ID:\r\n> ***@***.***>\r\n>\r\n","createdAt":"2023-07-13T09:29:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2968#issuecomment-1633892036","viewerDidAuthor":false}],"createdAt":"2023-06-26T09:54:00Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMTM2MjAxMTE5","name":"provider get / generation","description":"","color":"CC3938"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":2968,"title":"CDKTF Get: Spawns many instances of node until memory runs out","updatedAt":"2023-10-12T15:15:37Z"},{"assignees":[],"author":{"id":"U_kgDOBqtvwQ","is_bot":false,"login":"lohrm-stabl","name":"Michael Lohr"},"body":"### Description\r\n\r\nThere is the `--no-color` flag which disables all colors. However, it would be great to be able to disable the animations as well.\r\n\r\nThis is required because in some CIs, the output will look like this:\r\n```\r\nâ ‡  Synthesizing\r\nâ   Synthesizing\r\nâ ‹  Synthesizing\r\nâ ™  Synthesizing\r\nâ ¹  Synthesizing\r\nâ ¸  Synthesizing\r\nâ ¼  Synthesizing\r\nâ ´  Synthesizing\r\nâ ¦  Synthesizing\r\nâ §  Synthesizing\r\nâ ‡  Synthesizing\r\n```\r\n\r\nI think this is possible with the `CI` environment variable. However, it would be great if it could be explicitly triggered by a flag as well.\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5fmr3l","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @lohrm-stabl ğŸ‘‹\n\nYes, the `CI` environment variable should do the trick there ğŸ‘ ","createdAt":"2023-06-23T09:10:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2951#issuecomment-1603976677","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5inHac","author":{"login":"nlucansk"},"authorAssociation":"NONE","body":"As @ansgarm mentioned `CI` is there, flag seems to be redundant to me\r\n\r\nExample from one of my pipelines:\r\n```bash\r\nCI=1 pipenv run cdktf deploy --parallelism  1 \"*\" --auto-approve\r\n```\r\n\r\nThis particular example is used in Octopus Deploy that has pretty \"dumb\" output | *sigh*","createdAt":"2023-07-27T19:34:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2951#issuecomment-1654421148","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5i7ghD","author":{"login":"Beartime234"},"authorAssociation":"NONE","body":"Also happens to me, even with the `CI=1` flag I still get animations making my output like OPs.","createdAt":"2023-08-01T07:56:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2951#issuecomment-1659766851","viewerDidAuthor":false}],"createdAt":"2023-06-16T10:50:40Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"}],"milestone":null,"number":2951,"title":"cdktf-cli: disable animations via flag","updatedAt":"2023-08-01T07:56:21Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEyNDg4NTg1","is_bot":false,"login":"IhnatKlimchuk","name":"Ihnat Klimchuk"},"body":"### Description\n\nI use `cdktf` with `@cdktf/provider-azurerm` provider. I use Typescript for managing stacks and constructs. I created a stack with `StorageAccount` from `@cdktf/provider-azurerm/lib/storage-account` like this:\r\n\r\n```\r\n...\r\n    const account = new StorageAccount(this, \"storage-account\", {\r\n      location: this.region,\r\n      accountTier: \"Standard\",\r\n      accountReplicationType: \"LRS\",\r\n      resourceGroupName: this.resourceGroup.name,\r\n      name: `${env.name}${\"servicename\"}`,\r\n    });\r\n...\r\n``` \r\n\r\nin case I open `accountTier` definition I see next:\r\n```\r\n...\r\n/**\r\n* Docs at Terraform Registry: {@link https://registry.terraform.io/providers/hashicorp/azurerm/3.58.0/docs/resources/storage_account#account_tier StorageAccount#account_tier}\r\n*/\r\nreadonly accountTier: string;\r\n...\r\n```\r\nwhile according to docs\r\n```\r\naccount_tier - (Required) Defines the Tier to use for this storage account. Valid options are Standard and Premium. For BlockBlobStorage and FileStorage accounts only Premium is valid. Changing this forces a new resource to be created.\r\n```\r\n\r\nThis approach is looks like very time consuming and requires a lot of hops between code and docs. \r\nSo I would expect to have:\r\n1. Docs copied in place for simpler navigation and code writing. \r\n2. Typed possible options, so I don't need to navigate to landing page each new property\r\n\r\nLike this:\r\n```\r\n...\r\n/** account_tier - (Required) Defines the Tier to use for this storage account. Valid options are \"Standard\" and \"Premium\". For \"BlockBlobStorage\" and \"FileStorage\" accounts only \"Premium\" is valid. Changing this forces a new resource to be created.\r\n* Link - https://registry.terraform.io/providers/hashicorp/azurerm/3.58.0/docs/resources/storage_account#account_tier \r\n*/\r\nreadonly accountTier: \"Standard\" | \"Premium\"; \r\n\r\n// or 'readonly accountTier: \"Standard\" | \"Premium\" | string' for backward compatibility\r\n// or 'readonly accountTier: StorageAccountTiers' with proper docs for each option\r\n...\r\n```\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [X] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5fmprQ","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @IhnatKlimchuk ğŸ‘‹\n\nWe agree with you! Unfortunately those docs in the Terraform Registry are not available in a structured format so we can't easily include them in the inline docs and there's no enum type information that we can use.\n\nHowever, in the long term we are working with the respective teams that manage these other bits and are aligned on making such information easy to access programmatically which would then allow us to implement what you requested.","createdAt":"2023-06-23T09:03:32Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2945#issuecomment-1603967696","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7D87Zv","author":{"login":"shellscape"},"authorAssociation":"NONE","body":"checking in two years later to say that this is still sorely needed","createdAt":"2025-09-13T04:16:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2945#issuecomment-3287529071","viewerDidAuthor":false}],"createdAt":"2023-06-14T16:44:46Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"LA_kwDODd1Amc8AAAABUQzWlQ","name":"upstream/registry","description":"Pending upstream work on the Terraform Registry","color":"755CD9"}],"milestone":null,"number":2945,"title":"Add typed enums and inlined docs in CDKTF and related providers","updatedAt":"2025-09-13T04:16:14Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjMwNjIwNTc0","is_bot":false,"login":"DJAlPee","name":"Alexander P."},"body":"### Expected Behavior\r\n\r\nI want to check, if my synthed stack is valid terraform syntax (and later, I also would like to `plan` the rollout) using `toBeValidTerraform()`. Tests should pass without any errors.\r\n\r\n### Actual Behavior\r\n\r\nI get (randomly) one of the following error messages:\r\n\r\n```\r\n    Expected subject to be a valid terraform stack: Error: Command failed: terraform validate -json. Output: {\r\n      \"format_version\": \"1.0\",\r\n      \"valid\": false,\r\n      \"error_count\": 1,\r\n      \"warning_count\": 0,\r\n      \"diagnostics\": [\r\n        {\r\n          \"severity\": \"error\",\r\n          \"summary\": \"registry.terraform.io/hashicorp/aws: the cached package for registry.terraform.io/hashicorp/aws 4.66.1 (in .terraform/providers) does not match any of the checksums recorded in the dependency lock file\",\r\n          \"detail\": \"\"\r\n        }\r\n      ]\r\n    }\r\n    .\r\n```\r\n\r\n```\r\n    Expected subject to be a valid terraform stack: Error: Command failed: terraform validate -json. Output: {\r\n      \"format_version\": \"1.0\",\r\n      \"valid\": false,\r\n      \"error_count\": 1,\r\n      \"warning_count\": 0,\r\n      \"diagnostics\": [\r\n        {\r\n          \"severity\": \"error\",\r\n          \"summary\": \"failed to read schema for aws_kms_alias.basic_kms_int_alias_C8FAFA52 in registry.terraform.io/hashicorp/aws: failed to instantiate provider \\\"registry.terraform.io/hashicorp/aws\\\" to obtain schema: Unrecognized remote plugin message: \\n\\nThis usually means that the plugin is either invalid or simply\\nneeds to be recompiled to support the latest protocol.\",\r\n          \"detail\": \"\"\r\n        }\r\n      ]\r\n    }\r\n    .\r\n```\r\n\r\n```\r\n    Expected subject to be a valid terraform stack: Error: Command failed: terraform validate -json. Output: {\r\n      \"format_version\": \"1.0\",\r\n      \"valid\": false,\r\n      \"error_count\": 2,\r\n      \"warning_count\": 0,\r\n      \"diagnostics\": [\r\n        {\r\n          \"severity\": \"error\",\r\n          \"summary\": \"Unrecognized remote plugin message: \\n\\nThis usually means that the plugin is either invalid or simply\\nneeds to be recompiled to support the latest protocol.\",\r\n          \"detail\": \"\"\r\n        },\r\n        {\r\n          \"severity\": \"error\",\r\n          \"summary\": \"Unrecognized remote plugin message: \\n\\nThis usually means that the plugin is either invalid or simply\\nneeds to be recompiled to support the latest protocol.\",\r\n          \"detail\": \"\"\r\n        }\r\n      ]\r\n    }\r\n    .\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\nstack1.spec.ts\r\n```typescript\r\nimport { Testing } from 'cdktf';\r\nimport { MyFirstStack, MyFirstStackProps } from './stack1';\r\nimport 'cdktf/lib/testing/adapters/jest';\r\n\r\ndescribe('A stack, which uses all features', () => {\r\n    const props = {\r\n        // provide config for stack\r\n    } as MyStackProps;\r\n\r\n    // Other test e.g. toMatchSnapshot(), etc.\r\n\r\n    it('check if the produced terraform configuration is valid', () => {\r\n        const app = Testing.app();\r\n        const stack = new MyFirstStack(app, 'my-app', props);\r\n        // We need to do a full synth to validate the terraform configuration\r\n        expect(Testing.fullSynth(stack)).toBeValidTerraform();\r\n    });\r\n});\r\n```\r\n\r\nstack2.spec.ts\r\n```typescript\r\nimport { Testing } from 'cdktf';\r\nimport { MySecondStack, MySecondStackProps } from './stack2';\r\nimport 'cdktf/lib/testing/adapters/jest';\r\n\r\ndescribe('A stack, which uses all features', () => {\r\n    const props = {\r\n        // provide config for stack\r\n    } as MyStackProps;\r\n\r\n    // Other test e.g. toMatchSnapshot(), etc.\r\n\r\n    it('check if the produced terraform configuration is valid', () => {\r\n        const app = Testing.app();\r\n        const stack = new MySecondStack(app, 'my-app', props);\r\n        // We need to do a full synth to validate the terraform configuration\r\n        expect(Testing.fullSynth(stack)).toBeValidTerraform();\r\n    });\r\n});\r\n```\r\n\r\nsetup-jest.ts\r\n```typescript\r\nconst cdktf = require('cdktf');\r\ncdktf.Testing.setupJest();\r\n\r\nconst matchers = require('jest-extended');\r\nexpect.extend(matchers);\r\n```\r\n\r\njest config in package.json\r\n```json\r\n{\r\n    \"jest\": {\r\n        \"preset\": \"ts-jest\",\r\n        \"clearMocks\": true,\r\n        \"testEnvironment\": \"node\",\r\n        \"moduleFileExtensions\": [\r\n            \"js\",\r\n            \"json\",\r\n            \"ts\"\r\n        ],\r\n        \"rootDir\": \".\",\r\n        \"roots\": [\r\n            \"assets\",\r\n            \"src\"\r\n        ],\r\n        \"testRegex\": \".*?(?=\\\\.spec).*?\\\\.ts\",\r\n        \"transform\": {\r\n            \".+\\\\.(t|j)s$\": \"ts-jest\"\r\n        },\r\n        \"collectCoverage\": true,\r\n        \"collectCoverageFrom\": [\r\n            \"**/*.ts\"\r\n        ],\r\n        \"testPathIgnorePatterns\": [\r\n            \"/node_modules/\",\r\n            \".*\\\\.ts\\\\.snap\"\r\n        ],\r\n        \"coverageDirectory\": \"../coverage\",\r\n        \"coverageThreshold\": {\r\n            \"global\": {\r\n                \"functions\": 95,\r\n                \"lines\": 95\r\n            }\r\n        },\r\n        \"setupFilesAfterEnv\": [\r\n            \"<rootDir>/setup-jest.ts\"\r\n        ]\r\n    }\r\n}\r\n```\r\n\r\n### Versions\r\n\r\nlanguage: null\r\ncdktf-cli: 0.16.3\r\nnode: v16.18.1\r\nterraform: 1.5.0\r\narch: arm64\r\nos: darwin 22.5.0\r\n\r\nLanguage is actually Typescript...\r\n\r\n### Providers\r\n\r\n\"@cdktf/provider-aws@^14.0.4\":\r\n  version \"14.0.4\"\r\n  resolved \"https://<self hosted Artifactory>/artifactory/api/npm/<NPM Cache>/@cdktf/provider-aws/-/provider-aws-14.0.4.tgz#be096f1e219c8c32a1f7ce801ec8f11f62e8c832\"\r\n  integrity sha512-/NGdzzVPvTchei/2O7AdId9WX3GequSQwlJ5wuAeMKCLlUBCqRPVU1ndsr48tkwvFdyefgK3Goh5/1xeiUOSdw==\r\n\r\n\"@cdktf/provider-random@^7.0.1\":\r\n  version \"7.0.1\"\r\n  resolved \"https://<self hosted Artifactory>/artifactory/api/npm/<NPM Cache>/@cdktf/provider-random/-/provider-random-7.0.1.tgz#04796d06b417322b2f5a62612c64b725b8c2505b\"\r\n  integrity sha512-GF14hSu7ZyE6j+FIAZcTp6kpBNWrY1A926VyPLXS1b0Zc9FczRwqQfNTivMX6qdnScDE+QzixuX+csOOoWLU2g==\r\n\r\n\r\n### Gist\r\n\r\n_No response_\r\n\r\n### Possible Solutions\r\n\r\nBecause of that random behavior (sometimes even succeeds!), It feels like a race-condition issue...\r\n\r\n### Workarounds\r\n\r\nTrying multiple times and praying...\r\n\r\n### Anything Else?\r\n\r\n_No response_\r\n\r\n### References\r\n\r\n_No response_\r\n\r\n### Help Wanted\r\n\r\n- [ ] I'm interested in contributing a fix myself\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5fmoF3","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @DJAlPee ğŸ‘‹\n\nHow did you install Terraform? It seems like something is going on with some temporary or caching directory under the hood there and not directly CDKTF related.\n\nCould you tell some more about your system and how you are executing the tests?","createdAt":"2023-06-23T08:59:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2939#issuecomment-1603961207","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5fyLWL","author":{"login":"DJAlPee"},"authorAssociation":"NONE","body":"Hi @ansgarm \r\nI have installed terraform binary on my Mac M1 (Pro) using homebrew:\r\n```shell\r\nâœ— which terraform\r\n/opt/homebrew/bin/terraform\r\nâœ— terraform --version\r\nTerraform v1.5.0\r\non darwin_arm64\r\nâœ— cat ~/.terraformrc\r\nplugin_cache_dir   = \"${HOME}/.terraform.d/plugin-cache\"\r\ndisable_checkpoint = true\r\nâœ— ls -la ~/.terraform.d\r\ntotal 16\r\ndrwxr-xr-x   5 ap  staff   160 Jan  9 14:21 .\r\ndrwxr-x---+ 65 ap  staff  2080 Jun 26 10:30 ..\r\n-rw-r--r--   1 ap  staff   326 Jan  9 14:21 checkpoint_cache\r\n-rw-r--r--   1 ap  staff   394 Sep  6  2022 checkpoint_signature\r\ndrwxr-xr-x   3 ap  staff    96 Sep  6  2022 plugin-cache\r\n```\r\n\r\nWhat comes on top (but should not be an issue here?), that I don't have a `cdktf.json` file in my project, because synth of the terraform config is done within my project:\r\n```typescript\r\n    const { SynthStack } = (await import('@cdktf/cli-core/src/lib/synth-stack.js'));\r\n    const cdktfEntrypoint = path.join(cliDirname, 'infrastructure/main.js');\r\n    const output = path.join(cwd, 'cdktf.out');\r\n    const nodeCall = 'node ' + cdktfEntrypoint;\r\n    const result = await SynthStack.synth(AbortSignal.timeout(100000), nodeCall, output);\r\n```","createdAt":"2023-06-26T08:43:59Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2939#issuecomment-1606989195","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5ihA05","author":{"login":"github-actions"},"authorAssociation":"CONTRIBUTOR","body":"Hi there! ğŸ‘‹ We haven't heard from you in 30 days and would like to know if the problem has been resolved or if you still need help. If we don't hear from you before then, I'll auto-close this issue in 30 days.","createdAt":"2023-07-27T02:29:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2939#issuecomment-1652821305","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5i1FJz","author":{"login":"DJAlPee"},"authorAssociation":"NONE","body":"This is still valid. I have updated to latest version und still getting errors. There is now a new error popping up (sometimes):\r\n```\r\n    Expected subject to be a valid terraform stack: Error: Command failed: terraform validate -json. Output: {\r\n      \"format_version\": \"1.0\",\r\n      \"valid\": false,\r\n      \"error_count\": 2,\r\n      \"warning_count\": 0,\r\n      \"diagnostics\": [\r\n        {\r\n          \"severity\": \"error\",\r\n          \"summary\": \"fork/exec .terraform/providers/registry.terraform.io/hashicorp/aws/5.10.0/darwin_arm64/terraform-provider-aws_v5.10.0_x5: exec format error\",\r\n          \"detail\": \"\"\r\n        },\r\n        {\r\n          \"severity\": \"error\",\r\n          \"summary\": \"fork/exec .terraform/providers/registry.terraform.io/hashicorp/aws/5.10.0/darwin_arm64/terraform-provider-aws_v5.10.0_x5: exec format error\",\r\n          \"detail\": \"\"\r\n        }\r\n      ]\r\n    }\r\n    .\r\n```\r\n\r\n@ansgarm Would be great, if you could set this issue to a status, that won't close after 30 days without any new comments.","createdAt":"2023-07-31T10:16:48Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2939#issuecomment-1658081907","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc52Ptln","author":{"login":"DJAlPee"},"authorAssociation":"NONE","body":"@ansgarm and @xiehan it seems, that I have found the cause for this behavior!\r\n\r\nIt seems to be some kind of \"race-condition\" issue here.\r\nIf there is **only one test**, which is calling `toBeValidTerraform()`, everything is fine. When there is a **second stack**, with a **second test file**, which  uses `toBeValidTerraform()`, I get the errors, which I have already posted! Most properly because parallel execution causes some interferance?!\r\n\r\nIs it possible to make `toBeValidTerraform()` (and most properly `toPlanSuccessfully()`, too) safe for parallel execution?\r\nOr do I have to fix this within my test setup? (But how?)\r\n\r\nI have updated my issue reflecting this case a bit more detailed.","createdAt":"2024-03-07T15:58:38Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2939#issuecomment-1983830375","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc52Vdxp","author":{"login":"DJAlPee"},"authorAssociation":"NONE","body":"`--maxWorkers=1` seems to help, but this affects the performance of all tests.\r\nWhyever `--maxConcurrency=1` won't help, even when the tests, which executes `toBeValidTerraform()`, are \"marked\" with `it.concurrent`.","createdAt":"2024-03-08T09:21:15Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2939#issuecomment-1985338473","viewerDidAuthor":false}],"createdAt":"2023-06-14T12:11:36Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyNTcwMTY0OTY5","name":"testing","description":"","color":"456cc6"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"}],"milestone":null,"number":2939,"title":"Testing: `toBeValidTerraform()` fails with \"random\" error messages","updatedAt":"2024-03-08T09:21:16Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMzYzNDY2","is_bot":false,"login":"sarthak","name":"Sarthak Agrawal"},"body":"### Expected Behavior\n\nFor 2 stacks, A & B. If stack B depends on A, and _only_ stack B has a `TerraformVariable`  `xyz` defined, then running `cdktf deploy A B --var xyz=abc` should work as expected so that stack A is deployed first, and then stack B with the var xyz assuming value abc.\n\n### Actual Behavior\n\nRunning `cdktf deploy A B --var xyz=abc` fails deploying stack A:\r\n```\r\nError: Value for undeclared variable\r\n\r\n        â”‚ A variable named \"xyz\" was assigned on the command line, but the\r\n        â”‚ root module does not declare a variable of that name. To use this value, add\r\n        â”‚ a \"variable\" block to the configuration.\r\n```\r\n\r\nJust running `cdktf deploy B --var xyz=abc` instead fails wit (expectedly):\r\n```\r\nError: Usage Error: The following dependencies are not included in the stacks to run [...]\r\n```\n\n### Steps to Reproduce\n\nDefine a cdktf `App` with 2 stacks A & B such that stack B depends on stack A via inter-stack dependencies supported in CDKTF. Add a `TerraformVariable` construct to stack B, then attempt deployment of both the stacks together.\n\n### Versions\n\nlanguage: null\r\ncdktf-cli: 0.16.1\r\nnode: v18.13.0\r\nterraform: 1.3.6\r\narch: x64\r\nos: linux 5.15.0-1034-aws\n\n### Providers\n\n_No response_\n\n### Gist\n\n_No response_\n\n### Possible Solutions\n\n_No response_\n\n### Workarounds\n\nOne workaround at the moment is to not use `--var` cli flag, and instead pass variables via the `TF_VAR_*` environment variables so that stacks not having those variables do not complain.\n\n### Anything Else?\n\n_No response_\n\n### References\n\n_No response_\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2023-06-05T07:08:30Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"},{"id":"MDU6TGFiZWwzMTQ2NjcxNDUz","name":"feature/multi-stack","description":"","color":"6589C9"}],"milestone":null,"number":2919,"title":"cdktf-cli: terraform variables passed through --var flag and inter-stack dependencies don't interface nicely","updatedAt":"2023-06-09T11:51:12Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjg1NTExNQ==","is_bot":false,"login":"xiehan","name":"Nara Kasbergen Kwon"},"body":"### Description\n\nSplit from #2818 - we don't have anything in our docs about the `conditional()` feature so it's not easy for users to know that this exists. Note that we'd probably want to prioritize implementing it for all other languages besides TypeScript first before adding the docs page/section, however.\n\n### Links\n\n- https://developer.hashicorp.com/terraform/cdktf/concepts/functions\r\n- #2818\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2023-06-02T09:17:24Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"}],"milestone":null,"number":2915,"title":"Conditionals: Add documentation page or section","updatedAt":"2023-06-02T09:17:24Z"},{"assignees":[{"id":"MDQ6VXNlcjExMTIwNTY=","login":"ansgarm","name":"Ansgar Mertens","databaseId":0}],"author":{"is_bot":true,"login":"app/sentry"},"body":"Sentry Issue: [CDKTF-REGISTRY-DOCS-1A0](https://hashicorp.sentry.io/issues/4220363717/?referrer=github_integration)\n\n```\nSyntaxError: Unexpected token, expected \",\" (45:32)\n  43 |       \"destination\": \"s3\",\n  44 |       \"lifecycle\": {\n> 45 |         \"ignoreChanges\": [tags_\"logDeliveryEnabled\"]\n     |                                ^\n  46 |       },\n  47 |       \"name\": \"terraform-k...\n  File \"/__t/node/18.16.0/x64/lib/node_modules/cdktf-registry-docs/node_modules/prettier/parser-babel.js\", line 22, in p\n    '{snip} eate-error.js\"(l,h){\"use strict\";U();function p(d,x){let P=new SyntaxError(d+\" (\"+x.start.line+\":\"+x.start.column+\")\");return P.loc=x,P}h.ex {snip}\n  File \"/__t/node/18.16.0/x64/lib/node_modules/cdktf-registry-docs/node_modules/prettier/parser-babel.js\", line 22, in d\n    '{snip} U();var p=lr();function d(x){let{message:P,loc:m}=x;return p(P.replace(/ \\(.*\\)/,\"\"),{start:{line:m?m.line:0,column:m?m.column+1:0}})}h.expo {snip}\n  File \"/__t/node/18.16.0/x64/lib/node_modules/cdktf-registry-docs/node_modules/prettier/parser-babel.js\", line 29, in Object.parse\n    '{snip} sult:k,error:F}=Yf(...v.map(w=>()=>od(l,x,w)));if(!k)throw ed(F);return m.originalText=x,td(k,m)}}var ld=$e(\"parse\",he([\"jsx\",\"flow\"])),Lo=$ {snip}\n  File \"/__t/node/18.16.0/x64/lib/node_modules/cdktf-registry-docs/node_modules/prettier/index.js\", line 7515, in Object.parse\n    ast: parser.parse(text, parsersForCustomParserApi, opts)\n  File \"/__t/node/18.16.0/x64/lib/node_modules/cdktf-registry-docs/node_modules/prettier/index.js\", line 8829, in coreFormat\n    } = parser.parse(originalText, opts);\n...\n(5 additional frame(s) were not displayed)\n```","comments":[{"id":"IC_kwDODd1Amc5dtJQv","author":{"login":"sentry"},"authorAssociation":"NONE","body":"Sentry issue: [CDKTF-REGISTRY-DOCS-108](https://hashicorp.sentry.io/issues/4220329767/?referrer=github_integration)","createdAt":"2023-06-01T14:01:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2912#issuecomment-1572115503","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5dtJv-","author":{"login":"sentry"},"authorAssociation":"NONE","body":"Sentry issue: [CDKTF-REGISTRY-DOCS-10B](https://hashicorp.sentry.io/issues/4220330151/?referrer=github_integration)","createdAt":"2023-06-01T14:02:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2912#issuecomment-1572117502","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5euI8M","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"Source: \n\n```hcl\n\n  lifecycle {\n    ignore_changes = [\n      tags[\"LogDeliveryEnabled\"],\n    ]\n  }\n```\n\nSeems like we can't deal with this kind of syntax right now.","createdAt":"2023-06-13T11:54:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2912#issuecomment-1589153548","viewerDidAuthor":false}],"createdAt":"2023-06-01T14:00:12Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTg1Mzg1NTQ2","name":"feature/convert","description":"","color":"d93f0b"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":2912,"title":"hcl2cdk: produces incorrect typescript with mix of quoted and unquoted values","updatedAt":"2023-10-13T15:28:55Z"},{"assignees":[{"id":"MDQ6VXNlcjExMTIwNTY=","login":"ansgarm","name":"Ansgar Mertens","databaseId":0}],"author":{"is_bot":true,"login":"app/sentry"},"body":"Sentry Issue: [CDKTF-REGISTRY-DOCS-7P](https://hashicorp.sentry.io/issues/4220236457/?referrer=github_integration)\n\n```\nError: getExpressionAst errors on input string '\"^myami-\\d{3}\"': main.tf:0,8-10: Invalid escape sequence; The symbol \"d\" is not a valid escape sequence selector. \n  File \"/__t/node/18.16.0/x64/lib/node_modules/cdktf-registry-docs/node_modules/@cdktf/hcl2json/lib/bridge.js\", line 81, in cb\n    err ? reject(new Error(err)) : resolve(...msg);\n  File \"/__t/node/18.16.0/x64/lib/node_modules/cdktf-registry-docs/node_modules/@cdktf/hcl2json/wasm/wasm_exec.js\", line 366, in syscall/js.valueInvoke\n    const result = Reflect.apply(v, undefined, args);\n  File \"wasm://wasm/018549f2:wasm-function[1489]\", in <anonymous>\n  File \"wasm://wasm/018549f2:wasm-function[1473]\", in <anonymous>\n  File \"wasm://wasm/018549f2:wasm-function[3125]\", in <anonymous>\n...\n(5 additional frame(s) were not displayed)\n```","comments":[{"id":"IC_kwDODd1Amc5euIIt","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"This might be invalid HCL. We need to confirm, and then either cut a ticket to the original provider docs if so.","createdAt":"2023-06-13T11:52:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2910#issuecomment-1589150253","viewerDidAuthor":false}],"createdAt":"2023-06-01T13:54:41Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTg1Mzg1NTQ2","name":"feature/convert","description":"","color":"d93f0b"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":2910,"title":"hcl2cdk: getExpressionAst fails with regex strings due to escaping","updatedAt":"2023-10-13T15:28:54Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjY4MTE5MzM=","is_bot":false,"login":"yuriy-yarosh","name":"Yuriy Yarosh"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nIt would save too much time and effort if CDKTF adopters could skip unused resources imports for the existing providers, with a respective resource whitelist in the `cdktf.json` config file.\r\n\r\n```json\r\n{\r\n  \"language\": \"golang\",\r\n  \"app\": \"echo CDKTF breaks too often and eats too much RAM, JSII should've been written in Rust\",\r\n  \"terraformProviders\": [{\r\n    \"name\": \"aws\" ,\r\n    \"version\": \"~> 5.0.1\", # both 5.0.1 and 4.67.0 are broken now because of the following resources\r\n    \"include\": [],\r\n    \"exclude\": [\"aws_quicksight_template\", \"aws_appsync_domain_name\"]\r\n  }]\r\n}\r\n```\r\n\r\n```ts\r\nexport interface TerraformDependencyConstraint {\r\n  readonly name: string; // name of the module / provider\r\n  readonly source?: string; // path / url / registry identifier for the module / provider\r\n  readonly version?: string; // version constraint\r\n  readonly include?: string[]; // get and import only the specified resources, import everything if empty or unspecified\r\n  readonly exclude?: string[]; // ignore any buggy or too complex resources, that are breaking builds, or take too much time\r\ntype RequirementDefinition = string | TerraformDependencyConstraint;\r\n```\r\n\r\n### References\r\n\r\nIt's pointless and cumbersome to regenerate and re-import everything from scratch, over and over, without any incremental builds (as per [#2116](https://github.com/hashicorp/terraform-cdk/issues/2116) ).\r\n\r\nExisting generated modules are bloated with JSII bundles, about 1.5Gb (as per [#2829](https://github.com/hashicorp/terraform-cdk/issues/2829) ).\r\n\r\nAnd existing providers are conflicting from time to time with JSII naming conventions (as per AWS Provider [#31615](https://github.com/hashicorp/terraform-provider-aws/issues/31615) and [#2879](https://github.com/hashicorp/terraform-cdk/issues/2879)).\r\n\r\nCDK8S has it's escape hatches, and patching yaml's during import is a common practice there, due to various compatibility issues (as per CDK8S [#1323](https://github.com/cdk8s-team/cdk8s/issues/1323) and [#970](https://github.com/cdk8s-team/cdk8s-cli/issues/970) sometimes the whole codgen is very inconsistent [#1326](https://github.com/cdk8s-team/cdk8s/issues/1326)).\r\n\r\nIt's possible to workaround cdk8s import issues with some manual yaml patching.\r\nBut the respective CDKTF escape hatches are rather undocumented and would be fairly inconvenient.\r\nIt would be really weird to make a `git subtree` out of tf provider, with the respective patched release, just to workaround some broken codegen.","comments":[{"id":"IC_kwDODd1Amc5dWjN_","author":{"login":"yuriy-yarosh"},"authorAssociation":"NONE","body":"![right now](https://github.com/hashicorp/terraform-cdk/assets/6811933/96d8c3d5-9dfe-49c0-ba44-96619f43f084)\r\n\r\nIt's literally taking around 90 min right now, OOM's on 4 threads Archlinux box with 32Gb of RAM.","createdAt":"2023-05-28T16:29:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2892#issuecomment-1566192511","viewerDidAuthor":false}],"createdAt":"2023-05-28T02:40:40Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjA1MTIxODAz","name":"enhancement/new-workflow","description":"Proposed new workflow","color":"4A1023"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"},{"id":"LA_kwDODd1Amc7WpEvS","name":"ux/integration","description":"","color":"D670CB"},{"id":"LA_kwDODd1Amc8AAAABEqTcrA","name":"performance","description":"Gotta go fast","color":"890D75"}],"milestone":null,"number":2892,"title":"Allow skipping bugged resources, or allowlist used resources for the imported provider.","updatedAt":"2023-06-23T09:15:41Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE5MjgxMjM=","is_bot":false,"login":"g00ntar","name":"Gontar"},"body":"### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n### cdktf & Language Versions\r\ncdktf version: 0.16.1\r\nterraform version: 1.4.2\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\n### Affected Resource(s)\r\n\r\n<!--- Please list the affected resources. --->\r\n\r\n### Debug Output\r\nCode v1:\r\n```ts\r\nclass CoreStack extends TerraformStack {\r\n  constructor(scope: Construct, id: string) {\r\n    super(scope, id);\r\n    new TerraformOutput(this, 'test', {\r\n      value: new TerraformVariable(this, 'AWS_ACCESS_KEY', {}).value\r\n    })\r\n  }\r\n}\r\n```\r\n\r\nCode v2:\r\n```ts\r\nclass CoreStack extends TerraformStack {\r\n  constructor(scope: Construct, id: string) {\r\n    super(scope, id);\r\n    new TerraformOutput(this, 'test', {\r\n      value: new TerraformVariable(this, 'AWS-ACCESS-KEY', {}).value // please note dashes instead of underscores\r\n    })\r\n  }\r\n}\r\n```\r\n\r\n### Expected Behavior\r\n\r\nEqual treatment of variables independent from variable name or entry in docs about this behaviour.\r\n\r\n### Actual Behavior\r\nCode v1 `cdktf diff` output\r\n```bash\r\n      core  Missing variable: 'AWS_ACCESS_KEY'. You can provide it using the 'TF_VAR_AWS_ACCESS_KEY' environment variable.\r\n      core  Operation failed: failed running terraform plan (exit 1)\r\n```\r\n\r\nCode v2 `cdktf diff` output\r\n```bash\r\n      â•·\r\n      â”‚ Error: Output refers to sensitive values\r\n      â”‚ \r\n      â”‚   on cdk.tf.json line 16, in output:\r\n      â”‚   16:     \"test\": {\r\n      â”‚ \r\n      â”‚ To reduce the risk of accidentally exporting sensitive data that was\r\n      â”‚ intended to be only internal, Terraform requires that any root module\r\n      â”‚ output containing sensitive data be explicitly marked as sensitive, to\r\n      â”‚ confirm your intent.\r\n      â”‚ \r\n      â”‚ If you do intend to export this data, annotate the output value as\r\n      â”‚ sensitive by adding the following argument:\r\n      â”‚     sensitive = true\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\nCreate variables with names `AWS_ACCESS_KEY` `AWS-ACCESS-KEY` on terraform cloud and run the code.\r\n\r\n","comments":[],"createdAt":"2023-05-17T12:48:59Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjIzNTI1MzY0","name":"terraform cloud","description":"","color":"4ed354"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"LA_kwDODd1Amc7WpEvS","name":"ux/integration","description":"","color":"D670CB"}],"milestone":null,"number":2877,"title":"Inconsistent behaviour with variables from Terraform Cloud","updatedAt":"2023-06-23T10:44:48Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjc0NjA5MzQ=","is_bot":false,"login":"mpicard","name":"Martin Picard"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\nPython 3.11\r\ncdktf                        0.16.1  Cloud Development Kit for Terraform\r\ncdktf-cdktf-provider-azuread 7.0.2   Prebuilt azuread Provider for Terrafor...\r\ncdktf-cdktf-provider-azurerm 7.0.3 \r\n\r\n### Affected Resource(s)\r\n\r\n<!--- Please list the affected resources. --->\r\n\r\n### Debug Output\r\n\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\n\r\n### Expected Behavior\r\n\r\nWhen I compare to the Typescript version:\r\n\r\n```typescript\r\n  describe('MyConstruct', () => {\r\n    let myconstruct: MyConstruct;\r\n    const stack = Testing.synthScope(scope => {\r\n      myconstruct = new MyConstruct(scope, \"myconstruct\");\r\n    })\r\n})\r\n```\r\n\r\nIt works, so I expect in Python that it would also work\r\n\r\n\r\n### Actual Behavior\r\n\r\n\r\n```\r\n    stack = Testing.synth_scope(lambda scope: MyConstruct(scope, \"myconstruct\"))\r\n.venv/lib/python3.11/site-packages/cdktf/__init__.py:13787: in synth_scope\r\n    return typing.cast(builtins.str, jsii.sinvoke(cls, \"synthScope\", [fn]))\r\n.venv/lib/python3.11/site-packages/jsii/_kernel/__init__.py:149: in wrapped\r\n    return _recursize_dereference(kernel, fn(kernel, *args, **kwargs))\r\n.venv/lib/python3.11/site-packages/jsii/_kernel/__init__.py:422: in sinvoke\r\n    args=_make_reference_for_native(self, args),\r\n.venv/lib/python3.11/site-packages/jsii/_kernel/__init__.py:165: in _make_reference_for_native\r\n    return [_make_reference_for_native(kernel, i) for i in d]\r\n.venv/lib/python3.11/site-packages/jsii/_kernel/__init__.py:165: in <listcomp>\r\n    return [_make_reference_for_native(kernel, i) for i in d]\r\n.venv/lib/python3.11/site-packages/jsii/_kernel/__init__.py:199: in _make_reference_for_native\r\n    raise JSIIError(\r\nE   jsii.errors.JSIIError: Cannot pass function as argument here (did you mean to call this function?): <function TestingMyConstruct.<lambda> at 0x1027a04a0>\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n```python\r\nclass MyConstruct(Construct):\r\n    def __init__(self, scope: Construct, id: str):\r\n        super().__init__(scope, id)\r\n\r\nstack = Testing.synth_scope(lambda scope: MyConstruct(scope, \"myconstruct\"))\r\n```\r\n\r\n### Important Factoids\r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n- #0000\r\n","comments":[{"id":"IC_kwDODd1Amc5ecMLX","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"`Testing.synthScope` does not work in any other language than Typescript. Please use Testing.synth instead, e.g.\r\n\r\n```python\r\nstack = TerraformStack(Testing.app(), \"stack\")\r\napp_abstraction = MyApplicationsAbstraction(stack, \"app-abstraction\")\r\nsynthesized = Testing.synth(stack)\r\nassert Testing.to_have_resource(synthesized, Container.TF_RESOURCE_TYPE)\r\n```\r\n\r\n\r\nLeaving this open to clarify our documentation / code hints","createdAt":"2023-06-09T11:47:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2871#issuecomment-1584448215","viewerDidAuthor":false}],"createdAt":"2023-05-11T11:56:28Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyNTcwMTY0OTY5","name":"testing","description":"","color":"456cc6"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"}],"milestone":null,"number":2871,"title":"[Python] Testing.synth_scope is broken","updatedAt":"2023-06-09T11:48:28Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjIyODc1MTY2","is_bot":false,"login":"gmeligio","name":"Eligio MariÃ±o"},"body":"### Description\n\nI had an issue in the following snippet with mathematical expressions using values from a data source. The snippet already contains the solution using `cdktf.Op`.\r\n\r\nI tried different ways to get `defaultVcpus` and using `cdktf.Token` but those didn't work and I was getting in `totalCpu`  a big negative value, which is the internal Token representation . Then searching and reading  a few issues to see if there were a similar one to mine, I found in #2557 that there is a `cdktf.Op` and that solved it.\r\n\r\nIt would be nice to have a documentation page about what Operators are, when to use them, and how they interact with Tokens.\r\n\r\n```typescript\r\nconst dataInstance = new aws.dataAwsEc2InstanceType.DataAwsEc2InstanceType(this, 'dataInstance', {\r\n    instanceType: 't3a.medium',\r\n  });\r\n\r\nconst totalCpu = cdktf.Op.mul(0.8, dataInstance.defaultVcpus);\r\nconst containerCpu = cdktf.Op.mul(0.45, totalCpu);\r\n\r\nconst threadCount = cdktf.Fn.ceil(cdktf.Token.asNumber(containerCpu));\r\n```\n\n### Links\n\nhttps://developer.hashicorp.com/terraform/cdktf\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[{"id":"IC_kwDODd1Amc5dyIqy","author":{"login":"xiehan"},"authorAssociation":"MEMBER","body":"Note that we do already have https://developer.hashicorp.com/terraform/cdktf/concepts/functions#operators but I agree it's worth expanding with at least a few more examples.","createdAt":"2023-06-02T09:20:30Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2867#issuecomment-1573423794","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5eTKsK","author":{"login":"gmeligio"},"authorAssociation":"CONTRIBUTOR","body":"Thank you @xiehan. I was looking for an independent page like in the [HCL docs](https://developer.hashicorp.com/terraform/language/expressions/operators) and didn't find it on the Functions page.\r\n\r\nIt's OK where it is today in the link you shared.\r\n\r\nIf possible, I would like the new examples to showcase when Operators are the easiest or the only way to accomplish something, like their interaction with Token, instead of only showing the API syntax. Maybe something along the lines of my first comment could be used.\r\n\r\nAs it is right now, I read it like it covers an HCL feature but doesn't explain the difference with Typescript operators. An example of what I'm asking is this section that I read a lot when starting with Iterators https://developer.hashicorp.com/terraform/cdktf/concepts/iterators#when-to-use-iterators\r\n\r\n","createdAt":"2023-06-08T07:56:00Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2867#issuecomment-1582082826","viewerDidAuthor":false}],"createdAt":"2023-05-09T10:44:22Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"LA_kwDODd1Amc7nQOIC","name":"feature/terraform-functions","description":"","color":"A1C1CD"}],"milestone":null,"number":2867,"title":"(Concepts): new page to document Operators usage","updatedAt":"2023-06-08T07:56:00Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE2ODQxOTc4","is_bot":false,"login":"suvhotta","name":"Subhankar Hotta"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\ncdktf: 0.15.5\r\naws_provider: hashicorp/aws@~>3.0\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\n### Affected Resource(s)\r\n\r\n<!--- Please list the affected resources. --->\r\nI'm trying to create a common base class for all my stacks using AWS provider as follows:\r\nbase.py:\r\n<code>\r\n|class AWSBaseStack(TerraformStack):\r\n|    def __init__(self, scope: Construct, ns: str, region):\r\n|        super().__init__(scope, ns)\r\n|        AwsProvider(self, \"AWS\", region=region)\r\n</code>\r\n\r\nMy stack looks like this:\r\n<code>\r\n|class EC2Stack(AWSBaseStack):\r\n|    def __init__(self, scope: Construct, ns: str, name: str, ami: str, ssh_sg_id: str, region):\r\n|        super().__init__(scope, ns, region)\r\n|        instance = Instance(self, name,\r\n|                            ami=ami,\r\n|                            instance_type=\"t2.micro\",\r\n|                            key_name=\"test-dev-ew1\",\r\n|                            associate_public_ip_address=True,\r\n|                            subnet_id=\"subnet-123x439a17r3567l0\",\r\n|                            security_groups=[f\"{ssh_sg_id}\"]\r\n|                            )\r\n\r\n|        TerraformOutput(self, \"ec2-arn\", value=instance.arn)\r\n\r\n</code>\r\n### Actual Behavior\r\nIt is throwing the following error:\r\n\r\n                        â”‚ Error: Required plugins are not installed\r\n                        â”‚ \r\n                        â”‚ The installed provider plugins are not consistent with the packages selected\r\n                        â”‚ in the dependency lock file:\r\n                        â”‚   - registry.terraform.io/hashicorp/aws: the cached package for registry.terraform.io/hashicorp/aws 3.76.1 (in .terraform/providers) does not match any of the checksums recorded in the dependency lock file\r\n                        â”‚ \r\n                        â”‚ Terraform uses external plugins to integrate with a variety of different\r\n                        â”‚ infrastructure services. To download the plugins required for this\r\n                        â”‚ configuration, run:\r\n                        â”‚   terraform init\r\n                        â•µ\r\n\r\nThis error disappears when I use the provider normally inside the __init__ method of the stack.\r\n\r\nAm I doing anything wrong here? Is this the right way to re-use the aws providers or is there any better way to do the same?\r\n<!--- What actually happened? --->\r\n","comments":[{"id":"IC_kwDODd1Amc6gPWAZ","author":{"login":"djakielski"},"authorAssociation":"NONE","body":"I got the same issue with sentry provider\n\n```\ninfrastructure/inside postinstall: [2025-02-27T16:42:01.423] [ERROR] default - â•·\ninfrastructure/inside postinstall: â”‚ Error: Required plugins are not installed\ninfrastructure/inside postinstall: â”‚ \ninfrastructure/inside postinstall: â”‚ The installed provider plugins are not consistent with the packages\ninfrastructure/inside postinstall: â”‚ selected in the dependency lock file:\ninfrastructure/inside postinstall: â”‚   - registry.terraform.io/jianyuan/sentry: the cached package for registry.terraform.io/jianyuan/sentry 0.14.3 (in .terraform/providers) does not match any of the checksums recorded in the dependency lock file\ninfrastructure/inside postinstall: â”‚ \ninfrastructure/inside postinstall: â”‚ Terraform uses external plugins to integrate with a variety of different\ninfrastructure/inside postinstall: â”‚ infrastructure services. To download the plugins required for this\ninfrastructure/inside postinstall: â”‚ configuration, run:\ninfrastructure/inside postinstall: â”‚   terraform init\n```","createdAt":"2025-02-27T15:52:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2855#issuecomment-2688376857","viewerDidAuthor":false}],"createdAt":"2023-05-02T16:39:27Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzMxMzA4","name":"confirmed","description":"independently reproduced by an engineer on the team","color":"4B830E"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"}],"milestone":null,"number":2855,"title":"Error when trying to create a common base class for AWS Provider","updatedAt":"2025-02-27T15:52:29Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEwNDY0NDk3","is_bot":false,"login":"garysassano","name":"Gary Sassano"},"body":"Poetry has become the most popular tool for managing Python projects and also [projen](https://github.com/projen/projen) allows you to set up your repo with that. CDKTF already supports built-in templates for `python` (pipenv) and `python-pip` (pip) so I think there should be space for `python-poetry` (Poetry) as well.\r\n\r\nThere's also an [existing template](https://github.com/johnfraney/cdktf-remote-template-python-poetry) that works very well.","comments":[{"id":"IC_kwDODd1Amc5ay5ac","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @garysassano ğŸ‘‹\r\n\r\nThank you for raising this! This was originally discussed in a PR [here](https://github.com/hashicorp/terraform-cdk/pull/905#issuecomment-901404734) which then ended up becoming the community template you linked.\r\n\r\nIs there any data that you know of that could help to make the case in favor or Python Poetry? Personally, I'd rather replace one of the existing Python templates with the Poetry one, but this would require us to have some data that supports the higher popularity of Python Poetry over e.g. Pipenv.","createdAt":"2023-04-26T11:56:00Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2838#issuecomment-1523291804","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5aziU9","author":{"login":"garysassano"},"authorAssociation":"NONE","body":"I think [Google Trends](https://trends.google.com/trends/explore?date=today%205-y&q=python%20poetry,python%20pipenv) is quite good at providing some unbiased data showing the clear rise in popularity of Poetry over pipenv.","createdAt":"2023-04-26T13:50:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2838#issuecomment-1523459389","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5ha-K1","author":{"login":"aogier"},"authorAssociation":"NONE","body":"considering that pypi installation method is now officially supported by either project, pypi download stats could prove a shift toward poetry:\r\n\r\n* https://pepy.tech/project/poetry\r\n* https://pepy.tech/project/pipenv\r\n\r\nwhere we can observe ~3x poetry installs","createdAt":"2023-07-13T15:34:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2838#issuecomment-1634460341","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5ob-Sf","author":{"login":"aogier"},"authorAssociation":"NONE","body":"update, since July poetry doubled its download https://pepy.tech/project/poetry . While this is not the definitive benchmark, it's also to be noted we don't have any evidence to the contrary :) \r\n\r\nwhat do you think @ansgarm ? Regards","createdAt":"2023-10-08T21:15:05Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2838#issuecomment-1752163487","viewerDidAuthor":false}],"createdAt":"2023-04-25T13:07:30Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMTEzNjU3MzA2","name":"language/python","description":"","color":"5c2596"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"}],"milestone":null,"number":2838,"title":"Add `python-poetry` to `cdktf-cli` built-in templates","updatedAt":"2023-10-08T21:16:18Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEwMjQxNDQ=","is_bot":false,"login":"vladmiller","name":"Vlad Miller"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nIt takes a while for Python to load entire `cdktf-cdktf-provider-aws` bundle as well it takes quite a bit of time to install the provider because of it's size.\r\n\r\nIt would be very useful, if it was possible to install only the APIs one may require in their project. Similar like it's possible with moto:\r\n\r\n```bash\r\npip install 'moto[ec2,s3,all]'\r\n```\r\n\r\nFor example:\r\n```\r\npip install 'cdktf-cdktf-provider-aws[lambda,s3]'\r\n```\r\n\r\nThat would reduce the overall bandwith requirements as well as improve unit-testing for custom cdktf constructs and synth process.","comments":[{"id":"IC_kwDODd1Amc5bC_KG","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @vladmiller ğŸ‘‹\r\n\r\nthank you for raising this â€“ I think this would be something that would need some upstream work in JSII.\r\n\r\nThat said, we did recently fix the size of the pre-built packages â€“ e.g. the AWS Python package should be 50% smaller now â€“ maybe you can already see an improvement there?","createdAt":"2023-04-28T12:44:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2835#issuecomment-1527509638","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5bs89X","author":{"login":"vladmiller"},"authorAssociation":"NONE","body":"Thank you, @ansgarm for the feedback. I will try and see how it goes. Maybe there is a way to provide an alternative entry point that lazy-loads only requested libraries? ","createdAt":"2023-05-08T15:04:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2835#issuecomment-1538510679","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5dEBuo","author":{"login":"rirze"},"authorAssociation":"CONTRIBUTOR","body":"The main issue is that the provider library loads all service modules in the root `__init__.py` file. This is unnecessary as documentation implies loading CDKTF objects via their object path rather than at the root level:\r\n`from cdktf_cdktf_provider_aws.instance import Instance` \r\ninstead of\r\n`from cdktf_cdktf_provider_aws import Instance`\r\n\r\nSimply deleting the root `__init__.py` shaves 50% of loading time. Hope that helps. ","createdAt":"2023-05-24T15:07:00Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2835#issuecomment-1561336744","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5fvYo3","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> The main issue is that the provider library loads all service modules in the root `__init__.py` file. This is unnecessary as documentation implies loading CDKTF objects via their object path rather than at the root level:\r\n\r\nThe loading of all modules was added via https://github.com/aws/jsii/pull/3049. It is done to ensure types not directly referenced are loaded correctly. Perhaps an option could be added to not do this as it is currently less relevant for cdktf. Alternatively, a smarter lazy loading solution may be possible.","createdAt":"2023-06-25T20:46:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2835#issuecomment-1606257207","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5gPmJw","author":{"login":"rirze"},"authorAssociation":"CONTRIBUTOR","body":"> > The main issue is that the provider library loads all service modules in the root `__init__.py` file. This is unnecessary as documentation implies loading CDKTF objects via their object path rather than at the root level:\r\n> \r\n> The loading of all modules was added via [aws/jsii#3049](https://github.com/aws/jsii/pull/3049). It is done to ensure types not directly referenced are loaded correctly. Perhaps an option could be added to not do this as it is currently less relevant for cdktf. Alternatively, a smarter lazy loading solution may be possible.\r\n\r\nJust curious, why not use the common typing conditional?:\r\n```python3\r\nif typing.TYPE_CHECKING:\r\n\t# load all 200 aws services for 30+ seconds\r\n```\r\n\r\nThat way, synth executions take way less time.","createdAt":"2023-06-30T14:03:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2835#issuecomment-1614701168","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5ghCg_","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> Just curious, why not use the common typing conditional?:\r\n\r\nThe typing is used at runtime to lookup how to bridge between the internal JSII runtime and the python application.","createdAt":"2023-07-04T00:02:13Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2835#issuecomment-1619273791","viewerDidAuthor":false}],"createdAt":"2023-04-24T18:20:22Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMTEzNjU3MzA2","name":"language/python","description":"","color":"5c2596"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"}],"milestone":null,"number":2835,"title":"Allow partial PyPi installs for cdktf-cdktf-provider-aws","updatedAt":"2023-07-04T00:02:14Z"},{"assignees":[],"author":{"id":"U_kgDOBbto5Q","is_bot":false,"login":"toha-nordic","name":"Tomi Hautakoski"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n0.15.5 and 0.16.0 with Typescript. NodeJS v18.16.0.\r\n\r\n### Affected Resource(s)\r\n\r\ncdktf init prints out errors and cdktf deploy fails to execute.\r\n\r\n### Debug Output\r\n\r\nhttps://gist.github.com/toha-nordic/194ec10412d6250f2d1265660387f785\r\n\r\n### Expected Behavior\r\n\r\ncdktf runs without errors.\r\n\r\n### Actual Behavior\r\n```\r\ncdktf deploy\r\nSystemError [ERR_SYSTEM_ERROR]: A system error occurred: uv_os_get_passwd returned ENOENT (no such file or directory)\r\n    at new SystemError (node:internal/errors:250:5)\r\n    at new NodeError (node:internal/errors:361:7)\r\n    at Object.userInfo (node:os:366:11)\r\n    at sbt (/home/linuxbrew/.linuxbrew/Cellar/cdktf/0.16.0/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:90:18445)\r\n    at z9e (/home/linuxbrew/.linuxbrew/Cellar/cdktf/0.16.0/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:90:19575)\r\n    at /home/linuxbrew/.linuxbrew/Cellar/cdktf/0.16.0/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:208:13079\r\n    at e.configureScope (/home/linuxbrew/.linuxbrew/Cellar/cdktf/0.16.0/libexec/lib/node_modules/cdktf-cli/bundle/bin/cdktf.js:13:13455)\r\n    at td (/home/linuxbrew/.linuxbrew/Cellar/cdktf/0.16.0/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:78:19214)\r\n    at Object.w8t (/home/linuxbrew/.linuxbrew/Cellar/cdktf/0.16.0/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:78:19818)\r\n    at pmr (/home/linuxbrew/.linuxbrew/Cellar/cdktf/0.16.0/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:208:13022)\r\nCollecting Debug Information...\r\nThis error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). The promise rejected with the reason:\r\nSystemError [ERR_SYSTEM_ERROR]: A system error occurred: uv_os_get_passwd returned ENOENT (no such file or directory)\r\n    at new SystemError (node:internal/errors:250:5)\r\n    at new NodeError (node:internal/errors:361:7)\r\n    at Object.userInfo (node:os:366:11)\r\n    at sbt (/home/linuxbrew/.linuxbrew/Cellar/cdktf/0.16.0/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:90:18445)\r\n    at z9e (/home/linuxbrew/.linuxbrew/Cellar/cdktf/0.16.0/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:90:19575)\r\n    at /home/linuxbrew/.linuxbrew/Cellar/cdktf/0.16.0/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:208:13079\r\n    at e.configureScope (/home/linuxbrew/.linuxbrew/Cellar/cdktf/0.16.0/libexec/lib/node_modules/cdktf-cli/bundle/bin/cdktf.js:13:13455)\r\n    at td (/home/linuxbrew/.linuxbrew/Cellar/cdktf/0.16.0/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:78:19214)\r\n    at Object.w8t (/home/linuxbrew/.linuxbrew/Cellar/cdktf/0.16.0/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:78:19818)\r\n    at pmr (/home/linuxbrew/.linuxbrew/Cellar/cdktf/0.16.0/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:208:13022)\r\n(node:2968685) PromiseRejectionHandledWarning: Promise rejection was handled asynchronously (rejection id: 3)\r\n(Use `node --trace-warnings ...` to show where the warning was created)\r\nDebug Information:\r\nlanguage: typescript\r\ncdktf-cli: 0.16.0\r\nnode: v18.16.0\r\ncdktf: 0.15.5\r\nconstructs: 10.2.0\r\njsii: null\r\nterraform: 1.4.5\r\narch: x64\r\nos: linux 5.15.0-67-generic\r\n```\r\nAnd init:\r\n```\r\ncdktf init --template=typescript --providers=kreuzwerker/docker --local\r\nCould not run version check - A system error occurred: uv_os_get_passwd returned ENOENT (no such file or directory)\r\nNote: By supplying '--local' option you have chosen local storage mode for storing the state of your stack.\r\nThis means that your Terraform state file will be stored locally on disk in a file 'terraform.<STACK NAME>.tfstate' in the root of your project.\r\n? Project Name tmp\r\n? Project Description A simple getting started project for cdktf.\r\n? Do you want to start from an existing Terraform project? No\r\n? Do you want to send crash reports to the CDKTF team? Refer to \r\nhttps://developer.hashicorp.com/terraform/cdktf/create-and-deploy/configuration-file#enable-crash-reporting-for-the-cli for more information Yes\r\n\r\nadded 2 packages, and audited 57 packages in 2s\r\n\r\n7 packages are looking for funding\r\n  run `npm fund` for details\r\n\r\nfound 0 vulnerabilities\r\n\r\nadded 301 packages, and audited 358 packages in 11s\r\n\r\n37 packages are looking for funding\r\n  run `npm fund` for details\r\n\r\nfound 0 vulnerabilities\r\n========================================================================================================\r\n\r\n  Your cdktf typescript project is ready!\r\n\r\n  cat help                Print this message\r\n\r\n  Compile:\r\n    npm run get           Import/update Terraform providers and modules (you should check-in this directory)\r\n    npm run compile       Compile typescript code to javascript (or \"npm run watch\")\r\n    npm run watch         Watch for changes and compile typescript in the background\r\n    npm run build         Compile typescript\r\n\r\n  Synthesize:\r\n    cdktf synth [stack]   Synthesize Terraform resources from stacks to cdktf.out/ (ready for 'terraform apply')\r\n\r\n  Diff:\r\n    cdktf diff [stack]    Perform a diff (terraform plan) for the given stack\r\n\r\n  Deploy:\r\n    cdktf deploy [stack]  Deploy the given stack\r\n\r\n  Destroy:\r\n    cdktf destroy [stack] Destroy the stack\r\n\r\n  Test:\r\n    npm run test        Runs unit tests (edit __tests__/main-test.ts to add your own tests)\r\n    npm run test:watch  Watches the tests and reruns them on change\r\n\r\n  Upgrades:\r\n    npm run upgrade        Upgrade cdktf modules to latest version\r\n    npm run upgrade:next   Upgrade cdktf modules to latest \"@next\" version (last commit)\r\n\r\n Use Providers:\r\n\r\n  You can add prebuilt providers (if available) or locally generated ones using the add command:\r\n  \r\n  cdktf provider add \"aws@~>3.0\" null kreuzwerker/docker\r\n\r\n  You can find all prebuilt providers on npm: https://www.npmjs.com/search?q=keywords:cdktf\r\n  You can also install these providers directly through npm:\r\n\r\n  npm install @cdktf/provider-aws\r\n  npm install @cdktf/provider-google\r\n  npm install @cdktf/provider-azurerm\r\n  npm install @cdktf/provider-docker\r\n  npm install @cdktf/provider-github\r\n  npm install @cdktf/provider-null\r\n\r\n  You can also build any module or provider locally. Learn more https://cdk.tf/modules-and-providers\r\n\r\n========================================================================================================\r\n\r\nChecking whether pre-built provider exists for the following constraints:\r\n  provider: kreuzwerker/docker\r\n  version : latest\r\n  language: typescript\r\n  cdktf   : 0.16.0\r\n\r\nFound pre-built provider.\r\nAdding package @cdktf/provider-docker @ 7.0.0\r\nInstalling package @cdktf/provider-docker @ 7.0.0 using npm.\r\nPackage installed.\r\n[2023-04-20T09:35:17.444] [ERROR] default - Could not send telemetry data: SystemError [ERR_SYSTEM_ERROR]: A system error occurred: uv_os_get_passwd returned ENOENT (no such file or directory)\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\nIm running on Ubuntu 20.04.06 LTS with 5.15.0-67-generic kernel. NodeJS v18.16.0, Terraform 1.4.5.\r\n\r\n### Important Factoids\r\n\r\nMy guess is that the error is due to this local laptop user not having an entry in /etc/passwd file. The user is provisioned from corporate MS Active Directory service via local realmd+sssd services. I believe this is common configuration in corporate environments.\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n- #0000\r\n","comments":[{"id":"IC_kwDODd1Amc5adFY-","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @toha-nordic ğŸ‘‹\r\n\r\nThank you for the bug report! It seems like the environment you're running in doesn't make it possible for the CDKTF CLI to determine a user home directory using `os.userInfo()` from Node.js.\r\n\r\nHowever, you should be able to work around this by setting the `CDKTF_HOME` environment variable.\r\n\r\nWe should at least print a better error message if this call fails (e.g. hinting at `CDKTF_HOME`) ğŸ¤”","createdAt":"2023-04-21T09:50:57Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2825#issuecomment-1517573694","viewerDidAuthor":false}],"createdAt":"2023-04-20T06:57:18Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":2825,"title":"Getting \"A system error occurred: uv_os_get_passwd returned ENOENT\" errors with MS AD provisioned user","updatedAt":"2023-06-01T14:31:32Z"},{"assignees":[{"id":"MDQ6VXNlcjEzMzcwNDY=","login":"DanielMSchmidt","name":"Daniel Schmidt","databaseId":0}],"author":{"id":"MDQ6VXNlcjU3MzUzMQ==","is_bot":false,"login":"mutahhir","name":"Mutahhir Hayat"},"body":"```tf\nresource \"aws_instance\" \"server\" {\n  ami           = \"ami-a1b2c3d4\"\n  instance_type = \"t2.micro\"\n}\n```\n\n# actual\n```go\nimport constructs \"github.com/aws/constructs-go/constructs\"\n/*Provider bindings are generated by running cdktf get.\nSee https://cdk.tf/provider-generation for more details.*/\nimport \"github.com/aws-samples/dummy/gen/providers/aws/instance\"\ntype myConvertedCode struct {\n\tconstruct\n}\n\nfunc newMyConvertedCode(scope construct, name *string) *myConvertedCode {\n\tthis := &myConvertedCode{}\n\tconstructs.NewConstruct_Override(this, scope, name)\n\tinstance.NewInstance(this, jsii.String(\"server\"), &instanceConfig{\n\t\tami: jsii.String(\"ami-a1b2c3d4\"),\n\t\tinstanceType: jsii.String(\"t2.micro\"),\n\t})\n\treturn this\n}\n```\n\n# expected\n```go\nimport constructs \"github.com/aws/constructs-go/constructs\"\n/*Provider bindings are generated by running cdktf get.\nSee https://cdk.tf/provider-generation for more details.*/\nimport \"github.com/aws-samples/dummy/gen/providers/aws/instance\"\ntype myConvertedCode struct {\n\tconstruct\n}\n\nfunc newMyConvertedCode(scope construct, name *string) *myConvertedCode {\n\tthis := &myConvertedCode{}\n\tconstructs.NewConstruct_Override(this, scope, name)\n\tinstance.NewInstance(this, jsii.String(\"server\"), &InstanceConfig{ // <- needs to be upper-case\n\t\tAmi: jsii.String(\"ami-a1b2c3d4\"), // <- needs to be upper-case\n\t\tInstanceType: jsii.String(\"t2.micro\"), // <- needs to be upper-case\n\t})\n\treturn this\n}\n```","comments":[{"id":"IC_kwDODd1Amc5jgqkK","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Possible fix: https://github.com/aws/jsii-rosetta/pull/222/files","createdAt":"2023-08-08T12:20:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2824#issuecomment-1669507338","viewerDidAuthor":false}],"createdAt":"2023-04-19T14:51:44Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTg1Mzg1NTQ2","name":"feature/convert","description":"","color":"d93f0b"}],"milestone":null,"number":2824,"title":"Convert: Golang has wrong casing (lower case letters for attributes)","updatedAt":"2023-10-13T15:28:54Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjU3MzUzMQ==","is_bot":false,"login":"mutahhir","name":"Mutahhir Hayat"},"body":"https://github.com/hashicorp/terraform-cdk/pull/2632#discussion_r1115403914","comments":[],"createdAt":"2023-04-19T14:47:31Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTg1Mzg1NTQ2","name":"feature/convert","description":"","color":"d93f0b"}],"milestone":null,"number":2820,"title":"Convert: Type Coercion adds extra cast due to race condition (variables not being pre-populated)","updatedAt":"2023-10-13T15:28:53Z"},{"assignees":[{"id":"MDQ6VXNlcjEzMzcwNDY=","login":"DanielMSchmidt","name":"Daniel Schmidt","databaseId":0}],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Expected Behavior\r\n\r\nconvert should return:\r\n```python\r\naws.s3_bucket.S3Bucket(self, \"bucket\",\r\n    logging=aws.s3_bucket.S3BucketLogging(\r\n        target_bucket=\"target\"\r\n    )\r\n)\r\n```\r\n\r\n### Actual Behavior\r\n\r\nconvert returns no proper access for `S3BucketLogging`\r\n```python\r\naws.s3_bucket.S3Bucket(self, \"bucket\",\r\n    logging=S3BucketLogging(\r\n        target_bucket=\"target\"\r\n    )\r\n)\r\n```\r\n\r\n<!--- What actually happened? --->\r\n\r\n### Steps to Reproduce\r\n\r\nConvert the following snippet to e.g. Python\r\n```tf\r\nresource \"aws_s3_bucket\" \"bucket\" {\r\n  logging {\r\n    target_bucket = \"target\"\r\n  }\r\n}\r\n```\r\n\r\n### Important Factoids\r\n\r\nMore details (e.g. for other languages) can be found in the upstream issue linked below\r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n### References\r\n\r\n* https://github.com/aws/jsii/pull/4056\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n- #0000\r\n","comments":[{"id":"IC_kwDODd1Amc5euOIT","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"This might also be fixable by doing granular imports rather than star imports","createdAt":"2023-06-13T12:07:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2800#issuecomment-1589174803","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5jtVVM","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"Granular imports were implemented, but they don't help in this specific case. \n\nWhen we generate TypeScript, we don't import types as they're implicitly handled. When JSII/Rosetta converts the code to the destination language, it doesn't add import statements to the newly added types. \n\nThere are two ways of doing this. One is to fix this on the JSII side (recommended), and the other is to make the convert code know about this issue and have it add type imports (possibly faster to implement / easier).","createdAt":"2023-08-10T08:56:10Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2800#issuecomment-1672828236","viewerDidAuthor":false}],"createdAt":"2023-04-13T12:25:59Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMTEzNjU3MzA2","name":"language/python","description":"","color":"5c2596"},{"id":"MDU6TGFiZWwyMjQ2NzM3OTc1","name":"upstream/jsii","description":"Pending upstream work on JSII","color":"f9a2cf"},{"id":"MDU6TGFiZWwzMDMwODE1NTQy","name":"language/golang","description":"","color":"22ED90"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM1OTYzMTU0","name":"language/c#","description":"C# language issues","color":"c5def5"},{"id":"MDU6TGFiZWwzMTg1Mzg1NTQ2","name":"feature/convert","description":"","color":"d93f0b"}],"milestone":null,"number":2800,"title":"Convert: Nested named structs are not properly addressed (JSII upstream issue)","updatedAt":"2023-10-13T15:28:53Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nCurrently running `cdktf synth` on an app with no stack will output the following:\r\n```\r\n> cdktf synth\r\n\r\nGenerated Terraform code for the stacks:\r\n```\r\n\r\nWe sould show a different text (including some help for example) if no stacks were found\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5dVRqb","author":{"login":"kination"},"authorAssociation":"CONTRIBUTOR","body":"@ansgarm is just `no stack exists` will be fine?","createdAt":"2023-05-28T04:10:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2793#issuecomment-1565858459","viewerDidAuthor":false}],"createdAt":"2023-04-12T13:11:07Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzky","name":"good first issue","description":"Good for newcomers","color":"7057ff"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"}],"milestone":null,"number":2793,"title":"CLI UX: Nicer output for `cdktf synth` if there are no stacks in an app","updatedAt":"2023-05-28T04:10:12Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nWe disabled running the [java/gradle-shared-module](https://github.com/hashicorp/terraform-cdk/tree/main/examples/java/gradle-shared-module) example as it somehow started to fail in CI while working locally.\r\n\r\nhttps://github.com/hashicorp/terraform-cdk/pull/2757 attempted to fix this, but with no immediate success. Given that we don't use Gradle in our default template, we might as well sunset this example (if no one with Gradle knowledge happens to chime in).\r\n\r\nTo fix the example, we might need to remove the `mvn install` script and replace it with the Gradle way of specifying a local jar for a dependency that is usually fetched from a repository.\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2023-04-03T09:05:04Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyNjMzNjk4NzAy","name":"language/java","description":"","color":"E38858"},{"id":"MDU6TGFiZWwyNzQzNTkyMDA3","name":"examples","description":"","color":"4AB3A0"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"}],"milestone":null,"number":2759,"title":"Re-enable CI for Java Gradle example","updatedAt":"2023-06-02T10:07:48Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjI3MzQ1NA==","is_bot":false,"login":"jantman","name":"Jason Antman"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nUsing Python, there doesn't seem to be a way to introspect the version of cdktf that's being run. It would be very helpful if the cdktf package could expose a ``VERSION`` or ``__version__`` global, so that cdktf projects can ensure they're being executed with a compatible version.\r\n\r\n### References\r\n\r\n* https://packaging.python.org/en/latest/guides/single-sourcing-package-version/\r\n","comments":[],"createdAt":"2023-03-29T13:01:03Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":2746,"title":"cdktf Python - Expose version via Python API","updatedAt":"2023-03-31T07:45:15Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjU1NzE5OTA4","is_bot":false,"login":"rivatove","name":""},"body":"### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n### Description\r\n\r\nAt this moment, it's not possible to use forEach with certain arguments, despite their availability in HCL, e.g.\r\n\r\n- Set of numbers (result of `Fn.range`)\r\n- Nested sets (result of `Fn.chunk`)\r\n\r\nThey are standard library functions and it makes little sense that they can't be used for iteration.\r\n\r\nWorkaround (`Fn.chunk`):\r\n\r\n```\r\nconst chunkList = Fn.chunklist(value, chunkSize)\r\nconst iterator = new ListTerraformIterator(Fn.slice([...Array(100).keys()].map(v => v.toString()), 0, Fn.lengthOf(chunkList)))\r\n...\r\nFn.element(chunkList, iterator.value)\r\n```\r\n","comments":[{"id":"IC_kwDODd1Amc5X0Wi3","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Good point! I think the limitation lies mostly in the type system, a workaround you can use here is `cdktf.Token.asList`:\r\n\r\n```ts\r\nimport { Fn, TerraformIterator, Token } from \"cdktf\";\r\n\r\nconst chunkList = Fn.chunklist(value, chunkSize)\r\nconst iterator = TerraformIterator.fromList(Token.asList(chunkList));\r\n```","createdAt":"2023-03-17T08:05:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2731#issuecomment-1473341623","viewerDidAuthor":false}],"createdAt":"2023-03-16T20:36:46Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"},{"id":"LA_kwDODd1Amc8AAAABBv4DFg","name":"feature/iterators","description":"","color":"2911A8"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":2731,"title":"Allow iterators to handle sets of anything","updatedAt":"2023-06-01T14:31:41Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjcyNTI3MDQ0","is_bot":false,"login":"Maed223","name":"Mark DeCrane"},"body":"### Description\n\nNew cached asset lacks any documentation in the Assets page\n\n### Links\n\nhttps://developer.hashicorp.com/terraform/cdktf/concepts/assets\n\n### Help Wanted\n\n- [ ] I'm interested in contributing a fix myself\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2023-03-09T17:06:11Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":2711,"title":"Assets: Add documentation around TerraformCachedAsset","updatedAt":"2023-03-10T11:03:14Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"### Description\r\n\r\nShifting the problem from e.g. OPA  towards having constructs that inform / warn you about governance issues\r\n\r\n### Links\r\n\r\nNone\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n","comments":[],"createdAt":"2023-03-09T16:47:19Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"LA_kwDODd1Amc7KX5aA","name":"theme/construct-ecosystem","description":"","color":"5E568C"}],"milestone":null,"number":2710,"title":"Guide: How to use custom constructs to solve governance problems while writing configuration","updatedAt":"2023-03-10T11:01:37Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjMyNTUzMzQ=","is_bot":false,"login":"rirze","name":"Sourabh Cheedella"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Affected Resource(s)\r\n\r\nOn line 135 in `cdktf/lib/private/tokens/encoding.ts`:\r\n```ts\r\nif (startMatch && endMatch) {\r\n      if (startMatch.index > startIndex && startMatch.index > startIndex) {  // this conditional is repeated?\r\n        const lede = this.str.substring(\r\n          startIndex,\r\n          Math.min(startMatch.index, endMatch.index)\r\n        );\r\n        fragments.addLiteral(lede);\r\n      }\r\n```\r\nIn the second line, the `if` statement has the same conditional repeated. Is this intentional-- am I missing some crucial TS knowledge?\r\n\r\nIf I had to guess what the second conditional would be, then I would guess `endMatch.index > startIndex`. But I'm not so confident in the logic here to definitively open that PR. \r\n","comments":[{"id":"IC_kwDODd1Amc5XKrwq","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Yeah, that really looks like a typo. Maybe we can do some archeology to see if there was something correct before ğŸ¤” ","createdAt":"2023-03-09T16:58:21Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2709#issuecomment-1462418474","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5XKt0-","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Or someone wanted to be _really_ sure ğŸ˜‚","createdAt":"2023-03-09T17:03:30Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"LAUGH","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2709#issuecomment-1462426942","viewerDidAuthor":false}],"createdAt":"2023-03-09T16:44:20Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzky","name":"good first issue","description":"Good for newcomers","color":"7057ff"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"},{"id":"MDU6TGFiZWwzMjM2NDcwNTQ1","name":"feature/tokens","description":"","color":"58CF13"}],"milestone":null,"number":2709,"title":"Typo in Tokenizer code?","updatedAt":"2023-06-02T14:18:33Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nTerraform 1.4 added a new property that can be set on `exec-local`, we should add that one to the properties in our interface for `local-exec`.\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n* https://github.com/hashicorp/terraform/pull/32116\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5XHfTH","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"In the meantime this property can be set using an [override](https://developer.hashicorp.com/terraform/cdktf/concepts/resources#escape-hatch).","createdAt":"2023-03-09T08:46:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2702#issuecomment-1461580999","viewerDidAuthor":false}],"createdAt":"2023-03-09T08:36:32Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzky","name":"good first issue","description":"Good for newcomers","color":"7057ff"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2MjkzOTA4","name":"core-parity","description":"Better experience in Terraform Core than CDKTF","color":"1A80B6"}],"milestone":null,"number":2702,"title":"Support `local-exec` `quiet` attribute","updatedAt":"2023-06-01T17:48:48Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nWhen using `cdktf convert` to translate HCL to CDKTF languages, the order of the properties is sorted alphabetically.\r\nHowever, this order might have a reason, especially in the case of documentation examples. In the example given below the `name` of the table is moved below the attributes whereas the more natural place to put it, would be at the top of the resource.\r\n\r\nThis is only stylistic and does not change the behavior, but from my experience most Terraform config tends to put \"global\" properties such as \"name\" in this example at the top.\r\n\r\n### Example\r\n\r\n<details>\r\n<summary>\r\nGiven the following HCL example\r\n</summary>\r\n\r\n```hcl\r\nresource \"aws_dynamodb_table\" \"basic-dynamodb-table\" {\r\n  name           = \"GameScores\"\r\n  billing_mode   = \"PROVISIONED\"\r\n  read_capacity  = 20\r\n  write_capacity = 20\r\n  hash_key       = \"UserId\"\r\n  range_key      = \"GameTitle\"\r\n\r\n  attribute {\r\n    name = \"UserId\"\r\n    type = \"S\"\r\n  }\r\n\r\n  attribute {\r\n    name = \"GameTitle\"\r\n    type = \"S\"\r\n  }\r\n\r\n  attribute {\r\n    name = \"TopScore\"\r\n    type = \"N\"\r\n  }\r\n\r\n  ttl {\r\n    attribute_name = \"TimeToExist\"\r\n    enabled        = false\r\n  }\r\n\r\n  global_secondary_index {\r\n    name               = \"GameTitleIndex\"\r\n    hash_key           = \"GameTitle\"\r\n    range_key          = \"TopScore\"\r\n    write_capacity     = 10\r\n    read_capacity      = 10\r\n    projection_type    = \"INCLUDE\"\r\n    non_key_attributes = [\"UserId\"]\r\n  }\r\n\r\n  tags = {\r\n    Name        = \"dynamodb-table-1\"\r\n    Environment = \"production\"\r\n  }\r\n}\r\n```\r\n\r\n</details>\r\n\r\n`cdktf convert --language typescript --provider 'hashicorp/aws@~>4.53.0'` returns:\r\n\r\n```ts\r\n/*Provider bindings are generated by running cdktf get.\r\nSee https://cdk.tf/provider-generation for more details.*/\r\nimport * as aws from \"./.gen/providers/aws\";\r\nnew aws.dynamodbTable.DynamodbTable(this, \"basic-dynamodb-table\", {\r\n  attribute: [\r\n    {\r\n      name: \"UserId\",\r\n      type: \"S\",\r\n    },\r\n    {\r\n      name: \"GameTitle\",\r\n      type: \"S\",\r\n    },\r\n    {\r\n      name: \"TopScore\",\r\n      type: \"N\",\r\n    },\r\n  ],\r\n  billingMode: \"PROVISIONED\",\r\n  globalSecondaryIndex: [\r\n    {\r\n      hashKey: \"GameTitle\",\r\n      name: \"GameTitleIndex\",\r\n      nonKeyAttributes: [\"UserId\"],\r\n      projectionType: \"INCLUDE\",\r\n      rangeKey: \"TopScore\",\r\n      readCapacity: 10,\r\n      writeCapacity: 10,\r\n    },\r\n  ],\r\n  hashKey: \"UserId\",\r\n  name: \"GameScores\",\r\n  rangeKey: \"GameTitle\",\r\n  readCapacity: 20,\r\n  tags: {\r\n    Environment: \"production\",\r\n    Name: \"dynamodb-table-1\",\r\n  },\r\n  ttl: {\r\n    attributeName: \"TimeToExist\",\r\n    enabled: false,\r\n  },\r\n  writeCapacity: 20,\r\n});\r\n```\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2023-03-03T11:25:55Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMTg1Mzg1NTQ2","name":"feature/convert","description":"","color":"d93f0b"}],"milestone":null,"number":2688,"title":"Convert: Keep sort order of attributes in input HCL","updatedAt":"2023-07-13T15:43:53Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjI3MzQ1NA==","is_bot":false,"login":"jantman","name":"Jason Antman"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\ncdktf-cli 0.15.5\r\nPython 3.10.9 / cdktf 0.15.5 \r\n\r\n### Affected Resource(s)\r\n\r\nGrafana provider\r\n\r\n### Expected Behavior\r\n\r\nDictionary key arguments would be passed to provider configuration as specified.\r\n\r\n### Actual Behavior\r\n\r\nDictionary key arguments are lower-cased and have dashes converted to underscores, breaking them.\r\n\r\n### Steps to Reproduce\r\n\r\n1. Install cdktf latest version (0.15.5), generate bindings for `grafana/grafana@~> 1.35` provider.\r\n2. Configure the provider with the `http_headers` argument, such as:\r\n\r\n```\r\nGrafanaProvider(\r\n    self, 'grafana', org_id=1, http_headers={'X-Disable-Provenance': 'disabled'}\r\n)\r\n```\r\n\r\n3. The resulting synth'ed JSON has a header of `x_disable_provenance` instead of `X-Disable-Provenance`, which doesn't work with the underlying application.\r\n\r\n```\r\n  \"provider\": {\r\n    \"grafana\": [\r\n      {\r\n        \"http_headers\": {\r\n          \"x_disable_provenance\": \"disabled\"\r\n        },\r\n        \"insecure_skip_verify\": true,\r\n        \"org_id\": 1,\r\n        \"url\": \"http://nuc1:3000/\"\r\n      }\r\n    ]\r\n  },\r\n```\r\n\r\n### Important Factoids\r\n\r\nThis can currently be worked around with the `add_override` escape hatch.\r\n\r\n### References\r\n\r\nIt looks to me like this is related to #235 and #646 but I don't understand enough about the internals to really understand what's going on or why it works this way.","comments":[{"id":"IC_kwDODd1Amc6FTIIE","author":{"login":"farnoy"},"authorAssociation":"NONE","body":"Just hit this using Typescript\r\n```\r\ncdktf debug\r\nlanguage: typescript\r\ncdktf-cli: 0.20.7\r\nnode: v22.3.0\r\ncdktf: 0.20.8\r\nconstructs: 10.3.0\r\njsii: null\r\nterraform: 1.9.2\r\narch: x64\r\nos: linux 6.9.3\r\n```","createdAt":"2024-07-18T12:34:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2681#issuecomment-2236383748","viewerDidAuthor":false}],"createdAt":"2023-02-24T22:32:50Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMTEzNjU3MzA2","name":"language/python","description":"","color":"5c2596"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":2681,"title":"Python - provider argument dict keys changed to lower-case with underscores","updatedAt":"2024-07-18T12:34:21Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjMzNTQxNTA3","is_bot":false,"login":"AtomAsking","name":""},"body":"> Don't worry, it's a small problem\r\n\r\n## 1. The key name of the dict type cannot be consistent with the property name of the class\r\n\r\n### My Environment:\r\n- Python: 3.9\r\n- cdktf-cdktf-provider-azurerm: 5.0.5\r\n- cdktf: 0.15.5\r\n\r\n### anti-human design:\r\nThe NetworkInterfaceIpConfiguration source code shows that there is a property named private_ip_address_allocation, which is the same as the name queried in the official Terraform manual, which is fine.\r\n\r\nFrom the source code, we can see that:\r\nprivate_ip_address_allocation  type hints:  `typing.Sequence[typing.Union[\"NetworkInterfaceIpConfiguration\", typing.Dict[builtins.str, typing.Any]]]`\r\n\r\n```python\r\nip_configuration=[{\r\n                'name': 'test01-ip-configuration',\r\n                \"privateIpAddressAllocation\": \"Dynamic\", \r\n                'subnet_id': subnet.id,\r\n                'public_ip_address_id': public_ip_address.id\r\n            }]\r\n```\r\n\r\n```python\r\nip_configuration=[NetworkInterfaceIpConfiguration(\r\n                name='test01-ip-configuration',\r\n                private_ip_address_allocation=\"Dynamic\",\r\n                subnet_id=subnet.id,\r\n                public_ip_address_id=public_ip_address.id\r\n            )],\r\n```\r\nThe above two pieces of Python code both pass the test. You will find that in the code snippet with the structure `List(Dict)`, the property is named `privateIpAddressAllocation`, while in the code snippet with the structure `List(NetworkInterfaceIpConfiguration)`, the property is named `private_ip_address_allocation`. By reading the official Terraform manual, we know that this naming rule is the most reasonable and is consistent with the official one.\r\n\r\nI think this is an oversight because I tried declaring the `security_rule` attribute of the `NetworkSecurityGroup` class again and found that it did not have the above problem and passed the test successfully.\r\n\r\nFinally hopefully a fix can be made in a new version as this will bother some developers and I believe it's a good habit to stay consistent with the official Terraform documentation.\r\n\r\nFinally, let's take a look at how this is declared in the official Terraform documentation:\r\nhttps://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/network_interface#private_ip_address_allocation\r\n\r\n\r\n\r\n\r\n## 2. Report an anti-human design\r\nThe `ip_configuration` property of the `NetworkInterface` class is a Sequence for all to see, and the declaration of type hints shows that it supports two ways of writing, i.e. using the `Dict` type and the declaration of the `NetworkInterfaceIpConfiguration` class.\r\n\r\nSee some of the core code examples below:\r\n```python\r\n\"\"\"\r\nThis is the code I tested and it works fine.\r\n\"\"\"\r\nvirtual_network = VirtualNetwork(\r\n            self,\r\n            'my-virtual-network',\r\n            name='test01-virtual-network',\r\n            location=resource_group.location,\r\n            resource_group_name=resource_group.name,\r\n            address_space=['10.0.0.0/16'],\r\n            subnet=[\r\n                VirtualNetworkSubnet(\r\n                    name='test01-subnet',\r\n                    address_prefix='10.0.0.0/24',\r\n                    security_group=network_security_group.id\r\n                )\r\n            ]\r\n        )\r\n\r\nnetwork_interface = NetworkInterface(\r\n            self,\r\n            'my-network-interface',\r\n            name='test01-network-interface',\r\n            ip_configuration=[\r\n                # Note the following line, which uses the `NetworkInterfaceIpConfiguration` class to initialize\r\n                NetworkInterfaceIpConfiguration(\r\n                    name='test01-ip-configuration',\r\n                    private_ip_address_allocation=\"Dynamic\", \r\n                    subnet_id=virtual_network.subnet.get(0).id,\r\n                    public_ip_address_id=public_ip_address.id\r\n                )\r\n            ],\r\n            location=resource_group.location,\r\n            resource_group_name=resource_group.name\r\n        )\r\n```\r\n\r\n```python\r\n\"\"\"\r\nAccording to the type hints restriction of the source code is possible to use Dict type for initialization, but the code here will report an error, which is also tested by me.\r\n\"\"\"\r\nvirtual_network = VirtualNetwork(\r\n            self,\r\n            'my-virtual-network',\r\n            name='test01-virtual-network',\r\n            location=resource_group.location,\r\n            resource_group_name=resource_group.name,\r\n            address_space=['10.0.0.0/16'],\r\n            subnet=[\r\n                VirtualNetworkSubnet(\r\n                    name='test01-subnet',\r\n                    address_prefix='10.0.0.0/24',\r\n                    security_group=network_security_group.id\r\n                )\r\n            ]\r\n        )\r\n\r\nnetwork_interface = NetworkInterface(\r\n            self,\r\n            'my-network-interface',\r\n            name='test01-network-interface',\r\n            ip_configuration=[\r\n                # Note that the following Dict structure will throw an error.\r\n                {\r\n                    'name': 'test01-ip-configuration',\r\n                    'privateIpAddressAllocation': \"Dynamic\",\r\n                    'subnet_id': virtual_network.subnet.get(0).id,\r\n                    'public_ip_address_id': public_ip_address.id\r\n                }\r\n            ],\r\n            location=resource_group.location,\r\n            resource_group_name=resource_group.name\r\n        )\r\n```\r\n\r\n### The error message is as follows.\r\n```bash\r\nmy-stack  â•·\r\n          â”‚ Error: expanding `ip_configuration`: A Subnet ID must be specified for an IPv4 Network Interface.\r\n          â”‚ \r\n          â”‚   with azurerm_network_interface.my-network-interface (my-network-interface),\r\n          â”‚   on cdk.tf.json line 58, in resource.azurerm_network_interface.my-network-interface (my-network-interface):\r\n          â”‚   58:       }\r\n\r\n```\r\n\r\nI think both issues are caused by the same unknown problem (i.e., there is an unknown problem with the support for `Dict` types), so they are put together and hopefully solved.","comments":[{"id":"IC_kwDODd1Amc5hrxCN","author":{"login":"Jreamz"},"authorAssociation":"NONE","body":"Ran into this issue today as well, friendly bump\r\n\r\n```\r\ncdktf --version\r\n0.17.0\r\n```","createdAt":"2023-07-17T20:50:49Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2669#issuecomment-1638862989","viewerDidAuthor":false}],"createdAt":"2023-02-22T08:58:58Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMTEzNjU3MzA2","name":"language/python","description":"","color":"5c2596"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM1OTY5MTg4","name":"provider/azure","description":"Issue shows up using Azure provider","color":"bfd4f2"},{"id":"MDU6TGFiZWwzMTM2MjAxMTE5","name":"provider get / generation","description":"","color":"CC3938"}],"milestone":null,"number":2669,"title":"`azurerm` provider: Naming inconsistency with the `private_ip_address_allocation` property of the `NetworkInterfaceIpConfiguration` Class","updatedAt":"2023-07-17T20:51:35Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMTU0MTY2","is_bot":false,"login":"sabinayakc","name":"Sabinaya KC"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\nlanguage: typescript\r\ncdktf-cli: 0.15.4\r\nnode: v16.17.0\r\ncdktf: 0.15.4\r\nconstructs: 10.1.162\r\njsii: null\r\nterraform: 1.3.7\r\narch: x64\r\nos: linux 5.10.102.1-microsoft-standard-WSL2\r\n\r\n### Affected Resource(s)\r\n\r\n`cdktf plan`\r\n`cdtkf apply`\r\n\r\n### Expected Behavior\r\nShould be able to use module outputs from one stack to another. \r\n\r\n### Actual Behavior\r\n\r\nPlan errors out with the following error,\r\n```\r\nâ”‚ Error: Unsupported attribute\r\n                       â”‚ \r\n                       â”‚   on cdk.tf.json line 51, in provider.helm[0].kubernetes:\r\n                       â”‚   51:           \"cluster_ca_certificate\": \"${base64decode(data.terraform_remote_state.cross-stack-reference-input-test-service.outputs.cross-stack-output-moduletest-service-clustercluster_certificate_authority_data)}\",\r\n                       â”‚     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\r\n                       â”‚     â”‚ data.terraform_remote_state.cross-stack-reference-input-test-service.outputs is object with 3 attributes\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n```\r\n  const eksStack = new EKSStack(app, \"test-service\");\r\n  new CloudBackend(eksStack, {\r\n    hostname: \"app.terraform.io\",\r\n    organization: \"XXXX\",\r\n    workspaces: new NamedCloudWorkspace(\"test-service\"),\r\n  });\r\n\r\n  const toolsStack = new MyToolsStack(app, \"test-tools\", {\r\n    eks: eksStack.eks,\r\n  });\r\n  \r\n  new CloudBackend(toolsStack, {\r\n    hostname: \"app.terraform.io\",\r\n    organization: \"XXX\",\r\n    workspaces: new NamedCloudWorkspace(\"my-tools\"),\r\n  });\r\n```\r\n\r\nIn my EKSStack, I have used the `terraform-eks-module`\r\n```\r\nexport class EKSStack extends TerraformStack {\r\n  public eks: EksModule;   \r\n```\r\nAnd in my tools stack,\r\n```\r\n    const data = new DataAwsEksClusterAuth(\r\n      this,\r\n      `cluster-auth`,\r\n      {\r\n        name:  eks.clusterNameOutput,\r\n      }\r\n    );\r\n```\r\n\r\n\r\n### Important Factoids\r\n\r\n- I am using the `terraform-eks-module` to create EKS\r\n- EKS is created \r\n- But when I want to reuse the EKS outputs in a different stack I can't.\r\n\r\nDo I need to add outputs for each attribute I want to export to the other stack?","comments":[{"id":"IC_kwDODd1Amc5VgfST","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Cross stack references auto-add the outputs needed to the source stack (the one creating the EKS cluster in this case). It seems like this is happening, I'm not sure why this error happens, the remote state reference looks okay. Could you show us the generated output in the `cdk.tf.json` file of your EKs cluster stack?","createdAt":"2023-02-17T12:34:41Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2662#issuecomment-1434580115","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Vjx35","author":{"login":"sabinayakc"},"authorAssociation":"CONTRIBUTOR","body":"@DanielMSchmidt Here it is. I have redacted some stuff.\r\n\r\n```\r\n{\r\n  \"//\": {\r\n    \"metadata\": {\r\n      \"backend\": \"cloud\",\r\n      \"cloud\": \"tfc\",\r\n      \"stackName\": \"test-shared-service\",\r\n      \"version\": \"0.15.3\"\r\n    },\r\n    \"outputs\": {\r\n      \"test-shared-service\": {\r\n        \"test-shared-service-cluster-arn\": \"test-shared-service-cluster-arn\",\r\n        \"test-shared-service-cluster-endpoint\": \"test-shared-service-cluster-endpoint\",\r\n        \"test-shared-service-cluster-oidc\": \"test-shared-service-cluster-oidc\"\r\n      }\r\n    }\r\n  },\r\n  \"module\": {\r\n    \"test-shared-service-alb-irsa\": {\r\n      \"//\": {\r\n        \"metadata\": {\r\n          \"path\": \"test-shared-service/test-shared-service-alb-irsa\",\r\n          \"uniqueId\": \"test-shared-service-alb-irsa\"\r\n        }\r\n      },\r\n      \"attach_load_balancer_controller_policy\": true,\r\n      \"oidc_providers\": {\r\n        \"main\": {\r\n          \"namespace_service_accounts\": [\r\n            \"kube-system:alb-sa\"\r\n          ],\r\n          \"provider_arn\": \"${module.test-shared-service-cluster.oidc_provider_arn}\"\r\n        }\r\n      },\r\n      \"role_name\": \"test-shared-service-alb-role\",\r\n      \"source\": \"terraform-aws-modules/iam/aws//modules/iam-role-for-service-accounts-eks\"\r\n    },\r\n    \"test-shared-service-autoscaler-irsa\": {\r\n      \"//\": {\r\n        \"metadata\": {\r\n          \"path\": \"test-shared-service/test-shared-service-autoscaler-irsa\",\r\n          \"uniqueId\": \"test-shared-service-autoscaler-irsa\"\r\n        }\r\n      },\r\n      \"attach_cluster_autoscaler_policy\": true,\r\n      \"cluster_autoscaler_cluster_ids\": [\r\n        \"${module.test-shared-service-cluster.cluster_name}\"\r\n      ],\r\n      \"oidc_providers\": {\r\n        \"main\": {\r\n          \"namespace_service_accounts\": [\r\n            \"kube-system:${local.auto-scaler-name}-sa\"\r\n          ],\r\n          \"provider_arn\": \"${module.test-shared-service-cluster.oidc_provider_arn}\"\r\n        }\r\n      },\r\n      \"role_name\": \"test-shared-service-autoscaler-role\",\r\n      \"source\": \"terraform-aws-modules/iam/aws//modules/iam-role-for-service-accounts-eks\"\r\n    },\r\n    \"test-shared-service-cluster\": {\r\n      \"//\": {\r\n        \"metadata\": {\r\n          \"path\": \"test-shared-service/test-shared-service-cluster\",\r\n          \"uniqueId\": \"test-shared-service-cluster\"\r\n        }\r\n      },\r\n      \"aws_auth_roles\": [\r\n        {\r\n          \"groups\": [\r\n            \"system:masters\"\r\n          ],\r\n          \"rolearn\": \"arn:aws:iam::732461071035:role/InfrastructureAccountAccessRole\",\r\n          \"username\": \"NonProdRole\"\r\n        }\r\n      ],\r\n      \"cluster_addons\": {\r\n        \"aws-ebs-csi-driver\": {\r\n          \"most_recent\": true\r\n        },\r\n        \"coredns\": {\r\n          \"most_recent\": true\r\n        },\r\n        \"kube-proxy\": {\r\n          \"most_recent\": true\r\n        }\r\n      },\r\n      \"cluster_endpoint_public_access\": true,\r\n      \"cluster_ip_family\": \"ipv4\",\r\n      \"cluster_name\": \"test-shared-service-cluster\",\r\n      \"cluster_version\": \"1.24\",\r\n      \"control_plane_subnet_ids\": \"${local.control-plane-subnets}\",\r\n      \"create_cloudwatch_log_group\": false,\r\n      \"eks_managed_node_group_defaults\": {\r\n        \"iam_role_additional_policies\": {\r\n          \"AmazonEBSCSIDriverPolicy\": \"arn:aws:iam::aws:policy/service-role/AmazonEBSCSIDriverPolicy\"\r\n        }\r\n      },\r\n      \"eks_managed_node_groups\": \"${var.node-group-config}\",\r\n      \"iam_role_name\": \"test-shared-service\",\r\n      \"source\": \"terraform-aws-modules/eks/aws\",\r\n      \"subnet_ids\": \"${local.eks-subnets}\",\r\n      \"version\": \"19.7.0\",\r\n      \"vpc_id\": \"${data.terraform_remote_state.test-core-shared-state.outputs.test-shared-vpc-id}\"\r\n    }\r\n  },\r\n  \"output\": {\r\n    \"test-shared-service-cluster-arn\": {\r\n      \"value\": \"${module.test-shared-service-cluster.cluster_arn}\"\r\n    },\r\n    \"test-shared-service-cluster-endpoint\": {\r\n      \"value\": \"${module.test-shared-service-cluster.cluster_endpoint}\"\r\n    },\r\n    \"test-shared-service-cluster-oidc\": {\r\n      \"value\": \"${module.test-shared-service-cluster.oidc_provider}\"\r\n    }\r\n  },\r\n  \"provider\": {\r\n    \"aws\": [\r\n      {\r\n        \"assume_role\": [\r\n          {\r\n            \"role_arn\": \"arn:aws:iam::XXXXXX\"\r\n          }\r\n        ],\r\n        \"region\": \"us-east-2\"\r\n      },\r\n      {\r\n        \"alias\": \"infra\",\r\n        \"region\": \"us-east-2\"\r\n      }\r\n    ],\r\n    \"external\": [\r\n      {\r\n      }\r\n    ]\r\n  },\r\n  \"terraform\": {\r\n    \"cloud\": {\r\n      \"hostname\": \"app.terraform.io\",\r\n      \"organization\": \"test\",\r\n      \"workspaces\": {\r\n        \"name\": \"test-shared-service\"\r\n      }\r\n    },\r\n    \"required_providers\": {\r\n      \"aws\": {\r\n        \"source\": \"aws\",\r\n        \"version\": \"4.52.0\"\r\n      },\r\n      \"external\": {\r\n        \"source\": \"external\",\r\n        \"version\": \"2.2.3\"\r\n      },\r\n      \"helm\": {\r\n        \"source\": \"helm\",\r\n        \"version\": \"2.8.0\"\r\n      },\r\n      \"kubectl\": {\r\n        \"source\": \"gavinbunney/kubectl\",\r\n        \"version\": \"1.14.0\"\r\n      }\r\n    }\r\n  },\r\n  \"variable\": {\r\n    \"node-group-config\": {\r\n      \"default\": {\r\n        \"service_ng_1\": {\r\n          \"desired_size\": 1,\r\n          \"instance_types\": [\r\n            \"t3.xlarge\"\r\n          ],\r\n          \"max_size\": 10,\r\n          \"min_size\": 1,\r\n          \"node_group_name\": \"service-ng-1\"\r\n        }\r\n      },\r\n      \"nullable\": false,\r\n      \"type\": \"map(object({instance_types=list(string), node_group_name=string, min_size=number, desired_size=number, max_size=number}))\"\r\n    }\r\n  }\r\n}\r\n```","createdAt":"2023-02-18T01:33:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2662#issuecomment-1435442681","viewerDidAuthor":false}],"createdAt":"2023-02-17T00:22:56Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzMxMzA4","name":"confirmed","description":"independently reproduced by an engineer on the team","color":"4B830E"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTQ2NjcxNDUz","name":"feature/multi-stack","description":"","color":"6589C9"}],"milestone":null,"number":2662,"title":"Cross Stack Reference Not Working with Modules","updatedAt":"2023-06-01T17:46:54Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUwMDg5ODc=","is_bot":false,"login":"Chriscbr","name":"Chris Rybicki"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\nnode: 18.12.1\r\nnpm library \"@cdktf/provider-aws\": 12.0.1\r\nnpm library \"cdktf\": 0.15.2\r\n\r\n### Affected Resource(s)\r\n\r\n<!--- Please list the affected resources. --->\r\n\r\n### Debug Output\r\n\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\n\r\n### Expected Behavior\r\n\r\nIn other CDK frameworks like AWS CDK, I've noticed that trying to access a property that has a late-bound value will return the same token twice. For example:\r\n\r\n```\r\nimport * as s3 from \"aws-cdk-lib/aws-s3\";\r\n\r\nconst bucket = new s3.Bucket(this, \"CdkTestBucket\");\r\nconsole.log(bucket.bucketArn);\r\nconsole.log(bucket.bucketArn);\r\n```\r\n\r\nproduces:\r\n\r\n```\r\n${Token[TOKEN.237]}\r\n${Token[TOKEN.237]}\r\n```\r\n\r\nBut I've noticed in CDKTF, doing something similar usually gets me a different token each time:\r\n\r\n```\r\nimport { S3Bucket } from \"@cdktf/provider-aws/lib/s3-bucket\";\r\nconst bucket = new S3Bucket(this, \"CdkTestBucket\");\r\nconsole.log(bucket.bucket);\r\nconsole.log(bucket.bucket);\r\n```\r\n\r\nproduces:\r\n\r\n```\r\n${TfToken[TOKEN.0]}\r\n${TfToken[TOKEN.1]}\r\n```\r\n\r\nI'm wondering if there is a technical reason for this, as sometimes it can be useful to tell if two tokens are the same (even if they aren't resolved yet).\r\n\r\n<!--- What should have happened? --->\r\n\r\n### Actual Behavior\r\n\r\n<!--- What actually happened? --->\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Please list the steps required to reproduce the issue. --->\r\n\r\n### Important Factoids\r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n- #0000\r\n","comments":[{"id":"IC_kwDODd1Amc5VgH3B","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @Chriscbr ğŸ‘‹\r\n\r\nthe only difference I could spot between CDKTF and AWS CDK constructs was that our properties sometimes have a different value for setting vs. getting it â€“ and as getters and setters must adhere to the same type, we use a `putXy` method instead of a setter. I couldn't find such a case for AWS CDK (Cfn) constructs\r\nHere's an example of such a case in CDKTF: [`cdktf-provider-aws/src/s3-bucket/index.ts`](https://github.com/cdktf/cdktf-provider-aws/blob/14f8811f48854f04388645e308ec2fa259f71a20/src/s3-bucket/index.ts#L1182-L1196)\r\nInterestingly enough, the instance that is returned there, is cached in `_expiration` ğŸ˜„ but apparently that is [not the case for tokens we return](https://github.com/cdktf/cdktf-provider-aws/blob/14f8811f48854f04388645e308ec2fa259f71a20/src/s3-bucket/index.ts#L2763-L2777) (Line 2766).\r\n\r\nWhile we already store the input value, we don't do so for the token â€“ but I'd be open to caching the token we'll return as well (e.g. in `private _expirationReference` or similar).\r\nWe'd need to check whether this introduces problems, but I don't expect there to be any (besides maybe some performance implications; but we could also lazy-load them in that case).\r\n\r\nHowever, one potential thing blocking this, could be how we resolve cross stack references, although it seems that creating a `Reference` will only [lookup the source stack](https://github.com/hashicorp/terraform-cdk/blob/2e574c754b9da73858ff6196c4428c6632107c65/packages/cdktf/lib/terraform-resource.ts#L238-L243) of the construct that is going to be referenced which would be the same each time the reference is accessed.\r\n\r\nI vaguely remember that we used to have a bug where storing a reference in a variable and using it in two difference stacks caused cross stack references to fail, but I think that one was fixed and the [`Reference#resolve` method](https://github.com/hashicorp/terraform-cdk/blob/2e574c754b9da73858ff6196c4428c6632107c65/packages/cdktf/lib/tfExpression.ts#L147) does not look like its having a side-effect anymore that might cause this. Maybe @DanielMSchmidt remembers more about this.\r\n\r\nSo tl;dr would be: We currently don't return the same Token but we probably could start doing that ğŸ˜„","createdAt":"2023-02-17T11:06:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2658#issuecomment-1434484161","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5VhWMC","author":{"login":"Chriscbr"},"authorAssociation":"NONE","body":"Cool, thanks for the prompt answer @ansgarm ğŸ˜„ I don't think this issue is a blocker for my use case (in the end comparing token identities is probably not the safest thing to do in the first place), but it's handy to learn a bit more about how tokens work!","createdAt":"2023-02-17T15:27:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2658#issuecomment-1434804994","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5VjfnU","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> I vaguely remember that we used to have a bug where storing a reference in a variable and using it in two difference stacks caused cross stack references to fail, but I think that one was fixed and the [`Reference#resolve` method](https://github.com/hashicorp/terraform-cdk/blob/2e574c754b9da73858ff6196c4428c6632107c65/packages/cdktf/lib/tfExpression.ts#L147) does not look like its having a side-effect anymore that might cause this. Maybe @DanielMSchmidt remembers more about this\r\n\r\nI definitely recall noticing the different tokens when debugging an issue with cross stack references. I think at the time I experimented with making them the same and ran into some issues. Definitely possible that those have been fixed now though.","createdAt":"2023-02-17T22:50:40Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2658#issuecomment-1435367892","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc55vrHj","author":{"login":"danielenricocahall"},"authorAssociation":"NONE","body":"Following up on the thread here, the same behavior is observed in 0.20.5.","createdAt":"2024-04-08T11:48:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2658#issuecomment-2042540515","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6GzkxF","author":{"login":"Chriscbr"},"authorAssociation":"NONE","body":"What would be the best solutions for this implementation-wise? Would it be to store a cached token directly on the class (with a private field, inside the provider-generated files)? Or are there any other ways to go about this, like maybe caching the results of `this.interpolationForAttribute(x)` (can we safely assume this is a pure function)? Maybe that would avoid the need to update any code generators. TBH I'm not as familiar with the token system / how cross-stack references plays into this.","createdAt":"2024-07-31T23:43:41Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2658#issuecomment-2261666885","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6K54_1","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"There's already internal caching of token instances at the lowest level: https://github.com/hashicorp/terraform-cdk/blob/050ce8423b8e025857fe1a3fa2a1ceeebc3a6f2a/packages/cdktf/lib/tokens/private/token-map.ts#L231\r\n\r\nThe problem is that what's passed in is quite often a new object for every get call.\r\n\r\nCaching the result of `interpolationForAttribute` certainly seems like a simple solution that has the potential to work. I'm not sure if this even works correctly now, but since the function does check mutable state, it is currently possible to return different results at different points in time.\r\n\r\nMy memory's definitely a bit fuzzy, but I believe previous issues with caching and cross-stack references were the result of losing information after the token is resolved the first time. I'm pretty sure there are tests in place that would catch a regression though.","createdAt":"2024-09-05T01:36:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2658#issuecomment-2330431477","viewerDidAuthor":false}],"createdAt":"2023-02-15T19:31:13Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMTM2MjAxMTE5","name":"provider get / generation","description":"","color":"CC3938"},{"id":"MDU6TGFiZWwzMjM2NDcwNTQ1","name":"feature/tokens","description":"","color":"58CF13"}],"milestone":null,"number":2658,"title":"New token is generated each time a property is accessed","updatedAt":"2024-09-05T01:36:27Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjU3MzUzMQ==","is_bot":false,"login":"mutahhir","name":"Mutahhir Hayat"},"body":"Currently if we install a pre-built provider to a C# project, we get the following line inserted into the project file:\n\n```xml\n<PackageReference Include=\"HashiCorp.Cdktf.Providers.Random\" Version=\"3.0.11\" />\n```\n\nHowever, the same does not happen when installing a locally built provider. It is left for the developer to update. The update would look something like:\n\n```xml\n  <ItemGroup>\n    <ProjectReference Include=\".gen/aws/aws.csproj\" />\n  </ItemGroup>\n```\n\n","comments":[],"createdAt":"2023-02-14T10:38:33Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjQ2NzM1NDk1","name":"providers","description":"","color":"2bd8cd"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"}],"milestone":null,"number":2648,"title":"Installing local providers should update `.csproj` file as pre-built providers do","updatedAt":"2023-03-09T11:46:13Z"},{"assignees":[{"id":"MDQ6VXNlcjEzMzcwNDY=","login":"DanielMSchmidt","name":"Daniel Schmidt","databaseId":0}],"author":{"id":"MDQ6VXNlcjU3MzUzMQ==","is_bot":false,"login":"mutahhir","name":"Mutahhir Hayat"},"body":"\n```py\n        aws_rds_cluster_changeme_aws_aurora_cluster_instance =\n        aws.rds_cluster.RdsCluster(self, \"changeme_aws_aurora_cluster_instance\",\n            master_password=changeme_aws_aurora_cluster_password.value,\n            master_username=changeme_aws_aurora_cluster_username.value,\n            skip_final_snapshot=True\n        )\n```\n\n### Error\n\n```\nCommand output on stderr:\n\n    Traceback (most recent call last):\n      File \"/Users/mutahhir/src/scratchpad/terraform-convert-examples/converted-langs/python/aws/main.py\", line 6, in <module>\n        from aws_db_instance.restore_db_from_snapshot.main import MyStack as aws_db_instance_restore_db_from_snapshot\n      File \"/Users/mutahhir/src/scratchpad/terraform-convert-examples/converted-langs/python/aws/aws_db_instance/restore_db_from_snapshot/main.py\", line 43\n        data_aws_db_snapshot_changeme_latest_prod_snapshot =\n                                                            ^\n    SyntaxError: invalid syntax\n```","comments":[{"id":"IC_kwDODd1Amc5VUDL7","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"JSII Issue: https://github.com/aws/jsii/issues/3968","createdAt":"2023-02-15T12:50:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2641#issuecomment-1431319291","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5XDPSp","author":{"login":"rirze"},"authorAssociation":"CONTRIBUTOR","body":"This is invalid Python syntax? The proper way to achieve this in python is\r\n```python3\r\n        aws_rds_cluster_changeme_aws_aurora_cluster_instance = \\\r\n\t        aws.rds_cluster.RdsCluster(self, \"changeme_aws_aurora_cluster_instance\",\r\n\t            master_password=changeme_aws_aurora_cluster_password.value,\r\n\t            master_username=changeme_aws_aurora_cluster_username.value,\r\n\t            skip_final_snapshot=True\r\n\t        )\r\n```","createdAt":"2023-03-08T16:34:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2641#issuecomment-1460466857","viewerDidAuthor":false}],"createdAt":"2023-02-14T08:57:35Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMTEzNjU3MzA2","name":"language/python","description":"","color":"5c2596"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTg1Mzg1NTQ2","name":"feature/convert","description":"","color":"d93f0b"}],"milestone":null,"number":2641,"title":"Convert breaking long lines into multiple causes compilation issues in python","updatedAt":"2023-10-13T15:28:53Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjU3MzUzMQ==","is_bot":false,"login":"mutahhir","name":"Mutahhir Hayat"},"body":"The following is valid HCL (barring requried arguments etc), but invalid Typescript when synthesized. We should be able to read the `required_providers` section and generate any missing providers.\n\n### Source\n\n```hcl\n# Summary: A simple Azure Active Directory Group\n\n# Documentation: https://www.terraform.io/docs/language/settings/index.html\nterraform {\n  required_version = \">= 1.0.0\"\n  required_providers {\n    azuread = {\n      source  = \"hashicorp/azuread\"\n      version = \"=2.33.0\"\n    }\n  }\n}\n\n# Azure AD Group\n# Documentation: https://registry.terraform.io/providers/hashicorp/azuread/latest/docs/resources/service_principal\nresource \"azuread_group\" \"changeme_simple_group\" {\n  display_name = \"changeme-simple-group-name\"\n}\n```\n\n### Generated\n\n```ts\nimport { Construct } from \"constructs\";\nimport { TerraformStack } from \"cdktf\";\n/*Provider bindings are generated by running cdktf get.\nSee https://cdk.tf/provider-generation for more details.*/\nimport * as azuread from \"../../.gen/providers/azuread\";\n\nexport class MyStack extends TerraformStack {\n  constructor(scope: Construct, id: string) {\n    super(scope, id);\n\n    // NOT GENERATED, BUT REQUIRED\n    new azuread.provider.AzureadProvider(this, \"changeme\", {});\n\n    new azuread.group.Group(this, \"changeme_simple_group\", {\n      displayName: \"changeme-simple-group-name\",\n    });\n  }\n}\n```\n\n","comments":[],"createdAt":"2023-02-14T08:57:18Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTg1Mzg1NTQ2","name":"feature/convert","description":"","color":"d93f0b"}],"milestone":null,"number":2638,"title":"Converting from Terraform, we need the provider to be explicitly stated, we should read from required_providers instead","updatedAt":"2023-03-09T11:42:35Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nAn update of @types/node broke cdktf for all of our JSII users. To guard against this in the future we could try to remove `@types/node` (like we tried in https://github.com/hashicorp/terraform-cdk/pull/2622) and write a .d.ts file in cdktf to add definitions for the node APIs we use. This way no future update can break this anymore.\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n\r\n- Original issue: #2610","comments":[],"createdAt":"2023-02-09T11:05:10Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"}],"milestone":null,"number":2624,"title":"Remove dependency on @types/node","updatedAt":"2023-06-01T18:03:51Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nWe just came across this use-case for Java in the CDK Dev Slack:\r\n```java\r\n        new Instance(this, \"bastionHost\", InstanceConfig.builder()\r\n                .ami(\"ami-06c39ed6b42908a36\")\r\n                .instanceType(\"t3.nano\")\r\n                .subnetId(Token.asString(Fn.element(Token.asAny(vpc.getPrivateSubnetsOutput()), 0)))\r\n                .iamInstanceProfile(Token.asString(bastionHostIamRole.getIamInstanceProfileArnOutput()))\r\n                .rootBlockDevice(new InstanceRootBlockDevice.Builder()\r\n                        .encrypted(true)\r\n                        .kmsKeyId(Token.asString(ebsKmsKey.getKeyArnOutput()))\r\n                        .build())\r\n                .tags(Map.of(\r\n                        \"Name\", \"BastionHost\"\r\n                ))\r\n                .build());\r\n\r\n```\r\n(which works)\r\n\r\nwith the interesting line being:\r\n`.subnetId(Token.asString(Fn.element(Token.asAny(vpc.getPrivateSubnetsOutput()), 0)))`\r\n\r\nIt took us quite a bit to figure out the inner `Token.asAny()` wrapping.\r\n\r\nSo, we should document an example like this in [this section](https://developer.hashicorp.com/terraform/cdktf/concepts/modules#work-with-module-outputs) and mention it on the [functions page](https://developer.hashicorp.com/terraform/cdktf/concepts/functions).\r\n\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5VS9US","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"Related to #1891 ","createdAt":"2023-02-15T09:47:34Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2613#issuecomment-1431033106","viewerDidAuthor":false}],"createdAt":"2023-02-08T10:53:36Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"}],"milestone":null,"number":2613,"title":"Documentation: Module outputs may require \"Token typecasting\" when passed e.g. into Terraform functions","updatedAt":"2023-06-28T18:26:35Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nThere are a few snippets left in our documentation that are written inline (in TypeScript; no CodeBlocks) and therefore neither sourced from a documentation example nor translated to other languages.\r\n\r\nThe following files contain such snippets:\r\n- `best-practices.mdx` (3 snippets)\r\n- `project-setup.mdx` (2 snippets)\r\n- `terraform-cloud.mdx` (2 snippets)\r\n- `construct-design.mdx` (3 snippets)\r\n- `refactoring.mdx` (2 snippets)\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2023-02-07T15:38:47Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"}],"milestone":null,"number":2607,"title":"Documentation: Remaining code snippets that are TypeScript only and not in CodeBlocks","updatedAt":"2023-02-15T16:36:47Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nWe use [this tool](https://github.com/hashicorp/terraform-cdk/tree/main/tools/documentation-code-snippets) to be able to ensure the snippets in our docs are valid.\r\n\r\nBy running this tool in CI and checking whether a diff is produced, we can ensure that, after changing an example, the snippet generation was run. We might even opt to create an automated commit (like Projen does) to persist the result of the tool and save some time (spent running the same thing locally).\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2023-02-06T10:56:48Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTU1MzExNDc0","name":"dev-process","description":"Improvements to how CDK for Terraform is developed and built","color":"F6A4ED"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"}],"milestone":null,"number":2600,"title":"CI: Validate that docs snippets sourced from examples are up-to-date","updatedAt":"2023-06-01T17:36:40Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Affected Resource(s)\r\n\r\nFor example this snippet in `iterators.mdx`: https://github.com/hashicorp/terraform-cdk/commit/546d4227e259dfce07db768dfb952188ec2d862d#diff-1e6a8dd989f640f76851c942afe89936e68f289c0b5c52b8079a8645c7d047c8R396-R418\r\n\r\n<!--- Please list the affected resources. --->\r\n\r\n### Expected Behavior\r\n\r\nIf all lines start with at least the same number of tabs, that amount should be removed, similar to how shared leading whitespace is removed already. If tabs and spaces are mixed, nothing should be removed.\r\n\r\n<!--- What should have happened? --->\r\n\r\n### Actual Behavior\r\n\r\nLeading tabs are never removed\r\n\r\n<!--- What actually happened? --->\r\n\r\n### Important Factoids\r\n\r\nThis code would need to be adjusted:\r\nhttps://github.com/hashicorp/terraform-cdk/blob/b3c34a80e75a167b758807bcebfebd06d360c168/tools/documentation-code-snippets/update-documentation-code-snippets.ts#L220-L224\r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n","comments":[],"createdAt":"2023-02-02T09:47:33Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTU1MzExNDc0","name":"dev-process","description":"Improvements to how CDK for Terraform is developed and built","color":"F6A4ED"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"}],"milestone":null,"number":2585,"title":"Docs Snippet Tool only removes leading whitespace but not leading tabs","updatedAt":"2023-06-01T17:35:42Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nThe [unit test page](https://github.com/hashicorp/terraform-cdk/blob/main/website/docs/cdktf/test/unit-tests.mdx) has examples for all languages, but none are yet sourced from documentation examples that are checked for correctness.\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2023-02-02T09:38:28Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"}],"milestone":null,"number":2583,"title":"Documentation: Examples in `unit-tests.mdx` not sourced from documentation","updatedAt":"2023-02-15T16:37:18Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nThis one came in after the first pass of converting examples to other languages, which is probably why it was missed. No language is sourced from an example yet.\r\n\r\nhttps://github.com/hashicorp/terraform-cdk/blob/79b1d35e03d290b23a21cd9c9a53be0ba04360ff/website/docs/cdktf/concepts/tokens.mdx?plain=1#L155-L182\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5UQFCX","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"I saw this, and thought it of little value to place within the examples code, so I'd vote to skip it.","createdAt":"2023-02-02T10:23:48Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2582#issuecomment-1413501079","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5VapP3","author":{"login":"xiehan"},"authorAssociation":"MEMBER","body":"It's also a duplicate of #2298.","createdAt":"2023-02-16T12:56:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2582#issuecomment-1433048055","viewerDidAuthor":false}],"createdAt":"2023-02-02T09:34:32Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"}],"milestone":null,"number":2582,"title":"Documentation: `cdktf.NullValue` example in `tokens.mdx` not sourced from examples","updatedAt":"2023-02-16T12:56:37Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nThe following snippet is not translated to other languages and not sourced from code for TypeScript:\r\nhttps://github.com/hashicorp/terraform-cdk/blob/8d33d56a84301ef357bae4218a020a8d93b80ce4/website/docs/cdktf/concepts/variables-and-outputs.mdx?plain=1#L101-L117\r\n\r\n\r\n\r\n### References\r\n\r\n* Not merged yet, but I translated it to Go in this [commit](https://github.com/hashicorp/terraform-cdk/commit/29538f8a875769f6ba9de5e00e7a1cd10ef18d7a#diff-caac5ea344848751b09d287425aadc269a611612eb0523b0647945a0feadd7f6R98-R109) on this [PR](https://github.com/hashicorp/terraform-cdk/pull/2560).\r\n* Someone was asking for this translation on [Discuss](https://discuss.hashicorp.com/t/how-to-model-complex-variable-in-python/52161)\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2023-02-02T09:04:05Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMTEzNjU3MzA2","name":"language/python","description":"","color":"5c2596"},{"id":"MDU6TGFiZWwyNjMzNjk4NzAy","name":"language/java","description":"","color":"E38858"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM1OTYzMTU0","name":"language/c#","description":"C# language issues","color":"c5def5"}],"milestone":null,"number":2578,"title":"Documentation: Complex variables snippet not translated in `variables-and-outputs.mdx`","updatedAt":"2023-04-14T11:29:13Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjIwNzIwNDk4","is_bot":false,"login":"oleksiilopasov","name":"Oleksii Lopasov"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nIn documentation we have this information about CDKTF basics:\r\n```\r\nApp Class\r\nEach CDKTF project has one or more App instances that act as a container for the infrastructure configurations you create and deploy.\r\nAn App can have one or more stacks that represent a collection of related infrastructure.\r\n```\r\n\r\nI thought that means I can define multiple different apps one by one in `main.py` in the following manner:\r\n```\r\napp1 = App()\r\napp2 = App()\r\n...\r\n<calling stacks to deploy within the specific app>\r\n...\r\napp1.synth()\r\napp2.synth()\r\n```\r\nAfter that I expect `cdktf deploy stack-*` (All stack names start with `stack-`) to deploy all stacks. Though I have a deployment for those several combined within the latest app defined in code (app2 in my case). So I have all stacks synthesized, but only app2 stacks deployed. Is it possible to define several apps and deploy them within a single `cdktf deploy`? If not, it would be nice to have along with ability to provide app as a parameter to `cdktf deploy` CLI and define app dependencies within each other. \r\nIMO if App() is a higher-level abstraction compared to Stack() then it could make sense to provide engineers a mechanism to deploy them in similar manner as stacks.\r\nThanks in advance \r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5UKWxj","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @oleksiilopasov ğŸ‘‹\r\n\r\nThank you for raising this! I agree with you, if we support multiple apps, than our CLI should support them, too.\r\nUnfortunately, the docs are a bit misleading as we currently only support one app with the default config.\r\n\r\nWhile in theory you could already specify two different `outDir` options for each of your two apps, the CDKTF CLI currently won't handle those two distinct directories while synthesizing (as it only supports a single `outDir` option).\r\n\r\nOut of curiosity: What is the reason you'd like to use two apps?","createdAt":"2023-02-01T12:46:21Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2568#issuecomment-1412000867","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5UK7x_","author":{"login":"oleksiilopasov"},"authorAssociation":"NONE","body":"Hi @ansgarm \r\nLet me try to explain.\r\nSo, I have my Google Cloud organization defined with folder structure and YAML configs mapped to GCP folders and projects respectively. The deployment is similar to layer-cake where I deploy org-level stuff first, then folder-structure and projects skeletons, then relations between projects and project security, etc... This allows me to avoid the situations when one project (or it's resource) relates/depends to another, that doesn't exist yet. For example if one project needs access to another, I have to be sure both of them already exist and ready for further configuration. The layer-like deployment saves me from getting lost in dependency-hell and managing them explicitly in most cases. These layers are my stacks and each stack saves terraform state per environment (dev, stage, prod)\r\nBUT\r\nTo fill the projects with resources within the same CDKTF project, I have to change the approach and save each project state per project, not by env. Because we expect to have tons of projects, I don't want to define a stack for each of them. That's why I introduced an auxiliary class for iterating the projects and creating `TerraformStack()`-type class per each. This auxiliary class has different type so `add_dependency()` method can't be applied. While I want these project-resource-stacks to be deployed AFTER the org-level stacks finish, I can't define a dependency between them. So I made a decision to split them between different apps. Didn't work out as I mentioned above. So my current solution is use different name patterns for different stacks: for example `infra-*` for infrastructure-level and `resource-*` for resource-level. And deploy them with different CLI `deploy` commands. As there might be a CI/CD wrapper around CDKTF, it's not a problem, though I'm looking forward to my feature request to be implemented.","createdAt":"2023-02-01T14:28:45Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2568#issuecomment-1412152447","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5UYe1f","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"> That's why I introduced an auxiliary class for iterating the projects and creating TerraformStack()-type class per each. This auxiliary class has different type so add_dependency() method can't be applied.\r\n\r\nCould you elaborate a bit more on how that auxiliary class works? And about how you tried to define the dependency?\r\n\r\nWhile it probably is not possible to add a dependency to that auxiliary class, it probably would be possible to have it expose an `add_dependency()` method that would delegate this to all the Terraform stacks it manages? But maybe I'm missing something here.\r\n\r\nBut supporting multiple apps or a different abstraction to handle the layercake use-case you described, is definitely something that would be very valuable. So we should keep this issue open regardless ğŸ‘","createdAt":"2023-02-03T10:57:55Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2568#issuecomment-1415703903","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5UYt_g","author":{"login":"oleksiilopasov"},"authorAssociation":"NONE","body":"@ansgarm Hey\r\nHere is how my class works:\r\nmain.py:\r\n```python\r\napp = App()\r\norg_infra = OrgInfra(app, \"goog-cdktf-infra\")\r\nresource_stack_dev = ResourceStack(app, \"development\")\r\nresource_stack_nonprod = ResourceStack(app, \"non-production\")\r\n```\r\n`OrgInfra()` inherits `TerraformStack()` and should be executed before resource-related stacks start. `ResourceStack()` is a custom class (`non-TerraformStack()`)\r\n\r\nHere is what's inside this custom class:\r\n```python\r\nclass ResourceStack():\r\n    def __init__(self, scope: Construct, environment: str):\r\n        _, projects = helper.org_walk(environment)\r\n\r\n        for project in projects:\r\n            project_name = os.path.basename(project).split('.')[0]\r\n            ProjectStack(\r\n                scope, f\"stack-{environment}-{project_name}\",\r\n                ProjectStackConfig(\r\n                    environment=environment,\r\n                    path=project,\r\n                    project=project_name\r\n                )\r\n            )\r\n```\r\nI delegate the app instance to pass it into each child `ProjectStack()` class\r\nProjectStack is the standard TerraformStack() class with it's custom logic inside:\r\n```python\r\nclass ProjectStack(TerraformStack):\r\n    def __init__(self, scope: Construct, id: str, config: ProjectStackConfig):\r\n        super().__init__(scope, id)\r\n        ...<custom_logic>...\r\n```\r\nSo `ResourceStack()` iterates the projects YAML configs within the particular environment (env is mapped to related folder with projects inside) and executes `ProjectStack()` per each project. That's how my project-stacks are configured dynamically. I still can delegate an upstream stack to add it as a dependency, for example:\r\n```python\r\napp = App()\r\norg_infra = OrgInfra(app, \"goog-cdktf-infra\")\r\nresource_stack_dev = ResourceStack(app, \"development\", org_infra)\r\n```\r\nand then:\r\n```python\r\nclass ResourceStack():\r\n    def __init__(self, scope: Construct, environment: str, upstream: Construct):\r\n        _, projects = helper.org_walk(environment)\r\n\r\n        for project in projects:\r\n            project_name = os.path.basename(project).split('.')[0]\r\n            ProjectStack(\r\n                scope, f\"stack-{environment}-{project_name}\",\r\n                ProjectStackConfig(\r\n                    environment=environment,\r\n                    path=project,\r\n                    project=project_name\r\n                )\r\n            ).add_dependency(upstream)\r\n```\r\nBUT\r\nIn the beginning I also had `resource_stack_nonprod = ResourceStack(app, \"non-production\")` that I want to run AFTER `dev` is finished. In this case I can't pass an upstream stack because I don't have them defined explicitly - they are dynamic/ephemeral and exist only when `cdktf` is compiling the code. Additionally there can be tons of `dev` project-stacks. How will I add all of them as dependencies to `nonprod`?)\r\nThats why my current solution assumes stacks to have different name patters: `goog-*` for infrastructure and `stack-dev-*` and `stack-nonprod-*` for `dev` and `nonprod` dynamic stacks respectively. In this case I'll have to call `cdktf` three times deploying required stacks in required order.\r\nThat's how I see it, if we had multiple apps within a single cdktf project:\r\n```python\r\napp_infra = App(<infra-app config parameters>)\r\napp_stacks = App(<stack-app config parameters>)\r\napp_stacks.add_dependency(app_infra)\r\n\r\norg_infra = OrgInfra(app_infra, \"goog-org-infrastructure\")\r\norg_secure = OrgInfra(app_infra, \"goog-org-security\")\r\norg_secure.add_dependency(org_infra)\r\n\r\n# Iteration class, calling TerraformStack() per each project\r\nresource_stack_dev = ResourceStack(app_stacks, \"development\")\r\nresource_stack_nonprod = ResourceStack(app_stacks, \"non-production\")\r\n```\r\nThough even in this case we won't be able to set dependencies between `resource_stack_dev` and its child stacks and `resource_stack_nonprod` ones. The only way is to split these dynamic stacks between different apps and set dependencies on app-level.\r\n\r\nWhat do you think?","createdAt":"2023-02-03T11:54:56Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2568#issuecomment-1415765984","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5WoWs8","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @oleksiilopasov ğŸ‘‹\r\n\r\nThank you for the extensive write-up and sorry for the late reply. I think your case is a good example where allowing multiple apps or nested stacks (which e.g. the AWS CDK supports) could simplify your architecture.\r\n\r\nWith todays tools, you could have `ProjectStack` keep a list of the stacks it creates and expose a `add_dependency(stack)` method on `ProjectStack` that would iterate over that list and call `add_dependency(stack)` on each \"child\"-stack it has in its list.\r\n\r\nAn (somewhat hacky) alternative / addition could be to introduce helper stacks that have no resources and only exist to bundle the dependencies:\r\n```python\r\ninfra_done = AllInfraDoneStack()\r\ninfra_done.add_dependency(org_infra)\r\ninfra_done.add_dependency(org_secure)\r\n```\r\nYour `ResourceStack` could then add a dependency to that stack to each `ProjectStack` it creates.","createdAt":"2023-03-03T11:53:26Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2568#issuecomment-1453419324","viewerDidAuthor":false}],"createdAt":"2023-02-01T12:25:06Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"}],"milestone":null,"number":2568,"title":"CDKTF support for multiple applications","updatedAt":"2023-03-03T11:54:32Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n`Found an encoded list token string in a scalar string context. Use 'Fn.element(list, 0)' (not 'list[0]') to extract elements from token lists` does not seem to help people. Maybe we should link to a documentation article to clarify\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5Zsk4Q","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"I'd propose to close this as a duplicate of #2254 â€“ what do you think, @DanielMSchmidt?","createdAt":"2023-04-12T08:16:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2548#issuecomment-1504857616","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5ZsmYT","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"I don't think they cover quite the same topic although it's about the same error message. This issue proposes rephrasing the error message as well as linking to a documentation page that helps, the one you linked talks about hinting towards iterators. We can combine them, but I don't think they are the same","createdAt":"2023-04-12T08:21:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2548#issuecomment-1504863763","viewerDidAuthor":false}],"createdAt":"2023-01-27T14:55:12Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM1OTU1Nzk1","name":"ux/debugging","description":"","color":"2703FD"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":2548,"title":"Improve list token access error message","updatedAt":"2023-06-28T18:28:42Z"},{"assignees":[{"id":"MDQ6VXNlcjU3MzUzMQ==","login":"mutahhir","name":"Mutahhir Hayat","databaseId":0}],"author":{"id":"MDQ6VXNlcjc5NjMyNjU4","is_bot":false,"login":"tieto-hemmopaa","name":"Paavo Hemmo"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\nNode v18.13.0\r\nTerraform v1.3.4\r\ncdktf 0.15.1\r\n\r\n### Affected Resource(s)\r\n\r\nTerraformVariable\r\n<!--- Please list the affected resources. --->\r\n\r\n### Debug Output\r\n\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\n\r\n### Expected Behavior\r\n\r\nCreating a TerraformVariable should get the values of environment variables `TF_VAR_awsAccessKey` and `TF_VAR_awsSecretAccessKey`.\r\n\r\nRunning `cdktf deploy test-stack-1` or `cdktf deploy test-stack-2` should be successful.\r\n\r\nmain.ts:\r\n\r\n```\r\nimport { Construct } from 'constructs';\r\nimport { App, TerraformStack, S3Backend, TerraformVariable } from 'cdktf';\r\nimport { AwsProvider } from './.gen/providers/aws/provider';\r\nimport { S3Bucket } from './.gen/providers/aws/s3-bucket';\r\nimport { DynamodbTable } from './.gen/providers/aws/dynamodb-table';\r\n\r\ninterface MultiStackConfig {\r\n    environment: string;\r\n}\r\nclass MultiStack extends TerraformStack {\r\n  constructor(scope: Construct, id: string, config: MultiStackConfig) {\r\n    super(scope, id);\r\n    \r\n    const awsAccessKey = new TerraformVariable(this, 'awsAccessKey', {\r\n      type: 'string',\r\n      description: 'AWS Access Key',\r\n      sensitive: true\r\n    })\r\n    const awsSecretAccessKey = new TerraformVariable(this, 'awsSecretAccessKey', {\r\n      type: 'string',\r\n      description: 'AWS Secret Access Key',\r\n      sensitive: true\r\n    })\r\n    new AwsProvider(this, 'aws', {\r\n      region: 'eu-west-1',\r\n      accessKey: awsAccessKey.value,\r\n      secretKey: awsSecretAccessKey.value\r\n    });\r\n\r\n    const { environment } = config;\r\n\r\n    new S3Bucket(this, 's3_backend_bucket', {\r\n      bucket: `cdktf-remote-backend-${environment}`,\r\n    });\r\n    new DynamodbTable(this, 'dynamodb_lock_table', {\r\n      name: `cdktf-remote-backend-lock-${environment}`,\r\n      billingMode: 'PAY_PER_REQUEST',\r\n      attribute: [\r\n        {\r\n          'name': 'LockID',\r\n          'type': 'S'\r\n        }\r\n      ],\r\n      hashKey: 'LockID',\r\n    });\r\n    new S3Backend(this, {\r\n      bucket: `cdktf-remote-backend-${environment}`,\r\n      key: `integration_portal/terraform_${environment}.tfstate`,\r\n      encrypt: true,\r\n      region: 'eu-west-1',\r\n      dynamodbTable: `cdktf-remote-backend-lock-${environment}`,\r\n      accessKey: awsAccessKey.value,\r\n      secretKey: awsSecretAccessKey.value\r\n    });\r\n  }\r\n}\r\n\r\nconst app = new App();\r\nnew MultiStack(app, 'test-stack-1', {\r\n  environment: 'qa'\r\n});\r\nnew MultiStack(app, 'test-stack-2', {\r\n  environment: 'prod'\r\n});\r\napp.synth();\r\n```\r\n\r\nEnvironment variables:\r\n```\r\nTF_VAR_awsAccessKey='accessKeyValueForIAMWithPermissions'\r\nTF_VAR_awsSecretAccessKey='secretAccessKeyValueForIAMWithPermissions'\r\n```\r\n<!--- What should have happened? --->\r\n\r\n### Actual Behavior\r\n\r\n<!--- What actually happened? --->\r\n\r\n`cdktf deploy test-stack-1` prints the following output:\r\n\r\n```\r\ntest-stack-1  Initializing the backend...\r\n\r\n\r\n1 Stack deploying     0 Stacks done     0 Stacks waiting\r\n[2023-01-25T14:29:22.234] [ERROR] default - â•·\r\nâ”‚ Error: error configuring S3 Backend: error validating provider credentials: error calling sts:GetCallerIdentity: InvalidClientTokenId: The security token included in the request is invalid.\r\nâ”‚ \tstatus code: 403, request id: [some_id]\r\nâ”‚ \r\nâ”‚ \r\ntest-stack-1  â•·\r\n                            â”‚ Error: error configuring S3 Backend: error validating provider credentials: error calling sts:GetCallerIdentity: InvalidClientTokenId: The security token included in the request is invalid.\r\n                            â”‚ \tstatus code: 403, request id: [some_id]\r\n                            â”‚ \r\n                            â”‚ \r\n                            â•µ\r\n                            \r\n\r\n\r\n0 Stacks deploying     1 Stack done     0 Stacks waiting\r\nError: non-zero exit code 1\r\n\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Please list the steps required to reproduce the issue. --->\r\n\r\n1. Create an AWS IAM User with the required permissions.\r\n\r\n2. Make an empty directory and go there\r\n```\r\nmkdir test-cdktf\r\ncd test-cdktf\r\n```\r\n\r\n3. Init the project:\r\n```\r\ncdktf init --template=typescript\r\n```\r\n\r\n4. When done, modify the cdktf.json file by adding the provider:\r\n```\r\n\"terraformProviders\": [\r\n    \"aws@~> 4.0\"\r\n  ]\r\n```\r\n5. Create the appropriate TypeScript classes for the provider (creates content to the .gen-folder):\r\n```\r\ncdktf get\r\n```\r\n\r\n6. Copy the content of my main.ts file to your project.\r\n\r\n7. Add `TF_VAR_awsAccessKey` and `TF_VAR_awsSecretAccessKey` to environment variables.\r\n\r\n8. Deploy the `test-stack-1` (or `test-stack-2`):\r\n\r\n```\r\ncdktf deploy test-stack-1\r\n```\r\n\r\n\r\n### Important Factoids\r\n\r\nThe IAM role used for this deployment does have the correct permissions. The code works fine by hard-coding the environment variable values to the code and getting rid of TerraformVariable.\r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n- #0000\r\n","comments":[{"id":"IC_kwDODd1Amc5Tqh-j","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @tieto-hemmopaa ğŸ‘‹\r\nJust to confirm that there's not a problem in setting the environment variable: Could you try to run `echo $TF_VAR_awsAccessKey` to confirm that the value of the variable does not contain quotes (`'`) or similar?","createdAt":"2023-01-25T13:52:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2535#issuecomment-1403658147","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5TqjnR","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"I just checked the [related Terraform docs](https://developer.hashicorp.com/terraform/language/settings/backends/configuration), and it appears that you can't use Terraform Variables to configure backends.\r\n\r\nWe should catch such errors in the CDKTF core library (e.g. using an Aspect, as we already do for other checks) and print a helpful warning.\r\n\r\nI'm wondering why Terraform isn't giving a better error, though ğŸ¤”","createdAt":"2023-01-25T13:57:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2535#issuecomment-1403664849","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Tqjsi","author":{"login":"tieto-hemmopaa"},"authorAssociation":"NONE","body":"Hi @ansgarm !\r\nNo quotes. I've tried setting the environment variables both with and without quotes. Neither of those add them to the value of the variable.","createdAt":"2023-01-25T13:57:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2535#issuecomment-1403665186","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5TqkF0","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"From the [docs](https://developer.hashicorp.com/terraform/language/settings/backends/configuration) of the S3 backend:\r\n> This can also be sourced from the AWS_ACCESS_KEY_ID environment variable\r\n\r\nSounds like you should be able to pass the required keys using the environment variables defined in the docs of the S3 backend.","createdAt":"2023-01-25T13:59:06Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2535#issuecomment-1403666804","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Tqu1c","author":{"login":"tieto-hemmopaa"},"authorAssociation":"NONE","body":"Thank you so much @ansgarm !\r\n\r\nIn case anyone else is wondering, I was able to get my code working by first modifying the code in the following way:\r\n\r\n```\r\nnew S3Backend(this, {\r\n      bucket: `cdktf-remote-backend-${environment}`,\r\n      key: `integration_portal/terraform_${environment}.tfstate`,\r\n      encrypt: true,\r\n      region: 'eu-west-1',\r\n      dynamodbTable: `cdktf-remote-backend-lock-${environment}`,\r\n      accessKey: process.env.TF_VAR_awsAccessKey,\r\n      secretKey: process.env.TF_VAR_awsSecretAccessKey\r\n    });\r\n```\r\n\r\nAnd running the `terraform init -migrate-state` command in `cdktf.out/stacks/test-stack-1`.\r\n\r\nAfter that `cdktf deploy test-stack-1` works perfectly.","createdAt":"2023-01-25T14:30:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2535#issuecomment-1403710812","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Tq0Ea","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Glad you figured it out!\r\nThe only warning I have about using `process.env.TF_VAR_awsAccessKey` is that it will cause the secret to end up in the generated `cdk.tf.json` file. So be cautious if you commit that file to CI or do something else with it!","createdAt":"2023-01-25T14:45:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2535#issuecomment-1403732250","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5TrNyM","author":{"login":"tieto-hemmopaa"},"authorAssociation":"NONE","body":"I only use `process.env.TF_VAR_awsAccessKey` and `process.env.TF_VAR_awsSecretAccessKey` when configuring the `S3Backend`. ğŸ‘ For all the other classes I use the `TerraformVariable`.\r\n\r\nThe secrets used configuring the backend do not seem to end up in the `cdk.tf.json` files.\r\n\r\nThe content of the file for the Backend looks like this:\r\n\r\n```\r\n\"backend\": {\r\n      \"s3\": {\r\n        \"bucket\": \"cdktf-remote-backend-qa\",\r\n        \"dynamodb_table\": \"cdktf-remote-backend-lock-qa\",\r\n        \"encrypt\": true,\r\n        \"key\": \"integration_portal/terraform_qa.tfstate\",\r\n        \"region\": \"eu-west-1\"\r\n      }\r\n}\r\n```\r\n","createdAt":"2023-01-25T15:55:40Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2535#issuecomment-1403837580","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5TrREz","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hm, maybe you ran `cdktf diff/plan/apply/deploy/destroy` without those environment variables at a later stage? If you have them set, they should end up in the generated file. But if you run `synth` (happens automatically for the commands I mentioned previously) it'll recreate that generated file â€“ thereby possibly removing those secrets again.\r\nIt does not need to be a bad thing, I just wanted to point that out as it can bring trouble depending on when you set those secrets and what you do with the generated file afterwards.","createdAt":"2023-01-25T16:05:06Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2535#issuecomment-1403851059","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5TuM3W","author":{"login":"tieto-hemmopaa"},"authorAssociation":"NONE","body":"Sure, I ran all sorts of commands during the process. I'll keep an eye out later on ğŸ‘ ","createdAt":"2023-01-26T06:56:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2535#issuecomment-1404620246","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5WnXhF","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"This just came up in a question on the CDK Dev Slack where CDKTF allowed the value of a AWS SSM Parameter data source to be passed to a Terraform Backend although Terraform did not support this. This seemed to have resulted in an unresolved token that was put into the backend config.","createdAt":"2023-03-03T08:33:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2535#issuecomment-1453160517","viewerDidAuthor":false}],"createdAt":"2023-01-25T13:43:57Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzg0MDc0","name":"priority/important-soon","description":"High priority, to be worked on as part of our current release or the following one.","color":"CC56C1"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"}],"milestone":null,"number":2535,"title":"Passing backend config through `TerraformVariable`s is not supported by Terraform","updatedAt":"2023-03-03T08:33:21Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEwMTYyMw==","is_bot":false,"login":"edeustace","name":"ed eustace"},"body":"Running `cdktf provider list` within a cdktf package that is part of an [workspace][ws] throws an error.\r\n\r\n[ws]: https://docs.npmjs.com/cli/v7/using-npm/workspaces\r\n\r\n\r\n<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\ncdktf: 15.0.0\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\n### Affected Resource(s)\r\n\r\n\r\n<!--- Please list the affected resources. --->\r\n\r\n### Debug Output\r\n\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\nhttps://gist.github.com/edeustace/1806ada8fa6026fba4caefb85364fbbd#file-error-log\r\n\r\n### Expected Behavior\r\n\r\n<!--- What should have happened? --->\r\n\r\nCommand should have run. \r\n\r\n### Actual Behavior\r\n\r\n<!--- What actually happened? --->\r\n\r\nCommand failed and logged the error: \r\n` Could not determine cdktf version. Please make sure you are in a directory containing a cdktf project and have all dependencies installed.`\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Please list the steps required to reproduce the issue. --->\r\n\r\nCreate a monorepo: \r\n\r\n```shell\r\napp/\r\n  infrastructure/ # cdktf stuff in here\r\n  packages/ # packages here\r\n```\r\n\r\nin your monorepo package.json set up workspaces: \r\n\r\n```javascript\r\n  // snip\r\n  \"workspaces\": [ \"infrastructure\", \"packages/*\"]\r\n  // snip\r\n```\r\n\r\n`cd infrastructure`\r\n`cdktf provider list`\r\n\r\n### Important Factoids\r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\nI think this is the source that relates to the error: \r\n\r\nhttps://github.com/hashicorp/terraform-cdk/blob/44cf75daab5e89bdfe89887d24bcb283287e5564/packages/%40cdktf/commons/src/debug.ts#L96\r\n\r\nWhen parsing the output of `npm list cdktf --json`, and you are in a package within the workspace, the `dependencies` map that you want to check will be defined within the workspace package map in `dependencies`. \r\n\r\nSo for the above - w/ a workspace package called `infrastructure` the json will look like this: \r\n```javascript\r\n  {\r\n    dependencies: {\r\n       infrastructure: {\r\n         dependencies: {\r\n           // snip\r\n          cdktf: { /*..info here */ }\r\n          // snip\r\n         }\r\n       }\r\n   }\r\n}\r\n```\r\n \r\nSo the logic should be updated to check if cwd is within a workspace package: \r\n\r\n```javascript\r\nconst workspacePkgName = loadWorkspacePkgName( process.cwd() ) // <-- check if we are in a workspace package.\r\n\r\nif(workspacePkgName) {\r\n  const workspacePkg = json.dependencies[workspacePkgName]; \r\n  // then - here look to find `packageName`\r\n} else {\r\n  // do the regular check...\r\n}\r\n```\r\n\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n- #0000\r\n","comments":[{"id":"IC_kwDODd1Amc5dtMGw","author":{"login":"xiehan"},"authorAssociation":"MEMBER","body":"Thanks for raising this issue! We agree this should be addressed. Unfortunately it's not something we'll have capacity to work on soon, but we welcome any community contributions.","createdAt":"2023-06-01T14:07:55Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2519#issuecomment-1572127152","viewerDidAuthor":false}],"createdAt":"2023-01-20T13:55:29Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"LA_kwDODd1Amc78phHg","name":"cli/provider-subcommands","description":"cdktf provider <verb> commands","color":"4CBCB0"}],"milestone":null,"number":2519,"title":"cdktf provider list does not work when run from a package within a workspace ","updatedAt":"2023-06-01T14:07:56Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nWe could expose a matcher that asserts if a module is present and configured in a certain way\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n\r\n\r\n- https://stackoverflow.com/questions/75008472/how-can-i-test-my-terrafrom-modules-using-cdktf/75181665#75181665\r\n","comments":[],"createdAt":"2023-01-20T08:53:05Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyNTcwMTY0OTY5","name":"testing","description":"","color":"456cc6"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":2518,"title":"Testing: Assert modules being present","updatedAt":"2023-01-20T08:53:05Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nOur Go project template, Go tutorials and documentation are currently lacking information about the recommended `defer jsii.Close()` cleanup call.\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n* AWS CDK Docs: https://docs.aws.amazon.com/cdk/v2/guide/work-with-cdk-go.html#go-cdk-jsii-close\r\n* https://github.com/aws/jsii/issues/700#issuecomment-1258102211\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2023-01-18T15:02:08Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyOTY3ODY2NzMy","name":"documentation/learn-tutorials","description":"","color":"29D75B"},{"id":"MDU6TGFiZWwzMDMwODE1NTQy","name":"language/golang","description":"","color":"22ED90"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"LA_kwDODd1Amc7x0kYM","name":"feature/init","description":"cdktf init related features","color":"C1E24A"}],"milestone":null,"number":2514,"title":"Improve Golang template & docs to include `defer jsii.Close()` cleanup call","updatedAt":"2024-01-12T13:45:45Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n`terraform plan` supports passing a `-destroy` flag ([docs](https://developer.hashicorp.com/terraform/cli/commands/plan#planning-modes)).\r\n`cdktf diff` / `cdktf plan` currently doesn't support this flag.\r\nWe should support it.\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2023-01-18T14:52:43Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2MjkzOTA4","name":"core-parity","description":"Better experience in Terraform Core than CDKTF","color":"1A80B6"}],"milestone":null,"number":2513,"title":"Support planning a destroy via `cdktf-cli`","updatedAt":"2023-02-16T13:55:36Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nhttps://developer.hashicorp.com/terraform/cdktf/concepts/resources#escape-hatch was not helpful in finding the syntax for overriding something with a list\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2023-01-18T14:44:02Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":2511,"title":"Document how to use escape hatch with lists","updatedAt":"2023-06-28T18:28:27Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n`cdktf convert` needs the provider information to make accurate translations. This means users either need to run the command in their cdktf project or with command line flags to pass down the providers they are using and it also means the command takes more time since the schema needs to be fetched.\r\n\r\nThis is both a bit annoying, we could improve `cdktf convert` by bundling the most common providers in their latest version (some things might be wrong if you don't specify an explicit version, but most things should be okay) and / or caching the schemas (to make re-runs of convert faster).\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5UqteI","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"To add to this, we don't need all of the provider schema so we might be able to compress it to only the information we need to not additionally blow up our bundle size.","createdAt":"2023-02-07T09:47:07Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2509#issuecomment-1420482440","viewerDidAuthor":false}],"createdAt":"2023-01-18T11:56:43Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"},{"id":"MDU6TGFiZWwzMTg1Mzg1NTQ2","name":"feature/convert","description":"","color":"d93f0b"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":2509,"title":"Convert: Bundle the most used providers","updatedAt":"2023-03-09T11:44:13Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjI2NzQ1MTUw","is_bot":false,"login":"acdoussan","name":""},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n- Please update the default template to output the built .js / .d.ts files from typescript to a `build` folder (aka set outDir to `build`), rather than dumping them next to the code. These files clutter up the folder and I don't want to see them.\r\n- Support absolute paths by default. Ref: https://discuss.hashicorp.com/t/cdktf-tsconfig-paths-not-working-for-local-imports/46163/6?u=acdoussan\r\n- It would be nice if the initial project setup was slightly more sophisticated, rather than having everything in a single file. I propose creating a src directory, which contains an `app.ts` file and a `exampleStack.ts` file. `main.ts` instantiates the app from `app.ts`, app.ts instantiates the stack from `exampleStack.ts`, `exampleStack.ts` can stay empty as it is in the current template. Example on what this would look like can be seen in [this issue](https://github.com/hashicorp/terraform-cdk/issues/2489).\r\n\r\n### References\r\n\r\nhttps://www.typescriptlang.org/tsconfig#outDir","comments":[{"id":"IC_kwDODd1Amc5SlJyF","author":{"login":"xiehan"},"authorAssociation":"MEMBER","body":"Hi @acdoussan, thanks for the detailed issue writeup! For the first two bullet points, I'll let the engineers weigh in since they can say more about whether there are any consequences to making these changes or not.\r\n\r\nAs for your third bullet point, I get where you're coming from, but unfortunately we're not likely to incorporate this proposed change at this time. The reason being is that since we're a relatively new project and lots of folks are still learning to use CDKTF for the first time, it's very important for us to be consistent between the library itself and our documentation and tutorials located at e.g. https://developer.hashicorp.com/terraform/tutorials/cdktf/cdktf-install and https://developer.hashicorp.com/terraform/cdktf/examples-and-guides/refactoring. These docs make heavy use of this \"all of your config in a single file\" pattern because it's much easier to convey the documentation that way even though it's not a desirable pattern for more complex, production-grade projects.\r\n\r\nDown the line, the team is talking about refactoring the entire template system to make it more robust, and I wonder if that time might be an opportunity for us to look into maintaining our current simple \"quickstart\" template but also add more advanced templates that might be more suitable for production projects. For now, however, it is more important for us to keep CDKTF accessible for beginners, and rely on our more experienced users to figure out for themselves how to refactor the default template to better suit complex use cases.","createdAt":"2023-01-17T14:01:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2490#issuecomment-1385471109","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6ejMx9","author":{"login":"fbartho"},"authorAssociation":"NONE","body":"@xiehan I understand the desire to simplify the learning curve a few years ago when this project started.\n\nThat's said, this is 2025 now, and the points that @acdoussan raised initially are friction points that I have to bypass when advocating for this tool with my team.\n\nCan we revisit this decision in light of the age of the project now?","createdAt":"2025-02-14T18:41:45Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2490#issuecomment-2660027517","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6ejQ7R","author":{"login":"fbartho"},"authorAssociation":"NONE","body":"Filed a related quality of life issue: https://github.com/hashicorp/terraform-cdk/issues/3827","createdAt":"2025-02-14T18:50:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2490#issuecomment-2660044497","viewerDidAuthor":false}],"createdAt":"2023-01-14T22:39:04Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjg5OTEzOTMx","name":"build","description":"","color":"f7bbc8"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":2490,"title":"cdktf-init typescript template general QOL improvements","updatedAt":"2025-02-14T18:50:55Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjI2NzQ1MTUw","is_bot":false,"login":"acdoussan","name":""},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nCurrently, the providers have to be defined directly on each stack. My provider configuration does not change between stacks. It would be nice if the cdk implementation walked up the object chain and used the first provider definition it finds, so I can define it in a single place.\r\n\r\nExample (this doesn't work):\r\n\r\n`main.ts`\r\n```\r\nimport { HomelabApp } from 'src/app';\r\n\r\nconst app = new HomelabApp();\r\napp.synth();\r\n```\r\n\r\n`src/app.ts`\r\n```\r\nimport { App, AppOptions } from \"cdktf\";\r\nimport { ProxmoxProvider } from 'gen/providers/proxmox/provider';\r\nimport { K8sStack } from './k8s';\r\n\r\nexport class HomelabApp extends App {\r\n  public readonly proxmoxProvider: ProxmoxProvider;\r\n  public readonly k8sStack: K8sStack;\r\n\r\n  constructor(options?: AppOptions) {\r\n    super(options);\r\n\r\n    this.proxmoxProvider = new ProxmoxProvider(this, 'proxmox-provider', {\r\n      pmApiUrl: <redacted>,\r\n      pmUser: <redacted>,\r\n      pmPassword: <redacted>,\r\n    });\r\n\r\n    this.k8sStack = new K8sStack(this, \"k8s\");\r\n  }\r\n}\r\n```\r\n\r\n`src/k8s.ts`\r\n```\r\nimport { Construct } from \"constructs\";\r\nimport { TerraformStack } from \"cdktf\";\r\nimport { Lxc } from \"gen/providers/proxmox/lxc\";\r\n\r\nexport class K8sStack extends TerraformStack {\r\n  public readonly test: Lxc;\r\n\r\n  constructor(scope: Construct, id: string) {\r\n    super(scope, id);\r\n\r\n    this.test = new Lxc(this, 'lxc-test', {\r\n      <redacted config, not relevant>\r\n    });\r\n  }\r\n}\r\n```\r\n\r\n`tsconfig.json`\r\n```\r\n{\r\n  \"compilerOptions\": {\r\n    \"paths\": {\r\n      \"src/*\": [\"./src/*\"],\r\n      \"gen/*\": [\"./.gen/*\"]\r\n    },\r\n    \"alwaysStrict\": true,\r\n    \"charset\": \"utf8\",\r\n    \"declaration\": true,\r\n    \"experimentalDecorators\": true,\r\n    \"inlineSourceMap\": true,\r\n    \"inlineSources\": true,\r\n    \"lib\": [\"es2018\"],\r\n    \"module\": \"CommonJS\",\r\n    \"noEmitOnError\": true,\r\n    \"noFallthroughCasesInSwitch\": true,\r\n    \"noImplicitAny\": true,\r\n    \"noImplicitReturns\": true,\r\n    \"noImplicitThis\": true,\r\n    \"noUnusedLocals\": true,\r\n    \"noUnusedParameters\": true,\r\n    \"resolveJsonModule\": true,\r\n    \"strict\": true,\r\n    \"strictNullChecks\": true,\r\n    \"strictPropertyInitialization\": true,\r\n    \"stripInternal\": true,\r\n    \"target\": \"ES2018\",\r\n    \"incremental\": true,\r\n    \"skipLibCheck\": true\r\n  },\r\n  \"ts-node\": {\r\n    \"require\": [\"tsconfig-paths/register\"]\r\n  },\r\n  \"include\": [\"**/*.ts\"],\r\n  \"exclude\": [\"node_modules\", \"cdktf.out\"]\r\n}\r\n```\r\n\r\nError I get when running `npm run synth -- --json`\r\n```\r\n[2023-01-14T15:43:03.640] [ERROR] default - Error: Validation failed with the following errors:\r\n  [k8s] Found resources without a matching provider construct. Please make sure to add provider constructs [e.g. new RandomProvider(...)] to your stack 'k8s' for the following providers: proxmox\r\n    at K8sStack.runAllValidations (/Users/acdoussan/git/homelab/terraform/node_modules/cdktf/lib/terraform-stack.ts:342:13)\r\n    at StackSynthesizer.synthesize (/Users/acdoussan/git/homelab/terraform/node_modules/cdktf/lib/synthesize/synthesizer.ts:30:18)\r\n    at /Users/acdoussan/git/homelab/terraform/node_modules/cdktf/lib/app.ts:129:49\r\n    at Array.forEach (<anonymous>)\r\n    at HomelabApp.synth (/Users/acdoussan/git/homelab/terraform/node_modules/cdktf/lib/app.ts:129:12)\r\n    at Object.<anonymous> (/Users/acdoussan/git/homelab/terraform/main.ts:4:5)\r\n    at Module._compile (node:internal/modules/cjs/loader:1105:14)\r\n    at Module.m._compile (/Users/acdoussan/git/homelab/terraform/node_modules/ts-node/src/index.ts:1618:23)\r\n    at Module._extensions..js (node:internal/modules/cjs/loader:1159:10)\r\n    at Object.require.extensions.<computed> [as .ts] (/Users/acdoussan/git/homelab/terraform/node_modules/ts-node/src/in\r\nERROR: cdktf encountered an error while synthesizing\r\n```\r\n\r\n### References\r\n","comments":[{"id":"IC_kwDODd1Amc5TZ2p4","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"A sort of workaround could be to create a function that creates the provider so that the configuration is one spot and you just need to call it from each stack.","createdAt":"2023-01-21T16:46:05Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2489#issuecomment-1399286392","viewerDidAuthor":false}],"createdAt":"2023-01-14T22:19:58Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":2489,"title":"Allow providers to be defined globally on the app, rather than in each stack","updatedAt":"2023-07-13T15:32:21Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjI2NzQ1MTUw","is_bot":false,"login":"acdoussan","name":""},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nCurrently, [the docs](https://developer.hashicorp.com/terraform/tutorials/cdktf/cdktf-install) (and default project template after running `cdktf init`) require `cdktf-cli` to be installed globally. This defeats the purpose of npm's package management, where every project contains all its dependencies and can be repeatably built in different environments.\r\n\r\nCurrently, if there is a breaking change to the way `cdktf-cli` works, and I create a new template, but also have to work with an existing template, I would have to uninstall / reinstall `cdktf-cli` each time I want to switch which package I am working on, or manually add `cdktf-cli` as a dependency for each project, and uninstall it globally.\r\n\r\nI am proposing two changes:\r\n- Update the docs to use `npx` rather than instructing users to install `cdktf-cli` globally\r\n  - See references for what it takes to make this work, but this should look something like `npx create-react-app` but for cdktf. So, for example, `npx cdktf-init`\r\n- Update the project template from `cdktf init` to depend on `cdktf-cli` directly in its dependencies.\r\n\r\nThis should be pretty straightforward, but requires a new repository / published npm package that y'all should create.\r\n\r\n### References\r\n\r\nhttps://blog.deepgram.com/npx-script/","comments":[{"id":"IC_kwDODd1Amc5Sbjiv","author":{"login":"acdoussan"},"authorAssociation":"NONE","body":"This would also probably require updating [other documentation](https://developer.hashicorp.com/terraform/tutorials/cdktf/cdktf-install#deploy-container) as well as these run the global cli. Best path would likely be to add a `\"cdktf\": \"cdktf\"` script to the template, and then update the documentation to be `npm run cdktf -- deploy` or equivalent.","createdAt":"2023-01-14T22:56:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2488#issuecomment-1382955183","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5ScsC6","author":{"login":"acdoussan"},"authorAssociation":"NONE","body":"also might be good to expose the whole cdktf cli instead of just the init functionality (basically `npx cdktf` instead of `npx cdktf-init`)","createdAt":"2023-01-15T21:02:59Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2488#issuecomment-1383252154","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5SeW2z","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @acdoussan ğŸ‘‹\r\nThank you for proposing this! This would be very helpful for folks switching between different projects regularly.\r\n\r\nThat said, it is already possible to install the `cdktf-cli` as a dependency in the `package.json`, actually our `typescript` init template already does this and adds e.g. the `npm run synth` command ([source](https://github.com/hashicorp/terraform-cdk/blob/main/packages/cdktf-cli/templates/typescript/package.json#L11)) that will invoke that dependency.\r\n\r\nHowever, as we're supporting multiple other languages and adding a `package.json` to a Python project would not feel natural to Python users, that path forward does not really work outside of TypeScript.\r\n\r\nI still think we should find an answer to simplify working with multiple different CDKTF versions. However, I'm not sure whether `npx` would be the right way forward (at least as a recommendation; it already works today, try e.g. `npx cdktf-cli@0.14.0 --version`).\r\n\r\nAn alternative approach could be to change the `cdktf-cli` into a thin wrapper that determines a projects CDKTF version and uses the right `cli` package for that version.","createdAt":"2023-01-16T08:57:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2488#issuecomment-1383689651","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5SgzJ7","author":{"login":"acdoussan"},"authorAssociation":"NONE","body":"Heya!\r\n\r\nYeah, was mostly focusing on the typescript implementation. You're right there is a script for it, but `cdktf-cli` is not added to [the dependencies](https://github.com/hashicorp/terraform-cdk/blob/main/packages/cdktf-cli/templates/typescript/.hooks.sscaff.js#L15), so it still requires the cli to be installed globally to work.\r\n\r\nDef agree it would be weird to have a package.json for other projects. Maybe the default for those is a bash script, or something language specific, that runs a determined cli version using `npx`? It looks like y'all already assume most people will install it via npm, so shouldn't be much different, other than not having to install it globally.","createdAt":"2023-01-16T17:01:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2488#issuecomment-1384329851","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Sg4CE","author":{"login":"acdoussan"},"authorAssociation":"NONE","body":"Also, you can run it with npx like that, but it still requires the package to be installed. Usually `npx` scripts don't require things to be installed to run.\r\n\r\nExample output I get:\r\n```\r\n$ npx cdktf-cli@0.14.0 --version\r\nNeed to install the following packages:\r\n  cdktf-cli@0.14.0\r\nOk to proceed? (y) \r\n```","createdAt":"2023-01-16T17:16:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2488#issuecomment-1384349828","viewerDidAuthor":false}],"createdAt":"2023-01-14T22:05:56Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":2488,"title":"Install cdktf-cli as part of TS template instead of relying on global installation","updatedAt":"2023-01-19T16:12:34Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUwNDM3ODA=","is_bot":false,"login":"blairham","name":"Blair Hamilton"},"body":"### cdktf & Language Versions\r\n```\r\nlanguage: typescript\r\ncdktf-cli: 0.14.3\r\nnode: v16.15.1\r\ncdktf: 0.14.3\r\nconstructs: 10.1.215\r\nterraform: 1.1.7\r\n```\r\n\r\n### Affected Resource(s)\r\n* CDKTF Typescript\r\n\r\n```\r\n    const tags = new TerraformVariable(this, \"default_tags\", {\r\n      type: \"map\",\r\n      default: {\r\n        BusinessOwner: \"Magoo\",\r\n        Environment: \"sbx\",\r\n        Deployment: \"Terraform\",\r\n      },\r\n    });\r\n```\r\n\r\n### Expected Behavior\r\nWhen creating a `map` TerraformVariable, it should not modify the keys as the module expects specific case-sensitive values.\r\n\r\nIn `cdktf.json` ,\r\n```\r\n  \"variable\": {\r\n    \"default_tags\": {\r\n      \"default\": {\r\n        \"BusinessOwner\": \"Magoo\",\r\n        \"Deployment\": \"Terraform\",\r\n        \"Environment\": \"sbx\",\r\n      },\r\n      \"type\": \"map\"\r\n    }\r\n```\r\n\r\n### Actual Behavior\r\nWhen creating a `map` TerraformVariable, I the keys are changed to snake case.\r\n```\r\n  \"variable\": {\r\n    \"default_tags\": {\r\n      \"default\": {\r\n        \"business_owner\": \"Magoo\",\r\n        \"deployment\": \"Terraform\",\r\n        \"environment\": \"sbx\",\r\n      },\r\n      \"type\": \"map\"\r\n    }\r\n```\r\n\r\n### Steps to Reproduce\r\n* run Synth\r\n* look at cdktf.json output","comments":[{"id":"IC_kwDODd1Amc5TZ2aO","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"This sort of thing was briefly mentioned in https://github.com/hashicorp/terraform-cdk/pull/2446#pullrequestreview-1227833208.\r\nShould probably just remove the `keysToSnakeCase` function and explicitly set in the few places where it is still needed.","createdAt":"2023-01-21T16:39:49Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2473#issuecomment-1399285390","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc57Bflj","author":{"login":"marcel-tomate"},"authorAssociation":"NONE","body":"Also running into this problem with my custom provider, which is using `schema.MapAttribute`  and it will transform my keys from kebab-case to snake_case, which will break things. \r\nFor now I can workaround with this:\r\n```\r\nconst ipamProvider = new provider.IpamProvider(\r\n      this,\r\n      \"ipamProvider\"\r\n      // {\r\n      //   // will result in wrong keys:\r\n      //   staticAssignments: data.staticAssignments,\r\n      // }\r\n    );\r\n\r\n    // Hotfix https://github.com/hashicorp/terraform-cdk/pull/395#issuecomment-822786292\r\n    ipamProvider.addOverride(\"static_assignments\", data.staticAssignments);\r\n```","createdAt":"2024-04-18T14:18:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2473#issuecomment-2063989091","viewerDidAuthor":false}],"createdAt":"2023-01-10T21:45:44Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":2473,"title":"Synth changing TerraformVariable map keys to snake case","updatedAt":"2024-04-18T14:18:40Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nCurrently both finding the problem / potential errors and isolating error causes is a problem when debugging.\r\nI would suggest us thinking in the direction of a Debugging Construct, e.g. that catches the error and prints it and increases the internal log levels of synth-time logs within its scope or functions that add meta-data to certain values that improve debugability, e.g. add context that a certain value is not expected to be a token, etc.\r\n\r\n\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n\r\n- The Rust web framework [Axum](https://github.com/tokio-rs/axum) uses a macro on handler functions called [`debug_handler`](https://docs.rs/axum-macros/0.3.1/axum_macros/attr.debug_handler.html) to make errors thrown from the compiler in this section\r\n- Rust has the concepts of [marker traits](https://doc.rust-lang.org/std/marker/index.html). These are interfaces to implement on a custom type to indicate certain behaviour \r\n","comments":[],"createdAt":"2023-01-10T13:49:48Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM1OTU1Nzk1","name":"ux/debugging","description":"","color":"2703FD"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":2470,"title":"Improve debugging by special debugging constructs / functions","updatedAt":"2023-01-10T13:49:48Z"},{"assignees":[],"author":{"id":"U_kgDOBhgAOg","is_bot":false,"login":"Abhishek-singhcoupa","name":""},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\nlanguage: python\r\ncdktf-cli: 0.13.3\r\nnode: v18.12.1\r\ncdktf: 0.13.3\r\nconstructs: 10.1.188\r\njsii: 1.72.0\r\nterraform: 1.1.9\r\narch: x64\r\nos: darwin 22.2.0\r\npython: Python 3.10.8\r\npip: pip 22.3.1 from /usr/local/lib/python3.10/site-packages/pip (python 3.10)\r\npipenv: pipenv, version 2022.9.24\r\n\r\n\r\n### Affected Resource(s)\r\n\r\n<!--- Please list the affected resources. --->\r\nwafv2 RuleGroup , Rules\r\n\r\n### Debug Output\r\n\r\ndeploy fails with error - \r\n\r\n********************\r\n\r\n[ERROR] default - â•·\r\nâ”‚ Error: creating WAFv2 RuleGroup (test-cdk): WAFInvalidParameterException: Error reason: EXACTLY_ONE_CONDITION_REQUIRED, field: STATEMENT, parameter: Statement\r\nâ”‚ {\r\nâ”‚   RespMetadata: {\r\nâ”‚     StatusCode: 400,\r\nâ”‚     RequestID: \"7beaebeb-dc61-460d-9c47-10a9188b56eb\"\r\nâ”‚   },\r\nâ”‚   Field: \"STATEMENT\",\r\nâ”‚   Message_: \"Error reason: EXACTLY_ONE_CONDITION_REQUIRED, field: STATEMENT, parameter: Statement\",\r\nâ”‚   Parameter: \"Statement\",\r\nâ”‚   Reason: \"You have used none or multiple values for a field that requires exactly one value.\"\r\nâ”‚ }\r\nâ”‚\r\nâ”‚   with aws_wafv2_rule_group.test-rg-cdk,\r\nâ”‚   on cdk.tf .json line 69, in resource.aws _wafv2_rule_group.test-rg-cdk:\r\nâ”‚   69:       }\r\n\r\n**************\r\n\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\n\r\n### Expected Behavior\r\n\r\nThe rule statement should be present.\r\n\r\n### Actual Behavior\r\n\r\nstatement is blank, making the deploy fail.\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Please list the steps required to reproduce the issue. --->\r\nUse cdktf python , main.py definition - \r\n\r\n*****\r\n```\r\n#!/usr/bin/env python\r\nfrom pickle import NONE\r\nimport profile\r\nfrom typing import Sequence\r\nfrom constructs import Construct\r\nfrom cdktf import App, TerraformStack, TerraformOutput, Token, Fn\r\nfrom imports.aws.provider import AwsProvider\r\nfrom imports.aws import fms_policy, wafv2_rule_group\r\nimport json\r\n\r\n\r\nclass MyStack(TerraformStack):\r\n    def __init__(self, scope: Construct, id: str):\r\n        super().__init__(scope, id)\r\n        \r\n        # Creating wafv2_rule_group\r\n        AwsProvider(self, \"AWS\", region=\"xxx\", profile='xxx')\r\n\r\n        wrg=wafv2_rule_group.Wafv2RuleGroup(self, \r\n        id_='test-rg-cdk',\r\n        visibility_config={\r\n            \"sampled_requests_enabled\": True,\r\n            \"cloudwatch_metrics_enabled\": True,\r\n            \"metric_name\": \"test-metric\"\r\n        },\r\n        description=\"Test rg from cdk\",\r\n        capacity=80,\r\n        name='test-cdk',\r\n        scope='REGIONAL',\r\n        rule=[\r\n            {\r\n                \"name\": \"body_size_constraint\",\r\n                \"priority\": 0,\r\n                \"statement\": {\r\n                    \"size_constraint_statement\": {\r\n                        \"field_to_match\": {\r\n                            \"body\": {}\r\n                        },\r\n                        \"comparison_operator\": \"GT\",\r\n                        \"size\": 8192,\r\n                        \"text_transformation\": [\r\n                            {\r\n                            \"priority\": 0,\r\n                            \"type\": \"NONE\"\r\n                            }\r\n                        ]\r\n                    }\r\n                },\r\n                \"action\": {\r\n                    \"count\": {}\r\n                },\r\n                \"visibilityConfig\": {\r\n                    \"sampledRequestsEnabled\": True,\r\n                    \"cloudwatchMetricsEnabled\": True,\r\n                    \"metricName\": \"body_size_constraint\"\r\n                }\r\n            }\r\n        ],\r\n        tags={\r\n            \"name\":\"waf-fms-policy-cdk\",\r\n            \"Managedby\":\"CDK Terraform\"\r\n        })\r\n\r\n\r\n\r\n\r\napp = App()\r\nMyStack(app, \"coupa-waf-cdk\")\r\n\r\napp.synth()\r\n```\r\n\r\n\r\n******\r\n\r\nRun cdktf deploy\r\n\r\n\r\n###  Refer the below cdk.tf.json output file -- showing blank statement line-39-\r\n\r\n```\r\n{\r\n  \"//\": {\r\n    \"metadata\": {\r\n      \"backend\": \"local\",\r\n      \"stackName\": \"waf-cdk\",\r\n      \"version\": \"0.13.3\"\r\n    },\r\n    \"outputs\": {\r\n    }\r\n  },\r\n  \"provider\": {\r\n    \"aws\": [\r\n      {\r\n        \"profile\": \"xx\",\r\n        \"region\": \"xxx\"\r\n      }\r\n    ]\r\n  },\r\n  \"resource\": {\r\n    \"aws_wafv2_rule_group\": {\r\n      \"test-rg-cdk\": {\r\n        \"//\": {\r\n          \"metadata\": {\r\n            \"path\": \"waf-cdk/test-rg-cdk\",\r\n            \"uniqueId\": \"test-rg-cdk\"\r\n          }\r\n        },\r\n        \"capacity\": 80,\r\n        \"description\": \"Test rg from cdk\",\r\n        \"name\": \"test-cdk\",\r\n        \"rule\": [\r\n          {\r\n            \"action\": {\r\n              \"count\": {\r\n              }\r\n            },\r\n            \"name\": \"body_size_constraint\",\r\n            \"priority\": 0,\r\n            \"statement\": {\r\n            },\r\n            \"visibility_config\": {\r\n              \"cloudwatch_metrics_enabled\": true,\r\n              \"metric_name\": \"body_size_constraint\",\r\n              \"sampled_requests_enabled\": true\r\n            }\r\n          }\r\n        ],\r\n        \"scope\": \"REGIONAL\",\r\n        \"tags\": {\r\n          \"Managedby\": \"CDK Terraform\",\r\n          \"name\": \"waf-fms-policy-cdk\"\r\n        },\r\n        \"visibility_config\": {\r\n          \"cloudwatch_metrics_enabled\": true,\r\n          \"metric_name\": \"test-metric\",\r\n          \"sampled_requests_enabled\": true\r\n        }\r\n      }\r\n    }\r\n  },\r\n  \"terraform\": {\r\n    \"backend\": {\r\n      \"local\": {\r\n        \"path\": \"/xxxx/terraform.coupa-waf-cdk.tfstate\"\r\n      }\r\n    },\r\n    \"required_providers\": {\r\n      \"aws\": {\r\n        \"source\": \"aws\",\r\n        \"version\": \"4.46.0\"\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n","comments":[{"id":"IC_kwDODd1Amc5Srtcx","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Thanks for reporting this bug! I could reproduce it in `0.15`. I could get around it by using an [escape hatch](https://developer.hashicorp.com/terraform/cdktf/concepts/resources#escape-hatch):\r\n\r\n```py\r\nwrg.add_override('rule.0.statement', {\r\n            \"size_constraint_statement\": {\r\n                \"field_to_match\": {\r\n                    \"body\": {}\r\n                },\r\n                \"comparison_operator\": \"GT\",\r\n                \"size\": 8192,\r\n                \"text_transformation\": [\r\n                    {\r\n                        \"priority\": 0,\r\n                        \"type\": \"NONE\"\r\n                    }\r\n                ]\r\n            }\r\n        })\r\n```","createdAt":"2023-01-18T14:46:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2469#issuecomment-1387190065","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6POQWD","author":{"login":"sabinayakc"},"authorAssociation":"CONTRIBUTOR","body":"Same problem here. Cannot add multiple statements since typescript won't allow multiple properties of same key. \r\n\r\n```\r\n  statement: {\r\n              or_statement: {\r\n                statement: {\r\n                  not_statement: {\r\n                    statement: {\r\n                      geo_match_statement: {\r\n                        country_codes: [\"US\"],\r\n                      },\r\n                    },\r\n                  },\r\n                },\r\n\r\n                statement: {\r\n                 }\r\n              },\r\n            },\r\n```","createdAt":"2024-10-09T17:17:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2469#issuecomment-2402878851","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6YsEvn","author":{"login":"tianweiliu"},"authorAssociation":"NONE","body":"> Same problem here. Cannot add multiple statements since typescript won't allow multiple properties of same key.\r\n> \r\n> ```\r\n>   statement: {\r\n>               or_statement: {\r\n>                 statement: {\r\n>                   not_statement: {\r\n>                     statement: {\r\n>                       geo_match_statement: {\r\n>                         country_codes: [\"US\"],\r\n>                       },\r\n>                     },\r\n>                   },\r\n>                 },\r\n> \r\n>                 statement: {\r\n>                  }\r\n>               },\r\n>             },\r\n> ```\r\nJust found out the use should be:\r\n```\r\n  statement: {\r\n              or_statement: {\r\n                statement: [\r\n                  {\r\n                    not_statement: {\r\n                      statement: {\r\n                        geo_match_statement: {\r\n                          country_codes: [\"US\"],\r\n                        },\r\n                      },\r\n                    },\r\n                  },\r\n                  {\r\n                     and_statement: {\r\n                       statement: [\r\n                         ...\r\n                       ]\r\n                   }\r\n                ]\r\n              },\r\n            },\r\n```\r\nThis is NOT documented anywhere.\r\nSeriously, the entire WAFv2 rule documentation for typescript is a just a copy from native terraform without any needed modifications (with even the wrong modifications of statements still in camel case!).","createdAt":"2024-12-25T07:46:42Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2469#issuecomment-2561690599","viewerDidAuthor":false}],"createdAt":"2023-01-10T11:43:05Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzMxMzA4","name":"confirmed","description":"independently reproduced by an engineer on the team","color":"4B830E"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM1OTcwMTgw","name":"provider/aws","description":"Issue shows up using AWS provider","color":"396F8B"},{"id":"MDU6TGFiZWwzMTM2MjAxMTE5","name":"provider get / generation","description":"","color":"CC3938"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":2469,"title":"wafv2 rule-group - rule \"statement\" is not getting reflected in the cdk.tf.json","updatedAt":"2024-12-25T07:47:14Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjU4MjYxNg==","is_bot":false,"login":"cosminnicula","name":"Cosmin Nicula"},"body":"Don't know if this is the right place to open this type of issue, so please let me know if I should open it in another place.\r\n\r\nWhen instantiating a Vpc module, I can't specify the provider, just as I would normally specify with Terraform HCL.\r\nFor example the following HCL snippet of code does not have an equivalent in CDKTF:\r\n```\r\nresource \"aws_vpc\" \"vpc-eu-west-1\" {\r\n  ...\r\n  provider = aws.aws-eu-west-1\r\n  ...\r\n}\r\n```\r\nwhere ```aws.aws-eu-west-1``` references a provider block like the following:\r\n```\r\nprovider \"aws\" {\r\n  ...\r\n  alias = \"aws-eu-west-1\"\r\n  ...\r\n}\r\n```\r\n\r\nIs this going to be supported in the future?","comments":[{"id":"IC_kwDODd1Amc5Sr6G2","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @cosminnicula ğŸ‘‹\r\n\r\nSorry for the late reply, it seems that this issue indeed is rather related to the [CDK for Terraform](https://github.com/hashicorp/terraform-cdk) itself. This repository is about a layer that allows using AWS CDK constructs in the CDKTF â€“ using Terraform modules in CDKTF is a core functionality of CDKTF.\r\n\r\nLet my try to get this issue moved..","createdAt":"2023-01-18T15:18:38Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2515#issuecomment-1387241910","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Sr9Ui","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi again, @cosminnicula ğŸ‘‹\r\n\r\nAfter re-reading your issue, it seems that our docs are missing the explanation for how to pass a provider alias to a resource.\r\n\r\nIn CDKTF you can pass the instance of a provider construct you instantiate to a resource.\r\nTypeScript example:\r\n```ts\r\nconst provider = new LocalProvider(this, \"local\");\r\nnew File(this, \"dummy\", { provider: provider, filename: \"dummy.txt\" });\r\n```\r\n\r\nWe should definitely extend our docs to include an example of passing a provider to a resource.","createdAt":"2023-01-18T15:28:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2515#issuecomment-1387255074","viewerDidAuthor":false}],"createdAt":"2022-12-29T14:46:10Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"}],"milestone":null,"number":2515,"title":"Document how to pass a `provider` to a resource","updatedAt":"2023-02-15T16:35:48Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjg1NTExNQ==","is_bot":false,"login":"xiehan","name":"Nara Kasbergen Kwon"},"body":"### Context\r\n\r\nHashiCorp has been rolling out a policy requiring us to add a copyright notice above the license in all of our open-source repositories. See, for example, [LICENSE](https://github.com/hashicorp/terraform-cdk/blob/main/LICENSE) in this repo. The format of the copyright notice is:\r\n\r\n```\r\nCopyright (c) <-- year of repo creation --> HashiCorp, Inc.\r\n\r\n<-- rest of license text -->\r\n```\r\n\r\nHashiCorp's Engineering Services team has created `hashicorp-copywrite[bot]` to automate creating Dependabot-style PRs injecting the copyright notice at the top of each OSS license file. This practice has worked great for other teams, but not so much for us, since the majority of our projects use [Projen](https://projen.io), which manages the license file and will overwrite the changes introduced by `hashicorp-copywrite[bot]`.\r\n\r\n### What has already been done\r\n\r\nIn https://github.com/hashicorp/cdktf-aws-cdk/commit/add779b5c8257f4ad1f8d5d973538574184cd945 @ansgarm figured out how to customize the license file generated by Projen to include the copyright header. In recent weeks, I've been going through our other repositories to apply this technique to make sure we're compliant with the license policy while continuing to have the license file generation managed by Projen.\r\n\r\nIn https://github.com/cdktf/cdktf-provider-project/commit/84325ff773f3e99c857933c7b2d736cccd7bc5f2 I applied this technique with one additional modification, that allows the copyright year to be specified, because the individual pre-built provider repos technically all have different creation years. For example, [cdktf-provider-aws](https://github.com/cdktf/cdktf-provider-aws) was created in 2020, [cdktf-provider-newrelic](https://github.com/cdktf/cdktf-provider-newrelic) was created in 2021, and [cdktf-provider-salesforce](https://github.com/cdktf/cdktf-provider-salesforce) was created in 2022. However, right now, all of their LICENSE files have 2022 as the copyright year, which is the default if no override year is specified. ([example](https://github.com/cdktf/cdktf-provider-aws/blob/main/LICENSE))\r\n\r\n### What still needs to happen\r\n\r\nWe need to figure out how & where to inject the true creation/copyright year so that the licenses for each of these repos are correct.\r\n\r\nTwo options for where:\r\n- in [cdktf-provider-project](https://github.com/cdktf/cdktf-provider-project)\r\n- in [cdktf-repository-manager](https://github.com/cdktf/cdktf-repository-manager) - pass it to the individual provider repos using [the new `creationYear` option](https://github.com/cdktf/cdktf-provider-project/blob/main/API.md#creationyearoptional-)\r\n\r\nTwo options for how:\r\n- by making a call to the GitHub API to look up the creation date of the repo: https://docs.github.com/en/rest/repos/repos?apiVersion=2022-11-28#get-a-repository\r\n- by using some kind of hard-coded mapping, kind of like https://github.com/cdktf/cdktf-repository-manager/blob/main/provider.json\r\n\r\nBut maybe there are other options I haven't thought of yet!\r\n\r\n### Note\r\n\r\nI'm assigning this issue to Mark for now to have him take a stab at designing/proposing a solution, but not necessarily implementing it just yet.","comments":[],"createdAt":"2022-12-23T17:00:43Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"},{"id":"LA_kwDODd1Amc8AAAABJnHAvQ","name":"legal","description":"An issue or PR related to compliance with company policies","color":"F09F90"}],"milestone":null,"number":2449,"title":"Properly inject the copyright year in the license in pre-built provider repos","updatedAt":"2023-06-01T17:05:02Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE0MzQ4MzM5","is_bot":false,"login":"Jiafi","name":"Jordan Wolinsky"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\ncdktf version `0.14.3` Typescript\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\n### Affected Resource(s)\r\nnullResource using the `LocalExecProvisioner`.  \r\n<!--- Please list the affected resources. --->\r\n\r\n### Debug Output\r\n```typescript\r\n    new nullResource.Resource(this, 'postgresScript', {\r\n      provisioners: [\r\n        {\r\n          // Pipe system password into script as input\r\n          type: 'local-exec',\r\n          command: `psql`,\r\n          environment: {\r\n            PGPASSWORD: \"password\",\r\n          },\r\n        },\r\n      ],\r\n    });\r\n```\r\nGenerates \r\n```json\r\n            {\r\n            \"local-exec\": {\r\n              \"command\": \"psql\",\r\n              \"environment\": {\r\n                \"pgpassword\": \"passwordHere\"\r\n              }\r\n            }\r\n````\r\n### Expected Behavior\r\n```json\r\n            {\r\n            \"local-exec\": {\r\n              \"command\": \"psql\",\r\n              \"environment\": {\r\n                \"PGPASSWORD\": \"passwordHere\"\r\n              }\r\n            }\r\n```\r\n<!--- What should have happened? --->\r\n\r\n### Actual Behavior\r\n```json\r\n            {\r\n            \"local-exec\": {\r\n              \"command\": \"psql\",\r\n              \"environment\": {\r\n                \"pgpassword\": \"passwordHere\"\r\n              }\r\n            }\r\n````\r\n<!--- What actually happened? --->\r\n\r\n### Steps to Reproduce\r\nCreate a null provider and resource.\r\n```typescript\r\n    new nullProvider.NullProvider(this, 'null', {});\r\n    new nullResource.Resource(this, 'postgisAdminScript', {\r\n      provisioners: [\r\n        {\r\n          // Pipe system password into script as input\r\n          type: 'local-exec',\r\n          // If this command fails, the password is printed out locally.  Need to figure out a better way of configuring the password\r\n          command: `echo $PGPASSWORD`,\r\n          environment: {\r\n            PGPASSWORD: \"password\",\r\n          },\r\n        },\r\n      ],\r\n    });\r\n```\r\n<!--- Please list the steps required to reproduce the issue. --->\r\n\r\n### Important Factoids\r\nenvironment should respect the casing that is originally used in the `environment` `Record`.\r\n\r\nIt looks like[ all keys are being lower cased here](https://github.com/hashicorp/terraform-cdk/blob/c837a9de1306a6f3cfbd751f56a1a346386d68c5/packages/cdktf/lib/util.ts#L79-L110)\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n- #0000\r\n","comments":[{"id":"IC_kwDODd1Amc5RPL4z","author":{"login":"Jiafi"},"authorAssociation":"CONTRIBUTOR","body":"https://github.com/hashicorp/terraform-cdk/pull/2446 Potential fix.","createdAt":"2022-12-22T14:55:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2443#issuecomment-1362935347","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5RPM_4","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @Jiafi ğŸ‘‹\r\n\r\nGood catch, it seems like these lines are a bit too overambitious:\r\nhttps://github.com/hashicorp/terraform-cdk/blob/1908d763a5a676651579983100f92cb08c74777c/packages/cdktf/lib/terraform-resource.ts#L185-L189\r\n\r\nWe should confirm what exactly we need to convert there. Probably just the first layer but not deeper.\r\n\r\nThat said, you can workaround this problem using an escape hatch:\r\n```ts\r\n    new nullProvider.NullProvider(this, \"null\", {});\r\n    const adminScript = new nullResource.Resource(\r\n      this,\r\n      \"postgisAdminScript\",\r\n      {}\r\n    );\r\n    // using overrides to preserve casing of environment variables (open issue: https://github.com/hashicorp/terraform-cdk/issues/2443)\r\n    adminScript.addOverride(\"provisioner\", [\r\n      {\r\n        // Pipe system password into script as input\r\n        type: \"local-exec\",\r\n        // If this command fails, the password is printed out locally.  Need to figure out a better way of configuring the password\r\n        command: `echo $PGPASSWORD`,\r\n        environment: {\r\n          PGPASSWORD: \"password\",\r\n        },\r\n      },\r\n    ]);\r\n```","createdAt":"2022-12-22T14:59:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2443#issuecomment-1362939896","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5RPSEd","author":{"login":"Jiafi"},"authorAssociation":"CONTRIBUTOR","body":"@ansgarm Thanks for the workaround! It mostly worked but needed to be changed slightly.  Needed `local-exec` as the key.\r\n```typescript\r\n    new nullProvider.NullProvider(this, \"null\", {});\r\n    const adminScript = new nullResource.Resource(\r\n      this,\r\n      \"postgisAdminScript\",\r\n      {}\r\n    );\r\n    // using overrides to preserve casing of environment variables (open issue: https://github.com/hashicorp/terraform-cdk/issues/2443)\r\n    adminScript.addOverride('provisioner', [\r\n      {\r\n        ['local-exec']: {\r\n          command: `${postgisUserSetupScript.path} ${rds.rdsHostOutput} ${this.postgresDB} ${rds.rdsSystemUsernameOutput} ${this.postgresUser}`,\r\n          environment: {\r\n            PGPASSWORD: rds.rdsSystemPasswordOutput,\r\n          },\r\n        },\r\n      },\r\n    ]);\r\n    ","createdAt":"2022-12-22T15:16:18Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2443#issuecomment-1362960669","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5RPUZX","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Ah, whoops ğŸ˜… Glad you figured it out!","createdAt":"2022-12-22T15:25:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2443#issuecomment-1362970199","viewerDidAuthor":false}],"createdAt":"2022-12-22T01:22:09Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzMxMzA4","name":"confirmed","description":"independently reproduced by an engineer on the team","color":"4B830E"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":2443,"title":"local-exec environment populated by cdktf synth gets lowercased","updatedAt":"2023-06-01T14:31:01Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEwNDAxNzk4","is_bot":false,"login":"zmully","name":"Zack Mully"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nExisting CDKTF matchers (`.toHaveResource`, etc.) do not support testing for TerraformOutputs (I've not tried any other TerraformXXX resources).\r\n\r\nFor example, this test:\r\n```\r\n it('should create Terraform Output for key_arn', () => {\r\n    expect(\r\n      Testing.synthScope((scope) => {\r\n        const options: KmsKeyConfig = {\r\n          alias: 'test-key',\r\n          region: REGIONS.USEAST1,\r\n          accountId: ACCOUNTS['sandbox-security'],\r\n        };\r\n        new KmsKey(scope, 'KmsKeyName', options);\r\n      }),\r\n    ).toHaveResourceWithProperties(TerraformOutput, { asdf: 'test' })\r\n  });\r\n```\r\n\r\nThrows this error:\r\n```\r\nsrc/aws/kms/__tests__/index.test.ts:123:36 - error TS2345: Argument of type 'typeof TerraformOutput' is not assignable to parameter of type 'TerraformConstructor'.\r\n      Property 'tfResourceType' is missing in type 'typeof TerraformOutput' but required in type 'TerraformConstructor'.\r\n\r\n    123     ).toHaveResourceWithProperties(TerraformOutput, { asdf: 'test' })\r\n                                           ~~~~~~~~~~~~~~~\r\n\r\n      node_modules/cdktf/lib/testing/matchers.d.ts:2:14\r\n        2     readonly tfResourceType: string;\r\n                       ~~~~~~~~~~~~~~\r\n        'tfResourceType' is declared here.\r\n```\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-12-20T17:10:28Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwyNTcwMTY0OTY5","name":"testing","description":"","color":"456cc6"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMzYxMTMzNzQ3","name":"feature/snapshot-test","description":"Snapshot testing + assertion related issues","color":"006b75"}],"milestone":null,"number":2438,"title":"Add expect matcher for TerraformOutputs","updatedAt":"2023-06-02T09:07:32Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM4Njg3NTQ=","is_bot":false,"login":"jsteinich","name":"Jon Steinich"},"body":"        I don't believe this actually works\r\n\r\nin my package.json I had\r\n```\r\n  \"dependencies\": {\r\n    \"@cdktf/provider-aws\": \"^9.0.0\",\r\n    \"@cdktf/provider-null\": \"^2.0\",\r\n    \"cdktf\": \"^0.12.0\",\r\n```\r\n\r\nI upgraded my cdktf-cli to 14.3. I ran `npm uninstall cdktf`(because if I don't i also run into more issues). Update my package.json to have\r\n```\r\n  \"dependencies\": {\r\n    \"@cdktf/provider-aws\": \"^9.0.0\",\r\n    \"@cdktf/provider-null\": \"^2.0\",\r\n    **\"cdktf\": \"^0.14.3\",**\r\n```\r\nRan `npm i`\r\n\r\nNow at this point I expect to be able to run `cdktf provider upgrade aws,null` and have it update my packages and my cdktf.json for me. But instead this breaks with\r\n```\r\nÎ» cdktf provider upgrade null\r\n[2022-12-09T13:18:12.427] [ERROR] default - npm ERR! code ELSPROBLEMS\r\n\r\nnpm ERR! code ELSPROBLEMS\r\n[2022-12-09T13:18:12.429] [ERROR] default - npm ERR! invalid: cdktf@0.14.3 /$redacted/cdktf/aws/ec2-stack/node_modules/cdktf\r\n{\r\n  \"error\": {\r\n    \"code\": \"ELSPROBLEMS\",\r\n    \"summary\": \"invalid: cdktf@0.14.3 /$redacted/cdktf/aws/ec2-stack/node_modules/cdktf\",\r\n    \"detail\": \"\"\r\n  }\r\n}\r\n\r\nnpm ERR! A complete log of this run can be found in:\r\nnpm ERR!     /$redacted/.npm/_logs/2022-12-09T21_18_12_286Z-debug-0.log\r\n\r\nnpm ERR! invalid: cdktf@0.14.3 `$redacted/cdktf/aws/ec2-stack/node_modules/cdktf\r\n{\r\n  \"error\": {\r\n    \"code\": \"ELSPROBLEMS\",\r\n    \"summary\": \"invalid: cdktf@0.14.3 $redacted/cdktf/aws/ec2-stack/node_modules/cdktf\",\r\n    \"detail\": \"\"\r\n  }\r\n}\r\n\r\nnpm ERR! A complete log of this run can be found in:\r\nnpm ERR!     /$redacted/.npm/_logs/2022-12-09T21_18_12_286Z-debug-0.log\r\nError: External Error: Could not determine CDKTF version. Please make sure you are in a directory containing a CDKTF project and have all dependencies installed.\r\n    at Object.External (/opt/homebrew/Cellar/cdktf/0.14.3/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:94:41856)\r\n    at Object.ZFr (/opt/homebrew/Cellar/cdktf/0.14.3/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:492:29211)\r\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\r\n    at async qp.handleCommand (/opt/homebrew/Cellar/cdktf/0.14.3/libexec/lib/node_modules/cdktf-cli/bundle/bin/cdktf.js:54:479)\r\n    at async B.handler (/opt/homebrew/Cellar/cdktf/0.14.3/libexec/lib/node_modules/cdktf-cli/bundle/bin/cdktf.js:53:29879)\r\nCollecting Debug Information...\r\n/opt/homebrew/Cellar/cdktf/0.14.3/libexec/lib/node_modules/cdktf-cli/node_modules/yoga-layout-prebuilt/yoga-layout/build/Release/nbind.js:53\r\n        throw ex;\r\n        ^\r\n\r\nError: External Error: Could not determine CDKTF version. Please make sure you are in a directory containing a CDKTF project and have all dependencies installed.\r\n    at Object.External (/opt/homebrew/Cellar/cdktf/0.14.3/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:94:41856)\r\n    at Object.ZFr (/opt/homebrew/Cellar/cdktf/0.14.3/libexec/lib/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:492:29211)\r\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\r\n    at async qp.handleCommand (/opt/homebrew/Cellar/cdktf/0.14.3/libexec/lib/node_modules/cdktf-cli/bundle/bin/cdktf.js:54:479)\r\n    at async B.handler (/opt/homebrew/Cellar/cdktf/0.14.3/libexec/lib/node_modules/cdktf-cli/bundle/bin/cdktf.js:53:29879) {\r\n  __type: 'External'\r\n}\r\n\r\nNode.js v18.12.1\r\n```\r\n\r\nThe only way to actually upgrade is to go in, npm uninstall all my providers and then run `cdktf provider add `\r\n\r\nThis is the most cumbersome way to upgrade in (there's almost 5 steps) no way streamlined at all. Am I missing something?\r\n\r\n_Originally posted by @jin-ahn in https://github.com/hashicorp/terraform-cdk/issues/2020#issuecomment-1344794127_\r\n      ","comments":[],"createdAt":"2022-12-20T16:38:36Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"LA_kwDODd1Amc78phHg","name":"cli/provider-subcommands","description":"cdktf provider <verb> commands","color":"4CBCB0"}],"milestone":null,"number":2437,"title":"cdktf provider upgrade issues","updatedAt":"2023-09-29T12:53:23Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjgyMDAyOTI3","is_bot":false,"login":"Logankwb","name":"Logan Davies"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\nI'm using CDKTF to produce a Terraform Module for consumption by regular Terraform. As such I'm using `cdktf synth` to render Terraform JSON code.\r\n\r\nThis causes some warnings when I go to apply my workspace\r\n\r\n![image](https://user-images.githubusercontent.com/82002927/208343588-bc1d257a-2ae8-4cd2-b5a8-d19fc187ece6.png)\r\n\r\nFor now, I'm working around this by adding an override, but this removes the whole terraform block, which could cause issues if used elsewhere:\r\n```golang\r\nstack.AddOverride(jsii.String(\"terraform\"), cdktf.Token_NullValue())\r\n```\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5RC5-w","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"Related to #1518 \r\n\r\nIf you are using typescript, you may also want to take a look at https://github.com/cdktf/cdktf-tf-module-stack","createdAt":"2022-12-20T16:55:59Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2435#issuecomment-1359716272","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc577L1E","author":{"login":"marcel-tomate"},"authorAssociation":"NONE","body":"I'm encountering a similar issue. I prefer to use an 'empty' http backend, which typically defaults to using environment variables. However, this approach doesn't work with the constructs. I've found a workaround by using: stack.addOverride(\"terraform.backend\", null);. This solution allows me to maintain my own backend.tf file alongside the synthesized one.","createdAt":"2024-04-26T10:24:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2435#issuecomment-2079112516","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc69aq_7","author":{"login":"tjholm"},"authorAssociation":"NONE","body":"Setting `nil` does not work for me in `AddOverride`, nor does setting `cdktf.Token_NullValue()`. \n\nI had to implement an override as a backend implementation (I'm using go).\nhttps://aws.github.io/jsii/user-guides/lib-user/language-specific/go/\nExample:\n```go\ntype NilTerraformBackend struct {\n\tcdktf.TerraformBackend\n}\n\nfunc (t *NilTerraformBackend) ToTerraform() interface{} {\n\treturn map[string]interface{}{}\n}\n\nfunc NewNilTerraformBackend(app constructs.Construct, name *string) *NilTerraformBackend {\n\tbackend := &NilTerraformBackend{}\n\n\tcdktf.NewTerraformBackend_Override(backend, app, jsii.String(\"nil\"), name)\n\n\treturn backend\n}\n```\nThen create it as part of my stack.\n\nThis makes sure the `terraform.backend` key is never generated in the output.","createdAt":"2025-08-12T06:29:23Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2435#issuecomment-3177885691","viewerDidAuthor":false}],"createdAt":"2022-12-19T03:47:13Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMDEzNzM4ODIw","name":"needs-research","description":"","color":"709F22"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"LA_kwDODd1Amc7iaeox","name":"feature/cdktf-as-module-source","description":"When CDKTF is used to build Terraform Modules used in plain Terraform","color":"C31CA3"}],"milestone":null,"number":2435,"title":"Add support for no backend","updatedAt":"2025-08-12T22:20:58Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEyNDA2NQ==","is_bot":false,"login":"shishkin","name":"Sergey Shishkin"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\nCDKTF 0.14.3, TypeScript\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\n### Affected Resource(s)\r\n\r\n`Fn.yamlencode` used to output static YAML with some custom annotations:\r\n\r\n```typescript\r\nnew TerraformOutput(this, \"test\", {\r\n  value: Fn.yamlencode({\r\n    ingress: {\r\n      enabled: true,\r\n      annotations: {\r\n        \"ingress.pomerium.io/allow_public_unauthenticated_access\": \"true\",\r\n      },\r\n    },\r\n  }),\r\n});\r\n```\r\n\r\n### Debug Output\r\n\r\n<details>\r\n<summary>Output</summary>\r\n\r\n```\r\n1 Stack deploying     0 Stacks done     0 Stacks waiting\r\n[2022-12-18T19:56:56.285] [ERROR] default - â•·\r\nâ”‚ Error: Reference to undeclared resource\r\nâ”‚\r\nâ”‚   on cdk.tf.json line 16, in output.test:\r\nâ”‚   16:       \"value\": \"${yamlencode({ingress = {enabled = true, annotations = {ingress.pomerium.io/allow_public_unauthenticated_access = \\\"true\\\"}}})}\"\r\nâ”‚\r\nâ”‚ A managed resource \"ingress\" \"pomerium\" has not been declared in the root\r\ntest  â•·\r\n      â”‚ Error: Reference to undeclared resource\r\n      â”‚\r\n      â”‚   on cdk.tf.json line 16, in output.test:\r\n      â”‚   16:       \"value\": \"${yamlencode({ingress = {enabled = true, annotations = {ingress.pomerium.io/allow_public_unauthenticated_access = \\\"true\\\"}}})}\"\r\n      â”‚\r\n      â”‚ A managed resource \"ingress\" \"pomerium\" has not been declared in the root\r\n      â”‚ module.\r\n      â•µ\r\n```\r\n</details>\r\n\r\n<details>\r\n<summary>cdk.tf.json</summary>\r\n\r\n```json\r\n{\r\n  \"//\": {\r\n    \"metadata\": {\r\n      \"backend\": \"local\",\r\n      \"stackName\": \"test\",\r\n      \"version\": \"0.14.3\"\r\n    },\r\n    \"outputs\": {\r\n      \"test\": {\r\n        \"test\": \"test\"\r\n      }\r\n    }\r\n  },\r\n  \"output\": {\r\n    \"test\": {\r\n      \"value\": \"${yamlencode({ingress = {enabled = true, annotations = {ingress.pomerium.io/allow_public_unauthenticated_access = \\\"true\\\"}}})}\"\r\n    }\r\n  },\r\n  \"provider\": {\r\n    \"kubernetes\": [\r\n      {\r\n      }\r\n    ]\r\n  },\r\n  \"terraform\": {\r\n    \"backend\": {\r\n      \"local\": {\r\n        \"path\": \"/path/to/project/terraform.test.tfstate\"\r\n      }\r\n    },\r\n    \"required_providers\": {\r\n      \"kubernetes\": {\r\n        \"source\": \"kubernetes\",\r\n        \"version\": \"2.16.1\"\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n</details>\r\n\r\n### Expected Behavior\r\n\r\nAnnotations should be treated as static YAML dictionary keys.\r\n\r\n### Actual Behavior\r\n\r\nCDKTF tries to interpret annotations as resources.\r\n","comments":[{"id":"IC_kwDODd1Amc5RPH3h","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @shishkin ğŸ‘‹\r\n\r\nThank you for reporting this! This seems to be a bug when passing objects with keys that need escaping into `Fn` functions.\r\n\r\nI confirmed this locally and found a workaround using `TerraformLocal` that you can use until this is fixed.\r\n\r\n```typescript\r\n    const local = new TerraformLocal(this, \"local\", {\r\n      ingress: {\r\n        enabled: true,\r\n        annotations: {\r\n          \"ingress.pomerium.io/allow_public_unauthenticated_access\": \"true\",\r\n        },\r\n      },\r\n    });\r\n\r\n    new TerraformOutput(this, \"test\", {\r\n      value: Fn.yamlencode(local.asAnyMap),\r\n    });\r\n```","createdAt":"2022-12-22T14:40:30Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2434#issuecomment-1362918881","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5RPU7H","author":{"login":"shishkin"},"authorAssociation":"NONE","body":"Thanks a lot for this workaround @ansgarm! Look forward to this being fixed too.","createdAt":"2022-12-22T15:27:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2434#issuecomment-1362972359","viewerDidAuthor":false}],"createdAt":"2022-12-18T19:09:13Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzMxMzA4","name":"confirmed","description":"independently reproduced by an engineer on the team","color":"4B830E"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjM2NDcwNTQ1","name":"feature/tokens","description":"","color":"58CF13"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":2434,"title":"Reference to undeclared resource","updatedAt":"2023-06-01T14:31:01Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEyNDA2NQ==","is_bot":false,"login":"shishkin","name":"Sergey Shishkin"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\ncdktf 0.14.1 with TypeScript\r\n\r\nUPDATE: Same behavior in 0.14.3.\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and pre-built provider you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\n### Affected Provider / Resource(s)\r\n\r\n@cdktf/provider-kubernetes\r\n\r\nTried on ConfigMapV1 and SecretV1\r\n\r\n<!--- Please list the affected resources. --->\r\n\r\n### Debug Output\r\n\r\nhttps://gist.github.com/shishkin/1c6b19a7e1c6fb92f2734a694c7b3013#file-output\r\n\r\n### Expected Behavior\r\n\r\nExpected the `clusterPortHttps` variable replaced with its value in the resulting config map resource.\r\n\r\n### Actual Behavior\r\n\r\n`var.CLUSTER_PORT_HTTPS` is output inside resulting config map resource.\r\n\r\n### Steps to Reproduce\r\n\r\nhttps://gist.github.com/shishkin/1c6b19a7e1c6fb92f2734a694c7b3013#file-stack-ts\r\n\r\n### Important Factoids\r\n\r\nNumeric variable value is output correctly when put inside `TerraformOutput` construct. String variable `clusterDomain` is output correctly inside both config map resource and `TerraformOutput`.\r\n\r\nUPDATE: Also the port number is output in the config map resource correctly when its value is referred to via `.stringValue` or `.value` instead of typed `.numberValue`.\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5QVwo-","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @shishkin ğŸ‘‹\r\n\r\nThis seems weird. Would you mind sharing the `cdk.tf.json` file that is generated in the `cdktf.out/<your stack>` directory? I'm curious what the interpolated string looks like in there.","createdAt":"2022-12-13T07:51:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2420#issuecomment-1347881534","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5QV_H-","author":{"login":"shishkin"},"authorAssociation":"NONE","body":"@ansgarm I've put it in the gist: https://gist.github.com/shishkin/1c6b19a7e1c6fb92f2734a694c7b3013#file-cdk-tf-json-L36\r\n\r\nIndeed, the string interpolation syntax seems missing for the numeric variable:\r\n\r\n```json\r\n\"data\": {\r\n  \"config\": \"${yamlencode({url = \\\"https://${var.CLUSTER_DOMAIN}:var.CLUSTER_PORT_HTTPS/\\\"})}\"\r\n},\r\n```","createdAt":"2022-12-13T08:45:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2420#issuecomment-1347940862","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5QW2d1","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Yup, seems like a bug on our end ğŸ‘ Thanks for reporting!\r\n\r\nAs using `variable.stringValue` works as a workaround, it is luckily not that pressing but still something we need to tackle ğŸ›","createdAt":"2022-12-13T10:43:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2420#issuecomment-1348167541","viewerDidAuthor":false}],"createdAt":"2022-12-12T17:00:29Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"},{"id":"MDU6TGFiZWwzMjM2NDcwNTQ1","name":"feature/tokens","description":"","color":"58CF13"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":2420,"title":"TerraformVariable of number type doesn't get replaced","updatedAt":"2023-06-01T14:32:38Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjU5NzU0OQ==","is_bot":false,"login":"andrewbaxter","name":"Andrew Baxter"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n```\r\n    <dependency>\r\n      <groupId>com.hashicorp</groupId>\r\n      <artifactId>cdktf</artifactId>\r\n      <version>0.14.1</version>\r\n    </dependency>\r\n```\r\n\r\nnode `v18.12.1`\r\nnpm `8.19.2`\r\n\r\nI think all other versions are in the debug output below.\r\n\r\n### Affected Resource(s)\r\n\r\nThis is `stripe_product` in `andrewbaxter/terraform-provider-stripe`\r\n\r\n### Debug Output\r\n\r\nhttps://gist.github.com/andrewbaxter/57279456f0c8eff22f44dbcd3045423c\r\n\r\n### Expected Behavior\r\n\r\nIn addition to the missing required field, I'd expect the message to include\r\n- Resource id\r\n- Resource type\r\n- Stack id\r\n\r\n### Actual Behavior\r\n\r\nError message only relays the missing field, with no other context.\r\n\r\n### Steps to Reproduce\r\n\r\n### Important Factoids\r\n\r\nThis is a provider I'm developing, so there may be issues with the provider too.\r\n\r\n### References","comments":[{"id":"IC_kwDODd1Amc5PDKTt","author":{"login":"andrewbaxter"},"authorAssociation":"NONE","body":"Looking more closely, now that I know the source `Product` does appear in the stack trace, but I'd expect spec issues to be caught and nicely formatted rather than result in a crash with 2 stack dumps.","createdAt":"2022-11-24T10:08:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2340#issuecomment-1326228717","viewerDidAuthor":false}],"createdAt":"2022-11-24T10:06:18Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyNjMzNjk4NzAy","name":"language/java","description":"","color":"E38858"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM1OTU1Nzk1","name":"ux/debugging","description":"","color":"2703FD"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"}],"milestone":null,"number":2340,"title":"Java, missing required field error is unclear","updatedAt":"2022-12-02T09:31:43Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjU2MzMwMQ==","is_bot":false,"login":"mihok","name":"Matthew Mihok"},"body":"### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n### Description\r\n\r\nCurrently tokens are forced into strings, and `dependsOn` or `addOverride` resolves these down to templated strings, which are not allowed. Where a block of code such as this:\r\n\r\n```typescript\r\n    const account = new ServiceAccount(scope, `${name}-account`, {\r\n      accountId: name,\r\n      description: \"Generated by Terraform\",\r\n    });\r\n\r\n    const key = new ServiceAccountKey(scope, `${name}-key`, {\r\n      serviceAccountId: account.id,\r\n      publicKeyType: \"TYPE_RAW_PUBLIC_KEY\",\r\n    });\r\n\r\n    key.dependsOn = [ account.id ];\r\n```\r\n\r\nWhich results in the following error from terraform:\r\n\r\n```\r\nâ”‚ Error: Invalid expression\r\nâ”‚ \r\nâ”‚   on cdk.tf.json line 102, in resource.google_service_account_key.logging-robot-key.depends_on:\r\nâ”‚  102:           \"${google_service_account.logging-robot-account.id}\",\r\nâ”‚ \r\nâ”‚ A single static variable reference is required: only attribute access and\r\nâ”‚ indexing with constant keys. No calculations, function calls, template\r\nâ”‚ expressions, etc are allowed here.\r\n```\r\n\r\nThere needs to be a simple way for people to reference the object without templated strings.\r\n\r\nIdeally, this might be as simple as having some kind of `toUntemplatedString` (ugly, not set on the name of the function/property)\r\n\r\nSo the above code would look something along the lines of:\r\n\r\n```typescript\r\n    const account = new ServiceAccount(scope, `${name}-account`, {\r\n      accountId: name,\r\n      description: \"Generated by Terraform\",\r\n    });\r\n\r\n    const key = new ServiceAccountKey(scope, `${name}-key`, {\r\n      serviceAccountId: account.id,\r\n      publicKeyType: \"TYPE_RAW_PUBLIC_KEY\",\r\n    });\r\n\r\n    key.dependsOn = [ account.idRaw ];\r\n```\r\n\r\nWhich result in a cdk.tf.json:\r\n\r\n```json\r\n \r\n \"depends_on\": [\r\n   \"google_service_account.logging-robot-account.id\"\r\n ]\r\n\r\n```\r\n\r\nHappy to do some of the implementation if it helps!\r\n","comments":[{"id":"IC_kwDODd1Amc5O9hF6","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @mihok ğŸ‘‹\r\n\r\nAs you're using `account.id` in the key, Terraform should be able to automatically figure out the dependency between those two resources (you don't need to specify the dependency).\r\nThat said, if you would need to define the dependency, usually you would pass the whole resource into the `dependsOn` property: `key.dependsOn = [account]` (like done in [HCL](https://developer.hashicorp.com/terraform/language/meta-arguments/depends_on))","createdAt":"2022-11-23T09:13:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2334#issuecomment-1324749178","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5O-3KT","author":{"login":"mihok"},"authorAssociation":"NONE","body":"Thanks for looking at this @ansgarm, I reran the codebase with the instructions you have given me but Typescript suggests the value for dependsOn must be an array of strings, which is why I created this bug\r\n","createdAt":"2022-11-23T13:55:21Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2334#issuecomment-1325101715","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5O_DCu","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Ah, got it. That's something we should check then ğŸ¤”\r\nI came up with this because of this example which passes the resource construct:\r\nhttps://github.com/hashicorp/terraform-cdk/blob/217b7398fcc470d618f16f1095c3a88f69d6baeb/examples/typescript/google/main.ts#L46\r\n(we run examples in CI, so it should fail if TypeScript does not like that)","createdAt":"2022-11-23T14:24:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2334#issuecomment-1325150382","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5O_E9I","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Okay, there seems to be an inconsistency between dependencies passed via the initial config (like in the example I posted) and setting the property later on.\r\n\r\nThis extra bit happens if `dependsOn` is defined in the config:\r\nhttps://github.com/hashicorp/terraform-cdk/blob/217b7398fcc470d618f16f1095c3a88f69d6baeb/packages/cdktf/lib/terraform-resource.ts#L95-L99\r\n\r\nSo, the proper way in your case would be to call:\r\n```ts\r\nimport { dependable } from \"cdktf\";\r\n// ...\r\nkey.dependsOn = [dependable(account)]\r\n```\r\n\r\nBut I agree that this could use some more docs (at least inline docstrings on the `dependsOn` property; ideally some section in our [docs](https://developer.hashicorp.com/terraform/cdktf)).","createdAt":"2022-11-23T14:30:37Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2334#issuecomment-1325158216","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5PJEDV","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"Ideally setting after would also work with passing the entire object rather than needing to turn into a string. Can certainly improve documentation either way, but not requiring extra steps when late setting seems preferable.","createdAt":"2022-11-25T18:33:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":4}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2334#issuecomment-1327775957","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6BxfTX","author":{"login":"edwardch-ibotta"},"authorAssociation":"NONE","body":"is `dependable` something exposed in non-type script versions of the cdk?","createdAt":"2024-06-18T23:10:57Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2334#issuecomment-2177234135","viewerDidAuthor":false}],"createdAt":"2022-11-22T22:29:49Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":2334,"title":"Inconsistent behaviour of `dependsOn` if set via initial resource config vs. via `resource.dependsOn`","updatedAt":"2024-06-18T23:10:59Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjI0ODA5ODQz","is_bot":false,"login":"RyanSiu1995","name":"Ryan, Siu Long Wa"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n`cdktf==0.13.3` in python\r\n\r\n### Affected Resource(s)\r\n<!--- Please list the affected resources. --->\r\n`Testing.to_have_resource_with_properties` is the function not working as expected.\r\n\r\n### Debug Output\r\n\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\n```\r\n(Pdb) Testing.to_have_resource_with_properties(synthesized, CDKRepository.TF_RESOURCE_TYPE, { \"name\": \"test333\" })\r\nTrue\r\n(Pdb) Testing.to_have_resource_with_properties(synthesized, CDKRepository.TF_RESOURCE_TYPE, { \"name\": \"test333\" , \"default_branch\": \"x\"})\r\nFalse\r\n(Pdb) Testing.to_have_resource_with_properties(synthesized, CDKRepository.TF_RESOURCE_TYPE, { \"name\": \"test333\" , \"default_branch\": \"master\"})\r\nTrue\r\n(Pdb) Testing.to_have_resource_with_properties(synthesized, CDKRepository.TF_RESOURCE_TYPE, { \"name\": \"test333\" , \"default_branch\": None})\r\nTrue\r\n(Pdb) Testing.to_have_resource_with_properties(synthesized, CDKRepository.TF_RESOURCE_TYPE, { \"name\": \"test333\" , \"default_branch\": None})\r\nTrue\r\n(Pdb) synthesized\r\n'{\\n  \"resource\": {\\n    \"github_repository\": {\\n      \"test333\": {\\n        \"default_branch\": \"master\",\\n        \"name\": \"test333\"\\n      }\\n    }\\n  }\\n}'\r\n```\r\n\r\n### Expected Behavior\r\n<!--- What should have happened? --->\r\nIf I expect the property to be None and the synthesized object has something,`to_have_resource_with_properties` should return `False here.\r\n\r\n### Actual Behavior\r\n<!--- What actually happened? --->\r\nIt returns `True` here.\r\n\r\n### Steps to Reproduce\r\n<!--- Please list the steps required to reproduce the issue. --->\r\n1. Create a resource with an optional attribute\r\n2. Assert the property as None with that function.\r\n\r\n### Important Factoids\r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n- #0000\r\n","comments":[{"id":"IC_kwDODd1Amc5dtZUl","author":{"login":"xiehan"},"authorAssociation":"MEMBER","body":"Thanks for reporting this! We agree this should be addressed. Unfortunately it's not something we'll have capacity to work on soon, but we welcome any community contributions.","createdAt":"2023-06-01T14:38:56Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2326#issuecomment-1572181285","viewerDidAuthor":false}],"createdAt":"2022-11-21T17:27:36Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMTEzNjU3MzA2","name":"language/python","description":"","color":"5c2596"},{"id":"MDU6TGFiZWwyNTcwMTY0OTY5","name":"testing","description":"","color":"456cc6"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"}],"milestone":null,"number":2326,"title":"pytest to_have_resource_with_properties not able to detect None","updatedAt":"2023-06-01T14:38:56Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE3NDcxMjA=","is_bot":false,"login":"trondhindenes","name":"Trond Hindenes"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n```\r\nâ¯ cdktf --version\r\n0.14.1\r\n\r\n```\r\n\r\n### Affected Resource(s)\r\n\r\n\r\n\r\n### Debug Output\r\n\r\n\r\n### Expected Behavior\r\ncdktf should have executed `poetry run python main.py`, and never called `pipenv`\r\n\r\n### Actual Behavior\r\n\r\nsomething inside cdktf calls \"pipenv\" even tho I've adjusted cdktf.json. Seems to me like it totally disregards the \"app\" attribute in the cdktf.json file\r\n```\r\nâ   Synthesizing\r\n[2022-11-18T18:54:22.986] [ERROR] default - Courtesy Notice: Pipenv found itself running within a virtual environment, so it will automatically use that environment, instead of creating its own for any project. You can set PIPENV_IGNORE_VIRTUALENVS=1 to force pipenv to ignore that environment and create its own instead. You can set PIPENV_VERBOSITY=-1 to suppress this warning.\r\n\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\nCreated a cdk tf app using the template. \r\nSwitched from pipenv to poetry. \r\nDeleted Pipfile* Replaced `app` attr in cdktf.json with `poetry run python main.py`. \r\nVerified that simply running `poetry run python main.py` works.\r\nTried running `cdktf synth`\r\n\r\nThis is the first time I'm looking at cdktf in about two years, and I'm _quite_ certain I've used it with poetry before\r\n\r\n### Important Factoids\r\n\r\n\r\n\r\n### References\r\n\r\n\r\n- #0000\r\n","comments":[{"id":"IC_kwDODd1Amc5Osxnh","author":{"login":"trondhindenes"},"authorAssociation":"NONE","body":"I just tested a bunch of different cdktf versions. Looks like this broke in `[0.11.0](https://www.npmjs.com/package/cdktf-cli/v/0.11.0)` 0.10.4 behaves as expected.","createdAt":"2022-11-18T18:06:32Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2321#issuecomment-1320360417","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Os7OS","author":{"login":"trondhindenes"},"authorAssociation":"NONE","body":"Some more info on this: Only happens when cdktf.json has  `\"sendCrashReports\": \"true\"`","createdAt":"2022-11-18T18:43:38Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2321#issuecomment-1320399762","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5OyL2i","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi ğŸ‘‹\r\nThat is probably happening because the CDKTF CLI tries to [determine the underlying version](https://github.com/hashicorp/terraform-cdk/blob/4677ffdba0636e5211bbb89cc1a58932d226582e/packages/cdktf-cli/src/lib/debug.ts#LL110C20-L110C20) of the installed cdktf core Python package.\r\n\r\nIs there a good way to spot that a Python project is using Python Poetry?","createdAt":"2022-11-21T09:45:44Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2321#issuecomment-1321778594","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5OzH0k","author":{"login":"trondhindenes"},"authorAssociation":"NONE","body":"> Is there a good way to spot that a Python project is using Python Poetry?\r\n\r\nyes:\r\nif folder constains `Pipfile` --> assume its managed by pipenv\r\nif folder contains `poetry.lock` --> assume it's managed by poetry\r\n\r\ni would also add:\r\nif command in `cdktf.json` `app` starts with `poetry` or `pipenv` that's also a strong indicator as to what command to run in order to grab package versions","createdAt":"2022-11-21T12:53:54Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2321#issuecomment-1322024228","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5OzILo","author":{"login":"trondhindenes"},"authorAssociation":"NONE","body":"My cdktf.json looks like this, for instance:\r\n```\r\n{\r\n  \"language\": \"python\",\r\n  \"app\": \"poetry run python main.py\",\r\n  \"projectId\": \"490ecd27-404c-44cb-b2bc-1066ff1f28b3\",\r\n  \"sendCrashReports\": \"false\",\r\n  \"terraformProviders\": [],\r\n  \"terraformModules\": [],\r\n  \"codeMakerOutput\": \"imports\",\r\n  \"context\": {\r\n    \"excludeStackIdFromLogicalIds\": \"true\",\r\n    \"allowSepCharsInLogicalIds\": \"true\"\r\n  }\r\n}\r\n\r\n```\r\nwhen running \"cdktf synth\" cdktf will actually start the python process for me. So here the debug call should be `poetry run pip freeze` to list packages in the managed env. And `pipenv run pip freeze` if it were a pipenv-managed app.","createdAt":"2022-11-21T12:55:17Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2321#issuecomment-1322025704","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Q-5OA","author":{"login":"trondhindenes"},"authorAssociation":"NONE","body":"Just thinking more about this: \r\nIt might be neater to list packages programmatically instead of kicking off another process to do it:\r\n```\r\ntry: from pip._internal.operations import freeze\r\nexcept ImportError: # pip < 10.0\r\n    from pip.operations import freeze\r\n\r\npkgs = freeze.freeze()\r\nfor pkg in pkgs: print(pkg)\r\n```\r\nThat way cdktf doesn't have to care about which package manager is used\r\n\r\n(provided of course that there are hooks in the python layer to add this kind of functionality - I wouldn't know anything about that)","createdAt":"2022-12-20T00:14:50Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2321#issuecomment-1358664576","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Q-6Kk","author":{"login":"trondhindenes"},"authorAssociation":"NONE","body":"some more info while I'm at it:\r\nA process wrapped in pipenv will always get the environment variable `PIPENV_ACTIVE=1` set, so that's probably another safe \r\nway to determine if pipenv is involved. But I guess you have to support both situations where users run `pipenv run cdktf...` and `cdktf` but the cdktf.json contains `pipenv run python main.py` so there are different ways to have cdktf and pipenv interact, and that's why I think this \"assuming the world is perfect\" that cdktf is doing now is so dangerous.","createdAt":"2022-12-20T00:19:49Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2321#issuecomment-1358668452","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5W4kqb","author":{"login":"giner"},"authorAssociation":"NONE","body":"Another more generic approach could be adding an option languageRuntimeCmd defaulting to `pipenv run` for python which could be redefined as `poetry run` or anything else user prefers.","createdAt":"2023-03-07T07:16:01Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2321#issuecomment-1457670811","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5W4yyH","author":{"login":"giner"},"authorAssociation":"NONE","body":"This would also solve a problem with inconsistency between `cdktf debug` (which always runs pipenv for python) and other commands which execute `app` where app could run, for example, poetry","createdAt":"2023-03-07T08:08:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2321#issuecomment-1457728647","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5dta3U","author":{"login":"xiehan"},"authorAssociation":"MEMBER","body":"Thanks for reporting this! We agree this should be addressed. Unfortunately it's not something we'll have capacity to work on soon, but in the meantime, we welcome any community contributions.","createdAt":"2023-06-01T14:42:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2321#issuecomment-1572187604","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5khfIa","author":{"login":"martimors"},"authorAssociation":"NONE","body":"The `cdktf get` command generates a rogue `Pipfile`, so do many other commands (luckily not `cdktf synth`). I've added it to the `.gitignore` and it looks like it isn't used (it basically just copies my poetry environment), but it sure would be nice if it didn't happen. This is not an issue over at cdk8s so maybe we can get inspiration from them.","createdAt":"2023-08-21T15:01:40Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2321#issuecomment-1686499866","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5khuUH","author":{"login":"trondhindenes"},"authorAssociation":"NONE","body":"@dingobar when I checked this last, you could disable the behavior by setting `\"sendCrashReports\": \"false\"` in the cdktf.json file. Doesn't fix the issue, but at least it hides it","createdAt":"2023-08-21T15:36:00Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"CONFUSED","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2321#issuecomment-1686562055","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5kh441","author":{"login":"martimors"},"authorAssociation":"NONE","body":"Thanks! Its something ğŸ™‚ğŸ‘","createdAt":"2023-08-21T16:02:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2321#issuecomment-1686605365","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6_27Zp","author":{"login":"bendog"},"authorAssociation":"NONE","body":"I built a [uv template](https://github.com/bendog/cdktf-remote-template-python-uv) for this hoping this would resolve the issue, however it seems the Pipenv on get is a bug. \nmaybe I'll look into this, anybody have any advice? ","createdAt":"2025-08-25T05:06:56Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"ROCKET","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2321#issuecomment-3218847337","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7WlimI","author":{"login":"bendog"},"authorAssociation":"NONE","body":"I've created a PR for this over three months ago, but I have have heard nothing from Hashicorp about it ğŸ˜¢ ","createdAt":"2025-12-02T04:43:27Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2321#issuecomment-3600165256","viewerDidAuthor":false}],"createdAt":"2022-11-18T18:01:22Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMTEzNjU3MzA2","name":"language/python","description":"","color":"5c2596"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"LA_kwDODd1Amc78phHg","name":"cli/provider-subcommands","description":"cdktf provider <verb> commands","color":"4CBCB0"}],"milestone":null,"number":2321,"title":"cdktf tries to use pipenv even tho I have removed it from cdktf.json","updatedAt":"2025-12-02T04:47:05Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nSimilar to other code blocks in our docs, we should retrieve these snippets from an example to also confirm them in CI:\r\nhttps://github.com/hashicorp/terraform-cdk/blob/5f60e02891b5af40ff4557b507192ad014184f22/website/docs/cdktf/concepts/tokens.mdx?plain=1#L68-L94\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n* Follow-up issue for https://github.com/hashicorp/terraform-cdk/pull/2297\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-11-16T10:54:38Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":2298,"title":"Read `Token.nullValue()` snippet from documentation example","updatedAt":"2023-06-01T13:29:57Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjgwMDUxOTQ=","is_bot":false,"login":"lossanarch","name":"Stephen Hallett"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\ngithub.com/hashicorp/terraform-cdk-go/cdktf v0.13.3\r\ngithub.com/aws/jsii-runtime-go v1.71.0\r\ncdktf-cli v0.12.3 & v0.13.3\r\n\r\n### Affected Resource(s)\r\n\r\nElement function:\r\ngithub.com/hashicorp/terraform-cdk-go/cdktf.Fn_Element(list interface{}, index *float64) interface{}\r\n\r\n### Debug Output\r\n\r\nhttps://gist.github.com/lossanarch/ba5bcd5c404bd6a895f229d289b7e66c\r\n\r\n### Expected Behavior\r\n\r\nthe list argument of `Fn_Element` should receive a `*[]*string` without panic, as this is the most common return type from various list returning methods such as `cdktf.TerraformLocal.AsList()` or `cdktf.Token.AsList()` (and of course the example below)\r\n\r\n### Actual Behavior\r\n\r\nSynth panics with `panic: parameter list must be one of the allowed types: *[]interface{}, IResolvable; received &[]*string{(*string)(0x1400036b670)} (a *[]*string)`\r\n\r\n### Steps to Reproduce\r\n\r\n1. Create a data resource that returns a list of objects, eg:\r\n```\r\ninstance := dataawsssoadmininstances.NewDataAwsSsoadminInstances(stack, jsii.String(\"SsoInstances\"),\r\n\t\t&dataawsssoadmininstances.DataAwsSsoadminInstancesConfig{})\r\n```\r\n2. Use Fn_Element() to select an element from that list\r\n```\r\nidentityStoreId := cdktf.Fn_Element(instance.IdentityStoreIds(), jsii.Number(0)).(string)\r\n```\r\n\r\n### Important Factoids\r\n\r\nThis worked in 0.12 and only broke after upgrading to the above package versions. Tested with both 0.12 and 0.13 cdktf-cli versions.\r\nThe issue can be worked around by putting the list-returning method into a `TerraformLocal` and then passing Fn_Element the returned `interface{}` from the `Expression()` method (but _will not_ accept TerraformLocal's `AsList()` method as it returns `*[]*string`):\r\n```\r\nisid := cdktf.NewTerraformLocal(stack, jsii.String(\"LocalInstanceStoreIds\"), instance.IdentityStoreIds())\r\nidentityStoreId := cdktf.Fn_Element(isid.Expression(), jsii.Number(0)).(string)\r\n```\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5PJxlC","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"Created https://github.com/aws/jsii/issues/3856 since I suspect this to be a result of an upstream JSII change.","createdAt":"2022-11-26T02:22:34Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2281#issuecomment-1327962434","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5fmNpA","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"waiting on this upstream JSII issue: https://github.com/aws/jsii/issues/3948","createdAt":"2023-06-23T07:28:50Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2281#issuecomment-1603852864","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5fmOeB","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"The workaround for this is using a TerraformLocal (as posted by @lossanarch) or using `cdktf.Token_AsList()`. Unfortunately we won't have capacity to work on a permanent fix soon, but we welcome any community contributions.","createdAt":"2023-06-23T07:32:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2281#issuecomment-1603856257","viewerDidAuthor":false}],"createdAt":"2022-11-13T21:01:34Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwyMjQ2NzM3OTc1","name":"upstream/jsii","description":"Pending upstream work on JSII","color":"f9a2cf"},{"id":"MDU6TGFiZWwzMDMwODE1NTQy","name":"language/golang","description":"","color":"22ED90"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":2281,"title":"cdktf.Fn_Element method no longer accepts *[]*string","updatedAt":"2023-06-23T08:41:01Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nWe should support something like this:\r\n```hcl\r\ndynamic \"origin_group\" {\r\n    for_each = var.load_balancer_origin_groups\r\n    content {\r\n      name = origin_group.key\r\n\r\n      dynamic \"origin\" {\r\n        for_each = origin_group.value.origins\r\n        content {\r\n          hostname = origin.value.hostname\r\n        }\r\n      }\r\n    }\r\n  }\r\n```\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n* https://developer.hashicorp.com/terraform/language/expressions/dynamic-blocks#multi-level-nested-block-structures\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-11-02T19:50:53Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2MjkzOTA4","name":"core-parity","description":"Better experience in Terraform Core than CDKTF","color":"1A80B6"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"},{"id":"LA_kwDODd1Amc8AAAABBv4DFg","name":"feature/iterators","description":"","color":"2911A8"}],"milestone":null,"number":2246,"title":"Support nested iteration (i.e. using `TerraformIterator.dynamic` inside `TerraformIterator.dynamic`)","updatedAt":"2024-01-10T11:27:22Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjkwOTI5NjY=","is_bot":false,"login":"daniel-laszlo","name":"Daniel Laszlo"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\ncdktf 0.13.2\r\n\r\n\r\n### Affected Resource(s)\r\n\r\n<!--- Please list the affected resources. --->\r\n`cdktf synth`\r\n`cdktf diff`\r\n`cdktf deploy`\r\n\r\n### Debug Output\r\n\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\n\r\n### Expected Behavior\r\n\r\n<!--- What should have happened? --->\r\n\r\nCan we standardize options for handling multi-stack workflows? I need to be able to run all subcommands for 1) a specific stack, 2) for all stacks.\r\n\r\n### Actual Behavior\r\n\r\n- `cdktf synth` runs for all stacks without supplying any further options, but I cannot specify to run for only one stack\r\n- `cdktf diff` requires specifying a stack, but there is no option to run for all stacks\r\n- `cdktf deploy` requires specifying a stack or `'*'` to run for all stacks\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Please list the steps required to reproduce the issue. --->\r\n\r\n### Important Factoids\r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n","comments":[{"id":"IC_kwDODd1Amc5Nrp-o","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Yeah this part is a bit confusing and we don't really call the reason it explicitly in our documentation, so we should definitely add a section. \n\nSynth synthesizes all stacks because synthesizing means running the app command. The command is arbitrary, but most commonly we run ts /python/ etc to execute your cdktf program. We can't run half a program that easily, so that's why we run it entirely. \n\nWhen we built the multi-stack feature we wanted to allow to plan multiple stacks as well, but that's not really feasible right now. With cross stack references you might use a value from one stack in another. If we didn't apply yet or the changes would change that referenced value we can not make a (correct) plan. This is why we limit the plan to one stack. ","createdAt":"2022-11-04T11:23:41Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2235#issuecomment-1303289768","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Nrs5W","author":{"login":"daniel-laszlo"},"authorAssociation":"CONTRIBUTOR","body":"Thank you for the explanation","createdAt":"2022-11-04T11:37:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2235#issuecomment-1303301718","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5QQMpz","author":{"login":"daniel-laszlo"},"authorAssociation":"CONTRIBUTOR","body":"@DanielMSchmidt followup question. Would I lose the ability to run plan for a stack which references a value from another stack? And then I would be restricted to only deploy in this case?","createdAt":"2022-12-12T12:34:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2235#issuecomment-1346423411","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5QQQSo","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"No, you can plan the stack housing the value, apply it and the plan the stack using the value. If you plan the stack using the value first your plan might be incorrect / erroring","createdAt":"2022-12-12T12:47:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2235#issuecomment-1346438312","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5fJY2Y","author":{"login":"LyleDavis"},"authorAssociation":"NONE","body":"@DanielMSchmidt in the scenario of running a plan on a stack where it depends on another stack that hasn't yet had the relevant changes applied, is it guaranteed that it will error or will it sometimes show an incorrect plan without erroring?\r\n\r\nI'm new to CDKTF and terraform in general, but in CI I was hoping to be able to run a diff on all stacks (if not together then one by one) and then deploy `*` on merge. Obviously that would be dangerous if there is the potential for the diff to be wrong due to stack dependencies.","createdAt":"2023-06-18T22:58:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2235#issuecomment-1596296600","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5hcrAc","author":{"login":"fathom-parth"},"authorAssociation":"NONE","body":"@DanielMSchmidt a tiny bump if you have time to answer @LyleDavis's question! I'm setting up `cdktf` for my organization and trying to make sure our CI/CD setup is optimal.\r\n\r\nI think given this issue, the issue at https://github.com/hashicorp/terraform-cdk/issues/2157, and the [cdktf best practices](https://developer.hashicorp.com/terraform/cdktf/create-and-deploy/best-practices#separate-business-units-with-stacks) telling us to use multiple stacks over a single stack per-environment/project (we use gcp), there's no real way to run `cdktf diff` during CI?","createdAt":"2023-07-13T20:55:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2235#issuecomment-1634906140","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5hlUDY","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> in the scenario of running a plan on a stack where it depends on another stack that hasn't yet had the relevant changes applied, is it guaranteed that it will error or will it sometimes show an incorrect plan without erroring?\r\n\r\nBoth situations are possible. If the value doesn't exist at all an error will occur when performing a diff; however, if the value is being changed, the existing value would be used and lead to an incorrect plan.\r\n\r\n\r\n\r\n> I think given this issue, the issue at #2157, and the [cdktf best practices](https://developer.hashicorp.com/terraform/cdktf/create-and-deploy/best-practices#separate-business-units-with-stacks) telling us to use multiple stacks over a single stack per-environment/project (we use gcp), there's no real way to run `cdktf diff` during CI?\r\n\r\nIt really depends how the stacks are being used. Separate environments that don't reference each other will diff without issue. Dependent stacks can certainly cause diff issues, but it is still possible to use with some extra coordination.","createdAt":"2023-07-16T19:28:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2235#issuecomment-1637171416","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5hpUkh","author":{"login":"fathom-parth"},"authorAssociation":"NONE","body":"@jsteinich \r\n\r\n> It really depends how the stacks are being used. Separate environments that don't reference each other will diff without issue.\r\n\r\nSo I think the main issue is that there's no way that I can see to `cdktf diff` all the \"leaf\" stacks (i.e. the stacks with no dependencies) programmatically easily.\r\n\r\nWithout this, if a user adds a stack, they'll have to change the `diff` job explicitly to include their new stack. But our `deploy` job just runs `cdktf deploy '*'`. Ideally a user wouldn't have to worry about changing either job.\r\n\r\n> Dependent stacks can certainly cause diff issues, but it is still possible to use with some extra coordination.\r\n\r\nIn our case, the issue is that many stacks would be dependent on say the `networking` stack so that they can all use the same `network`. In this case the `networking` stack would rarely change and I still want to see the `diff` output for all the other stacks.\r\n\r\nYou mention \"it is still possible to use with some extra coordination\", could you expand a little on this?","createdAt":"2023-07-17T14:06:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2235#issuecomment-1638222113","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5h7mB9","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"There is a stack manifest created that includes dependency information. It's possible to write a script that reads it in and then diffs in an appropriate order. Would probably also need to be multi-step so that dependencies can be resolved (or just error if a potential issue is detected).\r\n","createdAt":"2023-07-20T02:27:41Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2235#issuecomment-1643012221","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5iBFft","author":{"login":"fathom-parth"},"authorAssociation":"NONE","body":"Ah so we were looking into that but we'd still have to call `cdktf deploy` on (using the previous example again) the `networking` stack before being able to `diff` the downstream stacks?\r\n\r\nIt doesn't seem like a great practice to call `deploy` before merging the PR.","createdAt":"2023-07-20T19:06:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2235#issuecomment-1644451821","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5iEpyV","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> Ah so we were looking into that but we'd still have to call `cdktf deploy` on (using the previous example again) the `networking` stack before being able to `diff` the downstream stacks?\r\n> \r\n> It doesn't seem like a great practice to call `deploy` before merging the PR.\r\n\r\nA workaround for the initial creation could be to have a conditional for creating the downstream stack(s) that is disabled for the 1st PR and a 2nd PR enables them.\r\nUpdates to the networking stack that need to ripple doesn't seem to have a great workaround.\r\n\r\n\r\nI certainly agree with all the issues here. Just looking for workarounds since a generic solution would be a complex addition to cdktf.","createdAt":"2023-07-21T10:48:49Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2235#issuecomment-1645386901","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5iGZfd","author":{"login":"fathom-parth"},"authorAssociation":"NONE","body":"Ooh! I like that!\r\n\r\nIs there a way to add a resource to the cross-stack outputs without actually having that resource be used cross-stack yet?\r\n\r\nThen we could make a PR to the networking stack that exposes some new resource as a cross-stack resource without any other stack actually using that output yet. This would allow all `diff` calls to still work!\r\n\r\nThen we could make a 2nd PR to the downstream stack that wants to use the new resource in the networking stack and the `diff` will work because the remote state will already have the cross-stack reference!","createdAt":"2023-07-21T16:11:15Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2235#issuecomment-1645844445","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5iH7nc","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> Is there a way to add a resource to the cross-stack outputs without actually having that resource be used cross-stack yet?\r\n\r\nYes, create a `TerraformOutput` containing the data you want to use.\r\nCross-stack references make use of Terraform remote state data sources. In order for something to be available as such, it must be put into an output. If you name it the same as will be generated I believe it will link up. If that fails, you can also explicitly reference as remote state.","createdAt":"2023-07-21T21:15:30Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2235#issuecomment-1646246364","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5iH8zN","author":{"login":"fathom-parth"},"authorAssociation":"NONE","body":"Ideally we can name it the same so that we can pass the reference normally in the 2nd PR without having to define a `TerraformOutput` -- will test!","createdAt":"2023-07-21T21:22:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2235#issuecomment-1646251213","viewerDidAuthor":false}],"createdAt":"2022-10-31T15:02:31Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTQ2NjcxNDUz","name":"feature/multi-stack","description":"","color":"6589C9"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":2235,"title":"Inconsistent UX for multi-stack cdktf commands","updatedAt":"2023-07-21T21:22:23Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nCurrently it is required to pass one or more provider names to the `cdktf provider upgrade` command. We can use the same functionality powering `cdktf provider list` (#2229) when that command is implemented to allow users to run `cdktf provider upgrade` without arguments and have it automatically figure out all installed providers and update all of them at once.\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-10-28T16:36:42Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"LA_kwDODd1Amc78phHg","name":"cli/provider-subcommands","description":"cdktf provider <verb> commands","color":"4CBCB0"}],"milestone":null,"number":2230,"title":"Support upgrading all used providers at once via `cdktf provider upgrade`","updatedAt":"2023-09-29T12:53:23Z"},{"assignees":[],"author":{"id":"U_kgDOBa6SIg","is_bot":false,"login":"chun-ko","name":"Chun Ko"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and pre-built provider you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\n### Affected Provider / Resource(s)\r\n\r\n<!--- Please list the affected resources. --->\r\n\r\n\r\n### Debug Output\r\n\r\nThis `priority` should be required field instead of optional\r\n\r\nhttps://github.com/cdktf/cdktf-provider-azurerm/blob/970b1a9f6a6c2b9fd9e44c575836675e4bd9c3fc/src/network-security-group/index.ts#L84\r\n\r\nBase on the documentation https://www.terraform.io/docs/providers/azurerm/r/network_security_group#priority\r\n\r\n\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\n\r\n### Expected Behavior\r\n\r\n<!--- What should have happened? --->\r\n\r\n### Actual Behavior\r\n\r\n<!--- What actually happened? --->\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Please list the steps required to reproduce the issue. --->\r\n\r\n### Important Factoids\r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n- #0000\r\n","comments":[{"id":"IC_kwDODd1Amc5ek6Qi","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"The `security_rule` block has the following schema: \r\n\r\n```json\r\n              \"security_rule\": {\r\n                \"type\": [\r\n                  \"set\",\r\n                  [\r\n                    \"object\",\r\n                    {\r\n                      \"access\": \"string\",\r\n                      \"description\": \"string\",\r\n                      \"destination_address_prefix\": \"string\",\r\n                      \"destination_address_prefixes\": [\r\n                        \"set\",\r\n                        \"string\"\r\n                      ],\r\n                      \"destination_application_security_group_ids\": [\r\n                        \"set\",\r\n                        \"string\"\r\n                      ],\r\n                      \"destination_port_range\": \"string\",\r\n                      \"destination_port_ranges\": [\r\n                        \"set\",\r\n                        \"string\"\r\n                      ],\r\n                      \"direction\": \"string\",\r\n                      \"name\": \"string\",\r\n                      \"priority\": \"number\",\r\n                      \"protocol\": \"string\",\r\n                      \"source_address_prefix\": \"string\",\r\n                      \"source_address_prefixes\": [\r\n                        \"set\",\r\n                        \"string\"\r\n                      ],\r\n                      \"source_application_security_group_ids\": [\r\n                        \"set\",\r\n                        \"string\"\r\n                      ],\r\n                      \"source_port_range\": \"string\",\r\n                      \"source_port_ranges\": [\r\n                        \"set\",\r\n                        \"string\"\r\n                      ]\r\n                    }\r\n                  ]\r\n                ],\r\n                \"description_kind\": \"plain\",\r\n                \"optional\": true,\r\n                \"computed\": true\r\n              },\r\n```\r\n\r\n@DanielMSchmidt will probably know more about this, but I think we're making all these optional because the schema does not define any object members as required or optional. I feel like this is a problem that would require some work from the azurerm provider to change the type of the `security_rule` to be an attribute block, or Terraform introducing required / optional within object attributes.\r\n\r\nLeaving this open for further discussion, but I'm unsure if we can resolve this on the CDKTF end.","createdAt":"2023-06-12T07:20:45Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2228#issuecomment-1586734114","viewerDidAuthor":false}],"createdAt":"2022-10-28T05:40:06Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMDEzNzM4ODIw","name":"needs-research","description":"","color":"709F22"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2MjAxMTE5","name":"provider get / generation","description":"","color":"CC3938"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"}],"milestone":null,"number":2228,"title":"`azurerm` provider: priority field should be required field in Network Security Group","updatedAt":"2023-06-12T07:21:39Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjYxOTYyNjA=","is_bot":false,"login":"cveld","name":"Carl in 't Veld"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nDuring the PowerShell Europe conference there was a community player that has shown a PowerShell sdk implementation for Pulumi.\r\nWe think a PowerShell sdk is essential to drive adoption of any cdk. \r\n\r\nIt would be great to see PowerShell support for Terraform cdk.\r\n\r\n### References\r\nhttps://github.com/pulumi/pulumi/issues/3507\r\nhttps://www.youtube.com/watch?v=YAQLvNjJKOs","comments":[],"createdAt":"2022-10-18T14:21:23Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"MDU6TGFiZWwzMjA1MTIxODAz","name":"enhancement/new-workflow","description":"Proposed new workflow","color":"4A1023"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"}],"milestone":null,"number":2201,"title":"PowerShell support","updatedAt":"2022-10-25T10:34:28Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nCDKTF bindings pin provider versions in general, therefore we could generate the `.terraform.lock.hcl` file for each stack as part of our synthetization. This makes using the provider across different machines / architectures easier and improves our upgrade workflow to have one less step, see #2020. This means we trim the sources of provider versions down to just the provider bindings instead of e.g. the last run of terraform init as well.\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5Nxsr6","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"I like this from a versioning perspective, but I worry about it from a security perspective. `.terraform.lock.hcl` functions as both version pinning and checksum matching.","createdAt":"2022-11-06T19:20:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2200#issuecomment-1304873722","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5W4Hvh","author":{"login":"nikowatari"},"authorAssociation":"CONTRIBUTOR","body":"can the alternative approach be considered?\r\n1. terraform plugins will be bundled directly into respective language packages\r\n2. extracted to some directory\r\n3. path to that directory provided to terraform as `TF_PLUGIN_CACHE_DIR`\r\n\r\nthay way terraform will always use the same provider binary as long as the same e.g. python package is used, w/o the need to touch `.terraform.lock.hcl`\r\n\r\nwhat's your opinion?","createdAt":"2023-03-07T05:16:54Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2200#issuecomment-1457552353","viewerDidAuthor":false}],"createdAt":"2022-10-18T14:03:08Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjQ2NzM1NDk1","name":"providers","description":"","color":"2bd8cd"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"LA_kwDODd1Amc78phHg","name":"cli/provider-subcommands","description":"cdktf provider <verb> commands","color":"4CBCB0"}],"milestone":null,"number":2200,"title":"Generate provider lock file before running terraform init","updatedAt":"2023-09-29T12:53:23Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nWhen working with pre-built providers in Java it can happen that maven installs a cdktf version that not matches what is specified in the pom.xml, because of outdated peer dependencies requiring an older version. To make a user aware of this we need a check reminding folks to upgrade.\r\n\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n\r\n- https://discuss.hashicorp.com/t/cdk-not-respecting-pom-xml/45418/7\r\n","comments":[{"id":"IC_kwDODd1Amc5MVQCV","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Some notes on other languages:\r\n\r\nFor Python (pip and pipenv) and Go, there appears to be no warning when installing an older pre-built provider (i.e. targeting an older CDKTF version) â€“ but at least it does not fall back to an older CDKTF version than specified like Maven does ğŸ˜…\r\n\r\nFor NPM and Dotnet it already prints an error when trying to install without matching peer dependencies ğŸ‘","createdAt":"2022-10-17T10:28:06Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2191#issuecomment-1280639125","viewerDidAuthor":false}],"createdAt":"2022-10-14T15:00:14Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"}],"milestone":null,"number":2191,"title":"CDKTF should check if the pre-built providers peer dependency matches the installed cdktf version","updatedAt":"2023-09-29T12:53:22Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nWhen releasing `cdktf 0.13.0` in #2162 this test did fail because `cdktf@latest` pointed to `0.12.3` while the cdktf-cli used in that test uses the repo local package with `0.13.0`:\r\n\r\n> Command failed: npm install\r\n    npm ERR! code ETARGET\r\n    npm ERR! notarget No matching version found for cdktf@0.13.0.\r\n    npm ERR! notarget In most cases you or one of your dependencies are requesting\r\n    npm ERR! notarget a package version that doesn't exist.\r\n    npm ERR! notarget \r\n    npm ERR! notarget It was specified as a dependency of 'cdktf-cli'\r\n    npm ERR! notarget \r\n    \r\nAs a first try at fixing this, I tried installing `cdktf` from the local package as well, however this failed with:\r\n\r\n> .gen/providers/docker/provider/index.ts:123:11 - error TS2345: Argument of type 'import(\"/private/var/folders/19/0g2813wd0g77r4dvy2_xtmfw0000gq/T/cdktf-converted.EE1ipB/node_modules/constructs/lib/construct\").Construct' is not assignable to parameter of type 'import(\"/Users/ansgar/projects/hashicorp/terraform-cdk/node_modules/constructs/lib/construct\").Construct'.\r\n\r\nFor testing this, you can change the version to e.g. `0.14.0` and that will re-create the issue we just encountered in a PR.\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-10-03T14:52:10Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyNTcwMTY0OTY5","name":"testing","description":"","color":"456cc6"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTU1MzExNDc0","name":"dev-process","description":"Improvements to how CDK for Terraform is developed and built","color":"F6A4ED"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"}],"milestone":null,"number":2164,"title":"Re-enable `convertProject.test.ts` test","updatedAt":"2023-10-13T15:28:52Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjg1NTExNQ==","is_bot":false,"login":"xiehan","name":"Nara Kasbergen Kwon"},"body":"Back in August, we were excited to announce the first generally available (GA) release of Cloud Development Kit for Terraform, with version 0.12. With [CDKTF](https://www.terraform.io/cdktf), you can write Terraform configurations in your choice of TypeScript, Python, C#, Java, or Go, and still benefit from the full ecosystem of HashiCorp Terraform providers and modules. Among the changes in 0.12, we announced that Go is now fully supported, after having been classified as experimental in the past.\r\n\r\nAfter that first GA release, we eagerly took in any and all feedback from the community, and one common theme predominated: performance. Go users in particular reported long build times and frequent out-of-memory errors, Java and C# synth times were significantly slower than our TypeScript benchmarks, and Python users reported a related issue that the generated classes for some providers were so big that they were crashing IDEs. While our metrics indicate that CDKTF is working well for the majority of users, the team agreed to prioritize addressing performance issues right away because we recognize that speed and stability are a core part of the user experience, and one of our north star goals is a first-class developer experience across all 5 languages that we support.\r\n\r\nThe team put our heads together and experimented with different ways to increase performance in a language-agnostic way, culminating in our 0.13 release. With this update, we're excited to announce significant improvements across the board, including (based on benchmark tests):\r\n\r\n- a 96.8% reduction in `cdktf synth` time when using Go with the Azure provider\r\n- an 83% reduction in `cdktf synth` time when using Java with the Google provider\r\n- a 36.8% reduction in `cdktf synth` time when using C# with the AWS provider\r\n- a 61.5% reduction in `cdktf synth` time when using TypeScript with the Kubernetes provider\r\n\r\nâ€¦ and more. In addition, the same changes that led to the above enhancements fixed the issue that was causing IDEs to crash for Python users, so we truly did see an improved developer experience across the board.\r\n\r\nThe downside is that in order to achieve these incredible performance gains, we must introduce a breaking change in CDKTF that will affect all existing users.\r\n\r\n### What Changed\r\nWith the 0.13 release, we are introducing namespaces in every class in our generated provider bindings, with namespaces automatically derived from the Terraform resource or data source it originates from.\r\n\r\nCurrently, each providerâ€™s exports are a flat list of constructs (resources, data sources, etc.). While thatâ€™s really convenient at times, it also results in large packages that compilers and LSP find taxing to handle. Not only that, but generating providers also takes longer for CDKTF. With the move to namespacing, the providers are divided into logical groups based on the kinds of constructs being exported. These numerous small packages are faster for the compiler to process than one large package, resulting in the significant speedups highlighted above.\r\n\r\n### What You Need To Do\r\nThe introduction of namespaces means that the import paths for all of your provider-related classes will need to be updated. As an example, instead of:\r\n\r\n```ts\r\nimport { AwsProvider, ec2 } from \"@cdktf/provider-aws\";\r\n\r\nclass MyStack extends TerraformStack {\r\n  constructor(scope: Construct, id: string) {\r\n    super(scope, id);\r\n\r\n    new AwsProvider(this, \"AWS\", {\r\n      region: \"us-west-1\",\r\n    });\r\n\r\n    const instance = new ec2.Instance(this, \"compute\", {\r\n      ami: \"ami-01456a894f71116f2\",\r\n      instanceType: \"t2.micro\",\r\n    });\r\n  }\r\n}\r\n```\r\n\r\nStarting from 0.13, you would do:\r\n\r\n```ts\r\nimport { AwsProvider } from \"@cdktf/provider-aws/lib/provider\";\r\nimport { Instance } from \"@cdktf/provider-aws/lib/instance\";\r\n\r\nclass MyStack extends TerraformStack {\r\n  constructor(scope: Construct, id: string) {\r\n    super(scope, id);\r\n\r\n    new AwsProvider(this, \"AWS\", {\r\n      region: \"us-west-1\",\r\n    });\r\n\r\n    const instance = new Instance(this, \"compute\", {\r\n      ami: \"ami-01456a894f71116f2\",\r\n      instanceType: \"t2.micro\",\r\n    });\r\n  }\r\n}\r\n```\r\n\r\nFor more upgrade information, check out [our upgrade guide for version 0.13](https://www.terraform.io/cdktf/release/upgrade-guide-v0-13).\r\n\r\n### When Do You Need To Update\r\nIf you're currently using CDKTF 0.12 and it's working well for you, you don't have to update to 0.13 right away. The only change introduced in 0.13 was the performance enhancement, so you're not missing out on any critical features.\r\n\r\nIf you'd like to start to take advantage of the performance improvements in 0.13 but aren't ready to change the import paths for all of your existing providers, we have good news for you, too: we've made the 0.13 release backwards-compatible with 0.12 provider bindings. This allows you to have two versions of the same provider in your code (one locally-generated and one [pre-built](https://www.terraform.io/cdktf/concepts/providers#install-pre-built-providers)) and to mix namespaced and non-namespaced providers as you like. Our goal here is to reduce the disruption of this breaking change and give users more time to gradually migrate their code to the new syntax.\r\n\r\nOnce you're ready to fully embrace our newly namespaced world introduced in 0.13, then you would go ahead and update your code as described in the \"What You Need To Do\" section above.\r\n\r\nNo matter what, however, you will need to update your existing code to the new namespaced syntax in order to upgrade to 0.14. We are only maintaining the backwards-compatible provider bindings for this one release, meaning the 0.12 (non-namespaced) provider bindings will no longer work with CDKTF 0.14 and above. We are currently targeting November 15, 2022 for the 0.14 release date.\r\n\r\n### What's Next\r\nThe [0.14 release](https://github.com/hashicorp/terraform-cdk/milestone/19) will focus primarily on quality-of-life improvements that make it easier to use [pre-built providers](https://www.terraform.io/cdktf/concepts/providers#install-pre-built-providers). One key discovery we made as we researched all the possibilities for improving performance was that pre-built providers give a vastly better developer experience than locally generating them using `cdktf get`, and so we want to encourage users to take advantage of these as much as possible. In the coming months, we'll be looking to scale up the number of pre-built providers we make available as installable packages, and until then, we'll be making improvements to the `cdktf provider add` command [introduced in CDKTF 0.11](https://www.hashicorp.com/blog/cdk-terraform-0-11-introduces-new-provider-command) and the `cdktf init` workflow to make it as easy as possible to find and add pre-built providers to your project.\r\n\r\n### Special Thanks\r\nWe would like to extend our deepest gratitude to the AWS CDK team, particularly Romain Marcadier (@RomainMuller), for working closely with us to explore all the options for improving the performance of code generation through [jsii](https://aws.github.io/jsii/) and helping us validate that introducing namespaces was our best path forward.\r\n\r\n### Try CDK for Terraform\r\nIf youâ€™re new to the project, the tutorials for [CDK for Terraform on HashiCorp Learn](https://learn.hashicorp.com/collections/terraform/cdktf) are the best way to get started. You can dive deeper into our documentation beginning with this [overview of CDKTF](https://www.terraform.io/docs/cdktf/index.html).\r\n\r\nWhether youâ€™re experimenting or actively using CDK for Terraform, weâ€™d love to hear from you. Please [file any bugs you encounter](https://github.com/hashicorp/terraform-cdk/issues/new?assignees=&labels=bug%2C+new&template=bug-report.md&title=), let us know about your [feature requests](https://github.com/hashicorp/terraform-cdk/issues/new?assignees=&labels=enhancement%2C+new&template=feature-request.md&title=), and share other questions, thoughts, and experiences in the [CDK for Terraform discussion forum](https://discuss.hashicorp.com/c/terraform-core/cdk-for-terraform/47).","comments":[{"id":"IC_kwDODd1Amc5L6MxW","author":{"login":"mattste"},"authorAssociation":"NONE","body":"Just a heads up that the tutorial [here](https://developer.hashicorp.com/terraform/tutorials/cdktf/cdktf-install) has outdated code unless it is changed to specify the cdktf version.","createdAt":"2022-10-10T16:17:13Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}},{"content":"HEART","users":{"totalCount":1}},{"content":"EYES","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2160#issuecomment-1273547862","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5ROKgX","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"While these performance improvements are pretty impressive, the changed import structure is quite a huge hit on the DX from my point of view (at least in Typescript). I'll have to import each and every resource explicitly. Are there plans to make this a bit more user friendly in future releases?","createdAt":"2022-12-22T10:26:58Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2160#issuecomment-1362667543","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5RON8o","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @skorfmann ğŸ‘‹\r\nYou can still import `* as aws` and use e.g. `aws.s3Bucket.S3Bucket` in TypeScript â€“ but I agree that it's still a bit more repetitive than it used to be (but at least only a single import required ğŸ˜‡ğŸ˜„)\r\n\r\nI don't think we currently have an issue tracking an improvement that would allow to use `aws.S3Bucket` (in TypeScript, and some other languages where that's possible) but that's a good idea. This might need to be language specific though which makes it more complicated to introduce without breaking performance for languages like e.g. Go again â€“ but I hope to be wrong ğŸ˜","createdAt":"2022-12-22T10:42:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2160#issuecomment-1362681640","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5dU8xy","author":{"login":"yuriy-yarosh"},"authorAssociation":"NONE","body":"I'm forced to use\r\n\r\n```bash\r\nnode --max-old-space-size=1024 --optimize-for-size --gc-interval=500 ../../../node_modules/.bin/cdktf get -l go -o imports --parallelism 4\r\n```\r\nor\r\n```bash\r\nnode --max-semi-space-size=512 --max-old-space-size=1536 --optimize-for-size --gc-interval=500 ../../../node_modules/.bin/cdktf get -l go -o imports --parallelism 4\r\n```\r\n\r\nto be able to actually download and codegen golang modules without OOM'ing, on 32Gb RAM Arch Linux box with Node 18 LTS.\r\n\r\n `--optimize-for-size --gc-interval=500` flags are not a part of NODE_OPTIONS env var, for some weird reason.\r\n\r\nIs it possible to cache the existing codegen during get, so it could be incremental ?\r\nI'm importing a lot of modules and providers 40+ - it takes too much time to codegen everything.","createdAt":"2023-05-28T01:02:26Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2160#issuecomment-1565772914","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5dddNh","author":{"login":"xiehan"},"authorAssociation":"MEMBER","body":"@yuriy-yarosh Is there a reason you can't use the [prebuilt providers](https://developer.hashicorp.com/terraform/cdktf/concepts/providers#install-pre-built-providers)? That is still by far the best solution, especially for huge providers like AWS.","createdAt":"2023-05-30T08:33:56Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2160#issuecomment-1568002913","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5deTGZ","author":{"login":"yuriy-yarosh"},"authorAssociation":"NONE","body":"@xiehan I wan't to use it for air-gap's and AWS is still too big that it breaks golang dep management (#2829).\r\nI'm not looking for a workaround and 5gb of JSII bundles is simply unacceptable - it's easier to drop CDKTF entirely, for me. If there was a way to remove duplicates between multiple JSII bundles - thet's might've help, to some extent.\r\n\r\nI couldn't do much hcl to golang conversion either... tfcdk was unable do process `lookup` `try` and other common TF functions, it's really weird when all the related conversion issues were closed. And it does look more like misorganization than regression, for me. Again, if someone had been using cdk converion to golang - they should've point out those issues already... which leads to a conclusion that no one does.","createdAt":"2023-05-30T10:56:33Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2160#issuecomment-1568223641","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5demi4","author":{"login":"xiehan"},"authorAssociation":"MEMBER","body":"@yuriy-yarosh Thank you for the feedback! While we believe we've optimized for the golden path that works for the majority of cdktf users, we're aware that performance is still suboptimal for some use cases, and air-gapped is indeed an ongoing challenge for us. What's tough is that when our team last did this performance optimization work with our 0.13 and 0.14 releases, we approached the limit of what we could improve in just cdktf itself; any more meaningful optimizations beyond this would have to happen at the JSII level. While we're not opposed to making PRs against JSII ourselves, we're a very small team so we've mostly been reliant on the AWS CDK team's stewardship of that project. We do sync with them regularly and I'll bring up these concerns with them the next time we meet to see if there's anything more they can help with here.\r\n\r\n`cdktf convert` is still largely an experimental feature and Golang support for `convert` was only added with our 0.16 release which came out last month, so it's true that not many people have used it yet; we also haven't actively promoted it much because we know it won't work for large production projects. We are still actively working on improving `convert`; our 0.17 release will be focused on it as well, with a stronger focus on getting it to work better for non-TypeScript languages. If you encounter specific issues, feel free to open new tickets; that's helpful to our team as well, to get more feedback on what's working and what's not.","createdAt":"2023-05-30T11:55:13Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2160#issuecomment-1568303288","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5eS-Uf","author":{"login":"jsparrow7777"},"authorAssociation":"NONE","body":"@xiehan I am using version 0.11.2 of cdktf with typescript. Stack is not too big but still `cdktf diff` or `cdktf synth` crashes the machine with 8GB memory. It's getting complex to manage its deployment looking at its resource usage. If we upgrade it to version 0.13, is it gonna help ?\r\nAlso, `cdktf convert` can convert HCL configuration to cdktf but is there any preferred method to do the opposite ?\r\nFrom what I read, we will have to do it manually using cdk.tf.json file. Open for suggestions !","createdAt":"2023-06-08T07:22:10Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2160#issuecomment-1582032159","viewerDidAuthor":false}],"createdAt":"2022-10-03T12:34:46Z","labels":[{"id":"MDU6TGFiZWwyMjQ2NzM1NDk1","name":"providers","description":"","color":"2bd8cd"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"},{"id":"LA_kwDODd1Amc8AAAABEqTZcQ","name":"notice","description":"Internal use only. An issue being used by the maintainers to flag something for the community.","color":"E1A241"},{"id":"LA_kwDODd1Amc8AAAABEqTcrA","name":"performance","description":"Gotta go fast","color":"890D75"}],"milestone":null,"number":2160,"title":"[Notice] Breaking Change in CDKTF 0.13","updatedAt":"2023-06-08T07:27:57Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjI0ODE3OTQ5","is_bot":false,"login":"natemellendorf","name":"Nate Mellendorf"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\nlanguage: python\r\ncdktf-cli: 0.12.2\r\nnode: v18.10.0\r\ncdktf: 0.12.3\r\nconstructs: 10.1.119\r\njsii: 1.69.0\r\nterraform: 1.3.0\r\narch: arm64\r\nos: linux 5.10.104-linuxkit\r\npython: Python 3.9.13\r\npip: pip 22.2.2 from /root/.local/share/virtualenvs/infra-o81V4Mez/lib/python3.9/site-packages/pip (python 3.9)\r\npipenv: pipenv, version 2022.9.24\r\n\r\n### Affected Resource(s)\r\n\r\nAny/All\r\n\r\n### Debug Output\r\n\r\nThe following is returned, when attempting to run a plan against multiple stacks:\r\n```\r\ncdktf plan '*-stack'\r\n...\r\nUsage Error: Could not find stack: *-stack\r\n```\r\n\r\n[cdktf plan first-stack](https://gist.github.com/natemellendorf/27aa0146084f69c06bad32ce5478967b)\r\n[cdktf plan second-stack](https://gist.github.com/natemellendorf/4f8235b0e5fd375b61f7ba8a73ebc6b5)\r\n\r\n### Expected Behavior\r\n\r\nSimilar to **cdktf apply**, I believe I should be able to run **cdktf plan '*-stack'** and review what would happen, should the matched stacks be applied.\r\n\r\n### Actual Behavior\r\n\r\nThe following error is returned:\r\n**Usage Error: Could not find stack: \\*-stack**\r\n\r\n### Steps to Reproduce\r\n\r\nUsing Python and the CDKTF, and [these two stacks](https://gist.github.com/natemellendorf/3ff552fc5474d478c9ed9aa880be97ba), attempt to run cdktf plan '*-stack'\r\n\r\n### Important Factoids\r\n\r\nYou can plan first-stack just fine with:\r\ncdktf plan first-stack\r\n\r\nHowever, if you try and plan the second stack (having not actually deployed first-stack), I get the following error:\r\n```bash\r\nsecond-stack  data.terraform_remote_state.cross-stack-reference-input-first-stack: Reading...\r\n\r\nâ ¼  Processing\r\n[2022-10-02T19:31:38.681] [ERROR] default - â•·\r\nâ”‚ Error: Unable to find remote state\r\nâ”‚ \r\nâ”‚   with data.terraform_remote_state.cross-stack-reference-input-first-stack,\r\nâ”‚   on cdk.tf.json line 18, in data.terraform_remote_state.cross-stack-reference-input-first-stack:\r\nâ”‚   18:         \"workspace\": \"${terraform.workspace}\"\r\nâ”‚ \r\nâ”‚ No stored state was found for the given workspace in the given backend.\r\nsecond-stack  â•·\r\n              â”‚ Error: Unable to find remote state\r\n              â”‚ \r\n              â”‚   with data.terraform_remote_state.cross-stack-reference-input-first-stack,\r\n              â”‚   on cdk.tf.json line 18, in data.terraform_remote_state.cross-stack-reference-input-first-stack:\r\n              â”‚   18:         \"workspace\": \"${terraform.workspace}\"\r\n              â”‚ \r\n              â”‚ No stored state was found for the given workspace in the given backend.\r\n              â•µ\r\n\r\nâ ´  Processing\r\n```\r\n\r\nThe above behavior makes sense. Second-stack fails because it can't find a data resource that it expects from first-stack.\r\nHowever, with that behavior, I do not see a way to plan multiple stacks that have inter-stack dependencies.\r\n\r\ncdktf apply and cdktf destroy seem to work just fine.\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5LyZAk","author":{"login":"ste-wr"},"authorAssociation":"NONE","body":"Yep this is affecting me as well.  This is pretty much a blocker for multi-stack in CI using `cdktf` commands unless we fall-back to some kind of recursive `terraform plan` after a `cdktf synth`","createdAt":"2022-10-07T12:00:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2157#issuecomment-1271500836","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5L1qJK","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"While not impossible, supporting this in all cases would be a large departure from how `diff` currently works.\r\nCross-stack references are accomplished through the use of Terraform remote state data sources. These rely on the remote state (1st stack) existing (already deployed). When that is the case, the diff will work just fine. When that isn't the case is where it gets tricky.\r\n\r\nA rough outline of how this could work:\r\n1. Diff (plan) the 1st stack\r\n2. Resyth/fill in the 2nd stack using the results of that plan\r\n3. Diff the 2nd stack","createdAt":"2022-10-08T16:53:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2157#issuecomment-1272357450","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5L3_QJ","author":{"login":"ste-wr"},"authorAssociation":"NONE","body":"@jsteinich That's how I assumed it would work.\r\n\r\nAre you suggesting that `diff` should work fine at the moment for multiple stacks where there's no dependency?  Because my experience (with 0.13.0 at least) is that this isn't the case.  In all cases, I get the `Could not find stack/specify a stack` error if I try to run vanilla `cdktf diff`.\r\n\r\nMaybe this is a docs improvement, because when I read that CDKTF supports multi-stack deployment, I kinda expect that the entire core command set (diff, synth, deploy, destroy) would support it.","createdAt":"2022-10-10T08:36:44Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2157#issuecomment-1272968201","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5MRkfi","author":{"login":"natemellendorf"},"authorAssociation":"CONTRIBUTOR","body":"I think we all understand the issue at hand, which is the way dynamic data blocks are created for stacks with dependencies. \r\n\r\nSo the CDK does this automatically. When you create two stacks, one that uses the output of another, the terraform synthesized will create the second stack with a dynamically named remote state data block.\r\n\r\nIn theory, it makes sense. In practice, it falls short. This is due to how a data block canâ€™t be planned if the resource it represents does not exist.\r\n\r\nPer this discussion, I donâ€™t think thereâ€™s any plan to address that behavior.\r\nhttps://github.com/hashicorp/terraform/issues/16380\r\n\r\nAt this point, I think this is in the hands of the CDKTF/TF team to solve. Either allow data blocks to return empty (so plans can succeed) or rework how CDKTF implements shared resources between two stacks.\r\n\r\nIf neither, then please communicate to the community that using CDKTF with multiple stacks is quite limited.\r\n","createdAt":"2022-10-15T06:26:06Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2157#issuecomment-1279674338","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5MSJGd","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> Are you suggesting that `diff` should work fine at the moment for multiple stacks where there's no dependency?\r\n\r\nNo. Apologizes if I gave that impression. I simply meant that it would be a simple addition for this case.\r\n\r\n\r\n\r\n> At this point, I think this is in the hands of the CDKTF/TF team to solve. Either allow data blocks to return empty (so plans can succeed) or rework how CDKTF implements shared resources between two stacks.\r\n\r\nI wouldn't expect this to change in Terraform directly (judging by their responses).\r\nThe CDKTF team applied a label (`needs-priority`) which means they are looking for community input to determine whether or not they will work on this. Even if they decide it's a lower priority, someone from the community is always welcome to contribute towards this.","createdAt":"2022-10-15T20:08:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2157#issuecomment-1279824285","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5uaoWk","author":{"login":"elovelan"},"authorAssociation":"NONE","body":"Will Terraform's native support for stacks help move this forward?\n\nIf so, can the community (myself included) help with implementation?","createdAt":"2023-12-12T17:19:48Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2157#issuecomment-1852474788","viewerDidAuthor":false}],"createdAt":"2022-10-02T19:54:05Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"},{"id":"MDU6TGFiZWwzMTQ2NjcxNDUz","name":"feature/multi-stack","description":"","color":"6589C9"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"},{"id":"LA_kwDODd1Amc7Zo-ep","name":"upstream/terraform","description":"Pending upstream work on Terraform","color":"844fba"}],"milestone":null,"number":2157,"title":"Unable to perform cdktf diff when using multiple stacks with inter-stack dependencies","updatedAt":"2023-12-12T17:21:16Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjI4ODI=","is_bot":false,"login":"nikolay","name":"Nikolay Kolev"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\nnode v16.17.1\r\ncdktf v0.12.2\r\n\r\n### Affected Resource(s)\r\n\r\n<!--- Please list the affected resources. --->\r\n\r\n### Debug Output\r\n\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\n```\r\n[redacted]/node_modules/yoga-layout-prebuilt/yoga-layout/build/Release/nbind.js:1146\r\n    }_nbind.throwError = throwError;_nbind.bigEndian = false;_a = _typeModule(_typeModule), _nbind.Type = _a.Type, _nbind.makeType = _a.makeType, _nbind.getComplexType = _a.getComplexType, _nbind.structureList = _a.structureList;var BindType = function (_super) {\r\n                                                             ^\r\n\r\nReferenceError: _a is not defined\r\n    at <anonymous> ([redacted]/node_modules/yoga-layout-prebuilt/yoga-layout/build/Release/nbind.js:1146:62)\r\n    at <anonymous> ([redacted]/node_modules/yoga-layout-prebuilt/yoga-layout/build/Release/nbind.js:1590:3)\r\n    at Object.<anonymous> ([redacted]/node_modules/yoga-layout-prebuilt/yoga-layout/dist/entry-browser.js:21:1)\r\n    at Module._compile (node:internal/modules/cjs/loader:1126:14)\r\n    at Object.v ([redacted]/node_modules/@esbuild-kit/cjs-loader/dist/index.js:1:933)\r\n    at Module.load (node:internal/modules/cjs/loader:1004:32)\r\n    at Function.Module._load (node:internal/modules/cjs/loader:839:12)\r\n    at Module.require (node:internal/modules/cjs/loader:1028:19)\r\n    at require (node:internal/modules/cjs/helpers:102:18)\r\n    at <anonymous> ([redacted]/node_modules/cdktf-cli/bundle/bin/cmds/handlers.js:389:21839)\r\n```\r\n\r\n### Expected Behavior\r\n\r\n<!--- What should have happened? --->\r\n\r\n### Actual Behavior\r\n\r\n<!--- What actually happened? --->\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Please list the steps required to reproduce the issue. --->\r\n\r\n### Important Factoids\r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n- https://github.com/vadimdemedes/yoga-layout-prebuilt/issues/2\r\n","comments":[],"createdAt":"2022-09-29T16:09:43Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjA5MTY3MTU4","name":"dependencies","description":"Auto-pinning","color":"FF9999"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"}],"milestone":null,"number":2151,"title":"The yoga-layout-prebuilt package is unmaintained and erroring out in strict mode","updatedAt":"2023-08-10T15:43:14Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"Let's remember this bit when refactoring the provider get generation at some point.\r\n\r\n        Wouldn't it be valuable to keep this field on a resource model? Where is the namespace living now?\r\nI'd refrain from having it implicit in multiple places instead of explicitly queried from here ğŸ¤”\r\n\r\n_Originally posted by @ansgarm in https://github.com/hashicorp/terraform-cdk/pull/2087#discussion_r978714103_\r\n      ","comments":[],"createdAt":"2022-09-29T15:49:35Z","labels":[{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2MjAxMTE5","name":"provider get / generation","description":"","color":"CC3938"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"}],"milestone":null,"number":2150,"title":"Generation: Refactor namespace field for code-generation","updatedAt":"2023-06-01T17:13:34Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjU3MzUzMQ==","is_bot":false,"login":"mutahhir","name":"Mutahhir Hayat"},"body":"All existing pre-built providers will be relocating to our new [Github organization `cdktf`](https://github.com/cdktf) (see #2135).\r\n\r\nFor the vast majority of CDKTF users, this wonâ€™t affect how you reference the providers, as youâ€™re consuming them through your language-specific package manager: NPM, PyPI, Maven, etc. However, for Golang users of CDKTF, this is something to be aware of. Soon, the module naming will switch from:\r\n\r\n```\r\ngithub.com/hashicorp/cdktf-provider-{provider name}-go \r\n```\r\n\r\nto \r\n\r\n```\r\ngithub.com/cdktf/cdktf-provider-{provider name}-go \r\n```\r\n\r\nThere is no need for any immediate action, but over the course of the next few days if you see the Go CLI complain about:\r\n\r\n```\r\ngo: github.com/hashicorp/cdktf-provider-hashicups-go/hashicups@v0.0.3: parsing go.mod:\r\n        module declares its path as: github.com/cdktf/cdktf-provider-hashicups-go/hashicups\r\n                but was required as: github.com/hashicorp/cdktf-provider-hashicups-go/hashicups\r\n```\r\n \r\nRegarding one or more of the pre-built providers, change the module path to the one with `github.com/cdktf`. \r\n\r\nYou could also use Go tools to do the replace for you (replace `hashicups` with your provider):\r\n\r\n```sh\r\n$ gofmt -w -r '\"github.com/hashicorp/cdktf-provider-hashicups-go/hashicups\" -> \"github.com/cdktf/cdktf-provider-hashicups-go/hashicups\"' ./\r\n$ go get # Fetch the prebuilt provider from the new module path\r\n$ go mod tidy # Remove old module path\r\n```\r\n\r\nAs another example, if you were using the AWS provider, the first command above becomes:\r\n\r\n```sh\r\n$ gofmt -w -r '\"github.com/hashicorp/cdktf-provider-aws-go/aws/v9\" -> \"github.com/cdktf/cdktf-provider-aws-go/aws/v9\"' ./\r\n```\r\n","comments":[{"id":"IC_kwDODd1Amc5LV2Xz","author":{"login":"RazaGR"},"authorAssociation":"NONE","body":"docs need to be updated https://learn.hashicorp.com/tutorials/terraform/cdktf-install?in=terraform/cdktf\r\n\r\nps. I am also getting node error when running cdk-go with default example:\r\n\r\n\r\n```\r\n $î‚° go run main.go\r\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n!!                                                                            !!\r\n!!  Node 17 has reached end-of-life on 2022-06-01 and is not supported.       !!\r\n!!  Please upgrade to a supported node version as soon as possible.           !!\r\n!!                                                                            !!\r\n!!  This software is currently running on node v17.4.0.                       !!\r\n!!  As of the current release of this software, supported node releases are:  !!\r\n!!  - ^18.0.0 (Planned end-of-life: 2025-04-30)                               !!\r\n!!  - ^16.3.0 (Planned end-of-life: 2023-09-11)                               !!\r\n!!  - ^14.6.0 (Planned end-of-life: 2023-04-30)                               !!\r\n!!                                                                            !!\r\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n```","createdAt":"2022-09-30T20:58:50Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2146#issuecomment-1264018931","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5LiiRF","author":{"login":"dzeediscoveryzone"},"authorAssociation":"NONE","body":"Hi All,\r\n\r\nI was hoping to get some assistance because I'm not able to get Go to work with 0.13.0 due to the provider organization change. I started from scratch with a vanilla project:\r\n\r\n`cdktf init --template=go --cdktf-version 0.13.0 --project-name ec2 --project-description \"A demo cdktf project using Go which deploys an EC2 instance\"`\r\n\r\nThen I went ahead and added the provider `cdktf provider add \"aws@~>4.0\"` which as expected adds the _old_ provider:\r\n\r\n```sh\r\ncdktf provider add \"aws@~>4.0\"\r\nChecking whether pre-built provider exists for the following constraints:\r\n  provider: aws\r\n  version : ~>4.0\r\n  language: go\r\n  cdktf   : 0.13.0\r\n\r\nFound pre-built provider.\r\nAdding package github.com/hashicorp/cdktf-provider-aws-go/aws @ 10.0.1\r\n[2022-10-04T13:35:25.152] [ERROR] default - go: upgraded github.com/aws/constructs-go/constructs/v10 v10.1.113 => v10.1.121\r\ngo: upgraded github.com/aws/jsii-runtime-go v1.68.0 => v1.69.0\r\ngo: added github.com/hashicorp/cdktf-provider-aws-go/aws/v10 v10.0.1\r\n\r\ngo: upgraded github.com/aws/constructs-go/constructs/v10 v10.1.113 => v10.1.121\r\ngo: upgraded github.com/aws/jsii-runtime-go v1.68.0 => v1.69.0\r\ngo: added github.com/hashicorp/cdktf-provider-aws-go/aws/v10 v10.0.1\r\nPackage installed.\r\n```\r\n\r\nEverything looks good so far except when I try to replace the org from hashicorp -> cdktf (I have tried both via gofmt, manually, as well running `go get -u github.com/cdktf/cdktf-provider-aws-go/aws/v10`, see below following the above instructions:\r\n\r\nAll of the above results in nothing being changed and when manually changing and running go get it fails with the error you presented in your wiki. Maybe I am missing something but I have been unsuccessful.\r\n\r\nI also attempted manually installing it:\r\n\r\n```sh\r\ngo get -u github.com/cdktf/cdktf-provider-aws-go/aws/v10\r\ngo: github.com/cdktf/cdktf-provider-aws-go/aws/v10@v10.0.1: parsing go.mod:\r\n        module declares its path as: github.com/hashicorp/cdktf-provider-aws-go/aws/v10\r\n                but was required as: github.com/cdktf/cdktf-provider-aws-go/aws/v10\r\n```","createdAt":"2022-10-04T17:43:19Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2146#issuecomment-1267344453","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5LlcEL","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"@dzeediscoveryzone Sorry, this was a bit of a timing issue on our part, but v10.0.2 of the AWS provider should work out of the box for your use case. v10.0.1 was still referencing the old Github repo path in it's `go.mod` file, which caused issues.\r\n\r\nCan you try again with v10.0.2 and see if it works? I believe just running `cdktf provider add \"aws@~>4.0\"` would pull in the new version","createdAt":"2022-10-05T08:19:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2146#issuecomment-1268105483","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5LmwKf","author":{"login":"dzeediscoveryzone"},"authorAssociation":"NONE","body":"@mutahhir no problem at all and thank you for the quick turnaround! My issue is now resolved. ğŸ‰ ","createdAt":"2022-10-05T13:34:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HOORAY","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2146#issuecomment-1268449951","viewerDidAuthor":false}],"createdAt":"2022-09-29T09:37:22Z","labels":[{"id":"MDU6TGFiZWwzMDMwODE1NTQy","name":"language/golang","description":"","color":"22ED90"},{"id":"LA_kwDODd1Amc78pgm0","name":"pre-built providers","description":"Issues around pre-built providers managed at https://github.com/hashicorp/cdktf-repository-manager","color":"E06AA9"},{"id":"LA_kwDODd1Amc8AAAABEqTZcQ","name":"notice","description":"Internal use only. An issue being used by the maintainers to flag something for the community.","color":"E1A241"}],"milestone":null,"number":2146,"title":"[Notice] Moving pre-built providers to the `cdktf` Github organization","updatedAt":"2022-10-05T13:34:35Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE5ODY5NTA=","is_bot":false,"login":"paymog","name":"Paymahn Moghadasian"},"body":"### cdktf & Language Versions\r\n\r\ntypescript 0.12.2\r\n\r\n### Issue\r\n\r\nI just installed the cdktf-cli at version 0.12.2 and I'm seeing it has unmet peer dependencies. Is this by design? \r\n\r\n```\r\n$ yarn add cdktf@latest cdktf-cli@latest\r\n[1/5] ğŸ”  Validating package.json...\r\n[2/5] ğŸ”  Resolving packages...\r\n[3/5] ğŸšš  Fetching packages...\r\n[4/5] ğŸ”—  Linking dependencies...\r\nwarning \"cdktf-cli > ink-select-input@4.2.1\" has unmet peer dependency \"ink@^3.0.5\".\r\nwarning \"cdktf-cli > ink-select-input@4.2.1\" has unmet peer dependency \"react@^16.5.2 || ^17.0.0\".\r\nwarning \"cdktf-cli > @cdktf/hcl2cdk > graphology@0.24.1\" has incorrect peer dependency \"graphology-types@>=0.24.0\".\r\n```\r\n\r\nI know I can install these dependencies myself but it seems unusual that a cli would require react. \r\n\r\n","comments":[{"id":"IC_kwDODd1Amc5MN4Ex","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @paymog ğŸ‘‹\r\n\r\nWe're using `ink` for the terminal UI, which is React based.\r\n\r\nRegarding the unmet peer dependencies: We [bundle](https://github.com/hashicorp/terraform-cdk/blob/9f226f0e6c48be366d7ec33c74d03f52f14eff5d/packages/cdktf-cli/build.ts#L54) the entrypoint to our CLI, which contains the peer dependencies (they are inlined). However, we still distribute the `lib` directory, so users could do e.g. `import xy from 'cdktf-cli/lib/some-internal-thing` (related to #1377) â€“ for which those peer dependencies make sense to specify but they aren't required for using the cli itself.\r\n\r\nThis is a bit tricky, but I feel that we might fix it by changing the peer dependencies to normal dependencies to get rid of that warning â€“ especially since (when importing from the package directly), users won't have to manually install all the missing dependencies by hand ğŸ¤”","createdAt":"2022-10-14T09:00:19Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2143#issuecomment-1278705969","viewerDidAuthor":false}],"createdAt":"2022-09-27T15:34:34Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"}],"milestone":null,"number":2143,"title":"Unmet peer dependencies for the cli","updatedAt":"2022-10-14T09:01:36Z"},{"assignees":[{"id":"MDQ6VXNlcjU3MzUzMQ==","login":"mutahhir","name":"Mutahhir Hayat","databaseId":0}],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nCurrently we do have a precommit hook that runs `yarn generate-docs:api` (if changes were made to the `cdktf` package). This runs between 3 to 6 minutes and interrupts the workflow.\r\n\r\nWe should change this to be a Github Workflow that runs on PRs and makes a commit if the docs were outdated (i.e. if running that command produced changes).\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-09-16T14:48:29Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTU1MzExNDc0","name":"dev-process","description":"Improvements to how CDK for Terraform is developed and built","color":"F6A4ED"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"}],"milestone":null,"number":2129,"title":"Add Github Action for PRs that updates API docs (instead of precommit hook)","updatedAt":"2023-08-21T09:23:19Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nCurrently there are docstrings for properties that can be set in config objects, for example:\r\n```ts\r\n/**\r\n  * Docs at Terraform Registry: {@link https://www.terraform.io/docs/providers/aws/r/s3_bucket#bucket S3Bucket#bucket}\r\n  */\r\nreadonly bucket?: string;\r\n```\r\n([source](https://github.com/hashicorp/cdktf-provider-aws/blob/ea5a2a5a45b6d5ed0a02b2f821ab6b5fd67a2aac/src/s3/s3-bucket.ts#L22-L25))\r\n\r\nbut not on setters or getters:\r\n```ts\r\npublic get bucket() {\r\n  return this.getStringAttribute('bucket');\r\n}\r\npublic set bucket(value: string) {\r\n  this._bucket = value;\r\n}\r\n```\r\n([source](https://github.com/hashicorp/cdktf-provider-aws/blob/ea5a2a5a45b6d5ed0a02b2f821ab6b5fd67a2aac/src/s3/s3-bucket.ts#L2022-L2027))\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-09-16T11:08:13Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2MjAxMTE5","name":"provider get / generation","description":"","color":"CC3938"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"}],"milestone":null,"number":2121,"title":"Add docstrings for setters and getters in generated bindings as well","updatedAt":"2023-09-29T12:53:22Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nWe currently only use `variable.value` in the [documentation](https://www.terraform.io/cdktf/concepts/variables-and-outputs#define-input-variables), but value is unsuitable for non-TS languages. We should add examples that use all sorts of value types, e.g. strings, numbers, booleans, lists, maps and show how they are all used.\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-09-13T18:00:03Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":2114,"title":"Improve TerraformVariable docs to mention stringValue, numberValue, etc","updatedAt":"2023-06-28T18:26:11Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nCurrently a TerraformAsset would copy (& zip) everything in the directory it points to, but sometimes you don't need all the files but a subset. We currently advise users to clean up before running cdktf, but having a glob-syntax list of things to ignore as a configuration to an asset would be a better UX.\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n\r\n- There is a .terraformignore: https://www.terraform.io/language/settings/backends/remote#excluding-files-from-upload-with-terraformignore\r\n","comments":[],"createdAt":"2022-09-13T15:40:11Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":2113,"title":"Allow to ignore files from TerraformAsset","updatedAt":"2023-06-01T15:02:01Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nTo clear up [confusions like this one](https://github.com/hashicorp/terraform-cdk/issues/1528#issuecomment-1245192917) we should add a bit of documentation to the tokens page that explains run-time vs synth-time concerns.\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-09-13T10:49:42Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"},{"id":"MDU6TGFiZWwzMjM2NDcwNTQ1","name":"feature/tokens","description":"","color":"58CF13"}],"milestone":null,"number":2109,"title":"Explain synth vs execution time on Tokens page","updatedAt":"2023-06-28T18:26:00Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE2MjA0NDUy","is_bot":false,"login":"benkeil","name":"Ben Keil"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n```\r\ncom.hashicorp:cdktf:0.12.1\r\nsoftware.constructs:constructs:10.1.79\r\ncom.hashicorp:cdktf-provider-aws:9.0.15\r\ncom.hashicorp:cdktf-provider-vault:2.0.34\r\n\r\nterraform version\r\nTerraform v1.2.8\r\non darwin_arm64\r\n\r\ncdktf --version\r\n0.12.1\r\n```\r\n\r\n### Affected Resource(s)\r\n\r\nCan't load more then 1 module with cdktf java \r\n\r\n### Debug Output\r\n\r\n\r\n```\r\njava.lang.reflect.InvocationTargetException\r\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:77)\r\n\tat java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n\tat java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Constructor.java:499)\r\n\tat java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:480)\r\n\tat kotlin.reflect.jvm.internal.calls.CallerImpl$Constructor.call(CallerImpl.kt:41)\r\n\tat kotlin.reflect.jvm.internal.KCallableImpl.call(KCallableImpl.kt:108)\r\n\tat io.kotest.engine.spec.InstantiateSpecKt.javaReflectNewInstance(instantiateSpec.kt:51)\r\n\tat io.kotest.engine.spec.InstantiateSpecKt.createAndInitializeSpec(instantiateSpec.kt:30)\r\n\tat io.kotest.engine.spec.InstantiateSpecKt.instantiate(instantiateSpec.kt:11)\r\n\tat io.kotest.engine.spec.SpecRefKt.instance(SpecRef.kt:14)\r\n\tat io.kotest.engine.spec.SpecExecutor.createInstance-gIAlu-s(SpecExecutor.kt:127)\r\n\tat io.kotest.engine.spec.SpecExecutor.access$createInstance-gIAlu-s(SpecExecutor.kt:48)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$innerExecute$1.invokeSuspend(SpecExecutor.kt:85)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$innerExecute$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$innerExecute$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.interceptor.FinalizeSpecInterceptor.intercept-0E7RQCE(FinalizeSpecInterceptor.kt:19)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invokeSuspend(SpecExecutor.kt:90)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.interceptor.PrepareSpecInterceptor.intercept-0E7RQCE(PrepareSpecInterceptor.kt:20)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invokeSuspend(SpecExecutor.kt:90)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.interceptor.ApplyExtensionsInterceptor.intercept-0E7RQCE(ApplyExtensionsInterceptor.kt:35)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invokeSuspend(SpecExecutor.kt:90)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.interceptor.SpecFinishedInterceptor.intercept-0E7RQCE(SpecFinishedInterceptor.kt:21)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invokeSuspend(SpecExecutor.kt:90)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.interceptor.SpecStartedInterceptor.intercept-0E7RQCE(SpecStartedInterceptor.kt:19)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invokeSuspend(SpecExecutor.kt:90)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.interceptor.SpecRefExtensionInterceptor$intercept$inner$1.invokeSuspend(SpecRefExtensionInterceptor.kt:27)\r\n\tat io.kotest.engine.spec.interceptor.SpecRefExtensionInterceptor$intercept$inner$1.invoke(SpecRefExtensionInterceptor.kt)\r\n\tat io.kotest.engine.spec.interceptor.SpecRefExtensionInterceptor$intercept$inner$1.invoke(SpecRefExtensionInterceptor.kt)\r\n\tat io.kotest.engine.spec.interceptor.SpecRefExtensionInterceptor.intercept-0E7RQCE(SpecRefExtensionInterceptor.kt:30)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invokeSuspend(SpecExecutor.kt:90)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.interceptor.RequiresTagSpecInterceptor.intercept-0E7RQCE(RequiresTagSpecInterceptor.kt:35)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invokeSuspend(SpecExecutor.kt:90)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.interceptor.TagsExcludedSpecInterceptor.intercept-0E7RQCE(TagsExcludedDiscoveryExtension.kt:32)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invokeSuspend(SpecExecutor.kt:90)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.interceptor.SystemPropertySpecFilterInterceptor.intercept-0E7RQCE(SystemPropertySpecFilterInterceptor.kt:49)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invokeSuspend(SpecExecutor.kt:90)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.interceptor.SpecFilterInterceptor.intercept-0E7RQCE(SpecFilterInterceptor.kt:37)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invokeSuspend(SpecExecutor.kt:90)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.interceptor.IgnoredSpecInterceptor.intercept-0E7RQCE(IgnoredSpecInterceptor.kt:52)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invokeSuspend(SpecExecutor.kt:90)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.interceptor.EnabledIfSpecInterceptor.intercept-0E7RQCE(EnabledIfSpecInterceptor.kt:40)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invokeSuspend(SpecExecutor.kt:90)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.SpecExecutor$referenceInterceptors$3$1.invoke(SpecExecutor.kt)\r\n\tat io.kotest.engine.spec.SpecExecutor.referenceInterceptors(SpecExecutor.kt:91)\r\n\tat io.kotest.engine.spec.SpecExecutor.execute(SpecExecutor.kt:60)\r\n\tat io.kotest.engine.ConcurrentTestSuiteScheduler$schedule$8$1$2.invokeSuspend(ConcurrentTestSuiteScheduler.kt:71)\r\n\tat kotlin.coroutines.jvm.internal.BaseContinuationImpl.resumeWith(ContinuationImpl.kt:33)\r\n\tat kotlinx.coroutines.DispatchedTask.run(DispatchedTask.kt:106)\r\n\tat kotlinx.coroutines.EventLoopImplBase.processNextEvent(EventLoop.common.kt:284)\r\n\tat kotlinx.coroutines.BlockingCoroutine.joinBlocking(Builders.kt:85)\r\n\tat kotlinx.coroutines.BuildersKt__BuildersKt.runBlocking(Builders.kt:59)\r\n\tat kotlinx.coroutines.BuildersKt.runBlocking(Unknown Source)\r\n\tat kotlinx.coroutines.BuildersKt__BuildersKt.runBlocking$default(Builders.kt:38)\r\n\tat kotlinx.coroutines.BuildersKt.runBlocking$default(Unknown Source)\r\n\tat io.kotest.common.RunBlockingKt.runBlocking(runBlocking.kt:3)\r\n\tat io.kotest.engine.TestEngineLauncher.launch(TestEngineLauncher.kt:194)\r\n\tat io.kotest.runner.junit.platform.KotestJunitPlatformTestEngine.execute(KotestJunitPlatformTestEngine.kt:82)\r\n\tat io.kotest.runner.junit.platform.KotestJunitPlatformTestEngine.execute(KotestJunitPlatformTestEngine.kt:46)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:108)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)\r\n\tat org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:96)\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:75)\r\n\tat org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.processAllTestClasses(JUnitPlatformTestClassProcessor.java:99)\r\n\tat org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor$CollectAllTestClassesExecutor.access$000(JUnitPlatformTestClassProcessor.java:79)\r\n\tat org.gradle.api.internal.tasks.testing.junitplatform.JUnitPlatformTestClassProcessor.stop(JUnitPlatformTestClassProcessor.java:75)\r\n\tat org.gradle.api.internal.tasks.testing.SuiteTestClassProcessor.stop(SuiteTestClassProcessor.java:61)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:568)\r\n\tat org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:36)\r\n\tat org.gradle.internal.dispatch.ReflectionDispatch.dispatch(ReflectionDispatch.java:24)\r\n\tat org.gradle.internal.dispatch.ContextClassLoaderDispatch.dispatch(ContextClassLoaderDispatch.java:33)\r\n\tat org.gradle.internal.dispatch.ProxyDispatchAdapter$DispatchingInvocationHandler.invoke(ProxyDispatchAdapter.java:94)\r\n\tat jdk.proxy1/jdk.proxy1.$Proxy2.stop(Unknown Source)\r\n\tat org.gradle.api.internal.tasks.testing.worker.TestWorker$3.run(TestWorker.java:193)\r\n\tat org.gradle.api.internal.tasks.testing.worker.TestWorker.executeAndMaintainThreadName(TestWorker.java:129)\r\n\tat org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:100)\r\n\tat org.gradle.api.internal.tasks.testing.worker.TestWorker.execute(TestWorker.java:60)\r\n\tat org.gradle.process.internal.worker.child.ActionExecutionWorker.execute(ActionExecutionWorker.java:56)\r\n\tat org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:133)\r\n\tat org.gradle.process.internal.worker.child.SystemApplicationClassLoaderWorker.call(SystemApplicationClassLoaderWorker.java:71)\r\n\tat worker.org.gradle.process.internal.worker.GradleWorkerMain.run(GradleWorkerMain.java:69)\r\n\tat worker.org.gradle.process.internal.worker.GradleWorkerMain.main(GradleWorkerMain.java:74)\r\nCaused by: software.amazon.jsii.JsiiException: Module 'terraform-aws-modules_s3-bucket_aws' not found\r\nError: Module 'terraform-aws-modules_s3-bucket_aws' not found\r\n    at exports.Kernel._typeInfoForFqn (/private/var/folders/c9/_w7dcm_1539b_fwzc6zs7gf40000gq/T/jsii-java-runtime7564311983626734599/lib/program.js:5359:38)\r\n    at exports.Kernel._findCtor (/private/var/folders/c9/_w7dcm_1539b_fwzc6zs7gf40000gq/T/jsii-java-runtime7564311983626734599/lib/program.js:5156:39)\r\n    at exports.Kernel._create (/private/var/folders/c9/_w7dcm_1539b_fwzc6zs7gf40000gq/T/jsii-java-runtime7564311983626734599/lib/program.js:5181:144)\r\n    at exports.Kernel.create (/private/var/folders/c9/_w7dcm_1539b_fwzc6zs7gf40000gq/T/jsii-java-runtime7564311983626734599/lib/program.js:4989:29)\r\n    at exports.KernelHost.processRequest (/private/var/folders/c9/_w7dcm_1539b_fwzc6zs7gf40000gq/T/jsii-java-runtime7564311983626734599/lib/program.js:6083:36)\r\n    at exports.KernelHost.run (/private/var/folders/c9/_w7dcm_1539b_fwzc6zs7gf40000gq/T/jsii-java-runtime7564311983626734599/lib/program.js:6057:48)\r\n    at Immediate._onImmediate (/private/var/folders/c9/_w7dcm_1539b_fwzc6zs7gf40000gq/T/jsii-java-runtime7564311983626734599/lib/program.js:6058:46)\r\n    at processImmediate (node:internal/timers:466:21)\r\n\tat software.amazon.jsii.JsiiRuntime.processErrorResponse(JsiiRuntime.java:124)\r\n\tat software.amazon.jsii.JsiiRuntime.requestResponse(JsiiRuntime.java:95)\r\n\tat software.amazon.jsii.JsiiClient.createObject(JsiiClient.java:89)\r\n\tat software.amazon.jsii.JsiiEngine.createNewObject(JsiiEngine.java:603)\r\n\tat imports.terraform_aws_modules.aws.S3Bucket.<init>(S3Bucket.java:17)\r\n\tat imports.terraform_aws_modules.aws.S3Bucket$Builder.build(S3Bucket.java:849)\r\n\tat de.otto.di.KotlinLambdaBuilderTest$1$stack$1.invoke(KotlinLambdaBuilderTest.kt:26)\r\n\tat de.otto.di.KotlinLambdaBuilderTest$1$stack$1.invoke(KotlinLambdaBuilderTest.kt:22)\r\n\tat de.otto.di.core.TerraformStackKt.<init>(TerraformStackKt.kt:8)\r\n\tat de.otto.di.KotlinLambdaBuilderTest$1.invoke(KotlinLambdaBuilderTest.kt:23)\r\n\tat de.otto.di.KotlinLambdaBuilderTest$1.invoke(KotlinLambdaBuilderTest.kt:20)\r\n\tat io.kotest.core.spec.style.FunSpec.<init>(funSpec.kt:25)\r\n\tat de.otto.di.KotlinLambdaBuilderTest.<init>(KotlinLambdaBuilderTest.kt:20)\r\n\t... 111 more\r\n```\r\n\r\n`cdktf.json`\r\n\r\n```\r\n{\r\n  \"language\": \"java\",\r\n  \"app\": \"./gradlew run\",\r\n  \"projectId\": \"cde4307b-d5d5-453d-a811-e51775ecc7d0\",\r\n  \"sendCrashReports\": \"false\",\r\n  \"codeMakerOutput\": \"src/main/java/imports\",\r\n  \"terraformProviders\": [],\r\n  \"terraformModules\": [\r\n    \"terraform-aws-modules/lambda/aws\",\r\n    \"terraform-aws-modules/s3-bucket/aws\"\r\n  ],\r\n  \"context\": {\r\n    \"excludeStackIdFromLogicalIds\": \"false\",\r\n    \"allowSepCharsInLogicalIds\": \"true\"\r\n  }\r\n}\r\n```\r\n\r\nEverything gets downloaded, but the $Modul.java seems to be wrong.\r\n\r\ncontent of `src/main/java/imports/terraform_aws_modules/aws/`\r\n\r\n```\r\n$Module.java\r\nLambda.java\r\nLambdaOptions.java\r\nS3Bucket.java\r\nS3BucketOptions.java\r\n```\r\n\r\ncontent of `src/main/java/imports/terraform_aws_modules/aws/$Module.java`\r\n\r\n```java\r\npackage imports.terraform_aws_modules.aws;\r\n\r\nimport static java.util.Arrays.asList;\r\n\r\nimport java.io.BufferedReader;\r\nimport java.io.InputStream;\r\nimport java.io.InputStreamReader;\r\nimport java.io.IOException;\r\nimport java.io.Reader;\r\nimport java.io.UncheckedIOException;\r\n\r\nimport java.nio.charset.StandardCharsets;\r\n\r\nimport java.util.HashMap;\r\nimport java.util.List;\r\nimport java.util.Map;\r\n\r\nimport software.amazon.jsii.JsiiModule;\r\n\r\n@software.amazon.jsii.Internal\r\npublic final class $Module extends JsiiModule {\r\n    private static final Map<String, String> MODULE_TYPES = load();\r\n\r\n    private static Map<String, String> load() {\r\n        final Map<String, String> result = new HashMap<>();\r\n        final ClassLoader cl = $Module.class.getClassLoader();\r\n        try (final InputStream is = cl.getResourceAsStream(\"imports/terraform_aws_modules/aws/$Module.txt\");\r\n             final Reader rd = new InputStreamReader(is, StandardCharsets.UTF_8);\r\n             final BufferedReader br = new BufferedReader(rd)) {\r\n            br.lines()\r\n              .filter(line -> !line.trim().isEmpty())\r\n              .forEach(line ->  {\r\n                final String[] parts = line.split(\"=\", 2);\r\n                final String fqn = parts[0];\r\n                final String className = parts[1];\r\n                result.put(fqn, className);\r\n            });\r\n        }\r\n        catch (final IOException exception) {\r\n            throw new UncheckedIOException(exception);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    private final Map<String, Class<?>> cache = new HashMap<>();\r\n\r\n    public $Module() {\r\n        super(\"terraform-aws-modules_lambda_aws\", \"0.0.0\", $Module.class, \"terraform-aws-modules_lambda_aws@0.0.0.jsii.tgz\");\r\n    }\r\n\r\n    @Override\r\n    public List<Class<? extends JsiiModule>> getDependencies() {\r\n        return asList(com.hashicorp.cdktf.$Module.class, software.constructs.$Module.class);\r\n    }\r\n\r\n    @Override\r\n    protected Class<?> resolveClass(final String fqn) throws ClassNotFoundException {\r\n        if (!MODULE_TYPES.containsKey(fqn)) {\r\n            throw new ClassNotFoundException(\"Unknown JSII type: \" + fqn);\r\n        }\r\n        String className = MODULE_TYPES.get(fqn);\r\n        if (!this.cache.containsKey(className)) {\r\n            this.cache.put(className, this.findClass(className));\r\n        }\r\n        return this.cache.get(className);\r\n    }\r\n\r\n    private Class<?> findClass(final String binaryName) {\r\n        try {\r\n            return Class.forName(binaryName);\r\n        }\r\n        catch (final ClassNotFoundException exception) {\r\n            throw new RuntimeException(exception);\r\n        }\r\n    }\r\n}\r\n```\r\n\r\ncontent of `src/main/resources/imports/terraform_aws_modules/aws/`\r\n\r\n```\r\n$Module.txt\r\nterraform-aws-modules_lambda_aws@0.0.0.jsii.tgz\r\nterraform-aws-modules_s3-bucket_aws@0.0.0.jsii.tgz\r\n```\r\n\r\ncontent of `src/main/resources/imports/terraform_aws_modules/aws/$Module.txt`\r\n\r\n```\r\nterraform-aws-modules_lambda_aws.Lambda=imports.terraform_aws_modules.aws.Lambda\r\nterraform-aws-modules_lambda_aws.LambdaOptions=imports.terraform_aws_modules.aws.LambdaOptions\r\n```\r\n\r\n### Expected Behavior\r\n\r\nShould synthesize the stack\r\n\r\n### Actual Behavior\r\n\r\nException\r\n\r\n### Steps to Reproduce\r\n\r\n1. `cdktf init --template=java`\r\n1. Add 2 modules, e.g. `terraform-aws-modules/lambda/aws` and `terraform-aws-modules/s3-bucket/aws`\r\n1. Add one resource of each type2. \r\n1. synthesise the app\r\n\r\n### Important Factoids\r\n\r\nI let it run with Kolin, but I also tried a plain java project and java the same error.\r\n","comments":[{"id":"IC_kwDODd1Amc5JwDW-","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"The auto naming is treating them both as having the name `aws`. This results in the output being partially overridden.\r\nYou can manually specify the names so that don't collide:\r\n```json\r\n\"terraformModules\": [\r\n          {\r\n                  \"source\": \"terraform-aws-modules/lambda/aws\",\r\n                  \"name\": \"lambda\"\r\n          },\r\n          {\r\n                \"source\": \"terraform-aws-modules/s3-bucket/aws\",\r\n                \"name\": \"s3\"\r\n          }\r\n  ]\r\n```","createdAt":"2022-09-05T17:31:56Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2073#issuecomment-1237333438","viewerDidAuthor":false}],"createdAt":"2022-08-28T16:07:43Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjE3NjIyNTkw","name":"modules","description":"","color":"2ffc8f"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2MjAxMTE5","name":"provider get / generation","description":"","color":"CC3938"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":2073,"title":"Cant't load more then 1 module in Java","updatedAt":"2023-06-01T14:31:00Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nCreate an example per language on how to use Terraform modules, ideally showing both a module from the registry and a local one.\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n\r\n- Part of #2053\r\n","comments":[],"createdAt":"2022-08-26T13:32:32Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyNzQzNTkyMDA3","name":"examples","description":"","color":"4AB3A0"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":2072,"title":"Create examples using modules","updatedAt":"2023-06-28T18:26:45Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nThis will help users understand how to work with data sources and follow best practices, e.g. for not hard-coding AMIs\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n\r\n- Part of #2053","comments":[],"createdAt":"2022-08-26T13:28:57Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyNzQzNTkyMDA3","name":"examples","description":"","color":"4AB3A0"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":2071,"title":"Use DataSources in the examples where possible","updatedAt":"2023-06-28T18:28:17Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nAs [mentioned](https://github.com/hashicorp/terraform-cdk/pull/2035#discussion_r951586064) by @a-h in #2035, we should not have the `replace` directive in the `go.mod` of our Go examples all the time but rather only add it when testing those examples in CI. Without the `replace` directive users could copy an individual Go example and use it as is.\r\n\r\nSo let's only add it in CI (e.g. in the existing `reinstall` script or in a separate CI-setup step).\r\nWe need to check, though, whether we also need to change the version for CDKTF from e.g. `0.12.0` to `0.0.0`.\r\nFurthermore it might make sense to add a script that can update the versions in the examples whenever we release a new major (aka minor while still below 1.0) version.\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-08-23T07:04:53Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyNzQzNTkyMDA3","name":"examples","description":"","color":"4AB3A0"},{"id":"MDU6TGFiZWwzMDMwODE1NTQy","name":"language/golang","description":"","color":"22ED90"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"}],"milestone":null,"number":2041,"title":"Remove `replace` directive from Go examples (add on-demand when running in CI instead)","updatedAt":"2023-06-01T17:52:20Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjMxMjU2MDc2","is_bot":false,"login":"aadhikary","name":""},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\ncdktf v0.12.1\r\ntypescript\r\n\r\n### Affected Resource(s)\r\n\r\nDeployed stacks cannot be easily torn down\r\n\r\n### Expected Behavior\r\n\r\nCDKTF should look into the state file and if notthing is deployed for a stack then it should gracefully get out and proceed to next stack on the dependency hierarchy list\r\n\r\n### Actual Behavior\r\n\r\nCDKTF tries to destroy stacks that do not exists and in some cases specially for Data constructs throws errors as :\r\n**data.terraform_remote_state.cross-stack-reference-input-SiteBNetworking.outputs is object with no attributes**\r\nEventhough this stack has not been deployed at all.\r\n\r\nI have seend this issue specially with Data construct for references","comments":[{"id":"IC_kwDODd1Amc5JNQRH","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Yeah, that is a good idea to improve the UX this way! We currently don't track if a deploy happened or not in CDKTF and therefore treat the stack selection as the complete truth of which stacks to destroy. Checking for an existing state and filtering out stacks without an existing state would be a good idea, I agree!","createdAt":"2022-08-26T08:28:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2031#issuecomment-1228211271","viewerDidAuthor":false}],"createdAt":"2022-08-19T08:40:49Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"},{"id":"MDU6TGFiZWwzMTQ2NjcxNDUz","name":"feature/multi-stack","description":"","color":"6589C9"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"}],"milestone":null,"number":2031,"title":"cdktf destroy with wildcard characters tries to destroy stacks that has not been deployed and can cause error","updatedAt":"2023-06-01T15:00:29Z"},{"assignees":[{"id":"MDQ6VXNlcjExMTIwNTY=","login":"ansgarm","name":"Ansgar Mertens","databaseId":0},{"id":"MDQ6VXNlcjEzMzcwNDY=","login":"DanielMSchmidt","name":"Daniel Schmidt","databaseId":0}],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n\r\nWe could use the [benchmark-action](https://github.com/benchmark-action/github-action-benchmark) to benchmark both the cdktf synth and get performance across languages to keep in mind to not worsen the current situation performance wise. This is the workflow the [jsii team uses](https://github.com/aws/jsii/blob/main/.github/workflows/main.yml#L361).\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-08-17T20:53:09Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTU1MzExNDc0","name":"dev-process","description":"Improvements to how CDK for Terraform is developed and built","color":"F6A4ED"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"},{"id":"LA_kwDODd1Amc8AAAABEqTcrA","name":"performance","description":"Gotta go fast","color":"890D75"}],"milestone":null,"number":2029,"title":"Performance: Create a benchmark for incoming changes","updatedAt":"2023-06-01T16:09:00Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEyNzIzNTk0","is_bot":false,"login":"lucasvieirasilva","name":"Lucas Vieira"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nThis feature is about adding the CLI option `--context` or `-c` to pass runtime context values to your CDK app, like in the AWS CDK.\r\n\r\nThis feature can be helpful in providing runtime values to the CDK app using a CLI format, currently, the only way is using environment variables.\r\n\r\n### References\r\n\r\n- [AWS CDK CLI](https://docs.aws.amazon.com/cdk/v2/guide/cli.html)\r\n","comments":[{"id":"IC_kwDODd1Amc5IR6Gq","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"#347 has some additional thoughts on this topic.","createdAt":"2022-08-12T01:50:56Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2019#issuecomment-1212653994","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5ITWU7","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"One can use a workaround by passing your context values in as environment variables and read them from your CDKTF program. I think one can also put them in the cdktf.json's context section, right @jsteinich ?","createdAt":"2022-08-12T11:52:50Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2019#issuecomment-1213031739","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5ITYiB","author":{"login":"lucasvieirasilva"},"authorAssociation":"NONE","body":"> One can use a workaround by passing your context values in as environment variables and read them from your CDKTF program. I think one can also put them in the cdktf.json's context section, right @jsteinich ?\r\n\r\nYes, if you add in the `cdktf.json` you cannot change at runtime like you can in the AWS CDK by passing the `--context var1=value1`.\r\n\r\nRegarding the values as environment variables, I'm already doing that.","createdAt":"2022-08-12T12:04:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2019#issuecomment-1213040769","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5vQmRu","author":{"login":"jamrod"},"authorAssociation":"NONE","body":"This is essential for maintaining multi-environment stacks, please integrate this functionality","createdAt":"2023-12-21T16:40:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/2019#issuecomment-1866622062","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6YI19O","author":{"login":"billyjbryant"},"authorAssociation":"NONE","body":"Any word on context support in CDKTF? ","createdAt":"2024-12-18T23:24:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2019#issuecomment-2552454990","viewerDidAuthor":false}],"createdAt":"2022-08-11T20:26:39Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":2019,"title":"Specifying context values in the CDKTF CLI","updatedAt":"2024-12-18T23:24:56Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjQxODg2OA==","is_bot":false,"login":"a0s","name":"Anton Osenenko"},"body":"Not sure is it bug or feature\r\n\r\nThis is not working\r\n\r\n```typescript\r\nconst resolverEndpoint = new Route53ResolverEndpoint(this, \"resolver_endpoint\", <Route53ResolverEndpointConfig>{\r\n      provider: config.provider,\r\n      direction: \"INBOUND\",\r\n      securityGroupIds: [this.resolverSecurityGroup.id],\r\n      ipAddress: subnetIdsIterator.dynamic(<Route53ResolverEndpointIpAddress>{\r\n        subnetId: subnetIdsIterator.key\r\n      }),\r\n      tags: {\r\n        Name: \"vpn-resolver\"\r\n      }\r\n    })\r\n```\r\n\r\n```\r\nâ”‚ Error: Extraneous JSON object property\r\nâ”‚ \r\nâ”‚   on cdk.tf.json line 1859, in resource.aws_route53_resolver_endpoint.vpn_endpoint_resolver_endpoint_61EF1F6A.dynamic.ip_address.content:\r\nâ”‚ 1859:               \"subnetId\": \"${each.key}\"\r\nâ”‚ \r\nâ”‚ No argument or block type is named \"subnetId\". Did you mean \"subnet_id\"?\r\nâ•µ\r\nâ•·\r\nâ”‚ Error: Missing required argument\r\nâ”‚ \r\nâ”‚   on cdk.tf.json line 1860, in resource.aws_route53_resolver_endpoint.vpn_endpoint_resolver_endpoint_61EF1F6A.dynamic.ip_address.content:\r\nâ”‚ 1860:             },\r\nâ”‚ \r\nâ”‚ The argument \"subnet_id\" is required, but no definition was found.\r\n\r\n```\r\n\r\nBut this works ok (but my perfectionism suffers at this point due to the use of an untyped struct)\r\n```typescript\r\nconst resolverEndpoint = new Route53ResolverEndpoint(this, \"resolver_endpoint\", <Route53ResolverEndpointConfig>{\r\n      provider: config.provider,\r\n      direction: \"INBOUND\",\r\n      securityGroupIds: [this.resolverSecurityGroup.id],\r\n      ipAddress: subnetIdsIterator.dynamic({\r\n        subnet_id: subnetIdsIterator.key\r\n      }),\r\n      tags: {\r\n        Name: \"vpn-resolver\"\r\n      }\r\n    })\r\n```\r\n","comments":[{"id":"IC_kwDODd1Amc5IJDwy","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @a0s ğŸ‘‹\r\nYeah, that is intentional at the moment, as we have no type information for the target attribute and we can't guess whether a key should be snake-case as it is part of Terraform config or whether it should stay as is because it may be part of unstructured data passed to e.g. a kubernetes spec.\r\nWe want to tackle this in the future (possibly in #1869 but that is currently more about the types of the \"input\").\r\n\r\nIf your example is safe enough to be snake cased everywhere, you could do something like this (untested, experimental, uses internal apis that could change):\r\n```ts\r\nimport { keysToSnakeCase } from 'cdktf/lib/util';\r\n\r\nconst resolverEndpoint = new Route53ResolverEndpoint(this, \"resolver_endpoint\", <Route53ResolverEndpointConfig>{\r\n      provider: config.provider,\r\n      direction: \"INBOUND\",\r\n      securityGroupIds: [this.resolverSecurityGroup.id],\r\n      ipAddress: subnetIdsIterator.dynamic(keysToSnakeCase(<Route53ResolverEndpointIpAddress>{\r\n        subnetId: subnetIdsIterator.key\r\n      })),\r\n      tags: {\r\n        Name: \"vpn-resolver\"\r\n      }\r\n});\r\n```\r\nThis only works in TypeScript and uses an utility function that CDKTF uses internally.","createdAt":"2022-08-10T08:26:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2013#issuecomment-1210334258","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5IJzis","author":{"login":"a0s"},"authorAssociation":"NONE","body":"Thank you for response! This is an interesting trick.","createdAt":"2022-08-10T11:16:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/2013#issuecomment-1210529964","viewerDidAuthor":false}],"createdAt":"2022-08-10T08:10:19Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"},{"id":"LA_kwDODd1Amc8AAAABBv4DFg","name":"feature/iterators","description":"","color":"2911A8"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":2013,"title":"Support typed structs inside dynamic iterators","updatedAt":"2023-06-01T14:32:38Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjcyNTI3MDQ0","is_bot":false,"login":"Maed223","name":"Mark DeCrane"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nCurrently Snapshot testing is only available in Typescript.  To my understanding this current method of snapshot testing in Typescript is not extensible to other supported languages as it is reliant on jest's functionality.  I myself see two paths forward to extending this capability. \r\n\r\n#### Leverage existing Snapshot testing frameworks available in each language \r\n\r\nThe main issue here being that the snapshot testing frameworks vary in level of maturity depending on the languageâ€“ see the referenced links for some below. Yet, from what I've seen most would require no added work on our end as they could simply consume the json config returned by `Testing.synth(STACK)` to both create and check against snapshots. Depending on the maturity of each of the frameworks they could be referenced in documentation to expose users to the potential ability.\r\n\r\n#### Create our own unified solution \r\n\r\nSimilar to AWS CDK we could create a general solution for supported languages other than Typescript to then be exposed via JSII. This would be a much larger undertaking, as well as having the potential to be awkward as workflows for Snapshot testing between Typescript and other languages could differ quite greatly. \r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n[AWS CDK Snapshot Testing](https://docs.aws.amazon.com/cdk/v2/guide/testing.html#:~:text=in%20states_capture.as_object()-,Snapshot%20tests,-In%20snapshot%20testing)\r\n\r\n[Snapshot testing in Python](https://pypi.org/project/pytest-snapshot/)\r\n\r\n[Snapshot testing in C#](https://dotnetfoundation.org/projects/verify)\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->","comments":[],"createdAt":"2022-08-04T19:06:05Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMTEzNjU3MzA2","name":"language/python","description":"","color":"5c2596"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwyNTcwMTY0OTY5","name":"testing","description":"","color":"456cc6"},{"id":"MDU6TGFiZWwyNjMzNjk4NzAy","name":"language/java","description":"","color":"E38858"},{"id":"MDU6TGFiZWwzMDMwODE1NTQy","name":"language/golang","description":"","color":"22ED90"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMTM1OTYzMTU0","name":"language/c#","description":"C# language issues","color":"c5def5"}],"milestone":null,"number":2000,"title":"Add Snapshot testing support for languages other than Typescript","updatedAt":"2023-07-13T15:47:39Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjcyNTI3MDQ0","is_bot":false,"login":"Maed223","name":"Mark DeCrane"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\nLanguage: Python\r\nCDKTF Version: 0.12\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\n### Affected Resource(s)\r\n\r\nTesting assertions\r\n\r\n<!--- Please list the affected resources. --->\r\n\r\n### Debug Output\r\n\r\n[View here](https://gist.github.com/Maed223/d3e662a94c12b90a50e7a5f53a7f3980)\r\n\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\n\r\n### Expected Behavior\r\n\r\nNo warning \r\n\r\n<!--- What should have happened? --->\r\n\r\n### Actual Behavior\r\n\r\nPytestCollectionWarning raised\r\n\r\n<!--- What actually happened? --->\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Please list the steps required to reproduce the issue. --->\r\nUsing any static method from cdktf.Testing within a pytest test suite\r\n\r\n### Important Factoids\r\n\r\nTo my understanding the issue causes no issues in terms of functionality, only an annoying warning. \r\n\r\nThe issue stems from the the naming of `Testing` as pytest attempts to collect the class as a test class since it's name is prefixed with `Test`. \r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n### References\r\n\r\n[Stack Overflow post describing the issue](https://stackoverflow.com/questions/58624641/how-to-prevent-pytestcollectionwarning-when-testing-class-testament-via-pytest) and a [post in the thread with a potential simple fix](https://stackoverflow.com/questions/58624641/how-to-prevent-pytestcollectionwarning-when-testing-class-testament-via-pytest#:~:text=You%20can%20set%20a%20__test__%20%3D%20False%20attribute%20in%20classes%20that%20pytest%20should%20ignore%3A)\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n- #0000\r\n","comments":[{"id":"IC_kwDODd1Amc5IFJpZ","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Just gave the the accepted answer at StackOverflow (`__test__ = False`) a quick test and unfortunately JSII does not allow properties starting with an underscore to be exposed to the other languages. So there's no simple way to get `__test__ = False` included in the generated Testing class in Python.\r\nMaybe there is another way to get `__test__` into the [`__dict__` property](https://stackoverflow.com/a/18445824/3420189) of the [Testing](https://stackoverflow.com/a/18445824/3420189) class, but I couldn't quickly find it.","createdAt":"2022-08-09T12:20:19Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1999#issuecomment-1209309785","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Il5Vq","author":{"login":"nlucansk"},"authorAssociation":"NONE","body":"Meanwhile to suppress warning you can create `pytest.ini` and add\r\n\r\n```\r\n[pytest]\r\nfilterwarnings =\r\n    ignore:::.*.cdktf:11850\r\n```\r\n\r\n![image](https://user-images.githubusercontent.com/51444462/185109067-7a0b1672-1652-4d62-8f12-cd3b57fa2adf.png)\r\n\r\n","createdAt":"2022-08-17T11:37:07Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":3}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1999#issuecomment-1217893738","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5fVLaY","author":{"login":"gtback"},"authorAssociation":"NONE","body":"Thanks, @nlucansk \r\n\r\nWith `cdktf 0.16.3`, I had to update the above to be: `ignore:::.*.cdktf:13637`","createdAt":"2023-06-20T19:31:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1999#issuecomment-1599387288","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5leCBI","author":{"login":"martimors"},"authorAssociation":"NONE","body":"Is the `Testing` class static? If yes, can it not just be converted into a module, say `cdktf.testing`?","createdAt":"2023-09-01T08:29:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1999#issuecomment-1702371400","viewerDidAuthor":false}],"createdAt":"2022-08-04T19:02:52Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyNTcwMTY0OTY5","name":"testing","description":"","color":"456cc6"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":1999,"title":"PytestCollectionWarning raised in using cdktf.Testing static methods with Pytest","updatedAt":"2023-09-01T08:29:26Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nIssue #1766 happened because Jest released a new version that was not compatible with another dependency of ours. We want to make our templates more robust against such upstream changes which can happen unexpectedly.\r\n\r\nWe can do so by e.g. narrowing the version constraints of the dependencies that we install here: https://github.com/hashicorp/terraform-cdk/blob/b776e644c3ba3ca6b70cd9d8ff7374e4cb5b6da9/packages/cdktf-cli/templates/typescript/.hooks.sscaff.js#L15\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-08-03T15:48:55Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"},{"id":"LA_kwDODd1Amc7x0kYM","name":"feature/init","description":"cdktf init related features","color":"C1E24A"}],"milestone":null,"number":1991,"title":"Make our init templates more robust against upstream version changes","updatedAt":"2023-06-01T16:16:55Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjQ2MjAx","is_bot":false,"login":"hans-d","name":"Hans Donner"},"body":"('override' must be specified using a Class, and cannot have a dict (python)\r\n\r\n```\r\n        asg = autoscaling.AutoscalingGroup(self, \"auto\",\r\n                                           mixed_instances_policy={\r\n                                               \"launch_template\": {\r\n                                                   \"launch_template_specification\": {\r\n                                                       \"launch_template_id\": tmpl.id\r\n                                                   },\r\n                                                   \"override\": [\r\n                                                       {\"instance_type\": \"t3.micro\"},\r\n                                                       autoscaling.AutoscalingGroupMixedInstancesPolicyLaunchTemplateOverride(\r\n                                                           instance_type = \"t3.micro\"\r\n                                                       )\r\n                                                   ]\r\n                                               }\r\n\r\n                                           },\r\n                                           availability_zones=[\"us-east-1a\", \"us-east-1b\"],\r\n                                           min_size=1,\r\n                                           max_size=10,\r\n                                           )\r\n\r\n```\r\ntranslates to:\r\n```\r\n    \"aws_autoscaling_group\": {\r\n      \"ec2_auto_16C147B8\": {\r\n        \"//\": {\r\n          \"metadata\": {\r\n            \"path\": \"proj1/ec2/auto\",\r\n            \"uniqueId\": \"ec2_auto_16C147B8\"\r\n          }\r\n        },\r\n        \"availability_zones\": [\r\n          \"us-east-1a\",\r\n          \"us-east-1b\"\r\n        ],\r\n        \"max_size\": 10,\r\n        \"min_size\": 1,\r\n        \"mixed_instances_policy\": {\r\n          \"launch_template\": {\r\n            \"launch_template_specification\": {\r\n              \"launch_template_id\": \"${aws_launch_template.ec2_tmpl_7F4E28E6.id}\"\r\n            },\r\n            \"override\": [\r\n              {\r\n              },\r\n              {\r\n                \"instance_type\": \"t3.micro\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      }\r\n    },\r\n```","comments":[{"id":"IC_kwDODd1Amc5HpNRy","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"Seems related to https://github.com/aws/jsii/issues/1919 (Passing dict in lieu of jsii structs does not consistently work).","createdAt":"2022-08-02T03:52:19Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1975#issuecomment-1201984626","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5d-kPF","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"This is still an issue","createdAt":"2023-06-05T12:19:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1975#issuecomment-1576682437","viewerDidAuthor":false}],"createdAt":"2022-07-24T15:09:30Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMTEzNjU3MzA2","name":"language/python","description":"","color":"5c2596"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwyMjQ2NzM3OTc1","name":"upstream/jsii","description":"Pending upstream work on JSII","color":"f9a2cf"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM1OTcwMTgw","name":"provider/aws","description":"Issue shows up using AWS provider","color":"396F8B"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":1975,"title":"AutoscalingGroup mixed_instances_policy override cannot take a dict as value (python)","updatedAt":"2023-06-23T08:55:51Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nThe [dynamic blocks docs](https://www.terraform.io/language/expressions/dynamic-blocks) state:\r\n> The labels argument (optional) is a list of strings that specifies the block labels, in order, to use for each generated block. You can use the temporary iterator variable in this value.\r\n\r\nWe currently don't support passing labels although they seem to be [quite rare](https://discuss.hashicorp.com/t/labels-in-dynamic-block/21461/5).\r\n\r\nI'm not sure whether we support blocks that require labels at all at the current moment.\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\nRelated todo in our code base\r\nhttps://github.com/hashicorp/terraform-cdk/blob/85c5a0912c608acd088c600f24f1cdb12a2ee27d/packages/cdktf/lib/terraform-dynamic-block.ts#L13\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-07-20T10:28:08Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2MjkzOTA4","name":"core-parity","description":"Better experience in Terraform Core than CDKTF","color":"1A80B6"},{"id":"LA_kwDODd1Amc8AAAABBv4DFg","name":"feature/iterators","description":"","color":"2911A8"}],"milestone":null,"number":1939,"title":"Support `labels` in `TerraformDynamicBlock`","updatedAt":"2023-06-02T14:15:54Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjI0MDkyNzY=","is_bot":false,"login":"harjis","name":"Joonas Harjukallio"},"body":"Hi! We would like to define Terraform Modules input variables as objects like this:\r\n\r\n```tf\r\nterraform {\r\n  required_providers {\r\n    azurerm = {\r\n      source  = \"hashicorp/azurerm\"\r\n      version = \"3.2.0\"\r\n    }\r\n  }\r\n}\r\n\r\nprovider \"azurerm\" {\r\n  features {}\r\n}\r\n\r\nvariable \"storage_account\" {\r\n  description = \"Storage Account options\"\r\n  type = object({\r\n    replication_type: string,\r\n    account_tier: string\r\n  })\r\n}\r\n\r\n\r\nresource \"azurerm_storage_account\" \"storage-account\" {\r\n  account_replication_type = var.storage_account.replication_type\r\n  account_tier             = var.storage_account.account_tier\r\n  location                 = \"westeurope\"\r\n  name                     = \"st-name\"\r\n  resource_group_name      = \"rg-test\"\r\n\r\n  allow_nested_items_to_be_public = false\r\n}\r\n```\r\nThe problem we have is that when we use these Modules in CDKTF the generated Typescript types for `storage_account` is `any`:\r\n\r\n```ts\r\nexport interface StorageAccountModuleOptions {\r\n  /**\r\n   * Storage Account options\r\n   */\r\n  readonly storageAccount: any;\r\n}\r\n```\r\nDo you know if it is possible to type `storageAccount` more strongly so that the resulting types would be something like:\r\n```ts\r\ninterface StorageAccountModuleStorageAccount {\r\n  replicationType: string;\r\n  accountTier: string;\r\n}\r\nexport interface StorageAccountModuleOptions {\r\n  /**\r\n   * Storage Account options\r\n   */\r\n  readonly storageAccount: StorageAccountModuleStorageAccount;\r\n}\r\n```\r\n<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5GqI3v","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Hey, great point! We have no good way of inferring the outputs (@ansgarm brought up an idea with evaluating the TF like `terraform validate` does and using that type information to get the output values, but reading this issue I noticed we have no problem with reading the inputs and parsing them into a format that we can use to generate bindings from, so it's totally possible and we should do it.","createdAt":"2022-07-15T11:25:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1923#issuecomment-1185451503","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5GqKy0","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"We could use the parsing of the variable names as well for convert: #1891","createdAt":"2022-07-15T11:36:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1923#issuecomment-1185459380","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc67Iclz","author":{"login":"kevcube"},"authorAssociation":"NONE","body":"+1'ing this because it's been 3 years, this seems like a pretty major lack of type safety for this project which is a big draw to cdktf for me.\n\nmy complex variable:\n\n```hcl\nvariable \"origin\" {\n  description = \"One or more origins for this distribution (multiples allowed).\"\n  type = map(object({\n    connection_attempts = optional(number)\n    connection_timeout  = optional(number)\n    custom_origin_config = optional(object({\n      http_port                = number\n      https_port               = number\n      origin_protocol_policy   = string\n      origin_ssl_protocols     = list(string)\n      origin_keepalive_timeout = optional(number)\n      origin_read_timeout      = optional(number)\n    }))\n    domain_name = string\n    custom_header = optional(list(object({\n      name  = string\n      value = string\n    })))\n    origin_access_control_id = optional(string)\n    origin_id                = optional(string) # If not provided, map key is used.\n    origin_path              = optional(string)\n    origin_shield = optional(object({\n      enabled              = bool\n      origin_shield_region = optional(string)\n    }))\n    s3_origin_config = optional(object({\n      origin_access_identity = string\n    }))\n    vpc_origin_config = optional(object({\n      origin_keepalive_timeout = optional(number)\n      origin_read_timeout      = optional(number)\n      vpc_origin_id            = optional(string) # If not provided, uses aws_cloudfront_vpc_origin.this[this.vpc_origin].id\n      vpc_origin               = optional(string) # Custom parameter to lookup against aws_cloudfront_vpc_origin.this\n    }))\n  }))\n  default = {}\n}\n```\n\nmy output...\n\n```ts\n  /**\n  * One or more origins for this distribution (multiples allowed).\n  */\n  readonly origin?: any;\n```","createdAt":"2025-07-31T11:25:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1923#issuecomment-3139553651","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc67cO5t","author":{"login":"Saaalih2g"},"authorAssociation":"NONE","body":"Ø§Ù‚ØªØ±Ø§Ø­ ÙˆØ­Ù„ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ ÙˆØ§Ø±Ø³Ø§Ù„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬\r\n\r\nSaleh77\r\n\r\n\r\nÙÙŠ Ø®Ù…ÙŠØ³ØŒ 31 ÙŠÙˆÙ„ÙŠÙˆØŒ 2025 ÙÙŠ 2:25 Ù…ØŒ ÙƒØªØ¨ Kevin ***@***.***>:\r\n\r\n> *kevcube* left a comment (hashicorp/terraform-cdk#1923)\r\n> <https://github.com/hashicorp/terraform-cdk/issues/1923#issuecomment-3139553651>\r\n>\r\n> +1'ing this because it's been 3 years, this seems like a pretty major lack\r\n> of type safety for this project which is a big draw to cdktf for me.\r\n>\r\n> my complex variable:\r\n>\r\n> variable \"origin\" {\r\n>   description = \"One or more origins for this distribution (multiples allowed).\"\r\n>   type = map(object({\r\n>     connection_attempts = optional(number)\r\n>     connection_timeout  = optional(number)\r\n>     custom_origin_config = optional(object({\r\n>       http_port                = number\r\n>       https_port               = number\r\n>       origin_protocol_policy   = string\r\n>       origin_ssl_protocols     = list(string)\r\n>       origin_keepalive_timeout = optional(number)\r\n>       origin_read_timeout      = optional(number)\r\n>     }))\r\n>     domain_name = string\r\n>     custom_header = optional(list(object({\r\n>       name  = string\r\n>       value = string\r\n>     })))\r\n>     origin_access_control_id = optional(string)\r\n>     origin_id                = optional(string) # If not provided, map key is used.\r\n>     origin_path              = optional(string)\r\n>     origin_shield = optional(object({\r\n>       enabled              = bool\r\n>       origin_shield_region = optional(string)\r\n>     }))\r\n>     s3_origin_config = optional(object({\r\n>       origin_access_identity = string\r\n>     }))\r\n>     vpc_origin_config = optional(object({\r\n>       origin_keepalive_timeout = optional(number)\r\n>       origin_read_timeout      = optional(number)\r\n>       vpc_origin_id            = optional(string) # If not provided, uses aws_cloudfront_vpc_origin.this[this.vpc_origin].id\r\n>       vpc_origin               = optional(string) # Custom parameter to lookup against aws_cloudfront_vpc_origin.this\r\n>     }))\r\n>   }))\r\n>   default = {}\r\n> }\r\n>\r\n> my output...\r\n>\r\n>   /**  * One or more origins for this distribution (multiples allowed).  */\r\n>   readonly origin?: any;\r\n>\r\n> â€”\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/hashicorp/terraform-cdk/issues/1923#issuecomment-3139553651>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/A5IDPXHX4FWONYVJ6U4BUFL3LH4MHAVCNFSM6AAAAACCZTXYGGVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZTCMZZGU2TGNRVGE>\r\n> .\r\n> You are receiving this because you are subscribed to this thread.Message\r\n> ID: ***@***.***>\r\n>\r\n","createdAt":"2025-08-01T14:15:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1923#issuecomment-3144740461","viewerDidAuthor":false}],"createdAt":"2022-07-14T07:58:11Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjE3NjIyNTkw","name":"modules","description":"","color":"2ffc8f"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2MjAxMTE5","name":"provider get / generation","description":"","color":"CC3938"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":1923,"title":"Terraform module input variables & typescript","updatedAt":"2025-08-01T14:15:02Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjYxOTYyNjA=","is_bot":false,"login":"cveld","name":"Carl in 't Veld"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\nTerraform cdk seems to be a great initiative to open up even more great infrastructure as code scenarios!\r\n\r\nOne use case I am in particular exploring currently is intellisense in vscode on adding configurations.\r\n\r\nAt the very core using a terraform file, I played with declaring an azurerm resource.\r\ne.g.\r\n```terraform\r\nresource \"azurerm_storage_account\" \"storageaccount\" {\r\n    name = \"mystorageaccount\"\r\n    location = \"westeurope\"\r\n    accountTier: \"Standard\",\r\n    accountReplicationType: \"LRS\"\r\n}\r\n```\r\nInstalled hashicorp and Microsoft terraform extensions in vscode in order to get intellisense.\r\nThe behavior is that it is not reporting the missing required properties, and it does not show the valid values on e.g. accountTier and accountReplicationType. \r\n\r\nSo I started to explore the intellisense when using terraform cdk.\r\nI created this ticket to get your feedback on my thinking and maybe it helps you to steer the direction of your product.\r\n\r\n### cdktf & Language Versions\r\n\r\nnodejs:\r\n\"cdktf\": \"0.11.2\"\r\n\"azurerm@~> 2.0.0\"\r\n\r\ndotnet:\r\n    HashiCorp.Cdktf; Version=\"0.11.2\"\r\n    HashiCorp.Cdktf.Providers.Azurerm; Version=\"0.8.2\" \r\n\r\n\r\n### Actual Behavior for TypeScript\r\n- I like that missing required properties are reported design-time. It is unfortunate that the way typescript reports this is quite user-unfriendly, i.e. it shows a big ball of text explaining a type mismatch due to some missing properties.\r\n- It is unfortunate that it does not show the valid values on e.g. accountTier and accountReplicationType. Maybe because the azurerm provider is not reporting the list of values.\r\n\r\n### Actual Behavior for c# dotnet\r\n- missing required properties are not reported. Maybe this is something that can be added with the new .NET 7 init feature?\r\n- it does not show the valid values on e.g. accountTier and accountReplicationType.\r\n\r\nI will also test this out with bicep. If intellisense is great over there, maybe you can work together with the bicep team to improve the azurerm experience in the terraform space. ","comments":[{"id":"IC_kwDODd1Amc5Fgm9a","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"There are a couple related issues in the upstream jsii library pertaining to to the required properties:\r\n\r\n- https://github.com/aws/jsii/issues/716\r\n- https://github.com/aws/jsii/issues/715\r\n- Also similar issue seen in cdktf: https://github.com/hashicorp/terraform-cdk/issues/1860\r\n\r\nThe valid values you mention aren't available in the provider schema that is used to generate provider bindings. They are sometimes present in the provider source code or in documentation; however, that gets pretty messy to incorporate.\r\n\r\nAs much as I would like to recommend C# (I use it myself), you'll likely find TypeScript to be a smoother experience.","createdAt":"2022-06-25T02:45:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1898#issuecomment-1166176090","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Fia-i","author":{"login":"cveld"},"authorAssociation":"NONE","body":"Thanks for your helpful response!\n\nWhere/how is the azurerm provider schema produced?\nAnd where/how is cdk consuming this?\nAnd off topic, how is the vscode terraform language server consuming this?\nAlso there is no completion.\nIn the meanwhile I tested with Bicep and it does provide completion. Maybe\nin future Bicep metadata can be used to populate terraform metadata.\n\nIt is painful to see that the c# issues are already open for so long ğŸ˜¬\n\nOp za 25 jun. 2022 04:45 schreef Jon Steinich ***@***.***>:\n\n> There are a couple related issues in the upstream jsii library pertaining\n> to to the required properties:\n>\n>    - aws/jsii#716 <https://github.com/aws/jsii/issues/716>\n>    - aws/jsii#715 <https://github.com/aws/jsii/issues/715>\n>    - Also similar issue seen in cdktf: #1860\n>    <https://github.com/hashicorp/terraform-cdk/issues/1860>\n>\n> The valid values you mention aren't available in the provider schema that\n> is used to generate provider bindings. They are sometimes present in the\n> provider source code or in documentation; however, that gets pretty messy\n> to incorporate.\n>\n> As much as I would like to recommend C# (I use it myself), you'll likely\n> find TypeScript to be a smoother experience.\n>\n> â€”\n> Reply to this email directly, view it on GitHub\n> <https://github.com/hashicorp/terraform-cdk/issues/1898#issuecomment-1166176090>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/ABPIYJHQMLSI7T2VG67WR4TVQZXDZANCNFSM5ZZB762Q>\n> .\n> You are receiving this because you authored the thread.Message ID:\n> ***@***.***>\n>\n","createdAt":"2022-06-26T21:33:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1898#issuecomment-1166651298","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5FtO1-","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> Where/how is the azurerm provider schema produced?\r\n\r\nThe schema comes from a [Terraform cli command](https://www.terraform.io/cli/commands/providers/schema)\r\n\r\n\r\n\r\n> And where/how is cdk consuming this?\r\n\r\nThe resulting schema is parsed and used to generate TypeScript code. That code is then processed by jsii to generate code for other languages.\r\n\r\n\r\n\r\n\r\n> And off topic, how is the vscode terraform language server consuming this?\r\n\r\nI'm not sure, but am also curious. I have seen that the IntelliJ platform Terraform plugin also has more information in certain cases. One possibility is that it is actually reading the `go` source code of the provider.\r\n\r\n\r\n\r\n\r\n> In the meanwhile I tested with Bicep and it does provide completion. Maybe in future Bicep metadata can be used to populate terraform metadata.\r\n\r\nThat may be possible if Bicep aligns close enough with the Terraform provider.\r\n\r\n\r\n\r\n\r\n> It is painful to see that the c# issues are already open for so long\r\n\r\nI believe c# is the least used CDK language so it does tend to get less attention. Despite some limitations, it is still very powerful to work with.","createdAt":"2022-06-29T03:08:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1898#issuecomment-1169485182","viewerDidAuthor":false}],"createdAt":"2022-06-24T21:41:07Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjQ2NzM3OTc1","name":"upstream/jsii","description":"Pending upstream work on JSII","color":"f9a2cf"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM1OTU1Nzk1","name":"ux/debugging","description":"","color":"2703FD"},{"id":"MDU6TGFiZWwzMTM1OTYzMTU0","name":"language/c#","description":"C# language issues","color":"c5def5"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"}],"milestone":null,"number":1898,"title":"Azurerm first experience with c# dotnet and typescript","updatedAt":"2022-07-15T11:29:37Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nCurrently we only wrap [computed maps](https://github.com/hashicorp/terraform-cdk/pull/1667) through classes, to make maps accessible in all languages as references / accessors we should support them in all use-cases, so also non-computed (writable) maps should be wrapped. This is probably a similar effort as [supporting all lists](https://github.com/hashicorp/terraform-cdk/pull/1725)\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5E-N5G","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"@DanielMSchmidt do you have an example of a case that you'd like to change? I can see a case in code, but my previous provider snapshot didn't actually have any instances where that case hits.","createdAt":"2022-06-16T02:23:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1875#issuecomment-1157160518","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5LGa-I","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"For the `values` map returned by the tfe_outputs datasource ([docs](https://registry.terraform.io/providers/hashicorp/tfe/latest/docs/data-sources/outputs#values)) it would be nice if the new map type would have utility functions to retrieve typed values (e.g. `.getString()`, `getList()`, etc.) so that a user does not need to wrap them in `Token.asList()` or similar.","createdAt":"2022-09-27T19:48:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HOORAY","users":{"totalCount":1}},{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1875#issuecomment-1259974536","viewerDidAuthor":false}],"createdAt":"2022-06-14T17:35:02Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2MjAxMTE5","name":"provider get / generation","description":"","color":"CC3938"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"}],"milestone":null,"number":1875,"title":"Represent all maps with generated classes","updatedAt":"2023-06-01T16:38:18Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n\r\nThis would be useful to have for integration testing workflows, we did not tackle it in #649 to limit the scope.\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-06-14T17:12:06Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjIzNTI1MzY0","name":"terraform cloud","description":"","color":"4ed354"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":1874,"title":"Create GitHub action to create / destroy terraform cloud workspaces","updatedAt":"2022-08-12T07:45:56Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nWe can use the functionality provided in #877 to ask the user if they want to install missing providers in their project, to detect if a provider is already (natively) installed and use the correct import statement for that provider accordingly\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-06-07T13:58:31Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjQ2NzM1NDk1","name":"providers","description":"","color":"2bd8cd"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"},{"id":"MDU6TGFiZWwzMTg1Mzg1NTQ2","name":"feature/convert","description":"","color":"d93f0b"}],"milestone":null,"number":1853,"title":"Convert should use pre-built providers if possible","updatedAt":"2023-03-09T11:45:31Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjgyMzUyMTI=","is_bot":false,"login":"sebolabs","name":"Sebastian Mincewicz"},"body":"### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n### cdktf & Language Versions\r\n\r\ncdktf 0.11.0 (type-script)\r\n\r\n### Affected Resource(s)\r\n\r\nUnit tests not working like I would expect. Could be me though :)\r\n\r\n### Debug Output\r\nN/A\r\n\r\n### Expected Behavior\r\n\r\nTest should pass unless I'm doing something wrong.\r\n\r\n### Actual Behavior\r\n```\r\n> portal-azure@1.0.0 test\r\n> jest\r\n\r\n FAIL  __tests__/main-test.ts (9.099 s)\r\n\r\n  â— Configuration â€º should contain an application\r\n\r\n    Expected azuread_application with properties {} to be present in synthesised stack.\r\n    Found no azuread_application resources instead\r\n\r\n      28 |         new PortalStack(scope, 'test');\r\n      29 |       })\r\n    > 30 |     ).toHaveResource(Application);\r\n         |       ^\r\n      31 |   });\r\n\r\n      at Object.<anonymous> (__tests__/main-test.ts:30:7)\r\n\r\nTest Suites: 1 failed, 1 total\r\nTests:       1 failed, 0 todo, 0 passed, 1 total\r\nSnapshots:   0 total\r\nTime:        4.642 s\r\n```\r\n\r\n### Steps to Reproduce\r\n```\r\nimport \"cdktf/lib/testing/adapters/jest\";\r\nimport { Testing } from \"cdktf\";\r\nimport { PortalStack } from \"../main\";\r\nimport { Application } from \"@cdktf/provider-azuread\";\r\n\r\ndescribe(\"Configuration\", () => {\r\n  it(\"should contain an application\", () => {\r\n    expect(\r\n      Testing.synthScope((scope) => {\r\n        new PortalStack(scope, 'test');\r\n      })\r\n    ).toHaveResource(Application);\r\n  });\r\n});\r\n```\r\n\r\n### Important Factoids\r\n- `cdktf synth/diff/deploy` work perfectly fine\r\n- `cdk.tf.json` under `cdktf.out` contains the following:\r\n```\r\n[\r\n  [...]\r\n  \"resource\": {\r\n    \"azuread_application\": {\r\n      \"xxxauthportal_portalapp_3876DFED\": {\r\n        \"//\": {\r\n          \"metadata\": {\r\n  [...]\r\n]\r\n```\r\n\r\n### References (main.ts)\r\n```\r\nimport { Construct } from \"constructs\";\r\nimport {\r\n  App,\r\n  TerraformStack,\r\n  RemoteBackend,\r\n} from \"cdktf\";\r\nimport {\r\n  AzureadProvider,\r\n  ApplicationFeatureTags,\r\n  Application,\r\n} from \"./.gen/providers/azuread\";\r\n\r\nexport class PortalStack extends TerraformStack {\r\n  constructor(scope: Construct, name: string) {\r\n    super(scope, name);\r\n\r\n    new AzureadProvider(this, \"AzureAd\", {});\r\n\r\n    this.AzureAdApp();\r\n  }\r\n  \r\n  AzureAdApp(this: PortalStack) {\r\n\r\n    const samlIdUri = \"\";\r\n    const samlReplyUrl = \"\";\r\n    const samlLogoutUrl = \"\";\r\n\r\n    const appFeatureTags: ApplicationFeatureTags = {\r\n      enterprise: true,\r\n    };\r\n\r\n    new Application(this, \"portal_app\", {\r\n      displayName: `AuthPortal`,\r\n      featureTags: [appFeatureTags],\r\n      identifierUris: [samlIdUri],\r\n      web: {\r\n        redirectUris: [samlReplyUrl],\r\n        logoutUrl: samlLogoutUrl,\r\n      },\r\n      preventDuplicateNames: true,\r\n    });\r\n  }\r\n}\r\n\r\nconst app = new App();\r\nconst stack = new PortalStack(app, \"auth-portal\");\r\nnew RemoteBackend(stack, {\r\n  hostname: \"app.terraform.io\",\r\n  organization: \"xxx\",\r\n  workspaces: {\r\n    name: `auth-portal`,\r\n  }\r\n});\r\napp.synth();\r\n```","comments":[{"id":"IC_kwDODd1Amc5Ext6z","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"@sebolabs Currently you can't pass a stack instance to `Testing.synthScope`. You can work around by making your class extend from `Construct` instead. Take a look [here](https://github.com/hashicorp/terraform-cdk/issues/1506#issuecomment-1025767490) for more info.","createdAt":"2022-06-13T12:59:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"EYES","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1850#issuecomment-1153883827","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5E_v3B","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"While we seem to have answered the question I'd like to keep this issue open and add a proper warning / error if someone passes a stack into synthScope.","createdAt":"2022-06-16T11:41:15Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1850#issuecomment-1157561793","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5FDAtk","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> While we seem to have answered the question I'd like to keep this issue open and add a proper warning / error if someone passes a stack into synthScope.\r\n\r\nIf not too difficult, actually just allowing a stack would be more user friendly.","createdAt":"2022-06-17T02:28:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1850#issuecomment-1158417252","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5G7UjF","author":{"login":"paambaati"},"authorAssociation":"NONE","body":"Can you folks help understand the solution here?\r\n\r\nIf I pass in a `Construct` instead of a `Stack`, I still don't get any generated resources from `synthScope`.\r\n\r\nThis is how I've modified the above example â€“\r\n\r\n```diff\r\nimport \"cdktf/lib/testing/adapters/jest\";\r\nimport { Testing } from \"cdktf\";\r\n+import { Construct } from \"constructs\";\r\nimport { PortalStack } from \"../main\";\r\nimport { Application } from \"@cdktf/provider-azuread\";\r\n\r\n+ class PortalConstruct extends Construct {\r\n+  constructor(scope: Construct, options: Record<PropertyKey, unknown>) {\r\n+   super(scope, `${options.environment}-construct`)\r\n+    new PortalStack(scope, environment)\r\n+   }\r\n+}\r\n\r\ndescribe(\"Configuration\", () => {\r\n  it(\"should contain an application\", () => {\r\n    expect(\r\n      Testing.synthScope((scope) => {\r\n+        new PortalConstruct(scope, 'test');\r\n-        new PortalStack(scope, 'test');\r\n      })\r\n    ).toHaveResource(Application);\r\n  });\r\n});\r\n```\r\n","createdAt":"2022-07-20T08:01:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1850#issuecomment-1189955781","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5G7qRA","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"This is because your construct contains a stack. A stack does not synthesize into JSON like a construct would, but it writes a file to disk with it's childrens JSON in it. This hides the content from the testing marchers. You should abstract the things you do in a stack in one or more constructs and test how they work together here","createdAt":"2022-07-20T09:28:07Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1850#issuecomment-1190044736","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5HezKE","author":{"login":"pchaganti"},"authorAssociation":"NONE","body":"Running into the same issue. Is there any complete example that can be posted by the team to make it easier for users who run into this issue with testing? \r\n\r\nthanks!\r\n","createdAt":"2022-07-29T12:59:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1850#issuecomment-1199256196","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5HpOgw","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> Running into the same issue. Is there any complete example that can be posted by the team to make it easier for users who run into this issue with testing?\r\n> \r\n> thanks!\r\n\r\nHopefully [this](https://www.terraform.io/cdktf/test/unit-tests) helps. There are also internal tests of the testing framework now (for example: https://github.com/hashicorp/terraform-cdk/tree/main/test/python/testing-matchers)","createdAt":"2022-08-02T04:03:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1850#issuecomment-1201989680","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5HpXFS","author":{"login":"paambaati"},"authorAssociation":"NONE","body":"@jsteinich Thanks, that does help a bit, although it could use some more clarity â€“\r\n\r\n1. The inline comment in the linked example says `// Could be a class extending from Construct` but in other parts of the guide, we're always shown `TerraformStack` and not `Construct` as examples.\r\n\r\nAdditionally, not all of us use Jest, even though it is the most popular testing framework. For folks that use other frameworks, it would help if there was an example that shows how to use `Constructs`. I for one use `tap`, and I've managed to make this work with a combination of reading the original Jest plugin implementation and comments from this issue â€“\r\n\r\n```typescript\r\nimport tap from 'tap'\r\nimport expect from 'expect'\r\nimport { Testing, testingMatchers } from 'cdktf'\r\nimport { MyConstruct } from '../main'\r\nimport { Record as CFDNSRecord } from '../.gen/providers/cloudflare'\r\nimport type { TerraformConstructor } from 'cdktf/lib/testing/matchers'\r\n\r\ntap.Test.prototype.addAssert(\r\n  'toHaveResource',\r\n  3,\r\n  // NOTE: has to be a regular function and not an arrow function\r\n  // for the `this` binding to work correctly.\r\n  function toHaveResource(\r\n    hcl: string,\r\n    message: string,\r\n    resource: {\r\n      ctor: TerraformConstructor\r\n      props: Record<string, string>\r\n    },\r\n  ) {\r\n    const msg = message || 'Terraform stack is missing property'\r\n    const toHaveResourceWithProperties =\r\n      testingMatchers.getToHaveResourceWithProperties(\r\n        (items: Array<string>, assertedProperties: Record<string, unknown>) => {\r\n          if (Object.entries(assertedProperties).length === 0) {\r\n            return items.length > 0\r\n          }\r\n          return expect\r\n            .arrayContaining([expect.objectContaining(assertedProperties)])\r\n            .asymmetricMatch(items)\r\n        },\r\n      )\r\n    const self = this as unknown as typeof tap\r\n    return self.ok(\r\n      toHaveResourceWithProperties(hcl, resource.ctor, resource.props).pass,\r\n      msg,\r\n      resource,\r\n    )\r\n  },\r\n)\r\n\r\nvoid tap.test('infra > should include all resources', (t) => {\r\n  t.plan(1)\r\n  const hclJson = Testing.synthScope((scope) => {\r\n    new MyConstruct(scope)\r\n  })\r\n\r\n  t.toHaveResource(hclJson, 'should have the Cloudflare DNS record', {\r\n    ctor: CFDNSRecord,\r\n    props: { type: 'CNAME' },\r\n  })\r\n  t.end()\r\n})\r\n```","createdAt":"2022-08-02T05:11:55Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1850#issuecomment-1202024786","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5HuGBK","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> 1. The inline comment in the linked example says `// Could be a class extending from Construct` but in other parts of the guide, we're always shown `TerraformStack` and not `Construct` as examples.\r\n\r\nhttps://www.terraform.io/cdktf/concepts/constructs has some more information on constructs, including an example and a comparison to stacks.\r\n\r\n\r\n\r\n> I for one use `tap`, and I've managed to make this work\r\n\r\nThat's great. You can also use the `Testing` class directly which could possibly reduce the amount of adapter code needed.","createdAt":"2022-08-02T22:13:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1850#issuecomment-1203265610","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Uscph","author":{"login":"jmccann"},"authorAssociation":"NONE","body":"I just ran across this issue.  I used `cdktf init --template=typescript` to create a project.  I then started populating my generated project with resources and started populating my generated test examples with tests.\r\n\r\nThen I ran into `Found no github_issue_label resources instead` even though it was.\r\n\r\nRan into this issue from a search.  I didn't see anything from docs I came across of the need to use `Construct` if I want to do unit testing.\r\n\r\nSeems `cdktf init` generates project using `TerraformStack` which sounds like from this issue is not compatible with the unit test examples it generates for unit testing.\r\n\r\nAs a new user the docs and generated code don't seem to talk about this issue ... and would be nice if initial setup worked more out of the box.","createdAt":"2023-02-07T15:12:10Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1850#issuecomment-1420937825","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5jW2mL","author":{"login":"iot-resister"},"authorAssociation":"NONE","body":"I've read all the links here and I'm still confused about what a `MyApplicationsAbstraction` looks like.  I also don't understand why my example isn't working? Thanks for the awesome library!\r\n\r\n```ts\r\nit(\"should contain a container\", () => {\r\n  const stack = new OnPremStack(Testing.app(), \"learn-cdktf-docker\");\r\n  const synthesized = Testing.synth(stack);\r\n  expect(synthesized).toHaveResource(Container);\r\n});\r\n```","createdAt":"2023-08-06T18:06:50Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1850#issuecomment-1666935179","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5jkLXI","author":{"login":"Maed223"},"authorAssociation":"CONTRIBUTOR","body":"Hey @iot-resister!\r\n\r\n> I've read all the links here and I'm still confused about what a `MyApplicationsAbstraction` looks like. \r\n\r\n`MyApplicationsAbstraction` is a bit ambiguous as it is written in the Typescript documentation as it at times refers to a Construct, and at other times a Stack.  What's important to note is that in your usage (i.e. `OnPremStack`) it refers to a Stack, as the instance of `OnPremStack` is being passed into `Testing.synth` directly.\r\n\r\n>I also don't understand why my example isn't working? Thanks for the awesome library!\r\n\r\nHard to say exactly what the issue is from the snippet you've provided, could you provide a bit more context on what `OnPremStack` looks like and the specific issue you're running into? One thing that comes to mind is that the `Container` \r\ninstance is within another Stack that is nested in `OnPremStack`.\r\n\r\n\r\n","createdAt":"2023-08-08T23:06:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1850#issuecomment-1670428104","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6HT0So","author":{"login":"dan-developer"},"authorAssociation":"NONE","body":"Same problem here:\r\n\r\n```typescript\r\nit(\"check if this can be planned\", () => {\r\n        const app: App = Testing.app();\r\n        const stack: TerraformStack = new TerraformStack(app, \"test\");\r\n        expect(Testing.fullSynth(stack)).toPlanSuccessfully();\r\n    });\r\n```\r\n\r\nThis outputs:\r\n\r\n```\r\nerror TS2339: Property 'toPlanSuccessfully' does not exist on type 'JestMatchers<string>'.\r\n\r\n    7         expect(Testing.fullSynth(stack)).toPlanSuccessfully();\r\n                                               ~~~~~~~~~~~~~~~~~~\r\n\r\n```","createdAt":"2024-08-05T23:59:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1850#issuecomment-2270119080","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6HUCxG","author":{"login":"dan-developer"},"authorAssociation":"NONE","body":"> Same problem here:\r\n> \r\n> ```ts\r\n> it(\"check if this can be planned\", () => {\r\n>         const app: App = Testing.app();\r\n>         const stack: TerraformStack = new TerraformStack(app, \"test\");\r\n>         expect(Testing.fullSynth(stack)).toPlanSuccessfully();\r\n>     });\r\n> ```\r\n> \r\n> This outputs:\r\n> \r\n> ```\r\n> error TS2339: Property 'toPlanSuccessfully' does not exist on type 'JestMatchers<string>'.\r\n> \r\n>     7         expect(Testing.fullSynth(stack)).toPlanSuccessfully();\r\n>                                                ~~~~~~~~~~~~~~~~~~\r\n> ```\r\n\r\nAfter change the package versions, it back working correctly. Follow the versions:\r\n\r\n```\r\n\"dependencies\": {\r\n    \"@cdktf/provider-aws\": \"19.29.0\",\r\n    \"cdktf\": \"^0.20.8\",\r\n    \"constructs\": \"^10.3.0\"\r\n  },\r\n  \"devDependencies\": {\r\n    \"@types/jest\": \"^29.5.12\",\r\n    \"@types/node\": \"^22.1.0\",\r\n    \"jest\": \"^29.7.0\",\r\n    \"ts-jest\": \"^29.2.4\",\r\n    \"ts-node\": \"^10.9.2\",\r\n    \"typescript\": \"^5.5.4\"\r\n  }\r\n```","createdAt":"2024-08-06T01:12:05Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1850#issuecomment-2270178374","viewerDidAuthor":false}],"createdAt":"2022-06-07T12:31:50Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyNTcwMTY0OTY5","name":"testing","description":"","color":"456cc6"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM1OTU1Nzk1","name":"ux/debugging","description":"","color":"2703FD"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"},{"id":"LA_kwDODd1Amc7x0kYM","name":"feature/init","description":"cdktf init related features","color":"C1E24A"}],"milestone":null,"number":1850,"title":"Unit testing - toHaveResource() - found no resources instead","updatedAt":"2024-08-06T01:12:06Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjMxMjU2MDc2","is_bot":false,"login":"aadhikary","name":""},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\ncdktf (0.10.4) typescript\r\n\r\n### Affected Resource(s)\r\n\r\nDependency between stacks\r\n\r\n### Debug Output\r\n\r\nWhen stack2.dependsOn(stack1) then currently the stack dependency does not seem to work. This is not an issue if you are referencing Stack resource from stack1 into stack2. In resource reference case the stack seem to follow the order.\r\n\r\n### Expected Behavior\r\n\r\nstack2 should deploy only after stack1\r\n\r\n### Actual Behavior\r\n\r\nRace condition applies which causes any of the stack to deploy in any order.\r\n\r\n### NOTE\r\nStack addDependency method can be used to get around this.\r\n","comments":[{"id":"IC_kwDODd1Amc5EC9wN","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"`stack2.dependsOn(stack1)` just returns a `boolean` to indicate if `stack2` depends on `stack1`. `stack2.addDependency(stack1)` is the way to indicate that `stack2` should depend on `stack1`.\r\n\r\nPerhaps a different name would make this more apparent, but I think just adding documentation would suffice.","createdAt":"2022-05-31T03:20:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1829#issuecomment-1141627917","viewerDidAuthor":false}],"createdAt":"2022-05-30T15:07:12Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":1829,"title":"Docs: Make clear that `Stack.dependsOn` does not create a depedency between stacks (`addDependency` does)","updatedAt":"2022-08-12T07:57:06Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nhttps://github.com/hashicorp/terraform-cdk/pull/1761 introduced a new `CdktfConfig` class to handle working with the `cdktf.json` config. We should use that class in different places and remove the individual file reading and JSON parsing we have spread throughout the codebase.\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5QpfU2","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"Also move local-provider-constraints and local-provider-versions files to @cdktf/commons","createdAt":"2022-12-15T13:17:44Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1814#issuecomment-1353053494","viewerDidAuthor":false}],"createdAt":"2022-05-24T09:29:34Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"}],"milestone":null,"number":1814,"title":"Move new `CdktfConfig` class to base package to be reused across codebase","updatedAt":"2022-12-15T13:17:44Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjI4ODI=","is_bot":false,"login":"nikolay","name":"Nikolay Kolev"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nThe visual difference between `deploy` and `destroy` is minimal. Also, both are prone to an autocomplete devastating mistakes. Please, consider deprecating `deploy` in favor of `provision` or something different. This problem does not exist with `apply` and `destroy`! No to mention that `diff` also starts with a `D`.","comments":[{"id":"IC_kwDODd1Amc5DoJlc","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"You can use `apply` instead of `deploy`, but we need to keep `deploy` to stay compliant with the AWS cdk","createdAt":"2022-05-23T12:14:55Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1811#issuecomment-1134598492","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5DpG57","author":{"login":"nikolay"},"authorAssociation":"CONTRIBUTOR","body":"@DanielMSchmidt Sorry, didn't see the aliases on the far right. I'm not sure why they have to be kept when it's a totally different CLI, which is targeting only Terraform. In fact, `deploy` and `destroy` can be aliases only in the presence of an environment flag, for example. CDKTF can do irreversible damage unlike the typical CDK use cases!","createdAt":"2022-05-23T15:53:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1811#issuecomment-1134849659","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5E_TCO","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"They don't have to be in sync, but there are a lot of folks coming from the AWS CDK so we want to make their transitions as easy as possible.","createdAt":"2022-06-16T09:33:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1811#issuecomment-1157443726","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5FA1ou","author":{"login":"nikolay"},"authorAssociation":"CONTRIBUTOR","body":"@DanielMSchmidt It's hard to quantify, but a lot of people who use CDK are simply Terraform users, who are missing the dynamic provider capability of Terraform proper and are faced with the difficult choice to either use Terragrunt, or implement some templating, or use Terraform CDK. Given Terraform Cloud users can't use Terragrunt nicely, I picked CDKTF. And thanks to autocomplete, I've accidentally destroyed a test stack.","createdAt":"2022-06-16T16:04:07Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1811#issuecomment-1157847598","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5FBOwW","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"I'm sorry that happened to you! I definitely agree, a lot of folks come from Terraform, even more than from the AWS CDK would be my guess. That is why these commands exist both as apply/deploy & plan/diff. Not having the deploy alias for apply would certainly lead to folks being annoyed with CDKTF since apply is weird for them. It's a weird spot for both user groups and allowing both is the best trade-off we can do. \r\n\r\nAnother thing is, we don't want to second guess our users, which is why if you supply an --auto-approve flag we won't ask again before running the command. ","createdAt":"2022-06-16T17:34:07Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1811#issuecomment-1157950486","viewerDidAuthor":false}],"createdAt":"2022-05-20T19:11:27Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"}],"milestone":null,"number":1811,"title":"Human error-prone CLI","updatedAt":"2022-06-16T17:34:07Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nThis flag would instruct convert to maintain the logical IDs throughout the converted code & it would throw errors if the TF overall does not seem to be sound or if provider versions are missing. Sort of a strict mode that has the goal to produce CDKTF code that could theoretically be used with the same backend and a plan would show no diff. Although this might be a bit of a north star goal since the conversion is hard to make perfect in every detail.\r\n\r\nOnce this flag is implemented we can strip the extra soundness checks and logical id overrides from our normally produced cdktf code and get a more permissive version of convert to convert shorter incomplete snippets\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5DDpZa","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Sounds like `--strict` could also be a good name, what do you think?","createdAt":"2022-05-12T13:57:19Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1800#issuecomment-1125029466","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5DDqq0","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"I don't like strict because it does not cover the logical id part, at least in my understanding of the word ğŸ¤” ","createdAt":"2022-05-12T14:02:05Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1800#issuecomment-1125034676","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5DQINB","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"`production-ready` seems like a strange flag name. `strict` does seem closer to me.\r\n\r\nWhat do you mean by `does not seem to be sound`?\r\n\r\nI would expect the init from tf project flow to continue functioning as is. The `convert` command does seem like it should emit the logical id override though. Would be good to have user feedback to confirm the use cases though.","createdAt":"2022-05-17T01:26:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1800#issuecomment-1128301377","viewerDidAuthor":false}],"createdAt":"2022-05-12T13:45:12Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTg1Mzg1NTQ2","name":"feature/convert","description":"","color":"d93f0b"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":1800,"title":"Convert: Introduce \"production-ready\" flag","updatedAt":"2023-06-01T16:38:50Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nCurrently you can only initialise from a terraform project on TS projects, but it shouldn't be a lot of effort to extend this to all languages supported by convert\r\n\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-05-12T13:39:38Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTg1Mzg1NTQ2","name":"feature/convert","description":"","color":"d93f0b"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"LA_kwDODd1Amc7x0kYM","name":"feature/init","description":"cdktf init related features","color":"C1E24A"}],"milestone":null,"number":1799,"title":"Init: Support all languages from existing terraform project","updatedAt":"2023-10-13T15:28:52Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n0.10.4\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\n### Affected Resource(s)\r\n\r\n<!--- Please list the affected resources. --->\r\n\r\n### Debug Output\r\n\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\n\r\n### Expected Behavior\r\n\r\nShould work if possible or print a more useful warning (e.g. recommend `Fn.jsonencode()`).\r\n\r\n<!--- What should have happened? --->\r\n\r\n### Actual Behavior\r\n\r\nFails with\r\n\r\n`Error: Found an encoded list token string in a scalar string context. Use 'Fn.element(list, 0)' (not 'list[0]') to extract elements from token lists`\r\n<!--- What actually happened? --->\r\n\r\n### Steps to Reproduce\r\n\r\n```ts\r\nconst arr = [\"a\", \"b\", \"c\"];\r\nconst jsonString = JSON.stringify({\r\n  \"test:key\": Fn.concat([arr, arr]),\r\n});\r\nnew TerraformLocal(this, \"fails\", jsonString);\r\n```\r\n<!--- Please list the steps required to reproduce the issue. --->\r\n\r\n### Important Factoids\r\n\r\nUsing `Fn.jsonencode()` works as a workaround.\r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5DDfXJ","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"I think it should print a better error message, but it should not work. The token could have any value and the serialization to JSON happens with the token as a string, so there could potentially be extra things rendered at execution time that don't match what a user would expect. But yeah we should try to make the error message clearer","createdAt":"2022-05-12T13:21:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1796#issuecomment-1124988361","viewerDidAuthor":false}],"createdAt":"2022-05-12T12:57:45Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM1OTU1Nzk1","name":"ux/debugging","description":"","color":"2703FD"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":1796,"title":"Using `JSON.stringify()` falsely triggers `scalar list token string in a scalar string context` error","updatedAt":"2023-06-01T14:33:05Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjg1ODcxOTU0","is_bot":false,"login":"ben-marengo-msmg","name":"Ben Marengo"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\ncdktf 0.10.3\r\npython 3.9\r\n\r\n### Affected Resource(s)\r\n\r\nhaving the following in cdktf.json\r\n```json\r\n  \"terraformProviders\": [\"google@>= 3.84.0\", \"google-beta@>= 3.84.0\"],\r\n```\r\n\r\nsynthesising with cdk 0.9.0, `cdktf.out/stacks/<my-stack>/cdk.tf.json` shows\r\n```json\r\n{\r\n  ...,\r\n  \"terraform\": {\r\n    ...\r\n    \"required_providers\": {\r\n      \"google\": {\r\n        \"source\": \"google\",\r\n        \"version\": \">= 3.84.0\"\r\n      },\r\n      \"google-beta\": {\r\n        \"source\": \"google-beta\",\r\n        \"version\": \">= 3.84.0\"\r\n      }\r\n    }\r\n  },\r\n  ...\r\n}\r\n```\r\n\r\nsynthesising with cdk 0.10.3, `cdktf.out/stacks/<my-stack>/cdk.tf.json` shows\r\n```json\r\n{\r\n  ...,\r\n  \"terraform\": {\r\n    ...\r\n    \"required_providers\": {\r\n      \"google\": {\r\n        \"source\": \"google\",\r\n        \"version\": \"4.19.0\"\r\n      },\r\n      \"google-beta\": {\r\n        \"source\": \"google-beta\",\r\n        \"version\": \"4.19.0\"\r\n      }\r\n    }\r\n  },\r\n  ...\r\n}\r\n```\r\n\r\nthis is a problem because i deploy this synthesised cdk.tf.json as a module in other terraform stacks. pinning the version of the provider shackles the other terraform stacks to this version of the provider","comments":[{"id":"IC_kwDODd1Amc5Ce84A","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"This was added with https://github.com/hashicorp/terraform-cdk/pull/1586.\r\n\r\nPinning minimum required to what Terraform actually resolved is definitely intended. The generated code is quite likely not 100% compatible with the version specified in `cdktf.json` since any new / modified resource will only exist on the newer resolved version.\r\n\r\nAlso pinning maximum version is more subjective. The main reasoning behind this is to ensure that code written results in the same output regardless of where/when it is ran. Just specifying a minimum version means that a different version of the provider could be used than what a developer experienced locally.\r\n\r\nI do see that pinning the maximum version is probably overly restrictive when using cdktf to create Terraform modules. [Writing L2/L3 constructs](https://discuss.hashicorp.com/t/l3-construct-providers-patterns-and-practices-question/38591) could possibly run into some similar issues, so perhaps we'll need to loosen the restriction at the cost of less defined behavior. Alternatively, it might make sense to have a way to explicitly tell cdktf that a module is being created (see https://github.com/hashicorp/terraform-cdk/issues/1518#issuecomment-1023828746).\r\n\r\nIn the meantime, you should be able to use an escape hatch to override the value. Something along the lines of `stack.add_override(\"terraform.required_providers.google.version\", \">= 3.84.0\")`","createdAt":"2022-05-02T21:56:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1762#issuecomment-1115409920","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5HfqQS","author":{"login":"ben-marengo-msmg"},"authorAssociation":"NONE","body":"fyi - it currently contradicts the docs\r\nhttps://www.terraform.io/cdktf/create-and-deploy/configuration-file#version-constraint","createdAt":"2022-07-29T15:04:57Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1762#issuecomment-1199481874","viewerDidAuthor":false}],"createdAt":"2022-04-29T14:59:00Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"}],"milestone":null,"number":1762,"title":"provider version gets pinned on synth","updatedAt":"2022-07-29T15:04:57Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nThis was initially part of #877 but got scoped out of that work:\r\n\r\nAdd a command that allows searching for Terraform providers in the Terraform Registry:\r\n```\r\n$> cdktf provider search kubernetes\r\n\r\nSearching registry.terraform.io for \"kubernetes\" providers...\r\nFound\r\nhashicorp/kubernetes (official) https://registry.terraform.io/providers/hashicorp/kubernetes\r\nhashicorp/kubernetes-alpha (official) https://registry.terraform.io/providers/hashicorp/kubernetes-alpha\r\nredux/kubernetes (community) https://registry.terraform.io/providers/redeux/kubernetes\r\n...\r\n```\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\nThe terraform registry currently lacks a suitable search API. The Terraform VSCode extensions wants similar functionality to support provider install/upgrade workflows, so collaboration with that team to add this to the Terraform registry would be needed to build the search portion of this functionality.\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-04-25T13:43:08Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjQ2NzM1NDk1","name":"providers","description":"","color":"2bd8cd"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMDEzNzM4ODIw","name":"needs-research","description":"","color":"709F22"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"}],"milestone":null,"number":1744,"title":"Add `cdktf provider search` command","updatedAt":"2023-03-09T11:56:44Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nCurrently our templates used in `cdktf init` do a string replace to inject a RemoteBackend. This is less than ideal and broke in more than one instance (see [here](https://github.com/hashicorp/terraform-cdk/pull/1732/commits/ff6d66fdc8292dfb2a48f809acaf7fa038aba957) for one fix).\r\nWe should make that more robust.\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n* https://github.com/hashicorp/terraform-cdk/issues/1493\r\n* https://github.com/hashicorp/terraform-cdk/issues/1494\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-04-20T08:25:15Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjIzNTI1MzY0","name":"terraform cloud","description":"","color":"4ed354"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"LA_kwDODd1Amc7x0kYM","name":"feature/init","description":"cdktf init related features","color":"C1E24A"}],"milestone":null,"number":1734,"title":"Improve init templates (get rid of string replacing)","updatedAt":"2023-06-01T16:17:56Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjIyNzkwOQ==","is_bot":false,"login":"amcdnl","name":"Austin"},"body":"## Description\r\nCurrently the CDKTF supports `TerraformAsset` which work nicely for resources like Lambda files, however, for static web application deploys to S3 its not ideal.\r\n\r\nI've been attempting to do it something like this ( based on a few articles ):\r\n\r\n```\r\n    const files = glob.sync('../build/**/*', { absolute: false, nodir: true });\r\n    for (const file of files) {\r\n      new S3Object(this, `aws_s3_bucket_object_${path.basename(file)}`, {\r\n        dependsOn: [bucket],\r\n        key: file.replace(`../build/`, ''),\r\n        bucket: bucket.bucket,\r\n        source: path.resolve(file),\r\n        etag: `${Date.now()}`,\r\n        contentType: mime.contentType(path.extname(file)) || undefined\r\n      });\r\n    }\r\n```\r\n\r\nHowever, this approach is VERY slow since it has to catalog all the assets/etc and then manually upload one by one. When you have a fair amount of static assets like SVG icons or something, it can take 5+ minutes for a simple upload. I ended up moving this out of the process for the time being due to that but found the AWS CDK has  a nice approach to handle this using a `BucketDeployment` construct:\r\n\r\n```\r\n        new deploy.BucketDeployment(this, \"Deployment\", {\r\n            sources: [deploy.Source.asset(\"./build\")],\r\n            destinationBucket: siteBucket,\r\n            distribution: siteDistribution,\r\n            distributionPaths: [\"/*\"]\r\n        });\r\n```\r\n\r\nReference: https://dev.to/paulallies/deploy-your-static-react-app-to-aws-cloudfront-using-cdk-44hm\r\n\r\n","comments":[{"id":"IC_kwDODd1Amc5B3TGD","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @amcdnl ğŸ‘‹\r\nThat's a great idea. When building the serverless end to end example a while ago, I used the [aws-cli directly to sync files](https://github.com/hashicorp/cdktf-integration-serverless-example/blob/691ef0e646965fd1ccecb896c4707d397848e4ef/frontend/code/scripts/deploy.js#L11) to S3. But I agree, that we could support this via the CDKTF itself â€“ maybe some kind of \"deployment\" construct might cover this in the future while allowing for different cloud provider specific implementations to work underneath.\r\n\r\n@skorfmann did we have some kind of design issue for this broad topic already? I tried to find some, but didn't find anything besides the `TerraformAsset` feature, but that only copies / bundles files for use within the Terraform stage.","createdAt":"2022-04-21T10:16:43Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HOORAY","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1730#issuecomment-1105015171","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5B3wdg","author":{"login":"amcdnl"},"authorAssociation":"NONE","body":"@ansgarm - Thanks for the quick response. \r\n\r\nThats literally one of the resources I found when trying to figure this out. I ended up using a Github Actions command to do this over a script:\r\n\r\n```\r\n    - uses: jakejarvis/s3-sync-action@master\r\n      with:\r\n        args: --acl public-read --follow-symlinks --delete\r\n```\r\n\r\nOne other suggestion I wanted to make here is that TypeScript users are typically web devs and while I'm not new to this type of stuff by any means, it still took me several hours to get something going end-to-end. I feel like your really missing a huge community that would love this but it needs to be radically more simple to do simple things like deploy a create-react-app application and this could help. React even has a guide for different deployment models that I would encourage you to check out ( https://create-react-app.dev/docs/deployment ).","createdAt":"2022-04-21T12:16:29Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1730#issuecomment-1105135456","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5B4LcP","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> @skorfmann did we have some kind of design issue for this broad topic already? I tried to find some, but didn't find anything besides the `TerraformAsset` feature, but that only copies / bundles files for use within the Terraform stage.\r\n\r\nNot that I'm aware of. \r\n\r\nFYI: The mentioned [BucketDeployment](https://github.com/aws/aws-cdk/blob/10f5ede7ed4b835df6406f1b457e2b1230bef4df/packages/%40aws-cdk/aws-s3-deployment/lib/bucket-deployment.ts) construct does some heavy lifting behind the scenes which would likely work quite differently on our end.\r\n\r\nWould agree with @ansgarm here that some third party tooling is the best option for these kind of tasks at the moment.","createdAt":"2022-04-21T13:57:15Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1730#issuecomment-1105245967","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5B4dRR","author":{"login":"amcdnl"},"authorAssociation":"NONE","body":"@skorfmann - \r\n\r\n> Would agree with @ansgarm here that some third party tooling is the best option for these kind of tasks at the moment.\r\n\r\nI found this article https://medium.com/scaffold/deploying-a-react-app-on-aws-s3-using-terraform-and-the-cdktf-eb7c91038879 which uses this product called Scaffold ( https://scaffold.sh/ ) but I don't really want 'yet another' thing in the mix to do a simple task. I was hoping CDKTF could help me eliminate these types of mundane scripting like this with abstractions for providers.\r\n","createdAt":"2022-04-21T14:45:58Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1730#issuecomment-1105318993","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5gvIEM","author":{"login":"ap0nia"},"authorAssociation":"NONE","body":"I did some poking around and I cobbled together something that seems to work with the current version of the CDK (TypeScript). The implementation is based on the official [template-dir module](https://github.com/hashicorp/terraform-template-dir/tree/master).\r\n\r\n```ts\r\nimport cdktf from 'cdktf'\r\n\r\n// everything below inside of a stack\r\n\r\nconst bucket = new aws.s3Bucket.S3Bucket(this, 'bucket')\r\n\r\nconst fileTypes = new cdktf.TerraformLocal(this, \"file-types\", {\r\n  \".css\": \"text/css; charset=utf-8\",\r\n  \".js\": \"application/javascript\",\r\n  \".json\": \"application/json\",\r\n  // ... and rest of types from the module, or any you can find\r\n} )\r\n\r\nconst assets = new cdktf.TerraformAsset(this, 'assets', {\r\n  path: 'path/to/static/assets',\r\n  type: cdktf.AssetType.DIRECTORY,\r\n})\r\n\r\nconst forEach = cdktf.TerraformIterator.fromList(cdktf.Fn.fileset(assets.path, '**'))\r\n\r\nnew aws.s3Object.S3Object(this, 'dynamic-assets-upload', {\r\n    forEach,\r\n    bucket: assets.bucket,\r\n    forceDestroy: true,\r\n    key: forEach.value,\r\n    source: `${assets.path}/${forEach.value}`,\r\n    etag: cdktf.Fn.filemd5(`${assets.path}/${forEach.value}`),\r\n\r\n   // like the referenced module, every file is regex matched and the extension extracted;\r\n   // the extension is used to lookup from the local variable, \"fileTypes\",\r\n   // and defaults to \"application/octet-stream\" if not found\r\n    contentType: cdktf.Fn.lookup(\r\n      fileTypes.fqn,\r\n      cdktf.Fn.element(cdktf.Fn.regexall(\"\\.[^\\.]+$\", forEach.value), 0),\r\n      \"application/octet-stream\"\r\n    )\r\n  }\r\n)\r\n```\r\n\r\nIt would be great to know if this was helpful in any way!","createdAt":"2023-07-06T04:41:04Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}},{"content":"HEART","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1730#issuecomment-1622966540","viewerDidAuthor":false}],"createdAt":"2022-04-19T17:05:48Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMDEzNzM4ODIw","name":"needs-research","description":"","color":"709F22"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjA1MTIxODAz","name":"enhancement/new-workflow","description":"Proposed new workflow","color":"4A1023"}],"milestone":null,"number":1730,"title":"Improve S3 Bucket Deployments for Web Apps","updatedAt":"2023-07-06T04:41:53Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzNDA4NDU2","is_bot":false,"login":"schersh","name":"Sarah MacDonald"},"body":"Placeholder for engineering work to make improvements to `cdktf init` workflow, as identified in https://github.com/hashicorp/terraform-cdk/issues/1704","comments":[],"createdAt":"2022-04-08T20:44:29Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"LA_kwDODd1Amc7KmqHq","name":"planning/placeholder","description":"capacity-planning placeholder issue","color":"1D435A"},{"id":"LA_kwDODd1Amc7x0kYM","name":"feature/init","description":"cdktf init related features","color":"C1E24A"}],"milestone":null,"number":1705,"title":"[Placeholder] Improve `init` workflow","updatedAt":"2023-06-02T10:12:58Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nWe currently only check that the library version matches the CLI version in TS. This issue tracks that we check this in the other languages as well.\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2022-04-08T17:11:10Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMTM1OTU1Nzk1","name":"ux/debugging","description":"","color":"2703FD"}],"milestone":null,"number":1703,"title":"Add library version checks for non-TS languages","updatedAt":"2022-04-08T17:11:10Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjIxOTUyNjQ1","is_bot":false,"login":"Thomas-X","name":"Thomas Zwarts"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\nCurrently there's only 1:1 mappings for most TF providers, and this is an awesome thing to have. But the big selling point for CDK(in my eyes) is that there's higher level constructs which reduce all the bits and pieces you have to think about when using terraform or cloudformation, let's call the 1:1 mappings L1 constructs and anything above that L2. \r\n\r\nThis would involve having a higher level construct for highly used resources. Think of adding a L2 construct for AWS Lambda, a loadbalanced AWS ECS cluster etc. \r\n\r\nBasically supercharged terraform modules ğŸ˜ƒ \r\n\r\n#### *Cool, how would this look like?*\r\nConsider the following Lambda function setup:\r\n```typescript\r\n// rest of the stuff is \r\nconst lambdaRolePolicy = { // this could be typed!\r\n  \"Version\": \"2012-10-17\",\r\n  \"Statement\": [\r\n    {\r\n      \"Action\": \"sts:AssumeRole\",\r\n      \"Principal\": {\r\n        \"Service\": \"lambda.amazonaws.com\"\r\n      },\r\n      \"Effect\": \"Allow\",\r\n      \"Sid\": \"\"\r\n    }\r\n  ]\r\n};\r\nconst role = new aws.iam.IamRole(this, \"lambda-exec\", {\r\n  name: `learn-cdktf-${name}-${pet.id}`,\r\n  assumeRolePolicy: JSON.stringify(lambdaRolePolicy)\r\n});\r\n\r\nconst lambdaFunc = new aws.lambdafunction.LambdaFunction(this, \"learn-cdktf-lambda\", {\r\n  functionName: `learn-cdktf-${name}-${pet.id}`,\r\n  s3Bucket: bucket.bucket,\r\n  s3Key: lambdaArchive.key,\r\n  handler: config.handler,\r\n  runtime: config.runtime, // this could be a nice enum\r\n  role: role.arn\r\n});\r\n\r\n```\r\nThis requires a bunch of stuff I don't want to worry about when developing a simple lambda function (CDKTF could lighten this!)\r\n```typescript\r\nconst lambdaFunc = new LambdaFunction(this, \"l2-lambda-func\", {\r\n  functionName: 'foobar',\r\n  // role can be entirely omitted, just generate one behind the scenes that's assumed by lambda principal\r\n  runtime: aws.Lambda.Runtimes.DOTNETCORE3.1,\r\n  code: new AssetCode(\"./code.zip\"),\r\n  // for the rest provide sensible defaults, use nullable features where possible to indicate a required property etc\r\n});\r\n```\r\n\r\nI'm more than happy to spend some time on this if this is something we actually want\r\n\r\n### References\r\nThere's many, but the start would be removing all these hardcoded strings which could be in enums across most resources and eliminating the size of code needed for highly used resources by adding sensible defaults and 1st class 'modules'. \r\nhttps://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.BucketAccessControl.html\r\nhttps://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_lambda.RuntimeFamily.html\r\nhttps://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.RedirectProtocol.html\r\n\r\nprops like `autoDeleteObjects` on S3 bucketswould be a big boon https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.Bucket.html#construct-props. There's countless ways we could make the library nicer to work with, which results in cleaner code for everyone.\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5A_fv4","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @Thomas-X ğŸ‘‹\r\nI really like your ideas! They sound a bit like #474. Would you say this is a duplicate of that issue?\r\n\r\nAs you're mostly proposing L2 constructs for AWS: Have you seen the [AWS adapter](https://www.terraform.io/cdktf/create-and-deploy/aws-adapter)?","createdAt":"2022-04-06T15:12:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1686#issuecomment-1090386936","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5A_v6X","author":{"login":"Thomas-X"},"authorAssociation":"NONE","body":"Hi @ansgarm, thanks for the quick reply ğŸ‘‹ . \r\nLooking at it this is a duplicate of that issue, you can close this if that's preferred. \r\n\r\nI checked out the AWS adapter (pretty neat!) but I think we should strive for 1st class citizen L2/L3 abstractions that use cdktf. This would enable us to make L2/L3 abstractions for other cloud providers as well.\r\n\r\nI'd like to have a crack at a basic implementation, anything I should know that's not in CONTRIBUTING.MD? \r\nI'll just setup a quick repo for one of the AWS services to begin with, basing it off the L2 implementation of the AWS CDK. \r\n\r\nI can update the other ticket or this one when I've done that, let me know\r\n ","createdAt":"2022-04-06T16:14:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1686#issuecomment-1090453143","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5BDj2q","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Ah, I see! Sounds like you have some slightly different thing in mind.\r\nPlease let me know if I understood you correctly, but instead of only having L2/L3 abstractions for each single cloud provider, you'd rather build a shared L3 first (e.g. an L3 construct for a \"hosted static website\") and then have different implementations based on the cloud provider (i.e. implementations for that abstraction). Is that right? If yes, we could rephrase this issue's title instead of closing it ğŸ‘\r\n\r\nWe also had some discussions about this in the team in the past. I personally am quite torn about it, as I fear that different cloud providers have too different ways of approaching granting access to resources. So an abstraction like `bucket.grantRead()` might work with AWS IAM but could become leaky for other cloud providers that have e.g. some group based access model (I _think_ Google does, but I'm not sure). But there might of course still be solutions to this problem and it could be possible to find a model that is not too leaky while supporting multiple patterns of \"granting access\". I also remember that @DanielMSchmidt also had some ideas around this and is less skeptic about such shared layers than I am ğŸ˜\r\n\r\nThe `CONTRIBUTING.md` mostly covers PRs to this repo, so feel free to just go ahead with a quick repo ğŸ‘ Such a first draft would be much appreciated as it would serve as a good base for further discussions. However, of course we can't promise you that we'll adopt it.\r\n\r\nHave you seen the [cdktf-plus package](https://github.com/cdktf-plus/cdktf-plus)? @skorfmann started this some time ago to help with common boilerplate when deploying e.g. AWS lambda functions using CDKTF. It might serve as a good starting point about how to build a construct library.","createdAt":"2022-04-07T09:54:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":3}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1686#issuecomment-1091452330","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5BEpzu","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Yeah, I'd love to build this one day, if you happen to start with it let me know and I'll take a look ğŸ‘ ","createdAt":"2022-04-07T13:28:40Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1686#issuecomment-1091738862","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5PjcYs","author":{"login":"github-actions"},"authorAssociation":"CONTRIBUTOR","body":"Hi there! ğŸ‘‹ We haven't heard from you in 30 days and would like to know if the problem has been resolved or if you still need help. If we don't hear from you before then, I'll auto-close this issue in 30 days.","createdAt":"2022-12-02T02:39:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1686#issuecomment-1334691372","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5WucSG","author":{"login":"strongishllama"},"authorAssociation":"NONE","body":"At the risk of putting words in @Thomas-X's mouth, I think he is talking about the same thing in issue #474. However, if one of these two issues is going to be closed, I would vote for it to be #474 as the description in this issue is a lot more comprehensive.\r\n\r\nI'd also love for something like this to exist, and might have some free time to dedicate to it. @ansgarm & @DanielMSchmidt it's been a while since there was any activity on these two open issues. Any updates on your end you'd like to share? Or a place you've made a start?\r\n\r\nPersonally, L2 & L3 constructs for GCP would be the most useful for me, so that's likely where I'd put my effort. Likely starting exclusively L2 and leaving L3 once the L2 API feels good and stable.\r\n\r\nWould love to hear your thoughts, thanks!","createdAt":"2023-03-05T07:40:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1686#issuecomment-1455015046","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5WvOPI","author":{"login":"RichiCoder1"},"authorAssociation":"NONE","body":"I was just thinking about this myself!\r\n\r\nThe description of this issue alludes to it, but I think an important place to start (and good limited scope) would be asking what are the provider primitives that are missing for L2s that don't just provide higher level opinions.\r\n\r\nSo, for the AWS NodeJS Lambda example, the missing glue pieces for that are:\r\n\r\n* Asset management, aka automatically packaging and uploading assets to S3 (ideally in a more forward maintainable way that the CDK today). Ala S3 Assets/ECR Assets in the AWS CDK.\r\n* IAM Abstraction ala CDK AWS `aws_iam` to allow for sharing and creating intelligent iam policies\r\n\r\nIn addition, other abstractions are for example `IConnectable` and all the VPC/SG related abstractions.\r\n\r\nBuilding those would enable building L2s (as well as potentially unblocking the AWS adapter for asset cases).\r\n\r\nDitto for GCP and Azure, as I imagine they have the same IAM and Asset management concerns.","createdAt":"2023-03-05T21:59:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1686#issuecomment-1455219656","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5XPHRw","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @strongishllama @RichiCoder1\r\n\r\nthank you for bringing up this topic! While there are no concrete plans or prototypes, we're very interested in exploring this!\r\n\r\nIf I were to start writing some L2 constructs for GCP, I'd probably start with a small NPM package that has a peer dependency on the pre-built provider for GCP and then create a few constructs to get a feel for it. At a later stage this could use the same setup as e.g. the [cdktf-tf-module-stack](https://github.com/cdktf/cdktf-tf-module-stack) repository (which uses JSII to support all CDK languages). If you have any questions, I'm happy to help and if you start something, let us know!\r\n\r\nIn regards to shared abstractions (like e.g. `IConnectable`), I personally think that this might be pretty hard to get right as it may be easy to accidentally create leaky abstractions if the underlying permission models are subtly different. For example some providers â€“ I think it was Azure, but I may be wrong â€“ commonly use groups of resources to define access, while others like AWS use more granular controls.\r\nSo an abstraction like `serverA.allowAccess(serverB); serverB.allowAccess(serverC)` might work for AWS but e.g. could put all servers into the same resource group for Azure, which might accidentally also allow access for `serverA` to `serverC` if implemented naively by putting all in the same group. But there might still be a way to find a good abstraction that doesn't require the user to know about such pitfalls.\r\nThat said, this might get even more interesting when access is given between resources from two different providers which might ultimately not be possible without additional supporting infrastructure and would require us to implement a matrix of connections to actually support such cross provider access controls ğŸ˜„\r\n\r\nSo in the end, a layer 2 construct library for GCS might have its own abstractions for managing access that is not based on the same primitives that e.g. an AWS L2 construct library might be based on.\r\n\r\nHowever, there will probably be a common ground that is compatible across cloud providers, with e.g. asset management (as mentioned) being one thing that we're already looking at because we want to support that in the AWS Adapter. A Docker container that is built and uploaded to some registry for example would be very similar for lots of providers.\r\nBesides assets, there are probably other things that could rely on shared abstractions, and I'd say in general we'd be open to add such general abstractions to the `cdktf` core package (like e.g. an `DockerImageAsset`).","createdAt":"2023-03-10T10:14:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1686#issuecomment-1463579760","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5XRgBz","author":{"login":"RichiCoder1"},"authorAssociation":"NONE","body":"Yup. To clarify, my intent was to not share anything between providers because of that exact issue. It's more work and possibly more redundancy, but I believe it would only do harm in the end to try and do any sort of multi-provider abstractions from the get-go for L2/L3s.\r\n\r\nI'd endorse building the basics specific to the major cloud platform providers, and only then possibly try and build multi-cloud abstractions after that. Even Asset I fear will have platform-specific quirks that won't necessarily translate well when you get into actually giving those assets to cloud services (uploaded from S3, must be in ECR for AWS examples).","createdAt":"2023-03-10T18:23:54Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1686#issuecomment-1464205427","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5XUG16","author":{"login":"strongishllama"},"authorAssociation":"NONE","body":"Great, sounds like we're all on the same page to me. I'm going to start tinkering around [here](https://github.com/strongishllama/terraform-cdk-constructs). Feel free to reach out with any thoughts, feeling or feedback, it's all very welcome. It might be a little while before I have something I'm happy with/worth showing, so I'll post back here when there's a bit more there ğŸ˜ ","createdAt":"2023-03-11T11:15:21Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1686#issuecomment-1464888698","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5XZbZn","author":{"login":"xiehan"},"authorAssociation":"MEMBER","body":"I'll add that we here at HashiCorp have nothing against L2/L3 constructs and would _love_ it if there were more native constructs for CDKTF as well, we just don't have the staffing to make that a reality ourselves; there's so much to do on the constructs side that we'd likely need a separate team to _just_ focus on that, and that's not where we are today. This is why the only work we're committing to in the near-term is more work on the [AWS adapter](https://developer.hashicorp.com/terraform/cdktf/create-and-deploy/aws-adapter); I recognize that won't meet everyone's needs, but giving CDKTF users access to all AWS constructs is a super powerful thing in a world where we don't have enough constructs of our own yet. In the meantime, we're fully supportive of community contributions and recently added a [construct authoring guide](https://developer.hashicorp.com/terraform/cdktf/develop-custom-constructs/construct-design) to our documentation to encourage these. If there are any other meta-level things like that that we can do to make that easier, please let us know! ğŸ™‚ ","createdAt":"2023-03-13T14:47:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":3}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1686#issuecomment-1466283623","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Xc3qJ","author":{"login":"RichiCoder1"},"authorAssociation":"NONE","body":"> This is why the only work we're committing to in the near-term is more work on the [AWS adapter](https://developer.hashicorp.com/terraform/cdktf/create-and-deploy/aws-adapter);\r\n\r\nIronically one of the things missing from that called out here is the lack of asset support ğŸ˜…. I def could see that bridge being great for AWS consumers otherwise though!\r\n\r\n>  If there are any other meta-level things like that that we can do to make that easier, please let us know! ğŸ™‚\r\n\r\nOne thing that isn't absolutely necessary but might make @strongishllama and I's life easier is maybe expanding the scope of the `TerraformAsset` and maybe adding a `TerraformImage` resource. Being able to have the framework handle \"building\" assets, and then us taking over staging those assets in the appropriate cloud provider would probably help.","createdAt":"2023-03-14T01:00:37Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1686#issuecomment-1467185801","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc65nPkr","author":{"login":"so0k"},"authorAssociation":"NONE","body":"@xiehan , @RichiCoder1 , @Thomas-X - I totally missed this issue but I started working on L2 constructs about a year ago and ended up adding more and more AWSCDK polyfills (including asset manager, Aspect to transfer construct node dependencies to `depends_on` property and so on.\n\nI've also built an LLM workflow to automate porting AWSCDK to CDKTF provider-aws\n\nthe result of that is https://terraconstructs.dev  and full support for running the cdkworkshop (at https://aws-workshop.terraconstructs.dev )\n\nI'm curious to explore using the LLM workflow and the provider for gcp to see if LLMs can help design the L2 constructs for other clouds.\n\nin the mean time I keep porting the awscdk modules I need at my place of work and anyone is welcome to use and or contribute (this is Apache 2.0 licensed)","createdAt":"2025-07-24T16:17:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1686#issuecomment-3114072363","viewerDidAuthor":false}],"createdAt":"2022-04-05T10:12:29Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjk5ODU0MzY0","name":"abstractions (level 2 / level 3)","description":"","color":"279ebc"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"}],"milestone":null,"number":1686,"title":"Higher level Constructs","updatedAt":"2025-07-24T16:17:26Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE3NDg5MDk=","is_bot":false,"login":"beanaroo","name":"Michael Heyns"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\ncdktfL 0.9.4\r\nTypescript: 4.6.2\r\n\r\n### Affected Resource(s)\r\n\r\nAll resources\r\n\r\n### Expected Behavior\r\n\r\nExamples should not emit issues for conventional code quality rules.\r\n\r\n### Actual Behavior\r\n\r\nESLint emits `no-new` errors: https://eslint.org/docs/rules/no-new\r\nSonarQube emits `Major Bug S1848`: https://rules.sonarsource.com/typescript/RSPEC-1848\r\n\r\n\r\n### Steps to Reproduce\r\n\r\n```typescript\r\nexport class HelloTerra extends TerraformStack {\r\n  constructor(scope: Construct, id: string) {\r\n    super(scope, id);\r\n\r\n    new AwsProvider(this, \"aws\", {   // Emits Issue\r\n      region: \"eu-central-1\",\r\n    });\r\n\r\n    const region = new DataAwsRegion(this, \"region\");\r\n\r\n    new aws.DynamoDB.DynamodbTable(this, \"Hello\", {   // Emits Issue\r\n      name: `my-first-table-${region.name}`,\r\n      hashKey: \"temp\",\r\n      attribute: [{ name: \"id\", type: \"S\" }],\r\n      billingMode: \"PAY_PER_REQUEST\",\r\n    });\r\n  }\r\n}\r\n\r\n```\r\n\r\n### Important Factoids\r\n\r\nSearching the internet for information on these errors leads to advice that this is bad practice and should be avoided. This can be confusing for newcomers to the library.\r\n\r\nWorking in an organization that has shared/common linting rules makes it hard to justify adding exceptions.\r\n\r\nIt would be great if the documentation could address this, either through better examples or by clear explanation on why this approach is necessary.\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n- [Should constructors ever be used only for side-effects?](https://softwareengineering.stackexchange.com/questions/343447/should-constructors-ever-be-used-only-for-side-effects)\r\n- [Why is using side effects bad practice in JavaScript constructors?](https://stackoverflow.com/questions/14694982/why-is-using-side-effects-bad-practice-in-javascript-constructors)\r\n- [Constructors should not cause side effects](https://blog.millermedeiros.com/constructors-should-not-cause-side-effects/)\r\n- [EsLint - Suppress \"Do not use 'new' for side effects\"](https://stackoverflow.com/questions/33287045/eslint-suppress-do-not-use-new-for-side-effects#comment103169690_33287410)\r\n","comments":[{"id":"IC_kwDODd1Amc5AwgUQ","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"You are declaring what resources you want in your infrastructure. In a way, each new statement is like creating the infrastructure resource. Sometimes other pieces reference that (and you assign to a variable), but other times nothing needs to reference them.","createdAt":"2022-04-02T01:25:19Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1682#issuecomment-1086457104","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5BRJ_L","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @beanaroo ğŸ‘‹\r\nI can see your reasoning here. While this pattern does not match conventional code quality rules, it is a core pattern of the underlying [constructs](https://github.com/aws/constructs) library which powers all CDKs. Hence the [AWS CDK](https://github.com/aws-samples/aws-cdk-examples/blob/master/typescript/lambda-manage-s3-event-notification/lib/sample-service-stack.ts#L35) and the [cdk8s](https://github.com/cdk8s-team/cdk8s/blob/master/examples/typescript/hello/index.ts#L12) also have examples sharing this pattern.\r\n\r\nWhile I couldn't find any material on this design decision (e.g. in the [AWS CDK RFC repo](https://github.com/aws/aws-cdk-rfcs/)), I suspect that this pattern has been chosen for simplicity and for the sentiment of `new Something()` which already suggests the \"creation\" of certain pieces of infrastructure.\r\n\r\nI like your idea on adding docs for this which is certainly something we could cover and where we could advise to disable said linting rules in CDKTF projects.","createdAt":"2022-04-11T12:56:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1682#issuecomment-1095016395","viewerDidAuthor":false}],"createdAt":"2022-04-01T21:21:06Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyNzQzNTkyMDA3","name":"examples","description":"","color":"4AB3A0"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"}],"milestone":null,"number":1682,"title":"Typescript examples fail standard code analysis regarding constructor side-effects","updatedAt":"2022-08-12T09:22:20Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM1NzM1MTE4","is_bot":false,"login":"bestickley","name":"Ben Stickley"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\ncdktf: 0.9.4\r\nNode.js: 16.14.1\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\n### Affected Resource(s)\r\n\r\n<!--- Please list the affected resources. --->\r\nS3BucketObject\r\n### Debug Output\r\n\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\nhttps://gist.github.com/bestickley/1f15626e5770692b45bbc974a709b7c6\r\n### Expected Behavior\r\n\r\n<!--- What should have happened? --->\r\nSuccess\r\n### Actual Behavior\r\n\r\n<!--- What actually happened? --->\r\nError\r\n### Steps to Reproduce\r\n\r\n<!--- Please list the steps required to reproduce the issue. --->\r\n`\"type\": \"module\"` in package.json and use `S3BucketObject` construct.\r\n### Important Factoids\r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n- #0000\r\n","comments":[{"id":"IC_kwDODd1Amc5AU0CC","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @bestickley ğŸ‘‹\r\nWhy do you need to change the package type to module?","createdAt":"2022-03-25T16:32:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_DOWN","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1660#issuecomment-1079197826","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5AVFXM","author":{"login":"bestickley"},"authorAssociation":"NONE","body":"Because from the Node.js docs:\r\n\r\n> ECMAScript modules are [the official standard format](https://tc39.github.io/ecma262/#sec-modules) to package JavaScript code for reuse\r\n\r\nand I'd like to use the official standard format. Not a huge deal, but a nice to have.","createdAt":"2022-03-25T17:57:34Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1660#issuecomment-1079268812","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Apwdh","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Ah, I see! We use `ts-node` in our template which might cause this problem. I found this [blog post](https://michael-timbs.medium.com/node-esm-typescript-and-aws-cdk-4ec7ec3d2b31) about using ESM with the AWS CDK which seems like a solution to a similar problem.\r\nNevertheless, I'm going to tag this as issue `awaiting-evidence` for now, as we don't plan to proactively work on this but are still open for contributions or revisiting this if things change. I hope that is okay with you?","createdAt":"2022-03-31T14:48:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1660#issuecomment-1084688225","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5ArJCi","author":{"login":"bestickley"},"authorAssociation":"NONE","body":"I thought the issue was specific to the s3 module and how it reads files but I definitely could be wrong. That blog post is talking about issues arising from having ESM packages in your node_modules. My understanding is that the current cdktf s3 library is using Node.js APIs in a way that's not compatible with ESM. Yes, I'm ok with that tag.","createdAt":"2022-03-31T20:08:11Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1660#issuecomment-1085051042","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5peFck","author":{"login":"cyrfer"},"authorAssociation":"NONE","body":"I believe this bit me today. All the packages in my monorepo are ESM now.\r\n\r\nWhen I try to run `cdktf synth` it fails:\r\n```bash\r\nTypeError [ERR_UNKNOWN_FILE_EXTENSION]: Unknown file extension \".ts\"\r\n```","createdAt":"2023-10-18T22:23:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1660#issuecomment-1769494308","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5qUZVa","author":{"login":"jason-henriksen"},"authorAssociation":"NONE","body":"This is hitting me right now. \r\n\r\nI run extensive tests in jest.  I haven't found a way to use cdk to run jest.  But if I don't have type:'module' just will file.   If I do have it, then CDK fails.   I need both to play nice.","createdAt":"2023-10-28T07:22:55Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1660#issuecomment-1783731546","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc54VQt1","author":{"login":"cyrfer"},"authorAssociation":"NONE","body":"I would like to be able to package a ESM LIBRARY that leverages cdktf and related providers. This would make it much simpler to be able to depend on other ESM libraries.\r\n\r\nI have other packages which consume that library. Currently I am only able to package the library as CJS so that it is consumed as CJS where the cdktf CLI is used. I don't know how to get the cdktf CLI to work when my CJS library containing cdktf code depends on ESM libraries.\r\n\r\n# UPDATE\r\nI still want to be able to bundle a library as ESM but I am unblocked.\r\n\r\nI was able to get the cdktf CLI to work with my CJS library that depends on a ESM library by following the blog post mentioned above by @ansgarm. I edited cdktf.json to use [tsx](https://www.npmjs.com/package/tsx) instead of [ts-node](https://www.npmjs.com/package/ts-node).\r\n\r\n> Ah, I see! We use `ts-node` in our template which might cause this problem. I found this [blog post](https://michael-timbs.medium.com/node-esm-typescript-and-aws-cdk-4ec7ec3d2b31) about using ESM with the AWS CDK which seems like a solution to a similar problem. Nevertheless, I'm going to tag this as issue `awaiting-evidence` for now, as we don't plan to proactively work on this but are still open for contributions or revisiting this if things change. I hope that is okay with you?\r\n\r\n","createdAt":"2024-03-25T20:18:49Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1660#issuecomment-2018839413","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6EdPkR","author":{"login":"mstuercke"},"authorAssociation":"NONE","body":"If you're using [Bun](https://bun.sh/), just replace `app` value in `cdktf.json` with `\"bun main.ts\"`.\r\n\r\nExample:\r\n```json\r\n{\r\n  ...\r\n  \"app\": \"bun main.ts\",\r\n  ...\r\n}\r\n\r\n```","createdAt":"2024-07-11T07:45:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1660#issuecomment-2222258449","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7D8ZdY","author":{"login":"shellscape"},"authorAssociation":"NONE","body":"It's been three freaking years since this issue was open. ESM is the standard on which new code is being written. Can we please get some traction here? The binding generation alone being stuck on CJS (TypeScript, but CJS paths for imports) is massively problematic. Come on folks, quit sleeping on this. ","createdAt":"2025-09-13T02:27:07Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":5}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1660#issuecomment-3287390040","viewerDidAuthor":false}],"createdAt":"2022-03-25T15:29:45Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMTEzNjU2OTEz","name":"language/typescript","description":"","color":"a5ccff"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"}],"milestone":null,"number":1660,"title":"Support ECMAScript modules (ESM) in CDKTF projects","updatedAt":"2025-09-13T02:27:07Z"},{"assignees":[],"author":{"id":"U_kgDOBhbVIg","is_bot":false,"login":"Joe-Kollin","name":""},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Affected Resource(s)\r\n\r\nTagging with RouteTables, Routes, and NAT Gateways\r\n\r\n### Debug Output\r\n\r\n### Expected Behavior\r\n\r\n```\r\n// Create NAT gateways\r\n    this.natGateways = this.publicSubnets.map((subnet, index) => {\r\n      return new vpc.NatGateway(\r\n        this,\r\n        `${this.config.environment}-${this.config.name}-public-subnet-nat-test-${index}`,\r\n        {\r\n          dependsOn: this.publicSubnets,\r\n          allocationId: this.natGatewayEips[index].allocationId,\r\n          subnetId: subnet.id,\r\n          tags: {\r\n            az: subnet.availabilityZone,\r\n          },\r\n        }\r\n      );\r\n    });\r\n\r\n// Create subnets tables\r\n    this.privateRouteTables = this.privateSubnets.map((subnet, index) => {\r\n      return new vpc.RouteTable(\r\n        this,\r\n        `${this.config.environment}-${this.config.name}-private-subnet-route-table-${index}`,\r\n        {\r\n          vpcId: this.vpc.id,\r\n          tags: {\r\n            'name': `${this.config.environment}-${this.config.name}-private-subnet-route-table-${subnet.id}`,\r\n            'network': 'private',\r\n            'subnetId': subnet.id,\r\n            'az': subnet.availabilityZone,\r\n          },\r\n        }\r\n      );\r\n    });\r\n\r\n// Create route table routes for each subnet\r\n    this.privateRouteTableRoutes = this.privateRouteTables.map((routeTable, index) => {\r\n      const natGatewayId = this.natGateways?.find((gateway) => {\r\n        return routeTable.tags.az === gateway.tags.az;\r\n      })?.id;\r\n\r\n      if (natGatewayId) return [];\r\n\r\n      return new vpc.Route(\r\n        this,\r\n        `${this.config.environment}-${this.config.name}-private-subnet-route-${index}`,\r\n        {\r\n          routeTableId: routeTable.id,\r\n          destinationCidrBlock: '0.0.0.0/0',\r\n          natGatewayId: natGatewayId,\r\n        }\r\n      );\r\n    }).flat();\r\n```\r\n\r\n### Actual Behavior\r\n\r\nI want to reference tags of a created object and the deref does not work\r\n\r\n### Steps to Reproduce\r\n\r\nCreate a resource with tags and try to reference tag values in the creation of another resource by dereferencing the tags of the former.\r\n\r\n- #0000\r\n","comments":[{"id":"IC_kwDODd1Amc5AUm_P","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @Joe-Kollin ğŸ‘‹\r\nIt is currently [not possible to iterate](https://github.com/hashicorp/terraform-cdk/issues/1089) on resources that are only known at runtime. References are resolved to Terraform references, so the actual values behind those will never be available in TypeScript while the code is synthesized.\r\n\r\nHowever, as you seem to be iterating over an array of subnets (`this.publicSubnets`), that probably also are created while the stack is synthesized, you could change your code to contain a single loop (over the AZs) and in there create the resources that are supposed to belong to that AZ.\r\n\r\nAnother option would be to use e.g. `subnet.availabilityZoneInput` which returns the value that was passed to the Subnet when it was created in your code. This is also available for `.tagsInput` and all other attributes that you set. Those are available at synth time. If you post a full example (e.g. in a separate Github repo) I could create a PR with that change if you want.","createdAt":"2022-03-25T15:31:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1659#issuecomment-1079144399","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5AUuHK","author":{"login":"Joe-Kollin"},"authorAssociation":"NONE","body":"Thanks! No need to fix the changes, I can make them, but that helps","createdAt":"2022-03-25T16:05:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1659#issuecomment-1079173578","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Aj0Vi","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"Perhaps it would make sense to enrich the documentation around this behaviour a bit. Had a quick look at https://www.terraform.io/cdktf/concepts/tokens which could have a section (or even a completely new page) around dynamic behaviour like iterations. What do you think?","createdAt":"2022-03-30T13:19:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1659#issuecomment-1083131234","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Aj1TR","author":{"login":"Joe-Kollin"},"authorAssociation":"NONE","body":"Yeah I think that would help a lot. Using the `.tagsInput` or those input attributes in general has helped me a ton, and a quick spot to find recommendations or best practices for that sort of thing as well as cross stack references would be awesome.","createdAt":"2022-03-30T13:22:41Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1659#issuecomment-1083135185","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5ApMGi","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"When we initially added the `xInput` properties it was assumed that we'd eventually remove them. Given the direction that we've gone with tokens / references it seems like they are probably here to stay. Do you agree @skorfmann? If so, we can definitely improve the inline and external documentation around using them.","createdAt":"2022-03-31T12:52:45Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1659#issuecomment-1084539298","viewerDidAuthor":false}],"createdAt":"2022-03-25T14:58:10Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"LA_kwDODd1Amc7KjeH8","name":"feature/dynamic-terraform","description":"","color":"8D7D9C"}],"milestone":null,"number":1659,"title":"Can Not Deref Tags from another Object during creation","updatedAt":"2022-04-19T15:22:33Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEyMzUwMw==","is_bot":false,"login":"coen-hyde","name":"Coen Hyde"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nWe would like the option to disable the creation of assets for local modules behavior introduced in #1476. This new way means that for a cdktf application to run in Terraform Cloud with the latest changes to a module, someone needs to execute `cdktf synth` and commit the generated changes. We were previously triggering runs on cdktf app workspaces if a module it uses changed via the VCS workflow. In addition we do not really want to commit into source an asset directory that has the same module copied dozens of times.\r\n\r\nAs I understand it, this change was made to improve compatibility with Terraform Cloud. The old way worked for us well in Terraform Cloud. Is there something we are missing? Maybe there is an alternative flow that we are not aware of?\r\n","comments":[{"id":"IC_kwDODd1Amc5AMcgv","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"There are a couple motivations for local modules to be treated as assets:\r\n\r\n- When invoking Terraform Cloud from cdktf, any modules used need to be accessible. Packing as assets is a convenient way to ensure this is true.\r\n- Using assets centralizes the handling of relative paths (very common when using local modules) and results in a consistent experience.\r\n- Packaging everything together makes it very clear what source resulted in the synthesized output (More of an argument that the AWS CDK makes since lookups are very common in Terraform).\r\n\r\nI do have a few questions / comments about your workflow to help understand the best course of action:\r\n\r\n- Are the modules in the same repository as the cdktf app?\r\n- Is it possible to just trigger `cdktf synth` as part of the VCS workflow? Not having to run `cdktf synth` locally is a nicer flow from my experience.\r\n- What's the motivation for using a local module rather than just building into the cdktf app?","createdAt":"2022-03-24T02:29:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1644#issuecomment-1077004335","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5APeNt","author":{"login":"coen-hyde"},"authorAssociation":"NONE","body":"Yeah I get the motivation, it makes sense for a lot of workflows, just not ours.\r\n\r\n> Are the modules in the same repository as the cdktf app?\r\n\r\nThey are. We have a mono repo for our infrastructure that includes our modules, workspaces and cdktf apps.\r\n\r\n> Is it possible to just trigger cdktf synth as part of the VCS workflow? Not having to run cdktf synth locally is a nicer flow from my experience.\r\n\r\nI guess we could. But this will still make our git history kind of gross.\r\n\r\n> What's the motivation for using a local module rather than just building into the cdktf app?\r\n\r\nMost of our infrastructure is regular Terraform. These modules are just regular terraform modules which are used in other workspaces as well as the `cdktf` apps. We would prefer not to duplicate logic. Also writing Terraform in `cdktf` has a higher barrier for entry, which means fewer people have the expertise to make changes. So for these reason we try to do what we can in Terraform before reaching for `cdktf`.","createdAt":"2022-03-24T16:13:11Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1644#issuecomment-1077797741","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5AR2qr","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> > Is it possible to just trigger cdktf synth as part of the VCS workflow? Not having to run cdktf synth locally is a nicer flow from my experience.\r\n> \r\n> I guess we could. But this will still make our git history kind of gross.\r\n\r\nThe idea would be that the synth output (including assets) then doesn't need to be committed.\r\nIf that isn't possible, then I think an option to disable automatic options could be a good compromise.\r\n\r\n\r\n\r\n> Also writing Terraform in `cdktf` has a higher barrier for entry\r\n\r\nI'm interested to hear more about why you think this way. Ideally the barrier is actually lower (at least for developers).","createdAt":"2022-03-24T21:57:55Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1644#issuecomment-1078422187","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5AcWNf","author":{"login":"coen-hyde"},"authorAssociation":"NONE","body":"> The idea would be that the synth output (including assets) then doesn't need to be committed.\r\n> If that isn't possible, then I think an option to disable automatic options could be a good compromise.\r\n\r\nI don't think this is possible with the VCS workflow in Terraform Cloud. As far as i know you can't run a pre-processing script to do something like this. \r\n\r\n> I'm interested to hear more about why you think this way. Ideally the barrier is actually lower (at least for developers).\r\n\r\n`cdktf` is a layer of abstraction on top of Terraform but it is a rather transparent layer. To write `cdktf` you need to know how Terraform functions and how to code. That is two knowledge dependencies. Where as Terraform is only one. In an environment where we are trying to encourage people to use Infrastructure as Code instead of console clicking, reducing the barrier to entry is important.","createdAt":"2022-03-28T21:30:53Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1644#issuecomment-1081172831","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5znhBE","author":{"login":"joey-squid"},"authorAssociation":"CONTRIBUTOR","body":"Reviving this ancient issue to comment that this would be particularly helpful for module developers. Normally when changing the internals of a module you don't need to rerun `terraform init`, but (as it stands) you do need to run `cdktf get`.","createdAt":"2024-02-12T22:49:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1644#issuecomment-1939738692","viewerDidAuthor":false}],"createdAt":"2022-03-23T21:05:00Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjE3NjIyNTkw","name":"modules","description":"","color":"2ffc8f"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":1644,"title":"Option to disable creation of assets for local modules","updatedAt":"2024-02-12T22:49:19Z"},{"assignees":[{"id":"MDQ6VXNlcjU3MzUzMQ==","login":"mutahhir","name":"Mutahhir Hayat","databaseId":0}],"author":{"id":"MDQ6VXNlcjM4Njg3NTQ=","is_bot":false,"login":"jsteinich","name":"Jon Steinich"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n0.9.0. Any language.\r\n\r\n### Affected Resource(s)\r\n\r\nAttempting to use `.fqn` on any resource when appending to it or using in an array (probably other cases as well).\r\nThis mainly comes up when needing to use escape hatches.\r\n\r\n### Expected Behavior\r\n\r\nSynthesized output is valid.\r\n\r\n### Actual Behavior\r\n\r\n- `Expected the start of an expression, but found an invalid expression token`\r\n- jsii.errors.JSIIError: Expected array type, got \"<unresolved-token>\"\r\n- X is object with Y attributes\r\n\r\n### Important Factoids\r\n\r\nSupport for cross stack references caused a change in behavior. Previously `.fqn` actually return just a raw string (string token of string is the input string).\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n- https://discuss.hashicorp.com/t/python-escape-hatching-in-0-9-x/37202\r\n","comments":[{"id":"IC_kwDODd1Amc5GMVzR","author":{"login":"armandosorianopfs"},"authorAssociation":"NONE","body":"I just reached an scenario where `.fqn` is of type string, but it actually resolves into an array of objects, making it impossible to use it as value in any other object.\r\n\r\nJust for the case, this is the scenario:\r\n```\r\nconst webappService = new Service(this, 'k8s-service-webapp', {\r\n  ...\r\n  waitForLoadBalancer: true,\r\n});\r\n\r\nnew DnsRecordSet(this, `webapp-dns-zone-record`, {\r\n  ...\r\n  rrdatas: [(webappService?.status.fqn as any)[0]?.load_balancer?.ingress?.ip], // won't be resolved properly\r\n});\r\n```","createdAt":"2022-07-07T13:45:18Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1641#issuecomment-1177640145","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5GM-4A","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"You would need to take terraform functions in this case. It should look sth like this: `Fn.lookup(Fn.lookup(Fn.lookup(Fn.element(webappService.status.fqn, 0), \"load_balancer\"), \"ingress\"), \"ip\")`","createdAt":"2022-07-07T15:37:13Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1641#issuecomment-1177808384","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5GQX77","author":{"login":"armandosorianopfs"},"authorAssociation":"NONE","body":"@DanielMSchmidt you made my day!! thanks!!\r\n\r\nIf anyone reaches this issue with similar issue note that you need to use `lookup` to resolve object properties and `element` to resolve arrays. For my case, I've reached to this:\r\n```\r\nprivate getIpFromStatusFqn(fqn: string): string {\r\n  const resolvedFqn = Fn.element(fqn as unknown as any[], 0);\r\n  const loadBalancer = Fn.lookup(resolvedFqn, 'load_balancer', []);\r\n  const loadBalancerFirstElement = Fn.element(loadBalancer, 0);\r\n  const ingress = Fn.lookup(loadBalancerFirstElement, 'ingress', []);\r\n  const ingressFirstElement = Fn.element(ingress, 0);\r\n\r\n  return Fn.lookup(ingressFirstElement, 'ip', 'no-ip');\r\n}\r\n```","createdAt":"2022-07-08T08:19:04Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1641#issuecomment-1178697467","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5HsogQ","author":{"login":"paymog"},"authorAssociation":"NONE","body":"I'm running into a similar issue though using `Fn.lookup` and `Fn.element` isn't working well in all cases. Here's code that works well on version `0.8.6` (note the use of `.fqn` in the `addOverride` at the bottom)\r\n\r\n```typescript\r\n    const dataAwsAvailabilityZonesAll =\r\n      new aws.datasources.DataAwsAvailabilityZones(\r\n        this,\r\n        \"allAvailableZones\",\r\n        {}\r\n      );\r\n\r\n    const efs = new aws.efs.EfsFileSystem(this, \"efs-volume\", {\r\n      tags: {\r\n        name: name,\r\n        deployment: \"ipfs\",\r\n      },\r\n    });\r\n\r\n    const efsMountTarget = new aws.efs.EfsMountTarget(\r\n      this,\r\n      \"efs-mount-target\",\r\n      {\r\n        dependsOn: [efs],\r\n        count: 2,\r\n        fileSystemId: efs.id,\r\n        subnetId: \"${aws_subnet.priv_subnet[count.index].id}\",\r\n        securityGroups: config.vpcSecurityGroups.ids,\r\n      }\r\n    );\r\n    efsMountTarget.addOverride(\r\n      \"count\",\r\n      `\\${length(${dataAwsAvailabilityZonesAll.fqn}.names)}`\r\n    );\r\n```\r\n\r\nand here's my attempt at using `Fn.element` and `Fn.lookup` on version `0.12`\r\n\r\n```typescript\r\n    const zoneNames = Fn.lookup(dataAwsAvailabilityZonesAll.fqn, \"names\", undefined)\r\n    efsMountTarget.addOverride(\r\n      \"count\",\r\n      Fn.lengthOf(zoneNames)\r\n    );\r\n```\r\n\r\nbut I still get issues like @armandosorianopfs gets:\r\n\r\n\r\n```\r\n[2022-08-02T09:47:39.574] [ERROR] default - â•·\r\nâ”‚ Error: Invalid character\r\nâ”‚\r\nâ”‚   on cdk.tf.json line 271, in resource.aws_efs_mount_target.mercury-ipfs_efs-mount-target_B5A83491:\r\nâ”‚  271:         \"count\": \"${length(${data.aws_availability_zones.mercury-ipfs_allAvailableZones_45C25C25}.names)}\",\r\nâ”‚\r\nâ”‚ This character is not used within the language.\r\ngoldsky-infra-dev  â•·\r\n                   â”‚ Error: Invalid character\r\n                   â”‚\r\n                   â”‚   on cdk.tf.json line 271, in resource.aws_efs_mount_target.mercury-ipfs_efs-mount-target_B5A83491 (mercury-ipfs/efs-mount-target):\r\n                   â”‚  271:         \"count\": \"${length(${data.aws_availability_zones.mercury-ipfs_allAvailableZones_45C25C25 (mercury-ipfs/allAvailableZones)}.names)}\",\r\n                   â”‚\r\n                   â”‚ This character is not used within the language.\r\n                   â•µ\r\n\r\nâ ‡  Processing\r\n[2022-08-02T09:47:39.592] [ERROR] default - â•·\r\nâ”‚ Error: Invalid expression\r\nâ”‚\r\nâ”‚   on cdk.tf.json line 271, in resource.aws_efs_mount_target.mercury-ipfs_efs-mount-target_B5A83491:\r\nâ”‚  271:         \"count\": \"${length(${data.aws_availability_zones.mercury-ipfs_allAvailableZones_45C25C25}.names)}\",\r\nâ”‚\r\nâ”‚ Expected the start of an expression, but found an invalid expression token.\r\ngoldsky-infra-dev  â•·\r\n                   â”‚ Error: Invalid expression\r\n                   â”‚\r\n                   â”‚   on cdk.tf.json line 271, in resource.aws_efs_mount_target.mercury-ipfs_efs-mount-target_B5A83491 (mercury-ipfs/efs-mount-target):\r\n                   â”‚  271:         \"count\": \"${length(${data.aws_availability_zones.mercury-ipfs_allAvailableZones_45C25C25 (mercury-ipfs/allAvailableZones)}.names)}\",\r\n                   â”‚\r\n                   â”‚ Expected the start of an expression, but found an invalid expression token.\r\n```","createdAt":"2022-08-02T15:52:39Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1641#issuecomment-1202882576","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Koot5","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"@paymog I've been looking into this issue. I was hoping to get some more information, as I couldn't reproduce it exactly.\r\n\r\n### Why is the syntax error happening\r\nFrom what I understand, the root of the problem is this pattern:\r\n\r\n```tf\r\n${length(${data.foo}.names)}\r\n```\r\n\r\nOur token system assumes that we're going to be used within a string and adds interpolation syntax `${}` around the token. However, since you're already wrapping it within a `${}`, that becomes a syntax error in Terraform.\r\n\r\n### The 0.12 example doesn't work\r\n> and here's my attempt at using Fn.element and Fn.lookup on version 0.12\r\n> ```js\r\n>    const zoneNames = Fn.lookup(dataAwsAvailabilityZonesAll.fqn, \"names\", undefined)\r\n>    efsMountTarget.addOverride(\r\n>      \"count\",\r\n>      Fn.lengthOf(zoneNames)\r\n>    );\r\n> ```\r\n\r\nThis shouldn't emit the error you mentioned. I tried it out on my end, and it seems to be working fine on my end.\r\n\r\nIt outputs: \r\n\r\n```tf\r\n\"count\": \"${length(lookup(data.aws_availability_zones.allAvailableZones, \\\"names\\\", []))}\",\r\n```","createdAt":"2022-09-20T10:40:05Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1641#issuecomment-1252166521","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5KrYVP","author":{"login":"paymog"},"authorAssociation":"NONE","body":"Thanks for looking into this @mutahir! I've long since resolved this issue and I don't quite remember how I did it. \r\n\r\nThough, I suspect that the reason I was seeing that error on 0.12 was because 0.12 requires running `tsc` prior to diff/deploy while 0.8 didn't. I didn't realize that until quite a few hours into debugging the upgrade.","createdAt":"2022-09-20T20:38:11Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HOORAY","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1641#issuecomment-1252885839","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5LCMlf","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"While more functionality has been added to reduce the need for using `fqn`, it still doesn't change that `fqn` is less useable to users in the cases that it would still be ideal to use it.","createdAt":"2022-09-27T02:01:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1641#issuecomment-1258867039","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5LFDzv","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"Ah, I didn't fully understand the core of the issue but went on from the last error message. My bad. Thanks for reopening @jsteinich, I'll take another look soon.\r\n\r\nTo clarify: The main issue is the inability to use `.fqn` within the interpolated section of a string. The token system's expectation that the resource fqn is being inserted into a non-interpolated terraform string is requiring users to jump through hoops to reference something that previously just required them to just do `resource.fqn`. ","createdAt":"2022-09-27T14:46:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1641#issuecomment-1259617519","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5MYNT4","author":{"login":"M1kep"},"authorAssociation":"NONE","body":"Adding another example I'm currently running into while trying to setup a conditional expression, with variables in this case:\r\nIf there's a better way I should be doing this please let me know.\r\n\r\nGoal:\r\n```\r\nvariable \"a_var\" {\r\n    type = bool\r\n}\r\n\r\nvariable \"b_var\" {}\r\n\r\noutput \"test\" {\r\n    value = \"${var.a_var ? var.b_var : null}\"\r\n}\r\n```\r\n\r\nAttempt:\r\n```python\r\nclass MyStack(TerraformStack):\r\n    def __init__(self, scope: Construct, ns: str):\r\n        super().__init__(scope, ns)\r\n\r\n        a_var = TerraformVariable(self, \"a_var\")\r\n        b_var = TerraformVariable(self, \"b_var\")\r\n\r\n        TerraformOutput(self,\r\n                        \"test\",\r\n                        value=\"${\" + f\"{a_var.fqn} ? {b_var.fqn} : null\" + \"}\"\r\n        )\r\n```\r\n\r\nGenerates:\r\n```json\r\n...\r\n  \"output\": {\r\n    \"test\": {\r\n      \"value\": \"${${var.a_var} ? ${var.b_var} : null\"\r\n    }\r\n  },\r\n...\r\n```\r\nWorkaround I'm currently using:\r\n```python\r\n        TerraformOutput(self,\r\n                        \"test\",\r\n                        value=\"${\" + f\"var.{a_var.node.id} ? var.{b_var.node.id} : null\" + \"}\"\r\n        )\r\n```","createdAt":"2022-10-17T20:03:15Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1641#issuecomment-1281414392","viewerDidAuthor":false}],"createdAt":"2022-03-22T21:46:57Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"}],"milestone":null,"number":1641,"title":"Resource FQN tokens aren't resolved in a user friendly way","updatedAt":"2023-06-01T16:17:26Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n\n<!--- Thank you for keeping this note for the community --->\n\n### Description\n\n<!--- Please leave a helpful description of the feature request here. --->\n\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\n\nThis insight might help us understand what usage is more common and if we can remove a flag that is not used\n\n### References\n\n<!---\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\n\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\n--->\n","comments":[],"createdAt":"2022-03-22T15:39:14Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjA1MTMzMjIz","name":"feature/telemetry","description":"","color":"2A3D32"}],"milestone":null,"number":1639,"title":"Telemetry: track CLI flags being used","updatedAt":"2022-03-29T08:58:53Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM2NTc4MTQ2","is_bot":false,"login":"bLuka","name":"Luka"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nTo give some context, I have some experience with Terraform, and can easily find my way out, but it is more complicated with the CDK as some details are language specific, and others are CDK specific.\r\n\r\nIt's the first time I'm playing around with Terraform modules, and I'm having a hard time understanding how it works, especially using `TerraformHclModule`. I haven't found any other documentation apart from [a short introduction](https://www.terraform.io/cdktf/concepts/modules#create-modules) which does not describe how it works, or what the parameters mean.\r\n\r\nTo make it more beginner friendly, would it make sense to enhance the docs by providing fully functional examples of Terraform modules using `TerraformHclModule` for example, and add more details over the options you should feed it?\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n\r\nI may have missed some, but exact match searches from `TerraformHclModule` gave very few web results.","comments":[{"id":"IC_kwDODd1Amc5ABhtg","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @bLuka ğŸ‘‹\r\n\r\nThat is a nice idea! You are right, the example in the docs you linked, assumes familiarity with the AWS VPC module â€“ we could definitely improve this by extending them to explain what is passed and why. And we could of course also add an example using the `TerraformHclModule` construct (and link it in the docs).\r\n\r\nDo you have further ideas / questions we might need to answer to improve our docs with?","createdAt":"2022-03-21T16:44:48Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1631#issuecomment-1074142048","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5ADYzT","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"`TerraformHclModule` isn't really meant to be used by the average user. Typically module bindings would be generated following the instructions a bit earlier on that docs page. The generated bindings have properties that match the variables and outputs of the module. `TerraformHclModule` is meant as a fallback if that generation fails for any reason. It's basically using a Terraform module directly and relying on the user to lookup the relevant pieces.","createdAt":"2022-03-22T02:04:38Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1631#issuecomment-1074629843","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5AEhud","author":{"login":"bLuka"},"authorAssociation":"NONE","body":"Hello!\r\n\r\n> `TerraformHclModule` is meant as a fallback if that generation fails for any reason\r\n\r\n@jsteinich From my understanding, you highlight it's better to have language (let's say Typescript or Python) specific bindings rather than using `TerraformHclModule`. This is used to generate native Terraform modules instead of using the CDK to do so, is that right?\r\n\r\nEDIT: In fact, is `TerraformHclModule` a way to *create* new modules or a way to *consume* the modules? I first was looking for a way to create and publish modules, before thinking of consuming them.\r\n\r\n> Do you have further ideas / questions we might need to answer to improve our docs with?\r\n\r\n@ansgarm After those discussions, I realize few things are still obscure to me:\r\n- From building to publishing a new Terraform module (the documentation already covers how to consume them)\r\n- Why is the doc referring to `terraform-aws-modules/vpc/aws`? I thing AWS VPCs have native Terraform resources/data sources; what are the benefits of the VPC module compared to the Terraform resource? How is it different?","createdAt":"2022-03-22T09:27:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1631#issuecomment-1074928541","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5AFdME","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Ah, got it!\r\n\r\nThe `TerraformHclModule` is not creating a new module but offered to consume existing HCL modules (e.g. from the Terraform Registry). If you want to create an HCL module using CDKTF, you can use the [TFModuleStack](https://github.com/DanielMSchmidt/cdktf-tf-module-stack) construct. We might include something like this into the CDK for Terraform itself at some point in the future.\r\n\r\nHowever, if you plan to consume your modules using CDKTF, creating custom [constructs](https://www.terraform.io/cdktf/concepts/constructs) is the recommended way.\r\nWe could definitely improve the docs of `TerraformHclModule` to make that more clear.\r\n\r\nThe [`terraform-aws-modules/vpc/aws`](https://registry.terraform.io/modules/terraform-aws-modules/vpc/aws/latest) module is a reusable building block that uses e.g. an AWS VPC Terraform resource under the hood. It creates multiple resources and connects them in the right way (supplying lots of sane defaults along the way). The benefit is that you don't have to do all of that on your own as in practice there are lots of resources required to setup an AWS VPC to be ready to use.","createdAt":"2022-03-22T13:20:35Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1631#issuecomment-1075172100","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5VaoM8","author":{"login":"xiehan"},"authorAssociation":"MEMBER","body":"I believe a lot of this should be addressed now by the construct authoring docs introduced in #2084 (especially [this page](https://developer.hashicorp.com/terraform/cdktf/develop-custom-constructs/publishing-and-distribution)) but from the sound of it it may still be worth adding a short paragraph below the docs for `TerraformHclModule` talking about what that is/isn't intended to be used for and then pointing to our other docs about Constructs. It may be worth tackling this at the same time as other documentation tasks related to modules, like #2072 and #956.","createdAt":"2023-02-16T12:52:48Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1631#issuecomment-1433043772","viewerDidAuthor":false}],"createdAt":"2022-03-21T00:11:23Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyMjE3NjIyNTkw","name":"modules","description":"","color":"2ffc8f"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"}],"milestone":null,"number":1631,"title":"Make TerraformHclModule more beginner friendly â€” Request for docs","updatedAt":"2023-06-28T18:29:06Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjQ0MjM1OQ==","is_bot":false,"login":"iridian-ks","name":"iridian"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nThe Kubernetes backend in Terraform: https://www.terraform.io/language/settings/backends/kubernetes\r\nSeems to be missing from Terraform CDK: https://www.terraform.io/cdktf/concepts/remote-backends#supported-backends \r\n\r\nIt looks like CDK is generating a JSON file for backends, which I tried creating manually like so:\r\n\r\n_remote.tf.json_\r\n```\r\n{\r\n    \"terraform\": {\r\n        \"backend\": {\r\n            \"kubernetes\": {\r\n            }\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nThen in the Pod setting `KUBE_IN_CLUSTER_CONFIG` and `KUBE_NAMESPACE` env vars and running `cdktf deploy` does not initialize the backend and uses local state.","comments":[{"id":"IC_kwDODd1Amc5ABa62","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @iridian-ks ğŸ‘‹\r\nIf no backend construct is used, the CDKTF will default to using local state (and thereby render a local backend in the generated `cdk.tf.json`). That one probably overrides the one you are manually setting separately.\r\n\r\nYou can instead try to use an override on your Stack instance: https://www.terraform.io/cdktf/concepts/providers-and-resources#escape-hatch\r\n\r\nHowever, we should add the kubernetes backend to the ones we support.","createdAt":"2022-03-21T16:22:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1628#issuecomment-1074114230","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5ACQlq","author":{"login":"iridian-ks"},"authorAssociation":"NONE","body":"Tentatively, it looks like I'm getting this:\r\n\r\n```\r\n  \"terraform\": {\r\n    \"backend\": {\r\n      \"kubernetes\": {\r\n      },\r\n      \"local\": {\r\n        \"path\": \".../cdk/terraform.gloo.tfstate\"\r\n      }\r\n    }\r\n  }\r\n```\r\n\r\nNot sure if that's the intended behavior.\r\n\r\nBut it's resulting in:\r\n\r\n```\r\n[2022-03-21T19:34:03.007] [ERROR] default - â•·\r\nâ”‚ Error: Duplicate backend configuration\r\nâ”‚\r\nâ”‚   on cdk.tf.json line 38, in terraform.backend:\r\nâ”‚   38:       \"local\": {\r\nâ”‚\r\nâ”‚ A module may have only one backend configuration. The backend was\r\nâ”‚ previously configured at cdk.tf.json:36,21-22.\r\nâ•µ\r\n\r\n\r\nâ•·\r\nâ”‚ Error: Duplicate backend configuration\r\nâ”‚\r\nâ”‚   on cdk.tf.json line 38, in terraform.backend:\r\nâ”‚   38:       \"local\": {\r\nâ”‚\r\nâ”‚ A module may have only one backend configuration. The backend was\r\nâ”‚ previously configured at cdk.tf.json:36,21-22.\r\n```","createdAt":"2022-03-21T19:32:44Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1628#issuecomment-1074334058","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5ACRz5","author":{"login":"iridian-ks"},"authorAssociation":"NONE","body":"Sorry for the spam, but looks like this is better:\r\n\r\n```\r\n        self.add_override(\"terraform.backend.kubernetes\", {})\r\n        self.add_override(\"terraform.backend.local\", None)\r\n```","createdAt":"2022-03-21T19:38:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1628#issuecomment-1074339065","viewerDidAuthor":false}],"createdAt":"2022-03-19T00:58:32Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzky","name":"good first issue","description":"Good for newcomers","color":"7057ff"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2MjkzOTA4","name":"core-parity","description":"Better experience in Terraform Core than CDKTF","color":"1A80B6"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":1628,"title":"Support kubernetes backend","updatedAt":"2023-06-01T16:18:27Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nWe currently generate empty interfaces which we could skip. See for example:\r\n\r\nhttps://github.com/hashicorp/terraform-cdk/blob/880bb91aed2034ed94cdab01a97771d10dcc83f5/packages/%40cdktf/provider-generator/lib/get/__tests__/generator/__snapshots__/complex-computed-types.test.ts.snap#L52-L62\r\n\r\nWe should skip them in generation.\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n* https://github.com/hashicorp/terraform-cdk/pull/1499#discussion_r821286723\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5AITUE","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"There are cases where an empty interface is required; basically it needs to be for an attribute that is assignable at the level above.","createdAt":"2022-03-23T05:05:55Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1626#issuecomment-1075918084","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5AJW83","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Ah, thanks for researching! Should we close this then? Or can we properly determine when this is the case and when not?","createdAt":"2022-03-23T10:19:37Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1626#issuecomment-1076195127","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5AMbWl","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> Ah, thanks for researching! Should we close this then? Or can we properly determine when this is the case and when not?\r\n\r\nI think we should still try to fix since cutting down unused code should make things slightly faster. I think we'll just need to pass a bit more information to a struct during resource parsing.","createdAt":"2022-03-24T02:19:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1626#issuecomment-1076999589","viewerDidAuthor":false}],"createdAt":"2022-03-17T10:02:51Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2MjAxMTE5","name":"provider get / generation","description":"","color":"CC3938"}],"milestone":null,"number":1626,"title":"Skip generating empty interfaces for provider bindings","updatedAt":"2023-09-29T12:53:22Z"},{"assignees":[],"author":{"is_bot":true,"login":"app/"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n```\r\nâ¯ cdktf --version    \r\n0.9.4\r\n\r\nâ¯ java -version\r\njava version \"17.0.2\" 2022-01-18 LTS\r\nJava(TM) SE Runtime Environment (build 17.0.2+8-LTS-86)\r\nJava HotSpot(TM) 64-Bit Server VM (build 17.0.2+8-LTS-86, mixed mode, sharing\r\n```\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\n### Affected Resource(s)\r\n\r\nOn cdktf get with a cdktf.json using a terraformModule terraform-google-modules/iam/google jsii compilation failed \r\n\r\n<!--- Please list the affected resources. --->\r\n\r\n### Debug Output\r\nhttps://gist.github.com/alex-unikorny/be465d015447301fa3421d93d2370f85\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\n\r\n### Expected Behavior\r\n\r\nmodule available to import on Java code\r\n<!--- What should have happened? --->\r\n\r\n### Actual Behavior\r\n\r\ncdkft get download failed\r\n<!--- What actually happened? --->\r\n\r\n### Proposal Behavior\r\n\r\nWould be more easy for users if modules could manage as Maven dependency instead to do cdktf get\r\n\r\n### Steps to Reproduce\r\n\r\nUse this cdktf.json\r\nhttps://gist.github.com/alex-unikorny/a5f6a2f59c434ae8d11327d3942964d0\r\nAnd execute `cdktf get` from root dir.\r\n\r\n<!--- Please list the steps required to reproduce the issue. --->\r\n\r\n### Important Factoids\r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n","comments":[{"id":"IC_kwDODd1Amc4_lXSD","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"`terraform-google-modules/iam/google` is module with no root configuration. As such, nothing is generated. You can specify the submodules within it and those will generate. For example: `terraform-google-modules/iam/google//modules/projects_iam`.\r\n\r\nSeveral providers are available as Maven dependencies, but at this point no modules are. Feel free to upvote #195.\r\nYou can also publish to your own private Maven repo.","createdAt":"2022-03-14T13:03:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1620#issuecomment-1066759299","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc4_lqMh","author":{"login":""},"authorAssociation":"NONE","body":"Thanks for your time!, I`ve change the configuration with your suggestion, and now is working, maybe the registry documentation could be show how configure a specific module within the CDKTF tool, like Provision Instructions example.","createdAt":"2022-03-14T14:06:56Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1620#issuecomment-1066836769","viewerDidAuthor":false}],"createdAt":"2022-03-13T12:01:17Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyMjE3NjIyNTkw","name":"modules","description":"","color":"2ffc8f"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":1620,"title":"cdktf get - jsii compilation failed - using terraform-google-modules/iam/google","updatedAt":"2023-02-16T13:50:57Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nWhen writing constructs that \r\n\r\n- may only be created once per scope\r\n- interact with other constructs\r\n- Aspects need to filter this type\r\n\r\nOne needs to use a bit of boilerplate to implement `MyType.isMyType(s: Construct)`, `MyType.findChildrenOfMyType(s: Construct)`, `MyType.findParentOfMyType(s: Scope)`. Exposing a common API might make this easier to write for folks who do not know this mechanism. An API could look like this:\r\n\r\n\r\n```ts\r\nimport { TypedConstruct } from \"cdktf\";\r\n\r\nconst MyConstructType = new TypedConstruct(\"an_optional_name\");\r\n\r\nclass MyConstruct from Construct {\r\n  constructor(scope: Construct, name: string) {\r\n    super(scope, name);\r\n\r\n    MyConstructType.markAsType(this);\r\n\r\n  }\r\n}\r\n\r\nconst allOfMyConstructs = MyConstructType.findAllChildren(app);\r\nconst parentOfMyConstruct = MyConstructType.findParent(someInnerConstructScope);\r\nMyConstructType.isOfType(someOtherConstruct)\r\n```\r\n\r\n\r\nAll of these examples have the same problem: identify sth as xyz, find xyz parent, findAll xyz children. I was wondering if that is sth we can solve centrally \r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n\r\n- https://github.com/hashicorp/terraform-cdk/blob/909ed779d143bbfd5cf77e1aa2cb7c6af027d1d4/packages/cdktf/lib/app.ts#L87-L109\r\n- https://github.com/hashicorp/terraform-cdk/blob/909ed779d143bbfd5cf77e1aa2cb7c6af027d1d4/packages/cdktf/lib/terraform-stack.ts#L55-L121\r\n- https://github.com/DanielMSchmidt/cdktf-multi-stack-tfe/blob/main/src/index.ts#L126-L138\r\n","comments":[{"id":"IC_kwDODd1Amc4_VKBl","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"I know jsii doesn't support it, but the `findAll` function in `TerraformStack` is more what I'd want to use. Having to mark a type seems very clunky given when you generally already have typed objects.","createdAt":"2022-03-09T03:10:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1616#issuecomment-1062510693","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc4_mbFT","author":{"login":"Chriscbr"},"authorAssociation":"NONE","body":"I was thinking about some similar issues while trying to migrate another framework to constructs ([projen](https://github.com/projen/projen)), so I'm curious to see how you approach the problem. ğŸ™‚ \r\n\r\nOne challenge I had was figuring out the best way to provide the APIs you mention, like \"findAllChildren\" or \"findParent\" or \"isXxx\" (the naming is open ended), and if there's any way to keep things DRY. I encountered some friction because if I try implementing these on some class hierarchy, then static methods will start conflicting due to this JSII issue: https://github.com/aws/jsii/issues/3410\r\n\r\nOne idea I had was to code-gen some utility classes, for example:\r\n\r\n```ts\r\nimport { Construct, IConstruct } from \"constructs\";\r\nimport type { GitHub as GitHubType } from \"./github\";\r\n\r\nexport const GITHUB_SYMBOL = Symbol.for(\"projen.GitHub\");\r\n// needs to be defined as a property on the actual GitHub class as well\r\n\r\nexport namespace Types {\r\n  export class GitHub {\r\n    public static is(x: any): x is GitHubType {\r\n      return x !== null && typeof x === \"object\" && GITHUB_SYMBOL in x;\r\n    }\r\n\r\n    public static of(c: IConstruct): GitHubType {\r\n      if (this.is(c)) {\r\n        return c;\r\n      }\r\n\r\n      const parent = c.node.scope as Construct;\r\n      if (!parent) {\r\n        throw new Error(\"cannot find a parent GitHub (directly or indirectly)\");\r\n      }\r\n\r\n      return this.of(parent);\r\n    }\r\n\r\n    public static findAll(c: IConstruct): GitHubType[] {\r\n      return c.node.findAll().filter(this.is);\r\n    }\r\n  }\r\n\r\n  export class GitLab { }\r\n  export class Foo { }\r\n  ...\r\n}\r\n```\r\n\r\nI was also trying to figure out how to communicate that a particular type of construct is supposed to be a singleton, and where that logic should be enforced or validated (if at all).","createdAt":"2022-03-14T16:33:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1616#issuecomment-1067037011","viewerDidAuthor":false}],"createdAt":"2022-03-08T12:52:35Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjk5ODU0MzY0","name":"abstractions (level 2 / level 3)","description":"","color":"279ebc"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":1616,"title":"Expose API to identify / find constructs in tree","updatedAt":"2022-03-29T09:01:29Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nThere are [multiple high quality tutorials on HashiCorp Learn](https://learn.hashicorp.com/tutorials/terraform/cdktf) that give users a great introduction into CDK for Terraform. It would be nice to add some kind of automated testing which confirms that those tutorials work after we released a new version of the CDK for Terraform. This way we could notice if tutorials need updated code, for example after we introduced breaking changes. I wouldn't block our release on those tests but rather invoke them after a new version has been released.\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5dyTYl","author":{"login":"xiehan"},"authorAssociation":"MEMBER","body":"This would be hard for us to do because the tutorials don't have a single source of truth in an easily-testable git repo. We've talked to the Education team about this but the number of technical hurdles we'd have to run through don't make it worthwhile for us to tackle this anytime soon.","createdAt":"2023-06-02T09:56:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1575#issuecomment-1573467685","viewerDidAuthor":false}],"createdAt":"2022-02-18T11:42:46Z","labels":[{"id":"MDU6TGFiZWwyNTcwMTY0OTY5","name":"testing","description":"","color":"456cc6"},{"id":"MDU6TGFiZWwyOTY3ODY2NzMy","name":"documentation/learn-tutorials","description":"","color":"29D75B"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMTU1MzExNDc0","name":"dev-process","description":"Improvements to how CDK for Terraform is developed and built","color":"F6A4ED"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"}],"milestone":null,"number":1575,"title":"Automated testing for CDKTF Learn Tutorials","updatedAt":"2023-06-02T09:56:18Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjMzODYzNTU0","is_bot":false,"login":"ex-nihil","name":"Daniel"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\ncom.hashicorp:cdktf:0.9.0\r\n\"aws@~> 3.0\"\r\nOpenJDK Runtime Environment (build 1.8.0_312-b10)\r\n\r\n### Affected Resource(s)\r\n\r\nhttps://www.terraform.io/docs/providers/aws/r/memorydb_cluster\r\nhttps://www.terraform.io/docs/providers/aws/r/db_instance\r\n\r\n### Debug Output\r\n\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\n\r\n### Expected Behavior\r\n\r\n`db.port` should synthesize to Terraform reference instead of number:\r\n```\r\n\"value\": \"${aws_memorydb_cluster.cluster_9AC9C0F1.cluster_endpoint.0.port}\"\r\n```\r\n\r\nThis workaround can achieve the above:\r\n```\r\ndb.getStringAttribute(\"port\")\r\n```\r\n\r\n### Actual Behavior\r\n\r\n`db.port` synthesizes to:\r\n```\r\n\"value\": \"-8.109562212591454E298\"\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\nI assume this happens for any provider when trying to synth number types.\r\n\r\n### Important Factoids\r\n\r\nThis seems to be a regression as I found #679 that was supposedly fixed in 0.6.0.\r\n\r\n### References\r\n\r\n- #0000\r\n","comments":[{"id":"IC_kwDODd1Amc49PuRE","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"I just did a simple test in typescript and everything was working correctly. I wouldn't expect any issues in Java, but perhaps some more details on the code involved would shed some light.\r\n\r\nIt looks like you are using the 0.9.0 version of the cdktf library; are you also using version 0.9.0 of the cli?\r\nAre you just passing the port directly from the cluster to the db instance, or is there something else happening?","createdAt":"2022-02-02T03:06:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1528#issuecomment-1027531844","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc49kNq7","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Could you provide a snippet of your code as an example so that we can reproduce it?","createdAt":"2022-02-08T17:59:44Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1528#issuecomment-1032903355","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5KOCLV","author":{"login":"teodoradra"},"authorAssociation":"NONE","body":"Not really sure if this is relevant or even related to this issue but when searching this was the closest we could find.\r\n\r\ncom.hashicorp:cdktf:0.12.0\r\n\"akamai/akamai@~> 2.1.1\"\r\nOpenJDK 64-Bit Server VM Corretto-17.0.3.6.1 (build 17.0.3+6-LTS)\r\n\r\nWe actually had this issue with the Java version. We are trying to create a Akamai cpCode and use its generated id in a later stage.\r\nThe cpCodeId is a string of pattern `\"cpc_123456\"` and we need to extract the number part as an actual numeric value.\r\n\r\nWe can use the `Fn.trimprefix` function to get the string representation of the cpCodeId (so `\"cpc_123456\"` becomes `\"123456\"`) but when trying to parse it to a number we always get the same value `-8.109562212591454E298`. That actually happens with *any* number we try to parse.\r\n\r\n```java\r\nvar shouldBeNumber1 = Fn.parseint(\"123456\", 10); // becomes -8.109562212591454E298\r\n \r\nvar shouldBeNumber2 = Fn.tonumber(\"123456\");     // becomes -8.109562212591454E298\r\n\r\nvar shouldBeNumber3 = Fn.parseint(Fn.trimprefix(relevant-TfToken, \"cpc_\"), 10); // becomes -8.109562212591454E298\r\n\r\nvar shouldBeNumber4 = Fn.tonumber(Fn.trimprefix(relevant-TfToken, \"cpc_\"));     // becomes -8.109562212591454E298\r\n```","createdAt":"2022-09-13T10:09:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1528#issuecomment-1245192917","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5KOMK5","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"@teodoradra This is expected. Terraform functions return a token value (this extremely bug negative number). They are translated to `${parseint(\"123456\", 10)}` in the terraform JSON and then run at execution time.\r\n\r\nYou can read more about [Tokens here](https://www.terraform.io/cdktf/concepts/tokens).","createdAt":"2022-09-13T10:47:59Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1528#issuecomment-1245233849","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5KOeOd","author":{"login":"teodoradra"},"authorAssociation":"NONE","body":"@DanielMSchmidt thank you for your quick response! \r\n\r\nBut the thing that we keep seeing it that, after planning and running the changes we still have the exact same value if we try to convert the string to a number. If we leave it as a string (which we anyway trim using `trimprefix` and that works just fine) we can see the actual value in Terraform Cloud as it should be (meaning, the actual value not the negative float), so we are encountering a problem only when trying convert the string to number (using `Fn.tonumber` or `Fn.parseint`). And on our provider side we see the exact same thing (negative number) after running and applying the plan.  This is what we get on the Terraform Cloud side when we try to convert the string that we trimmed (using functions as well) to a number:\r\n```\r\nid : -8.109562212591383e+298\r\n```\r\nand this is what we get when we just trim it and don't convert to a number: \r\n```\r\nid : \"1376863\"\r\n```\r\nSo what is unclear to me is why when I use `Fn.trimprefix(code.getId(), \"cpc_\")` I get the right value, and if I use `Fn.parseInt(\"1376863\",10)` I get that negative number on the Terraform Cloud side. If I got it wrong, please let me know, I will revisit this problem that we have. Thank you!","createdAt":"2022-09-13T11:56:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1528#issuecomment-1245307805","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5KUVlt","author":{"login":"marceloaguiarr"},"authorAssociation":"NONE","body":"Hello, I am a teammate of Teodora and there are some things that are still a bit unclear to me.\r\n\r\nIt seems to me that the problem is that we have to provide a String representation of the `rules` but that is a complex object that we are creating as POJOs and then serialising (with either jackson or gson, I tried both).\r\n\r\nI created this simplified code snippet to illustrate the situation\r\n\r\n```java\r\n  public record TestingThing(Number id, String someOtherProperty) {}\r\n  \r\n  final var testingThing = new TestingThing(\r\n        Fn.tonumber(Fn.trimprefix(\"cpc_123456\", \"cpc_\")),\r\n        Fn.trimprefix(\"cpc_123456\", \"cpc_\"));\r\n\r\n  PropertyBuilder()\r\n  \t...\r\n        .count(Fn.tonumber(Fn.trimprefix(\"cpc_123456\", \"cpc_\"))) // expects a Number\r\n        .rules(new Gson().toJson(testingThing)) // expects a String\r\n        ...\r\n        .build();\r\n```\r\n\r\nAfter runnig synth on that this is the output.\r\n\r\n```json\r\n\t{\r\n\t  ...\r\n          \"count\": \"${tonumber(trimprefix(\\\"cpc_123456\\\", \\\"cpc_\\\"))}\",\r\n\t  \"rules\": \"{\\\"id\\\":-8.109562212591386E298,\\\"someOtherProperty\\\":\\\"${trimprefix(\\\"cpc_123456\\\", \\\"cpc_\\\")}\\\"}\"\r\n\t  ...\r\n\t}\r\n```\r\n\r\nAnd that value of `id` is never converted to the proper terraform token. The most weird thing to me is that the `trimprefix` worked as expected, even after serialising the object and running the synth, but the `tonumber` show two different behaviours.","createdAt":"2022-09-14T14:24:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1528#issuecomment-1246845293","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5KVH_0","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"It would be great if you could build a small example so we can debug this further. I am not sure what exactly happens here on the not-cdktf side that could influence the result, but it could also be a cdktf problem directly. I see you put the tokens into a class and serialize it out of that. If e.g. a number to string conversion appears outside of the cdktf context it can be that the token value itself is destroyed, e.g.  by an accidental rounding","createdAt":"2022-09-14T16:57:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1528#issuecomment-1247051764","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5KZFRx","author":{"login":"marceloaguiarr"},"authorAssociation":"NONE","body":"Hello. I have created [this repo](https://github.com/marceloaguiarr/cdktf-java-serialization) to show the error happening. Hope that makes things more clear.\r\n\r\nAll you have to do is clone, then run the test class. It should print the synthesized string with the error.\r\nAs you said, this really looks like a rounding error when the serialisation of the java class into json happens.","createdAt":"2022-09-15T13:17:14Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1528#issuecomment-1248089201","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5KdaK9","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Hey folks, sorry for taking so long, but I have found the problem.\r\n\r\nDuring synth your program transforms the number to a sting with Gson. After that CDKTF runs through all the numbers it knows of and translates them to terraform expressions if applicable. But your number is not a number anymore, it's a string now so we dont catch it. To solve this issue right now you can use `Fn.jsonencode(testingResource)` and it works.\r\n\r\nThe bigger question here is, can we make your current example work. I think we possibly can try to find things that look like numbers in all strings and see if they are known to us. For that we would need to check if a tokenized number can collide with another tokenized number if serialized to string. If we are sure this can not happen we can then search through every string for something that looks like a serialized number and replace this with the TF expression needed. The serialization format could vary between languages though, JS uses `e+` instead of `E` like Java for example. It could also be a custom serialization engine being used. So I guess it's hard to get right all the time, but getting it right most of the time and never getting it wrong would be sufficient I think ","createdAt":"2022-09-16T10:56:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1528#issuecomment-1249223357","viewerDidAuthor":false}],"createdAt":"2022-01-31T21:02:06Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"MDU6TGFiZWwzMjM2NDcwNTQ1","name":"feature/tokens","description":"","color":"58CF13"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":1528,"title":"Number attributes not synthed as references","updatedAt":"2023-06-01T17:31:22Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjY5MzA3MDU=","is_bot":false,"login":"marengaz","name":"Ben Marengo"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\npython\r\ncdk 0.8.6\r\n\r\n### Affected Resource(s)\r\n\r\nprovider\r\n\r\n\r\n### Steps to Reproduce\r\n\r\nmain.py\r\n```py\r\nfrom constructs import Construct\r\nfrom cdktf import App, TerraformStack, TerraformVariable\r\nfrom imports.google import (\r\n    BigqueryDataset,\r\n    GoogleProvider,\r\n)\r\n\r\n\r\nclass MyStack(TerraformStack):\r\n    def __init__(self, scope: Construct, ns: str):\r\n        super().__init__(scope, ns)\r\n        google = GoogleProvider(self, \"google\")\r\n\r\n        ds = BigqueryDataset(\r\n            self,\r\n            \"test_ds\",\r\n            provider=google,\r\n            project=\"my-project\",\r\n            dataset_id=\"test_ds\",\r\n            location=\"EU\",\r\n        )\r\n\r\ndef main():\r\n    app = App()\r\n    MyStack(app, \"my_stack\")\r\n    app.synth()\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    main()\r\n```\r\n\r\nsynthesised cdk.tf.json\r\n```json\r\n{\r\n  ...\r\n  \"provider\": {\r\n    \"google\": [\r\n      {}\r\n    ]\r\n  },\r\n  ...\r\n}\r\n```\r\n\r\ncalling cdk.tf.json as a module from another tf instance\r\n```hcl\r\nmodule \"MyStackModule\" {\r\n  source = \"path/to/cdktf.out/stacks/my_stack\"\r\n}\r\n```\r\n\r\n### Actual Behavior\r\n\r\ncalling the synthesised cdk.tf.json as a module from another terraform instance cases the following warning to be raised\r\n\r\n```\r\nâ•·\r\nâ”‚ Warning: Empty provider configuration blocks are not required\r\nâ”‚ \r\nâ”‚   on .terraform/modules/MyStackModule/my_stack/cdk.tf.json line 22, in provider:\r\nâ”‚   22:     \"google\": [\r\nâ”‚ \r\nâ”‚ Remove the google provider block from module.MyStackModule.\r\nâ•µ\r\n```\r\n\r\n\r\nremoving `google = GoogleProvider(self, \"google\")` from the cdk main.py raises the following error:\r\n```\r\njsii.errors.JSIIError: Validation failed with the following errors:\r\n  [dataset] Found resources without a matching provider. Please make sure to add the following providers to your stack: google\r\n```\r\n\r\n### Expected Behavior\r\n\r\neither:\r\n- dont show the warning when calling the synthesised cdk.tf.json as a module\r\n- dont require a provider in main.py\r\n\r\n### Important Factoids\r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n- #0000\r\n","comments":[{"id":"IC_kwDODd1Amc48_hrh","author":{"login":"marengaz"},"authorAssociation":"NONE","body":"on a similar note cdk 0.9.0 introduces another warning, because it defaults the backend to be the directory where the synth took place\r\n\r\n```json\r\n{\r\n  ...\r\n \"terraform\": {\r\n    \"backend\": {\r\n      \"local\": {\r\n        \"path\": \"path/to/terraform.batch_ingest.tfstate\"\r\n      }\r\n    },\r\n    ...\r\n  },\r\n  ...\r\n}\r\n```\r\n\r\n```\r\nâ•·\r\nâ”‚ Warning: Backend configuration ignored\r\nâ”‚ \r\nâ”‚   on .terraform/modules/MyStackModule/my_stack/cdk.tf.json line 1915, in terraform.backend:\r\nâ”‚ 1915:       \"local\": {\r\nâ”‚ \r\nâ”‚ Any selected backend applies to the entire configuration, so Terraform expects provider configurations only in the root module.\r\nâ”‚ \r\nâ”‚ This is a warning rather than an error because it's sometimes convenient to temporarily call a root module as a child module for testing purposes, but this backend configuration block will have no effect.\r\nâ•µ\r\n```","createdAt":"2022-01-27T14:47:10Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1518#issuecomment-1023285985","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc49BmMK","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"The provider block needing to exist is mentioned [here](https://github.com/hashicorp/terraform-cdk/issues/465#issuecomment-754916608).\r\nMore specifically defining providers causes them to appear in both `required_providers` and `provider` within the output. The latter could potentially be omitted if empty, but doing some might obscure errors if configuration is required.\r\nCould also potentially infer providers from resources and automatically add to `required_providers`.\r\nI worry about having too much hidden behavior with those options. Perhaps an explicit flag on the provider to omit would be better.\r\n\r\nThe backend warning is a result of https://github.com/hashicorp/terraform-cdk/pull/1461.\r\n\r\nPerhaps we could allow the user to specify at the stack level that the output is intended to be used as a module and have that make any tweaks to synthesizing to make that work better.","createdAt":"2022-01-28T02:32:41Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1518#issuecomment-1023828746","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc49Zk5I","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> Perhaps we could allow the user to specify at the stack level that the output is intended to be used as a module and have that make any tweaks to synthesizing to make that work better.\r\n\r\nThis would really have to be on a provider basis, since you might have other providers which are dedicated to that module. What would this special synth mode do then?\r\n\r\n> Could also potentially infer providers from resources and automatically add to `required_providers`.\r\n\r\nThis would be a lot of magic and I think user config might be required more often than not (don't have hard data on this though).","createdAt":"2022-02-04T15:53:22Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1518#issuecomment-1030114888","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Pyh27","author":{"login":"github-actions"},"authorAssociation":"CONTRIBUTOR","body":"Hi there! ğŸ‘‹ We haven't heard from you in 30 days and would like to know if the problem has been resolved or if you still need help. If we don't hear from you before then, I'll auto-close this issue in 30 days.","createdAt":"2022-12-06T02:36:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1518#issuecomment-1338645947","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5P0gyl","author":{"login":"marengaz"},"authorAssociation":"NONE","body":"unresolved","createdAt":"2022-12-06T11:14:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1518#issuecomment-1339165861","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6C6R3z","author":{"login":"shinebayar-g"},"authorAssociation":"NONE","body":"We need this so bad to make cdktf + terraform hcl usage possible in our terraform workspaces.\r\nWriting terraform modules in CDKTF and using that in our existing TFE repositories is the most common use case.\r\n\r\nCan't https://github.com/cdktf/cdktf-tf-module-stack integrated into cdktf itself? Currently HCL output is broken in this package.","createdAt":"2024-06-28T07:31:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1518#issuecomment-2196315635","viewerDidAuthor":false}],"createdAt":"2022-01-27T13:04:19Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"LA_kwDODd1Amc7iaeox","name":"feature/cdktf-as-module-source","description":"When CDKTF is used to build Terraform Modules used in plain Terraform","color":"C31CA3"}],"milestone":null,"number":1518,"title":"Empty provider configuration blocks are not required warning when using generated json as a module","updatedAt":"2024-06-28T07:31:49Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjU1MDM2NDE=","is_bot":false,"login":"gbisaga","name":"Gary Bisaga"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\ncdktf 0.8.6\r\nterraform v1.1.3\r\non windows_amd64\r\nnodejs v16.13.1\r\nNote: I tested both directly under windows command prompt and under WSL, and I get the same results in both cases.\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\n### Affected Resource(s)\r\n\r\n<!--- Please list the affected resources. --->\r\nPublicIp is what I tested, but I expect all will be affected\r\n\r\n### Debug Output\r\nN/A (problem in unit testing, it didn't generate a debug log file)\r\n\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\n\r\n### Expected Behavior\r\n\r\n<!--- What should have happened? --->\r\nThere are actually two problems here. I'm including them in the same issue because we think there's a good chance they have the same cause. The actual cdktf code deploys just fine; the problem is only in unit testing.\r\n\r\nThere are two kinds of test cases failing. We think they may be related.\r\n\r\n```\r\n    import { PublicIp } from \"../.gen/providers/azurerm/public-ip\";\r\n    it (\"is TEST CASE #1\", () => {\r\n      expect(\r\n        Testing.synthScope((scope) => {\r\n          new AppGatewayStack(scope, QA_PARAMS);   // AppGatewayStack does create a PublicIp\r\n        })\r\n      ).toHaveResource(PublicIp);\r\n    })\r\n\r\n    it (\"is TEST CASE #2\", () => {\r\n      const app = new App();\r\n      const stack = new AppGatewayStack(app, QA_PARAMS);\r\n      expect(Testing.fullSynth(stack)).toMatchSnapshot();\r\n    })\r\n````\r\n\r\nExpected behavior: Both tests should have passed.\r\n\r\n### Actual Behavior\r\n\r\n<!--- What actually happened? --->\r\nTEST CASE #1 actual behavior: It fails with the error\r\n```\r\n FAIL  __tests__/main-test.ts (12.786 s)\r\n  My CDKTF Application\r\n    Test the public IP\r\n      Ã— should have a public IP (59 ms)\r\n\r\n  â— My CDKTF Application â€º Test the public IP â€º should have a public IP\r\n\r\n    Type resource not found in stack\r\n\r\n      58 |           // }\r\n      59 |         })\r\n    > 60 |       ).toHaveResource(PublicIp);\r\n         |         ^\r\n      61 |     })\r\n      62 |   });\r\n      63 |   // // All Unit testst test the synthesised terraform code, it does not create real-world resources\r\n\r\n      at getAssertElementWithProperties (node_modules/cdktf/lib/testing/matchers.ts:108:13)\r\n      at toHaveResourceWithProperties (node_modules/cdktf/lib/testing/matchers.ts:186:64)\r\n      at Object.toHaveResource (node_modules/cdktf/lib/testing/adapters/jest.ts:72:65)\r\n      at __EXTERNAL_MATCHER_TRAP__ (node_modules/expect/build/index.js:386:30)\r\n      at Object.throwingMatcher [as toHaveResource] (node_modules/expect/build/index.js:387:15)\r\n      at Object.<anonymous> (__tests__/main-test.ts:60:9)\r\n```\r\n\r\nTEST CASE #2 actual behavior: The first time you run it, it passes and generates a snapshot file (though, see below). The second time and after, it fails with the error below.\r\n```\r\n      âœ• should not change the snapshot (24 ms)\r\n\r\n  â— AppGateway CDKTF Application â€º Test the public IP â€º should not change the snapshot\r\n\r\n    expect(received).toMatchSnapshot()\r\n\r\n    Snapshot name: `AppGateway CDKTF Application Test the public IP should not change the snapshot 1`\r\n\r\n    Snapshot: \"/tmp/cdktf.outdir.sMGHRL\"\r\n    Received: \"/tmp/cdktf.outdir.fElhCW\"\r\n```\r\n\r\nThis second error actually makes sense in a way, because the snapshot file generated seems to be wrong. Rather than a representation of the stack resources, the `__snapshots__/main-test.ts.snap` file looks like this:\r\n\r\n```\r\n   // Jest Snapshot v1, https://goo.gl/fbAQLP\r\n\r\n   exports[`AppGateway CDKTF Application Test the public IP should not change the snapshot 1`] = `\"/tmp/cdktf.outdir.sMGHRL\"`;\r\n```\r\n\r\nThe JSON with actual stack resources IS being generated under that location.\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Please list the steps required to reproduce the issue. --->\r\nInstall dependencies and run `npm run test`\r\n\r\n### Important Factoids\r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n- #0000\r\n","comments":[{"id":"IC_kwDODd1Amc49EdFI","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"I tried to reproduce this, on OSX it seems to work, can you check if this production case fails as well for you? \r\nhttps://github.com/DanielMSchmidt/cdktf-issue-1506","createdAt":"2022-01-28T19:42:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1506#issuecomment-1024577864","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc49EksE","author":{"login":"gbisaga"},"authorAssociation":"NONE","body":"Huh, it does work - I can run `npm run test` on that repo, and it works under windows. There's something weird going on here. One thing I did in your test is I changed the snapshot test to be a \"normal\" one:\r\n\r\n```\r\n    expect(\r\n      Testing.synthScope((scope) => {\r\n        new MyConstruct(scope, \"myConstruct\");\r\n      })\r\n    ).toMatchSnapshot();\r\n```\r\n\r\nNot only did this work, but the snapshot it generated looks correct. There's something weird going on with mine. I note that I include a number of other resources, as well as an Azure provider and S3 backend construct. I'll try to get it down to the minimum difference.","createdAt":"2022-01-28T20:23:15Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1506#issuecomment-1024609028","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc49E8-o","author":{"login":"gbisaga"},"authorAssociation":"NONE","body":"So I figured out what was wrong - sort of. At least, I figured out how to make it work, by comparing against your example. Problem was, when I was calling\r\n\r\n```\r\n        Testing.synthScope((scope) => {\r\n          new AppGatewayStack(scope, QA_PARAMS);   // AppGatewayStack does create a PublicIp\r\n        })\r\n```\r\n\r\n`AppGatewayStack` is defined as: \r\n\r\n```\r\nexport class AppGatewayStack extends TerraformStack {\r\n  constructor(scope: Construct, params: Parameters) { // , options: AppGatewayStackOptions\r\n    super(scope, params.stackName);\r\n    // etc.\r\n  }\r\n}\r\n```\r\n\r\nBut you had it synthing a subclass of Construct, not TerraformStack. Now, given that TerraformStack extends Construct, I would expect that to work, also. But it doesn't. I instead modified it to:\r\n\r\n```\r\n        Testing.synthScope((scope) => {\r\n          new AppGatewayConstruct(scope, QA_PARAMS);\r\n        })\r\n...\r\nexport class AppGatewayConstruct extends Construct {\r\n  constructor(scope: Construct, params: Parameters) { // , options: AppGatewayStackOptions\r\n    super(scope, `${params.stackName}-construct`);\r\n    // etc.\r\n   }\r\n}\r\n```\r\n\r\nand now everything works!","createdAt":"2022-01-28T22:35:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1506#issuecomment-1024708520","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc49I_hC","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"`Testing.synthScope` internally creates a new stack. I don't believe there's been any testing done on nested stacks, so I'm not surprised that they don't work correctly. We could either make sure nested stacks work properly (probably best in the long term) or make `Testing.synthScope` more obvious that a stack can't be passed (probably fails with an `App` as well).\r\n\r\nYour second test case comes down to `Testing.fullSynth` just always returns a temporary directory. Looks like the intent was to chain it with other functions (such as `toBeValidTerraform`. At a minimum there is some more documentation needed there. Should probably consider renaming the function as well.","createdAt":"2022-01-31T14:00:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1506#issuecomment-1025767490","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Hmg73","author":{"login":"getflex-stephen"},"authorAssociation":"NONE","body":"> `Testing.synthScope` internally creates a new stack. I don't believe there's been any testing done on nested stacks, so I'm not surprised that they don't work correctly. We could either make sure nested stacks work properly (probably best in the long term) or make `Testing.synthScope` more obvious that a stack can't be passed (probably fails with an `App` as well).\r\n\r\nI don't think the immediate issue is best solved by making nested stacks work. Because the thing that's in the way here is the fact that `Testing.synthScore` creates a new stack regardless. I'm pretty sure the common case is going to be testing whether a Stack has specific resources, rather than a Construct.","createdAt":"2022-08-01T14:26:30Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1506#issuecomment-1201278711","viewerDidAuthor":false}],"createdAt":"2022-01-24T23:37:30Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjE4NTU2NzE0","name":"windows","description":"","color":"839ad1"},{"id":"MDU6TGFiZWwyNTcwMTY0OTY5","name":"testing","description":"","color":"456cc6"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"MDU6TGFiZWwzMzYxMTMzNzQ3","name":"feature/snapshot-test","description":"Snapshot testing + assertion related issues","color":"006b75"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":1506,"title":"Unit testing failing to find resources for azurerm provider","updatedAt":"2023-06-01T14:33:04Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM4Njg3NTQ=","is_bot":false,"login":"jsteinich","name":"Jon Steinich"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nCurrently some more advanced data types aren't correctly handled when generating providers/modules. For example `list<list<string>>` is treated as just `list<string>` and `map<list<string>>` is treated as `list<map<string>>`.\r\n\r\nIdeally `AttributeTypeModel`, and perhaps some parts of `AttributeModel` and `AttributesEmitter`, get refactored to better support arbitrary types and to generally be easier to use. We've been talking about it for awhile now and it almost seems like a necessity to support these cases.\r\n\r\n### References\r\n\r\n#1299 \r\n","comments":[],"createdAt":"2022-01-21T03:20:49Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2MjAxMTE5","name":"provider get / generation","description":"","color":"CC3938"}],"milestone":null,"number":1501,"title":"Support nested collections and other ","updatedAt":"2023-06-01T16:38:36Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM4Njg3NTQ=","is_bot":false,"login":"jsteinich","name":"Jon Steinich"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\nThe return type for single item complex objects is a class that is different than the interface used to configure. This means that you can't pass from one resource to another of the same type. (It does work in Typescript / Python since the complex type matches the interface).\r\n\r\nThere are a couple options for solving this:\r\n\r\n1. Make the property setting support a union of the interface and complex type.\r\n2. Make the complex type implement the interface.\r\n3. Provide a method on the complex type to get as the interface.\r\n\r\nThe first option adds conceptually overhead in some languages and completely destroys the visible type in others.\r\nThe second option isn't directly possible (classes can't implement \"struct\" interfaces in jsii). Could potentially do with functional interfaces that both interface and class implement (haven't verified).\r\nThe third option could be challenging to track the reference or perhaps break at the jsii boundary (depending on exact implementation).\r\n\r\nThis is likely not a high priority. I noticed the issue while trying to get all of the edge provider tests working.\r\n\r\n### References\r\n\r\n#1299 \r\n","comments":[],"createdAt":"2022-01-21T03:12:13Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMTM2MjAxMTE5","name":"provider get / generation","description":"","color":"CC3938"}],"milestone":null,"number":1500,"title":"Allow passing OutputReference types to the same property of another resource","updatedAt":"2023-07-13T15:45:10Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjQxNjg0OQ==","is_bot":false,"login":"robin-norwood","name":"Robin Norwood"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n```\r\n$ cdktf --version\r\n0.8.6\r\n$ terraform -version\r\nTerraform v1.1.3\r\non darwin_amd64\r\n$ dotnet --version\r\n6.0.101\r\n$ dotnet --list-sdks\r\n3.1.416 [/usr/local/share/dotnet/sdk]\r\n6.0.101 [/usr/local/share/dotnet/sdk]\r\n```\r\n\r\n### Affected Resource(s)\r\n\r\nAWS resources? Maybe others.\r\n\r\n### Debug Output\r\n\r\nhttps://gist.github.com/robin-norwood/a0a64fd2aebd6d70f8911e5f91d34b01\r\n\r\n### Expected Behavior\r\n\r\nSynth runs without warning messages.\r\n\r\n### Actual Behavior\r\n\r\nAn excessive number of warnings.\r\n\r\n```\r\n$ cdktf deploy\r\nWarning NETSDK1174: The abbreviation of -p for --project is deprecated. Please use --project.\r\n\r\n/Users/rnorwood/code/learn-cdktf/.gen/aws/aws/Accessanalyzer/AccessanalyzerAnalyzer.cs(14,127): warning CS1573: Parameter 'config' has no matching param tag in the XML comment for 'AccessanalyzerAnalyzer.AccessanalyzerAnalyzer(Construct, string, IAccessanalyzerAnalyzerConfig)' (but other parameters do) [/Users/rnorwood/code/learn-cdktf/.gen/aws/aws.csproj]\r\n\r\n/Users/rnorwood/code/learn-cdktf/.gen/aws/aws/AccountAlternateContact.cs(14,114): warning CS1573: Parameter 'config' has no matching param tag in the XML comment for 'AccountAlternateContact.AccountAlternateContact(Construct, string, IAccountAlternateContactConfig)' (but other parameters do) [/Users/rnorwood/code/learn-cdktf/.gen/aws/aws.csproj]\r\n/Users/rnorwood/code/learn-cdktf/.gen/aws/aws/Acm/AcmCertificate.cs(14,101): warning CS1573: Parameter 'config' has no matching param tag in the XML comment for 'AcmCertificate.AcmCertificate(Construct, string, IAcmCertificateConfig?)' (but other parameters do) [/Users/rnorwood/code/learn-cdktf/.gen/aws/aws.csproj]\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n## Create project\r\n\r\n```sh\r\n$ mkdir learn-cdktf\r\n$ cd learn-cdktf\r\n$ cdktf init --template=\"csharp\"\r\n```\r\n\r\n## Add AWS provider\r\n\r\nEdit `cdktf.json`:\r\n\r\n```json\r\n{\r\n    \"language\": \"csharp\",\r\n    \"app\": \"dotnet run -p MyTerraformStack.csproj\",\r\n    \"projectId\": \"904ae1c4-a12f-43bc-a47e-fa6f77321d77\",\r\n    \"terraformProviders\": [\r\n      \"hashicorp/aws@~> 3.67.0\"\r\n    ],\r\n    \"terraformModules\": [],\r\n    \"context\": {\r\n        \"excludeStackIdFromLogicalIds\": \"true\",\r\n\"allowSepCharsInLogicalIds\": \"true\"\r\n    }\r\n}\r\n```\r\n\r\n```\r\n$ cdktf get\r\n$ dotnet add reference .gen/aws/aws.csproj\r\n```\r\n\r\nAny reasonable example code should reproduce, I used:\r\n\r\n```csharp\r\nusing System;\r\nusing Constructs;\r\nusing HashiCorp.Cdktf;\r\n\r\nusing aws;\r\nusing aws.Ec2;\r\n\r\nnamespace MyCompany.MyApp\r\n{\r\n    class MyApp : TerraformStack\r\n    {\r\n        public MyApp(Construct scope, string id) : base(scope, id)\r\n        {\r\n            new AwsProvider(this, \"AWS\", new AwsProviderConfig\r\n            {\r\n                Region = \"us-west-1\"\r\n            });\r\n\r\n            Instance instance = new Instance(this, \"compute\", new InstanceConfig\r\n            {\r\n                Ami = \"ami-01456a894f71116f2\",\r\n                InstanceType = \"t2.micro\",\r\n            });\r\n\r\n            new TerraformOutput(this, \"public_ip\", new TerraformOutputConfig\r\n            {\r\n                Value = instance.PublicIp\r\n            });\r\n        }\r\n\r\n        public static void Main(string[] args)\r\n        {\r\n            App app = new App();\r\n            new MyApp(app, \"aws_instance\");\r\n\r\n            app.Synth();\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nDeploy:\r\n\r\n```\r\n$ cdktf deploy\r\n```\r\n\r\nThe warnings show up here, and I believe with `cdktf synth`. The deploy succeeds, and subsequent commands don't show the warning.\r\n\r\n### Important Factoids\r\n\r\nReproduced on MacOS 10.14.6. .net and other tools installed via brew.\r\n\r\n### References\r\n\r\n","comments":[],"createdAt":"2022-01-12T23:00:40Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM1OTYzMTU0","name":"language/c#","description":"C# language issues","color":"c5def5"}],"milestone":null,"number":1479,"title":"Warnings the first time synthesizing C# projects: \"Parameter 'config' has no matching param tag...\"","updatedAt":"2022-02-08T13:51:48Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nOur documentation is currently spare on details how to access data from modules (HCLModules or generated ones), improving this would help the UX greatly\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n\r\n- https://github.com/hashicorp/terraform-cdk/issues/956 \r\n- https://github.com/hashicorp/terraform-cdk/issues/1340\r\n","comments":[{"id":"IC_kwDODd1Amc5VagEE","author":{"login":"xiehan"},"authorAssociation":"MEMBER","body":"Relates to #2072 - might make sense to tackle both at the same time.","createdAt":"2023-02-16T12:25:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1443#issuecomment-1433010436","viewerDidAuthor":false}],"createdAt":"2022-01-03T09:04:42Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":1443,"title":"Document data access for modules","updatedAt":"2023-06-28T18:26:54Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nIn regards to https://github.com/hashicorp/terraform-cdk/issues/1312 we want to make our docs more clear about why `synth` is called `synth` and not `compile`, `transpile` or similar.  \r\nIt should also be clear what happens when running `synth` (For example it _can_ involve compilation [i.e. when using Java] and executing the compilation result or may only involve executing the stack code [i.e. when using Python]).\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n* https://github.com/hashicorp/terraform-cdk/issues/1312\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5VbBFA","author":{"login":"xiehan"},"authorAssociation":"MEMBER","body":"May be worth tackling at the same time as #798 and #674 (and perhaps even #2109)","createdAt":"2023-02-16T14:08:55Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1406#issuecomment-1433145664","viewerDidAuthor":false}],"createdAt":"2021-12-10T10:00:52Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":1406,"title":"Docs: Add note about `synth` being common term in CDK ecosystem","updatedAt":"2023-06-28T18:29:15Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n---\r\nAdd a testcase to the Edge Provider tests (introduced in https://github.com/hashicorp/terraform-cdk/pull/1311) that tests mutations of Terraform resource arguments (aka inputs). For example test the `put*` methods (if they are available already), the `reset*` methods, and assigning values to properties.","comments":[],"createdAt":"2021-11-26T16:51:40Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyNTcwMTY0OTY5","name":"testing","description":"","color":"456cc6"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"}],"milestone":null,"number":1357,"title":"Edge Provider Test: Test mutations of resource arguments","updatedAt":"2023-06-01T16:46:02Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n---\r\nAdd a testcase to the Edge Provider tests (introduced in https://github.com/hashicorp/terraform-cdk/pull/1311) that tests the behaviour of passing an entire resource into a TerraformOutput. Terraform seems to support this, so we might want to do so too.","comments":[],"createdAt":"2021-11-26T16:49:41Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyNTcwMTY0OTY5","name":"testing","description":"","color":"456cc6"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"}],"milestone":null,"number":1356,"title":"Edge Provider Test: Test passing an entire resource to a Terraform Output","updatedAt":"2022-07-05T08:31:12Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\n\n### Community Note\n\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\n\n<!--- Thank you for keeping this note for the community --->\n\n### Description\n\n<!--- Please leave a helpful description of the feature request here. --->\n\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\n\n```ts\nimport { Construct } from \"constructs\";\nimport { App, TerraformStack } from \"cdktf\";\nimport { RandomProvider } from \"./.gen/providers/random\";\n\nclass MyStack extends TerraformStack {\n  constructor(scope: Construct, name: string) {\n    super(scope, name);\n\n    // define resources here\n    new RandomProvider(this, \"1\", {});\n    new RandomProvider(this, \"2\", {});\n  }\n}\n\nconst app = new App();\nnew MyStack(app, \"test-tf-provider-cfg\");\napp.synth();\n```\n\nResults in a successful synth, we don't warn that an alias needs to be set so users get this error on plan:\n\n```\n A default (non-aliased) provider configuration for \"random\" was already\nâ”‚ given at cdk.tf.json:18,15-16. If multiple configurations are required, set\nâ”‚ the \"alias\" argument for alternative configurations.\n```\n\n### References\n\n<!---\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\n\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\n--->\n","comments":[],"createdAt":"2021-11-24T14:25:40Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":1349,"title":"synth should fail if a second provider of the same type has no alias","updatedAt":"2021-12-02T09:59:03Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjMwMDgzNA==","is_bot":false,"login":"remyleone","name":"RÃ©my LÃ©one"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nCould you either:\r\n\r\n- Rename the help in help.txt if you don't want to add formatting text\r\n- Rename the help in README.md and add markdown formating.\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc46DI5d","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"What benefit do you see to rename to `help.txt`?","createdAt":"2021-11-19T09:27:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1315#issuecomment-973901405","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc46DJMG","author":{"login":"remyleone"},"authorAssociation":"NONE","body":"On windows, you have support natively with an editor as if you don't have a file extension you have to set it up for yourself. I would suggest to go the README.md way so that it can be directly pushed to a github/gitlab and have a basic readme setup and rendered. ","createdAt":"2021-11-19T09:28:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1315#issuecomment-973902598","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc46JvFK","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"I personally would love to see this in a `README.md` file ğŸ‘\r\nIt currently is also used to be [printed after the project was initialized](https://github.com/hashicorp/terraform-cdk/blob/9225fb5ef569057450b7b7df0bb8148ebc3d72eb/packages/cdktf-cli/templates/typescript/.hooks.sscaff.js#L19), but we could still do that with a `README.md`.","createdAt":"2021-11-22T15:16:11Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1315#issuecomment-975630666","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc48VHQ5","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"This could also have helped with #1478 if it would've included information of steps to run after cloning such a project (to install dependencies, generate provider bindings, etc.).\r\nFor example we should add something along these lines to the TypeScript template:\r\n````md\r\n# project xy\r\nThis is a CDK for Terraform project using TypeScript.\r\n\r\n## Dependencies\r\nYou need Nodejs, TODO and TBD installed.\r\n\r\n## Setup\r\nRun the following commands to install the required dependencies:\r\n```sh\r\nnpm install\r\ncdktf get\r\n```\r\n````","createdAt":"2022-01-13T14:06:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1315#issuecomment-1012167737","viewerDidAuthor":false}],"createdAt":"2021-11-17T15:46:19Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzky","name":"good first issue","description":"Good for newcomers","color":"7057ff"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"},{"id":"LA_kwDODd1Amc7x0kYM","name":"feature/init","description":"cdktf init related features","color":"C1E24A"}],"milestone":null,"number":1315,"title":"Rename the help file when running `cdk init` to markdown and/or have a .txt extension to the help file","updatedAt":"2023-06-02T09:35:50Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjMwMDgzNA==","is_bot":false,"login":"remyleone","name":"RÃ©my LÃ©one"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nI have not found tutorials or guides that explain how I can re-use existing resources and existing state.\r\nI've searched here:\r\n- https://learn.hashicorp.com/tutorials/terraform/cdktf-applications\r\n- https://www.terraform.io/docs/cdktf/index.html\r\n\r\nMaybe using https://www.terraform.io/docs/cdktf/concepts/data-sources.html could be an option but it seems to be quite verbose. Is there an easier way to import an existing resource within the state managed by the CDK?\r\nIf it is the only way, maybe adding a tutorial/guide to focus on this importing workflow could be helpful. Especially if it combines discovered aspects (tags) to apply different treatments (use tags as an input of a function that will apply other tags to the given resource).\r\n","comments":[{"id":"IC_kwDODd1Amc46CQtS","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"Data sources don't actually import the resource into state. They basically function as a lookup into the already provisioned infrastructure.\r\n\r\nActually importing is probably more work as it requires creating code that matches the existing infrastructure and then running `terraform import` for each resource. Definitely room for some improvements to that process.","createdAt":"2021-11-19T02:30:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1313#issuecomment-973671250","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc46JwZL","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"(linking [Support terraform import via the cdk cli #1134](https://github.com/hashicorp/terraform-cdk/issues/1134) for reference)","createdAt":"2021-11-22T15:21:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1313#issuecomment-975636043","viewerDidAuthor":false}],"createdAt":"2021-11-17T15:03:10Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":1313,"title":"Add more documentation about how to work with existing resources (import/alteration)","updatedAt":"2023-06-28T18:27:40Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nIâ€™d like to add a `terraform validate` run after synthesise, this might help users find unexpected problems (probably bugs in our code) and might help us catch issues in the examples. It will be a flag only on synth, e.g. `cdktf synth --validate myStack` and it will execute `terraform init && terraform validate` after the synthesis is done.\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2021-11-16T16:34:10Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM1OTU1Nzk1","name":"ux/debugging","description":"","color":"2703FD"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":1309,"title":"Validate Terraform code on synth","updatedAt":"2021-12-02T10:07:33Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nThere are currently no docstrings on the constructs we have for Terraform backends.\r\n\r\nSee this one for example: https://github.com/hashicorp/terraform-cdk/blob/main/packages/cdktf/lib/backends/s3-backend.ts\r\n\r\nIt should at least include a link to https://www.terraform.io/docs/language/settings/backends/s3.html\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5Cprlg","author":{"login":"aayushharwani-aidash"},"authorAssociation":"CONTRIBUTOR","body":"@ansgarm I am interested in working on this. Can you plz guide ?","createdAt":"2022-05-05T06:39:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1268#issuecomment-1118222688","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5CqEEd","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @aayushharwani-aidash ğŸ‘‹ Wow! That's great!\r\n\r\nI'll use the S3 backend as an example, but feel free to pick your favorite(s) â€“ you also don't have to do all at once to get a PR accepted and merged ğŸ™‚\r\n\r\nOur backends can be found [here](https://github.com/hashicorp/terraform-cdk/tree/main/packages/cdktf/lib/backends) and the docs on them are [here](https://www.terraform.io/language/settings/backends).\r\n\r\nSo let's take the [`S3Backend`](https://github.com/hashicorp/terraform-cdk/blob/main/packages/cdktf/lib/backends/s3-backend.ts) and the [related docs](https://www.terraform.io/language/settings/backends/s3) as an example.\r\n\r\nThe backend has a `S3BackendProps` type that defines the arguments that you can set on the backend:\r\nhttps://github.com/hashicorp/terraform-cdk/blob/537c7da0ffffff0d7b31b840f31fb3c6c57ee531/packages/cdktf/lib/backends/s3-backend.ts#L40-L44\r\n\r\nThe [docs contain descriptions](https://www.terraform.io/language/settings/backends/s3#configuration) for those config keys. For example for the `region` property:\r\n> [region](https://www.terraform.io/language/settings/backends/s3#region) - (Required) AWS Region of the S3 Bucket and DynamoDB Table (if used). This can also be sourced from the AWS_DEFAULT_REGION and AWS_REGION environment variables.\r\n(...)\r\n\r\nA docstring for this property could look like this:\r\n```ts\r\nexport interface S3BackendProps {\r\n  // ...\r\n  \r\n  /**\r\n   * AWS Region of the S3 Bucket and DynamoDB Table (if used). This can also\r\n   * be sourced from the AWS_DEFAULT_REGION and AWS_REGION environment \r\n   * variables.\r\n   */\r\n  readonly region?: string;\r\n  // ...\r\n```\r\n\r\nNote: The docs state that the region is required to be set, but in our code `region` is optional (\"`?`\") because it does not need to be set via the `S3BackendProps` config, but could also be set via an environment variable.\r\n\r\nBesides adding docstrings to the properties, it is also useful to add a general docstring to the S3Backend class itself:\r\nhttps://github.com/hashicorp/terraform-cdk/blob/537c7da0ffffff0d7b31b840f31fb3c6c57ee531/packages/cdktf/lib/backends/s3-backend.ts#L9-L12\r\n\r\nThe introductory section of the backend docs seems to fit quite well. And adding a link to the docs allows the user to access more information if required.\r\n```ts\r\n/**\r\n * Stores the state as a given key in a given bucket on Amazon S3. This backend\r\n * also supports state locking and consistency checking via Dynamo DB, which\r\n * can be enabled by setting the dynamodb_table field to an existing DynamoDB\r\n * table name. A single DynamoDB table can be used to lock multiple remote\r\n * state files. Terraform generates key names that include the values of the\r\n * bucket and key variables.\r\n * \r\n * Warning! It is highly recommended that you enable Bucket Versioning on the\r\n * S3 bucket to allow for state recovery in the case of accidental deletions\r\n * and human error.\r\n * \r\n * Read more about this backend in the Terraform docs:\r\n * https://www.terraform.io/language/settings/backends/s3\r\n */\r\nexport class S3Backend extends TerraformBackend {\r\n  constructor(scope: Construct, private readonly props: S3BackendProps) {\r\n    super(scope, \"backend\", \"s3\");\r\n  }\r\n  // ...\r\n```\r\n\r\nIf there's anything left unclear, feel free to ask! I hope this explains what we had in mind here.","createdAt":"2022-05-05T08:57:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1268#issuecomment-1118322973","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5CunrH","author":{"login":"aayushharwani-aidash"},"authorAssociation":"CONTRIBUTOR","body":"Thanks @ansgarm  , I got your point.","createdAt":"2022-05-06T11:27:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1268#issuecomment-1119517383","viewerDidAuthor":false}],"createdAt":"2021-11-08T09:13:00Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwxNzc1NzEyNzky","name":"good first issue","description":"Good for newcomers","color":"7057ff"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":1268,"title":"API docs: Add docs to Terraform backends","updatedAt":"2023-06-28T18:29:25Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUzOTY4NTg=","is_bot":false,"login":"fmmoret","name":"fmmoret"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\nThere is no mention of `.terraform.lock.hcl` or the security/reproducibility/integrity implications of the lock file that gets auto-created for every stack.\r\n\r\nDocs should inform developers that these files are important, and the docs should guide developers on how to collaborate on  & synchronize these files.\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\nhttps://www.terraform.io/docs/language/dependency-lock.html\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5W4Pi2","author":{"login":"nikowatari"},"authorAssociation":"CONTRIBUTOR","body":"will it be enough if the default `.gitignore` template would be updated to not ignore `.terraform.lock.hcl`?\r\n\r\ne.g. replace this line: https://github.com/hashicorp/terraform-cdk/blob/8da3c359dd0935ba530b6844004501f7ca09a813/packages/cdktf-cli/templates/python/%7B%7B%7D%7D.gitignore#L5\r\n\r\nwith:\r\n```\r\ncdktf.out/*\r\n!cdktf.out/stacks/\r\ncdktf.out/stacks/*\r\n!cdktf.out/stacks/*/\r\ncdktf.out/stacks/*/*\r\n!cdktf.out/stacks/*/.terraform.lock.hcl\r\n```","createdAt":"2023-03-07T05:54:40Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1216#issuecomment-1457584310","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5c38Qo","author":{"login":"fmmoret"},"authorAssociation":"NONE","body":"I had troubles with this. You need to terraform init in the stack folder if you change machines. cdktf doesn't appear to gracefully reuse the lock files if you have a remote backend.","createdAt":"2023-05-22T23:10:41Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1216#issuecomment-1558168616","viewerDidAuthor":false}],"createdAt":"2021-10-27T01:11:52Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"}],"milestone":null,"number":1216,"title":"Docs need (security) guidance around `.terraform.lock.hcl`","updatedAt":"2023-06-28T18:29:36Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjc5NTcxNTIz","is_bot":false,"login":"thomashutcheson-msm","name":"Thomas Hutcheson"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nAdding additional python with google cloud platform resources into the repo. This includes GoogleDataCatalogTaxonomy, FirestoreDocument, GoogleDataCatalogPolicyTag and GoogleDataCatalogPolicyTagIamMember resources. \r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc44ydgH","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @thomashutcheson-msm!\r\nThank you for the suggestion. We're open for PRs that add such an example ğŸ‘","createdAt":"2021-10-27T10:01:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1211#issuecomment-952752135","viewerDidAuthor":false}],"createdAt":"2021-10-25T10:11:22Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzky","name":"good first issue","description":"Good for newcomers","color":"7057ff"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyNzQzNTkyMDA3","name":"examples","description":"","color":"4AB3A0"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":1211,"title":"Additional-python-google-resources-examples","updatedAt":"2023-06-02T09:06:14Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\nPrint Terraform logs when the `expect(â€¦).toPlanSuccessfully()` matcher fails.\r\n\r\n#### Background\r\n\r\nWhen stumbling upon #1082 I had a hard time finding out why the test failed because these logs were swallowed:\r\n```\r\nâ•·\r\nâ”‚ Error: Error pinging Docker server: Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?\r\nâ”‚ \r\nâ”‚   with provider[\"registry.terraform.io/terraform-providers/docker\"],\r\nâ”‚   on cdk.tf.json line 19, in provider.docker[0]:\r\nâ”‚   19:       {}\r\nâ”‚ \r\nâ•µ\r\n```\r\nThey were swallowed because `stdio` is ignored here:\r\nhttps://github.com/hashicorp/terraform-cdk/blob/a5d0380585abee49c9ffbaa7fa6454aa186d07f8/packages/cdktf/lib/testing/matchers.ts#L267-L267\r\n\r\nThis also causes `CDKTF_LOG_LEVEL` not to work, as the stdio from Terraform is ignored.\r\n\r\n### References\r\n\r\n* #1082\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2021-10-05T19:29:43Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMzYxMTMzNzQ3","name":"feature/snapshot-test","description":"Snapshot testing + assertion related issues","color":"006b75"}],"milestone":null,"number":1124,"title":"Test matchers suppress Terraform logs","updatedAt":"2021-10-07T15:20:58Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE0MjU5MTk=","is_bot":false,"login":"nadworny","name":""},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\ncdktf-cli@0.6.3-pre.360\r\nnode:16.10-alpine\r\nDocker version 20.10.8, build 3967b7d\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\n### Affected Resource(s)\r\ncdktf cli\r\n<!--- Please list the affected resources. --->\r\n\r\n### Debug Output\r\nhttps://gist.github.com/nadworny/0d0c567efbbaeeab9e1169bab51811d6\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\n\r\n### Expected Behavior\r\nDocker build fails\r\n<!--- What should have happened? --->\r\n\r\n### Actual Behavior\r\nDocker build runs successfully. \r\n<!--- What actually happened? --->\r\n\r\n### Steps to Reproduce\r\n1. Clone the repo and go to `examples/python/docker`\r\n2. Create a following Dockerfile:\r\n```docker\r\nFROM node:16.10-alpine\r\n\r\nRUN npm install --global cdktf-cli@0.6.3-pre.360\r\n\r\nENV DEFAULT_TERRAFORM_VERSION=1.0.7\r\n\r\n# Install Terraform\r\nRUN apk add --update --no-cache git curl docker-cli unzip python3 python3-dev && \\\r\n    ln -sf python3 /usr/bin/python && python3 -m ensurepip && \\\r\n    rm -r /usr/lib/python*/ensurepip && \\\r\n    pip3 install --upgrade pip setuptools==45 && \\\r\n    if [ ! -e /usr/bin/pip ]; then ln -s pip3 /usr/bin/pip ; fi && \\\r\n    AVAILABLE_TERRAFORM_VERSIONS=\"0.15.0 ${DEFAULT_TERRAFORM_VERSION}\" && \\\r\n    for VERSION in ${AVAILABLE_TERRAFORM_VERSIONS}; do curl -LOk https://releases.hashicorp.com/terraform/${VERSION}/terraform_${VERSION}_linux_amd64.zip && \\\r\n    mkdir -p /usr/local/bin/tf/versions/${VERSION} && \\\r\n    unzip terraform_${VERSION}_linux_amd64.zip -d /usr/local/bin/tf/versions/${VERSION} && \\\r\n    ln -s /usr/local/bin/tf/versions/${VERSION}/terraform /usr/local/bin/terraform${VERSION};rm terraform_${VERSION}_linux_amd64.zip;done && \\\r\n    ln -s /usr/local/bin/tf/versions/${DEFAULT_TERRAFORM_VERSION}/terraform /usr/local/bin/terraform\r\n\r\nWORKDIR /cdktf\r\n\r\n# Prepare tf providers\r\nCOPY cdktf.json .\r\nRUN cdktf get\r\n```\r\n3. Build image `docker build -t cdktf-test -f Dockerfile .`\r\n<!--- Please list the steps required to reproduce the issue. --->\r\n","comments":[{"id":"IC_kwDODd1Amc43oBwh","author":{"login":"LeonidLapshinAquaCloud"},"authorAssociation":"NONE","body":"Have the same error today, last successful run was 3 days ago","createdAt":"2021-10-04T08:00:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1115#issuecomment-933239841","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc43oSNb","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"I think this is a duplicate of #1113. It seems like Ink-Spinners have a broken and unpinned dependency. This is our top priority to fix, @ansgarm is already working on this","createdAt":"2021-10-04T09:27:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1115#issuecomment-933307227","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc43oSvw","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Sorry, I misread the issue, my bad ğŸ™ˆ ","createdAt":"2021-10-04T09:30:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1115#issuecomment-933309424","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc46goxC","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"I wonder if this can be solved by #841 or if this stems from another problem\r\n","createdAt":"2021-11-29T13:27:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1115#issuecomment-981634114","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5fmhgs","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"This is still an issue","createdAt":"2023-06-23T08:37:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1115#issuecomment-1603934252","viewerDidAuthor":false}],"createdAt":"2021-10-04T07:55:35Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":1115,"title":"Error produced by cdktf get is not breaking docker build","updatedAt":"2023-06-23T09:19:22Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUwNzAyMDQ=","is_bot":false,"login":"danieldreier","name":"Daniel Dreier"},"body":"This is a design and planning task to plan the next revision of the `cdktf watch` command. There is a [backlog of potential watch-related improvements](https://github.com/hashicorp/terraform-cdk/issues?q=is%3Aopen+is%3Aissue+label%3Afeature%2Fwatch), and the purpose of this task is to prompt a design exercise to set direction and concretely plan follow-up work to improve that feature.","comments":[],"createdAt":"2021-09-29T20:12:32Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMDEzNzM4ODIw","name":"needs-research","description":"","color":"709F22"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjEzNDkxMzEy","name":"feature/watch","description":"","color":"3068EA"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":1105,"title":"Plan next revision of `cdktf watch` command","updatedAt":"2022-02-01T16:51:34Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUwNzAyMDQ=","is_bot":false,"login":"danieldreier","name":"Daniel Dreier"},"body":"The ability to control CDK for Terraform directly from a programming language has been a frequent request. There are three key issues in the backlog under this scope:\r\n\r\n- https://github.com/hashicorp/terraform-cdk/issues/804\r\n- https://github.com/hashicorp/terraform-cdk/issues/798\r\n- https://github.com/hashicorp/terraform-cdk/issues/237\r\n\r\nAWS CDK also has an [RFC issue](https://github.com/aws/aws-cdk-rfcs/issues/300) open on this topic where users describe many proposed use cases.\r\n\r\nThis is a design ticket. The goal is to design a good user experience, including APIs, for being able to programmatically drive CDK for Terraform, and to plan an implementation of the resulting design in tickets in future release milestones. The scope doesn't necessarily encompass all of the linked tickets - please use judgement and work with product to design an appropriate scope.","comments":[{"id":"IC_kwDODd1Amc5RtsZC","author":{"login":"dudany"},"authorAssociation":"NONE","body":"Hi @danieldreier, There is an estimation of when it will be added to the roadmap?","createdAt":"2023-01-04T13:31:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1104#issuecomment-1370932802","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Rt4kN","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"We are currently exploring this, but it's a little early to make delivery promises. I can put you down so you'll get notified once we have a prototype and enter the feedback gathering phase :) ","createdAt":"2023-01-04T14:15:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}},{"content":"LAUGH","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1104#issuecomment-1370982669","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Rt7lv","author":{"login":"dudany"},"authorAssociation":"NONE","body":"I would be happy to get notified, appreciate it :) \r\nThank you @DanielMSchmidt ","createdAt":"2023-01-04T14:25:17Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1104#issuecomment-1370995055","viewerDidAuthor":false}],"createdAt":"2021-09-29T20:01:53Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMDEzNzM4ODIw","name":"needs-research","description":"","color":"709F22"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjA1MTIxODAz","name":"enhancement/new-workflow","description":"Proposed new workflow","color":"4A1023"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"LA_kwDODd1Amc7q-uL1","name":"feature/programmatic-api","description":"","color":"54AAC9"}],"milestone":null,"number":1104,"title":"Design UX, APIs for procedurally driving CDKTF","updatedAt":"2023-01-04T14:25:26Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUwNzAyMDQ=","is_bot":false,"login":"danieldreier","name":"Daniel Dreier"},"body":"This is a research and design task.\r\n\r\nShowing idiomatic stack traces in all supported languages would significantly improve the CDK for Terraform user experience around debugging, but is a technically challenging project to implement. The purpose of this ticket is to set aside time for design and research into how to build cross-language stack traces. The ticket will be complete when a proposed UX and implementation has been described and ticketed out in a future release.","comments":[],"createdAt":"2021-09-29T19:55:20Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMDEzNzM4ODIw","name":"needs-research","description":"","color":"709F22"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM1OTU1Nzk1","name":"ux/debugging","description":"","color":"2703FD"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"}],"milestone":null,"number":1103,"title":"Design cross-language stack traces","updatedAt":"2022-04-11T15:50:21Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUwNzAyMDQ=","is_bot":false,"login":"danieldreier","name":"Daniel Dreier"},"body":"This is a capacity-planning placeholder issue for the implementation of the work planned in #1093. When that planning task is complete, please remove this issue and replace it with real implementation tickets.\r\n\r\n","comments":[],"createdAt":"2021-09-29T00:22:32Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"},{"id":"LA_kwDODd1Amc7Kmmfc","name":"feature/integration-test","description":"","color":"4F6FA8"},{"id":"LA_kwDODd1Amc7KmqHq","name":"planning/placeholder","description":"capacity-planning placeholder issue","color":"1D435A"}],"milestone":null,"number":1096,"title":"Placeholder: implement integration testing","updatedAt":"2023-06-01T16:46:37Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUwNzAyMDQ=","is_bot":false,"login":"danieldreier","name":"Daniel Dreier"},"body":"This is a research and design task to design and plan a workflow for integration testing of CDK for Terraform applications.  This ticket is a placeholder for the sake of long-term planning, and should be rewritten with more defined scope before work starts.\r\n\r\nThe scope of this issue is to propose an approach to integration testing, ideally aligned with the AWS CDK approach linked below. An internal HashiCorp RFC is needed for this issue before implementation work starts.\r\n\r\nReference Material\r\n* https://github.com/aws/aws-cdk-rfcs/pull/378","comments":[{"id":"IC_kwDODd1Amc443Cah","author":{"login":"marcus-sa"},"authorAssociation":"NONE","body":"Any consideration regarding adding support for something like https://www.terraform.io/docs/language/modules/testing-experiment.html  ?","createdAt":"2021-10-28T15:22:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1093#issuecomment-953951905","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc45iBqf","author":{"login":"JohnCalhoun"},"authorAssociation":"NONE","body":"need this feature and would love to help provider feedback or ideas","createdAt":"2021-11-10T14:05:40Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1093#issuecomment-965221023","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc45iDmZ","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> need this feature and would love to help provider feedback or ideas\r\n\r\nWhich use-cases do you have in mind in particular?","createdAt":"2021-11-10T14:09:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1093#issuecomment-965228953","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc45iEhT","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"@marcus-sa \r\n> Any consideration regarding adding support for something like https://www.terraform.io/docs/language/modules/testing-experiment.html ?\r\n\r\nNo, not so far - but curious to learn how you'd use this in the context of cdktf\r\n\r\n","createdAt":"2021-11-10T14:11:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1093#issuecomment-965232723","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc45iIEA","author":{"login":"marcus-sa"},"authorAssociation":"NONE","body":"> No, not so far - but curious to learn how you'd use this in the context of cdktf\r\n\r\n@skorfmann I've done something like [this](https://gist.github.com/marcus-sa/9df7cdbb1c0383e8f3bb974dc5ced55a) instead. Way easier than I initially thought.\r\n\r\nI might create a repository template for showcasing how one might structure their own project using Terraform CDK.\r\nThere are quite a few workarounds still needed, like explicitly overriding the logical id of `TerraformVariable` for it to be used.","createdAt":"2021-11-10T14:18:01Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1093#issuecomment-965247232","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc45jWR8","author":{"login":"JohnCalhoun"},"authorAssociation":"NONE","body":"yeah the overriding of TerraformVariable is super needed for this. But right now I can test up and including `terraform plan` using to toPlanSuccessfully(), but want i want to do next is actualy launch the stack (from the .test.ts jest file) and then get outputs from the stack and run AWS queries against the stack (like invoke a lambda function and check its return value).\r\n\r\nI built something sort of like this at my previous job but I want to do it this time in a more community supported way, I dont want to base our whole codebase testing on a hack that the community will do better anyways. ","createdAt":"2021-11-10T17:23:34Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1093#issuecomment-965567612","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc45kl0O","author":{"login":"marcus-sa"},"authorAssociation":"NONE","body":"> yeah the overriding of TerraformVariable is super needed for this. But right now I can test up and including `terraform plan` using to toPlanSuccessfully(), but want i want to do next is actualy launch the stack (from the .test.ts jest file) and then get outputs from the stack and run AWS queries against the stack (like invoke a lambda function and check its return value).\r\n> \r\n> I built something sort of like this at my previous job but I want to do it this time in a more community supported way, I dont want to base our whole codebase testing on a hack that the community will do better anyways.\r\n\r\nIf you refer to the [`terraform.ts`](https://gist.github.com/marcus-sa/9df7cdbb1c0383e8f3bb974dc5ced55a#file-terraform-ts) file in the gist I provided, then that can be used to synthesize, initialize and apply a stack, and upon finalizing it'll destroy the stack.\r\n\r\nIdk about AWS, but for GCP there's NodeJS clients for all their services that would allow you to do some end-to-end testing.\r\n\r\nI completely agree that an ideal solution would be community driven and integrated directly into Terraform CDK.\r\n\r\nI also had to do massive amounts of workarounds to be able to fetch the plan of a pull request run in Terraform Cloud.","createdAt":"2021-11-11T00:49:15Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1093#issuecomment-965893390","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6PH2wD","author":{"login":"so0k"},"authorAssociation":"NONE","body":"This CDKTF library leverages all the utility functions of terratest for its integration testing.. it does require a bridge to synth the ts into `tf.json`\r\nhttps://github.com/envtio/base/tree/v0.0.4/integ","createdAt":"2024-10-09T03:34:31Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1093#issuecomment-2401201155","viewerDidAuthor":false}],"createdAt":"2021-09-28T23:56:17Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMDEzNzM4ODIw","name":"needs-research","description":"","color":"709F22"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"},{"id":"LA_kwDODd1Amc7Kmmfc","name":"feature/integration-test","description":"","color":"4F6FA8"}],"milestone":null,"number":1093,"title":"Design CDK for Terraform integration testing","updatedAt":"2024-10-09T03:34:47Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjI5NTA1NjEw","is_bot":false,"login":"saikirangit","name":"Sai Kiran Tagore"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nWe have option to pass in a parameter to pass stack name for deploy but we do not have option for synth.\r\n\r\n**Our Use Case:**\r\nWe run all the terraform code using github actions and use typescript as a language. We have all our sensitive information for Terraform in Github Secrets. During a disaster recovery when we want to spin up new environment we create a keyvault via cdktf, write all the github secrets to keyvault and use those secrets from keyvault to create actual resources in azure.\r\n\r\nProblem we are running into is. When I do a synth, it is running Synth for both stacks and trying to retrieve secrets from non existing key vault. Is there a way we can synth only one stack?\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc43a6BS","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"Thank you for the use case.\r\nThis does go against the principle that the synthesized output always matches the code; however, it doesn't seem to unreasonable to want this. I'm curious what others have to say.","createdAt":"2021-09-29T03:33:49Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1090#issuecomment-929800274","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc45dU2t","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> Problem we are running into is. When I do a synth, it is running Synth for both stacks and trying to retrieve secrets from non existing key vault. Is there a way we can synth only one stack?\r\n\r\n@saikirangit could these two stacks be two separate applications?","createdAt":"2021-11-09T09:55:34Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1090#issuecomment-963988909","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc45f-Fu","author":{"login":"saikirangit"},"authorAssociation":"NONE","body":"@skorfmann That is what we ended up doing but it would be really useful if we can have that prerequisite kind of stack that we can use to setup.\r\n\r\nProbably in future.","createdAt":"2021-11-10T00:56:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1090#issuecomment-964682094","viewerDidAuthor":false}],"createdAt":"2021-09-28T18:46:29Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"}],"milestone":null,"number":1090,"title":"Synth single stack even when we have multiple stacks in the code.","updatedAt":"2021-11-30T16:45:32Z"},{"assignees":[{"id":"MDQ6VXNlcjExMTIwNTY=","login":"ansgarm","name":"Ansgar Mertens","databaseId":0}],"author":{"id":"MDQ6VXNlcjEzNjc4OQ==","is_bot":false,"login":"skorfmann","name":"Sebastian Korfmann"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n- 0.6.x\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\n### Affected Resource(s)\r\n\r\n<!--- Please list the affected resources. --->\r\n- cli autocomplete\r\n\r\n### Debug Output\r\n\r\n```\r\nâœ  /tmp cdktf diffError: Usage Error: /private/tmp is not a cdktf project directory, no cdktf.json found or cdktf.json is missing language / app keys\r\n    at Object.Usage (/Users/sebastian/.nvm/versions/node/v14.17.6/lib/node_modules/cdktf-cli/lib/errors.js:20:21)\r\n    at Object.throwIfNotProjectDirectory (/Users/sebastian/.nvm/versions/node/v14.17.6/lib/node_modules/cdktf-cli/bin/cmds/helper/check-directory.js:38:31)\r\n    at Object.handler (/Users/sebastian/.nvm/versions/node/v14.17.6/lib/node_modules/cdktf-cli/bin/cmds/diff.js:39:27)\r\n    at /Users/sebastian/.nvm/versions/node/v14.17.6/lib/node_modules/cdktf-cli/node_modules/yargs/build/index.cjs:1:9052\r\n    at j (/Users/sebastian/.nvm/versions/node/v14.17.6/lib/node_modules/cdktf-cli/node_modules/yargs/build/index.cjs:1:4931)\r\n    at M.applyMiddlewareAndGetResult (/Users/sebastian/.nvm/versions/node/v14.17.6/lib/node_modules/cdktf-cli/node_modules/yargs/build/index.cjs:1:9021)\r\n    at M.runCommand (/Users/sebastian/.nvm/versions/node/v14.17.6/lib/node_modules/cdktf-cli/node_modules/yargs/build/index.cjs:1:7206)\r\n    at Bt.[runYargsParserAndExecuteCommands] (/Users/sebastian/.nvm/versions/node/v14.17.6/lib/node_modules/cdktf-cli/node_modules/yargs/build/index.cjs:1:54320)\r\n    at Bt.parse (/Users/sebastian/.nvm/versions/node/v14.17.6/lib/node_modules/cdktf-cli/node_modules/yargs/build/index.cjs:1:36968)\r\n    at Bt.get [as argv] (/Users/sebastian/.nvm/versions/node/v14.17.6/lib/node_modules/cdktf-cli/node_modules/yargs/build/index.cjs:1:57661)\r\n(node:8575) UnhandledPromiseRejectionWarning: TypeError: explanatoryComment.replaceAll is not a function\r\n```\r\n\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\n\r\n### Expected Behavior\r\n\r\nDoesn't throw an exception\r\n\r\n<!--- What should have happened? --->\r\n\r\n### Actual Behavior\r\n\r\nit blows up\r\n\r\n<!--- What actually happened? --->\r\n\r\n### Steps to Reproduce\r\n\r\nUse autocomplete for stack dependent commands like `diff`, `deploy` or `destroy` outside of a project or inside a project where no `cdktf.json` file is present.\r\n\r\n<!--- Please list the steps required to reproduce the issue. --->\r\n\r\n### Important Factoids\r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n- #0000\r\n","comments":[{"id":"IC_kwDODd1Amc427tl2","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Do you get the same error if you run a `diff` in that directory?\r\nBut you're right, we might want to not error there but rather show no completions or such.","createdAt":"2021-09-17T08:48:34Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1038#issuecomment-921622902","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc427wHE","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> Do you get the same error if you run a `diff` in that directory?\r\n\r\nHaven't checked, but I'm assuming this would be working then.\r\n\r\n\r\n","createdAt":"2021-09-17T09:03:57Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1038#issuecomment-921633220","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc4273Xv","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Just checked â€“ that also errors:\r\n```\r\ncdktf diff                                                                                                                                                      11:44:06\r\nError: Usage Error: /Users/ansgar is not a cdktf project directory, no cdktf.json found or cdktf.json is missing language / app keys\r\n    at Object.Usage (/Users/ansgar/.config/yarn/global/node_modules/cdktf-cli/lib/errors.js:20:21)\r\n    at Object.throwIfNotProjectDirectory (/Users/ansgar/.config/yarn/global/node_modules/cdktf-cli/bin/cmds/helper/check-directory.js:38:31)\r\n    at Object.handler (/Users/ansgar/.config/yarn/global/node_modules/cdktf-cli/bin/cmds/diff.js:39:27)\r\n    at /Users/ansgar/.config/yarn/global/node_modules/cdktf-cli/node_modules/yargs/build/index.cjs:1:9052\r\n    at j (/Users/ansgar/.config/yarn/global/node_modules/cdktf-cli/node_modules/yargs/build/index.cjs:1:4931)\r\n    at M.applyMiddlewareAndGetResult (/Users/ansgar/.config/yarn/global/node_modules/cdktf-cli/node_modules/yargs/build/index.cjs:1:9021)\r\n    at M.runCommand (/Users/ansgar/.config/yarn/global/node_modules/cdktf-cli/node_modules/yargs/build/index.cjs:1:7206)\r\n    at Bt.[runYargsParserAndExecuteCommands] (/Users/ansgar/.config/yarn/global/node_modules/cdktf-cli/node_modules/yargs/build/index.cjs:1:54320)\r\n    at Bt.parse (/Users/ansgar/.config/yarn/global/node_modules/cdktf-cli/node_modules/yargs/build/index.cjs:1:36968)\r\n    at Bt.get [as argv] (/Users/ansgar/.config/yarn/global/node_modules/cdktf-cli/node_modules/yargs/build/index.cjs:1:57661)\r\n```\r\nwhich is a feature (at least to me). I think it improves a formerly cryptic error message when attempting commands in the wrong directory.","createdAt":"2021-09-17T09:47:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/1038#issuecomment-921662959","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc42__iD","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> which is a feature (at least to me). I think it improves a formerly cryptic error message when attempting commands in the wrong directory.\r\n\r\nI'd get rid of the stack trace there. ","createdAt":"2021-09-20T08:59:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/1038#issuecomment-922744963","viewerDidAuthor":false}],"createdAt":"2021-09-17T08:44:58Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":1038,"title":"cli: autocomplete error handling","updatedAt":"2022-01-25T16:23:00Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nThe [setup-terraform](https://github.com/hashicorp/setup-terraform/) Github Action by default wraps the Terraform CLI in a wrapper which alters its output. This produces different errors, e.g. [get fails](https://github.com/hashicorp/terraform-cdk/issues/1013) and planning / deploying might also fail (haven't checked yet, but as of TF 1.0 we also parse some JSON there).\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n* https://github.com/hashicorp/terraform-cdk/issues/1013\r\n* https://github.com/hashicorp/setup-terraform\r\n\r\n### Workaround (until this is closed)\r\n\r\nDisable the wrapper:\r\n\r\n```yaml\r\n- uses: hashicorp/setup-terraform@v1\r\n  with:\r\n    terraform_version: 0.14\r\n    terraform_wrapper: false # <--\r\n```\r\n\r\n### Related code locations\r\nThe following locations might need to be touched to support the prefixes to the Terraform output on stdout.\r\nFor fixing the `get` command:\r\nhttps://github.com/hashicorp/terraform-cdk/blob/6ff70ce09be46f7354a8bbeb732e7b928a3b158d/packages/cdktf-cli/lib/get/generator/provider-schema.ts#L244-L248\r\nFor parsing the plan:\r\nhttps://github.com/hashicorp/terraform-cdk/blob/6ff70ce09be46f7354a8bbeb732e7b928a3b158d/packages/cdktf-cli/bin/cmds/ui/models/terraform-cli.ts#L56-L61\r\nFor parsing the outputs:\r\nhttps://github.com/hashicorp/terraform-cdk/blob/6ff70ce09be46f7354a8bbeb732e7b928a3b158d/packages/cdktf-cli/bin/cmds/ui/models/terraform-cli.ts#L111-L116\r\n\r\nThe progress updates while deploying / destroying are interpreted line by line. Wrapping this would probably be the easiest way to hook in and remove the prefix from each line:\r\nhttps://github.com/hashicorp/terraform-cdk/blob/6ff70ce09be46f7354a8bbeb732e7b928a3b158d/packages/cdktf-cli/bin/cmds/ui/models/terraform-cli.ts#L83\r\nhttps://github.com/hashicorp/terraform-cdk/blob/6ff70ce09be46f7354a8bbeb732e7b928a3b158d/packages/cdktf-cli/bin/cmds/ui/models/terraform-cli.ts#L93\r\n","comments":[],"createdAt":"2021-09-15T10:15:21Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzky","name":"good first issue","description":"Good for newcomers","color":"7057ff"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"}],"milestone":null,"number":1020,"title":"Support `setup-terraform` action (with the default wrapper)","updatedAt":"2023-06-02T14:20:05Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjUwNzAyMDQ=","is_bot":false,"login":"danieldreier","name":"Daniel Dreier"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\nThe unit testing flow currently relies on Jest's watcher, which means someone wanting to use a watch workflow needs to run `cdktf watch` and also `jest watch`, and `cdktf watch` will do deployments even if tests fail.\r\n\r\nIt's unclear whether this is a problem, so I'm creating this issue as a prompt to remind us to re-evaluate after there is more real-world experience with both workflows. I suspect we want a singular watch workflow, but this may prove otherwise or be prohibitive to implement.\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2021-09-10T21:41:50Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjEzNDkxMzEy","name":"feature/watch","description":"","color":"3068EA"}],"milestone":null,"number":1003,"title":"Evaluate integrating watch and unit testing","updatedAt":"2021-11-30T16:48:04Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nbasically [this example](https://github.com/hashicorp/terraform-cdk/issues/951#issuecomment-913523817) plus a short description.\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n* https://github.com/hashicorp/terraform-cdk/issues/951\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc42iBdY","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"#929 should make it so using the object form isn't required; however, having an example is the docs is still a good thing.","createdAt":"2021-09-08T03:47:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}},{"content":"EYES","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/956#issuecomment-914888536","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Vagpb","author":{"login":"xiehan"},"authorAssociation":"MEMBER","body":"Relates to #2072 - might make sense to tackle both at the same time.","createdAt":"2023-02-16T12:27:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/956#issuecomment-1433012827","viewerDidAuthor":false}],"createdAt":"2021-09-07T09:21:30Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwyMjE3NjIyNTkw","name":"modules","description":"","color":"2ffc8f"},{"id":"MDU6TGFiZWwyMjIzNTI1MzY0","name":"terraform cloud","description":"","color":"4ed354"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTY5NzM3NTc2","name":"enterprise","description":"","color":"40BB81"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":956,"title":"Add specific example for using private Terraform modules to docs","updatedAt":"2023-06-28T18:27:03Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjg3NzUwODk1","is_bot":false,"login":"prashant-eppalpalli","name":""},"body":"Hi @skorfmann \r\n\r\nWe would like to know some best practices to work with the CDKTF project.\r\n\r\nWe have multiple AWS accounts for different environments and we are using Terraform Cloud to store state files.\r\n- We would like to know the strategies around deploying the same set of cdktf code in multiple environments.\r\n\r\n- Also how can we use cdktf projects across multiple team members? How team members can contribute their changes before merging the code into actual branches. Any best practices around that ?\r\n\r\n![CDKTF-Project](https://user-images.githubusercontent.com/87750895/129932149-35d4a882-06e1-4606-ab54-e74397f6cf13.jpg)\r\n\r\n","comments":[{"id":"IC_kwDODd1Amc41yXMP","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"One option is to use a different stack for each environment. The configuration for each stack can point to different AWS accounts and TF workspaces for state storage. I don't believe the auto workspace creation currently supports that, but the workspaces could be created in a different project.\r\n\r\nI personally like Terraform Atlantis for managing the code changes. It doesn't quite work out of the box with cdktf though.\r\nYou could also manage pipelines directly in GitLab, but be careful with current executions.","createdAt":"2021-08-20T03:04:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/918#issuecomment-902394639","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc41zunr","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"@prashant-eppalpalli If you're after a workflow like [this](https://docs.gitlab.com/ee/user/infrastructure/mr_integration.html) you could fallback to use the Terraform CLI. Here's an example Github Actions [workflow](https://github.com/hashicorp/cdktf-repository-manager/blob/main/.github/workflows/diff.yml) which produces output like [this](https://github.com/hashicorp/cdktf-repository-manager/pull/15#issuecomment-899809449). \r\n\r\nOther than that:\r\n\r\n- Are we talking about a single repository which is supposed to drive multiple workspaces / accounts? \r\n- Would they all be deployed in parallel, or are there dependencies between the workspaces? \r\n- Do you have policies and / or tests as part of your pipelines?","createdAt":"2021-08-20T14:55:19Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/918#issuecomment-902752747","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc413QnN","author":{"login":"prashant-eppalpalli"},"authorAssociation":"NONE","body":"Hi @skorfmann \r\n\r\nI will go through the workflow and get back to you on that.\r\n\r\n- Are we talking about a single repository which is supposed to drive multiple workspaces / accounts?\r\n  Currently we are thinking to use single repo with single branch per environment.\r\n  Each environment have its own TF workspace which will point to its own specific branch name. \r\n  Each environment have its own AWS account.\r\n\r\n- Would they all be deployed in parallel, or are there dependencies between the workspaces?\r\nThey will be deployed parallelly. There are no dependencies, however we need to sync our develop and master branch sometimes in future.\r\n\r\n- Do you have policies and / or tests as part of your pipelines?\r\nCurrently we don't have any policies or tests, but we may include those in future.","createdAt":"2021-08-23T11:23:18Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/918#issuecomment-903678413","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc42BxjV","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"@prashant-eppalpalli are the TF workspaces existing already, or would you want them to be created automatically as part of `cdktf deploy`?","createdAt":"2021-08-26T13:53:40Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/918#issuecomment-906434773","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc42C58i","author":{"login":"plaisted"},"authorAssociation":"NONE","body":"I've recently set up something similar, would be interested to see how others did this. We do continuous delivery rather than deployment:\r\n* We manage each environment with it's own stack / backend. Each application has an interface for the environment specific config which gets passed into the stack constructor.\r\n* On pull requests all apps / environments get synth'd. TF Plans are then run and posted back to the PR.\r\n* On completion of a PR, the build synth's all of the apps / environments into the different cdk.tf.json's. We create a build artifact for each stack that includes the cdk.tf.json file, a .terraform.lock.hcl file, and some metadata (in our case what AWS account each stack is associated with, what role to assume before planning / applying). The metadata is automatically created by a custom base stack we extend for our CDK stacks.\r\n* We then release versions on demand to any environment, this uses 'normal' terraform (no CDK) which is a simple plan -> review -> apply workflow. There is some higher level release automation to track deployments from lesser environments to prod and automate things like blue / green deployments (eg. deploy prod-blue stack and validate, then flip traffic) but all infrastructure changes flow through from the CDK / terraform changes.\r\n\r\nHaven't been using very long but so far been pretty happy with it.","createdAt":"2021-08-26T20:46:21Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/918#issuecomment-906731298","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc42DDsO","author":{"login":"rrrix"},"authorAssociation":"NONE","body":"I don't use the CDKTF \"stacks\" paradigm, and opted for something... different :) \r\n\r\nI  abstract out CDKTF as the \"compiler\", and choose to directly use the terraform CLI to manage my workspaces, run `plan`, `apply`, `destroy`, etc.\r\n\r\nI have 3 environment types (dev, stg, prod) running 2 unique applications (app1, app2) on a shared code base (both sharing majority of their code in a \"Common\" library), using TypeScript, Lerna (monorepo), yarn, and other related TypeScript ecosystem tooling (which is very rich, flexible, popular and well-defined). These are full-stack Production Enterprise (internal) Applications running in AWS (ALB's, AutoScaling, Docker, the works).\r\n\r\nThis model lets me use general node.js/TypeScript to program, customize and control anything related to my environment, build targets, deployment mechanisms, testing, etc. I think of the \"cdktf.tf.json\" as a \"dumb\" build artifact. The generated `cdktf.tf.json` files are disposable, as they are regenerated and replaced every time I do a build - however I do commit them to version control, so that I could always \"terraform apply\" back to a pre-existing state if I need to (except for my database obviously).    \r\n\r\nRoughly:\r\n```\r\ncdktf-project\r\n| -- packages/common/\r\n| -- packages/app1/\r\n| -- packages/app2/\r\n| -- packer/<packerfiles>\r\n\\ -- docker/{app1,app2}/<dockerfiles>\r\n```\r\n\r\nWhere `app1` and `app2` import from `common`, and both use customized golden AMI's and docker images.\r\n\r\nI have _three_ cdktf.json files, which all are identical:\r\n\r\n```json\r\n{\r\n  \"language\": \"typescript\",\r\n  \"app\": \"yarn -s compile && yarn -s run:main\",\r\n  \"terraformProviders\": [\r\n    \"hashicorp/aws@~> 3\",\r\n    \"hashicorp/random@~> 3\",\r\n    \"hashicorp/dns@~> 3\"\r\n  ],\r\n  \"codeMakerOutput\": \"../common/.gen\",\r\n  \"context\": {\r\n    \"excludeStackIdFromLogicalIds\": \"true\",\r\n    \"allowSepCharsInLogicalIds\": \"true\"\r\n  }\r\n}\r\n```\r\n\r\nNote the `\"codeMakerOutput\": \"../common/.gen\",` - they all generate to the same (shared) directory. \r\n\r\nExample relevant bits from `packages/app2/package.json/scripts`:\r\n\r\n```\r\n  \"scripts\": {\r\n    \"apply\": \"yarn synth && yarn tf:apply && yarn completed-time\",\r\n    \"build\": \"yarn build:common && yarn tsc --build && yarn synth\",\r\n    \"build:ami\": \"pushd../../packer/ && sh ./build-app2.sh && popd\",\r\n    \"build-ami\": \"pushd../../packer/ && sh ./build-app2.sh && popd\",\r\n    \"build:common\": \"pushd ../common && yarn build && popd\",\r\n    \"clean\": \"rm -rf dist *.log\",\r\n    \"clean-dist\": \"rm -rf dist\",\r\n    \"compile\": \"tsc --build --pretty\",\r\n    \"date\": \"date +'%Y/%m/%d %H:%M GMT%z'\",\r\n    \"completed-time\": \"echo ğŸŸ¢ Completed at $(yarn run date)\",\r\n    \"destroy\": \"yarn -s run tf:destroy\",\r\n    \"get\": \"yarn cdktf get\",\r\n    \"plan\": \"yarn synth && yarn -s run tf:plan\",\r\n    \"run:main\": \"node -r tsconfig-paths/register dist/src/main.js\",\r\n    \"rebuild-all\": \"yarn update && yarn build && yarn plan\",\r\n    \"show-user-data\": \"bin/show-user-data.sh\",\r\n    \"show-b64-user-data\": \"bin/show-b64-user-data.sh\",\r\n    \"synth\": \"yarn cdktf synth -o cdktf.out.$(terraform workspace show)\",\r\n    \"test\": \"jest --silent\",\r\n    \"update\": \"yarn upgrade --latest cdktf@next cdktf-cli@next && cdktf get\",\r\n    \"watch\": \"tsc -w\",\r\n    \"workspace:dev\": \"terraform workspace select dev || terraform workspace new dev\",\r\n    \"workspace:stg\": \"terraform workspace select stg || terraform workspace new stg\",\r\n    \"workspace:prod\": \"terraform workspace select prod || terraform workspace new prod\",\r\n    \"workspace:show\": \"terraform workspace show\",\r\n    \"tf\": \"terraform -chdir=cdktf.out.$(terraform workspace show)/stacks/app2\",\r\n    \"tf:init\": \"yarn tf init\",\r\n    \"tf:plan\": \"yarn tf plan\",\r\n    \"tf:apply\": \"yarn tf apply -auto-approve\",\r\n    \"tf:refresh\": \"yarn tf refresh\",\r\n    \"tf:destroy\": \"yarn tf destroy\"\r\n  },\r\n```\r\n\r\nI have logic in each of my `main.ts` files which does a `terraform workspace show`, combined with \"what application am I?\" to determine which set of deployment variables to use. This lets me have a \"matrix\" of applications and environments, each with it's own unique configuration.\r\n\r\nDuring my day-to-day, I simply run `yarn workspace:stg` (to use `stg`, for example) then `yarn apply`, which wraps up:\r\n\r\n- CDKTF Stack Synth (`cdktf synth`) into `cdktf.out.<workspace>/stacks/<app>/cdktf.tf.json`\r\n- Terraform Apply `terraform -chdir=cdktf.out.<workspace>/stacks/<app> apply -auto-approve`\r\n\r\nMy team is small so it's fairly easy _not_ to step on each-others toes while doing this, but would be easy-enough to wrap into a CI/CD system to handle per-branch/per-MR deploys should that ever be necessary.\r\n\r\nI have ~5 months (on and off) time spent on this system, and am quite satisfied. I wouldn't say it's the \"right\" way to go, but it works for me. ","createdAt":"2021-08-26T21:59:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/918#issuecomment-906771214","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc42EGIM","author":{"login":"prashant-eppalpalli"},"authorAssociation":"NONE","body":"> @prashant-eppalpalli are the TF workspaces existing already, or would you want them to be created automatically as part of `cdktf deploy`?\r\n\r\n@skorfmann \r\nCurrently TF workspace is already exist. At the moment we are not creating any TF workspace as part of cdktf deploy. We can say that TF workspaces existing already which we are creating separately. After that we are integrating cdktf with TF workspace.","createdAt":"2021-08-27T08:57:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/918#issuecomment-907043340","viewerDidAuthor":false}],"createdAt":"2021-08-18T16:03:42Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMDEzNzM4ODIw","name":"needs-research","description":"","color":"709F22"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"}],"milestone":null,"number":918,"title":"How multiple team members can use terraform CDKTF Project in a shared way","updatedAt":"2023-06-28T18:26:22Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjk5MDgxMDU=","is_bot":false,"login":"pecigonzalo","name":"Gonzalo Peci"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\nAny lang\r\n```\r\nâ¯ cdktf --version\r\n0.5.0\r\n```\r\n\r\n### Affected Resource(s)\r\n\r\n`cdktf-cli`\r\n\r\n### Debug Output\r\n\r\nhttps://gist.github.com/pecigonzalo/80b586232f124bcf63eee2e5911f7cae\r\n\r\n### Expected Behavior\r\n\r\nWe should be able to override the arch for the providers, either via config, by using `arch -x86_64` or some other way.\r\n\r\n### Actual Behavior\r\n\r\nEven when running an x86_64 version of `node` for the CDK and/or running the CDK with `arch -x86_64 cdktf get`, many providers fail to download because they are not available for m1.\r\n\r\n### Steps to Reproduce\r\n\r\n- Install `cdktf` using `homebrew` or `npx cdktf` (npx must be x86_64)\r\n- Initialize a new project in any lang with `cdktf init`\r\n- Add a provider like `\"terraformProviders\": [\"terraform-providers/docker@~> 2.0\"]`\r\n- Try to `cdktf get`\r\n\r\n### Important Factoids\r\n\r\n- Running on MBP M1\r\n- Using `asdf-vm` to install node and npx\r\n- `asdf-vm` is aliased to `arch -x86_64 asdf` and all binaries and tools installed by it are x86_64\r\n```\r\nâ¯ file ~/.asdf/installs/nodejs/14.2.0/bin/node\r\n/Users/USERNAME/.asdf/installs/nodejs/14.2.0/bin/node: Mach-O 64-bit executable x86_64\r\n```","comments":[{"id":"IC_kwDODd1Amc41j7jW","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"What version of Terraform do you have installed?","createdAt":"2021-08-13T17:25:01Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/909#issuecomment-898611414","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc41likL","author":{"login":"pecigonzalo"},"authorAssociation":"NONE","body":"My global version is (arm):\r\n\r\n```\r\nâ¯ terraform -v\r\nTerraform v1.0.3\r\non darwin_arm64\r\n\r\nYour version of Terraform is out of date! The latest version\r\nis 1.0.4. You can update by downloading from https://www.terraform.io/downloads.html\r\n```\r\n\r\nMy repo version is (with asdf-vm, x86_64):\r\n\r\n```\r\nâ¯ terraform -v\r\nTerraform v0.13.6\r\n\r\nYour version of Terraform is out of date! The latest version\r\nis 1.0.4. You can update by downloading from https://www.terraform.io/downloads.html\r\n```\r\n\r\nSo this uses the terraform CLI in the background? It could be that its not respecting the `asdf-vm` config and instead using my global terraform. I did not know that, I had a local terraform set for the repo just because I was trying to conver hcl -> typescript with CDK.","createdAt":"2021-08-15T11:04:43Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/909#issuecomment-899033355","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc41m_-Q","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"> So this uses the terraform CLI in the background?\r\n\r\nYes, it does. But you can also supply the `TERRAFORM_BINARY_NAME` environment variable to point the CDKTF to another Terraform binary. ([related source code](https://github.com/hashicorp/terraform-cdk/blob/main/packages/cdktf-cli/bin/cmds/helper/terraform.ts#L4))\r\n","createdAt":"2021-08-16T10:54:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/909#issuecomment-899415952","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc41nCEm","author":{"login":"pecigonzalo"},"authorAssociation":"NONE","body":"ğŸ¤” It could be that the exec is not happening in the context of the current folder, and its then grabbing my system `terraform` binary which is `darwin_arm64`. ","createdAt":"2021-08-16T11:08:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/909#issuecomment-899424550","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc417dQR","author":{"login":"pecigonzalo"},"authorAssociation":"NONE","body":"OK, I have tested changing my global terraform to use an `x86_64` version and then the `cdktf` commands work. \r\n\r\nI think we should still consider it a bug that this does not respect the context from which Im running the command from, and breaks `asdf-vm` version manager and likely other managers that depend on the current folder.","createdAt":"2021-08-24T16:10:40Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/909#issuecomment-904778769","viewerDidAuthor":false}],"createdAt":"2021-08-13T15:34:33Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"}],"milestone":null,"number":909,"title":"Unable to run on M1 with asdf-vm due to failed provider installation","updatedAt":"2021-09-02T15:21:28Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjcyNzQ4ODU4","is_bot":false,"login":"bondsb","name":""},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nThe return type for `addProvider()` within `TerraformModule` is `void`:\r\nhttps://github.com/hashicorp/terraform-cdk/blob/2baf75f53b99e68cf53061a73ad6bd5aa69f02be/packages/cdktf/lib/terraform-module.ts#L62\r\n\r\nThis request is to return `this`, with type `this`:\r\n\r\n```ts\r\n  public addProvider(provider: TerraformProvider | TerraformModuleProvider) : this {\r\n    if (!this._providers) {\r\n      this._providers = [];\r\n    }\r\n    this._providers.push(provider);\r\n    return this;\r\n  }\r\n```\r\n\r\nin order to allow for convenient method chaining:\r\n\r\n```ts\r\nvar myModule = new MyModule(this, \"my_module\", {\r\n   someValue: \"abcd\",\r\n}).addProvider(myProvider);\r\n```\r\n","comments":[{"id":"IC_kwDODd1Amc41btWP","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"I think the team would be happy to accept a PR to add this.","createdAt":"2021-08-11T02:42:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/900#issuecomment-896456079","viewerDidAuthor":false}],"createdAt":"2021-08-09T23:03:02Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzky","name":"good first issue","description":"Good for newcomers","color":"7057ff"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjE3NjIyNTkw","name":"modules","description":"","color":"2ffc8f"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":900,"title":"Method chaining with addProvider()","updatedAt":"2023-06-02T09:42:35Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM4Njg3NTQ=","is_bot":false,"login":"jsteinich","name":"Jon Steinich"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nInspired by a slack thread, the idea is to create the necessary resources to store Terraform state files / locks in remote backends. I.e. for S3Backend, an S3 bucket and DynamoDB table and associated permissions would be setup.\r\n\r\nPerhaps that configuration could be remembered and then newly initialized projects inherit the backend configuration settings.\r\n\r\n### References\r\n\r\nhttps://cdk-dev.slack.com/archives/C017XMM5L7N/p1627938410005400","comments":[{"id":"IC_kwDODd1Amc41Qn2T","author":{"login":"danieldreier"},"authorAssociation":"CONTRIBUTOR","body":"I'm categorizing this as x-large because doing a seamless bootstrap that provisions state storage and then moves state into it is a substantial project. It's not an immediate priority for the team in the next few months but we'd be open to designing this together if you or another external contributor wants to build this kind of workflow.","createdAt":"2021-08-05T15:26:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/891#issuecomment-893549971","viewerDidAuthor":false}],"createdAt":"2021-08-03T02:36:36Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MTU4","name":"size/x-large","description":"estimated > 1 month","color":"F8C5E8"}],"milestone":null,"number":891,"title":"cdktf bootstrap command","updatedAt":"2023-02-28T17:35:54Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzNjc4OQ==","is_bot":false,"login":"skorfmann","name":"Sebastian Korfmann"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n- 0.5.0 \r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\n### Affected Resource(s)\r\n\r\n- cli\r\n\r\n### Debug Output\r\n\r\n\r\n```\r\ncdktf watch --app 'npx tsc && node render-stack.js' --out cdktf.test.out\r\nError: Usage Error: /some/path is not a cdktf project directory, no cdktf.json found or cdktf.json is missing language / app keys\r\n```\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\n\r\n### Expected Behavior\r\n\r\nUsing the cli without a `cdktf.json` config file should work as well\r\n\r\n<!--- What should have happened? --->\r\n\r\n### Actual Behavior\r\n\r\nAn error is thrown when `cdkt.json` config file isn't present\r\n\r\n<!--- What actually happened? --->\r\n\r\n","comments":[{"id":"IC_kwDODd1Amc41G1Xu","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Oh I was not aware that a project without a cdktf.json is valid, I added this check with the intend to keep people from using cdktf outside of a cdk project context. What is the use-case for this behavior and is this documented anywhere yet?","createdAt":"2021-08-02T12:25:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/880#issuecomment-890983918","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc41G-Ie","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> What is the use-case for this behavior and is this documented anywhere yet?\r\n\r\nExcept for `app`, everything else is pretty much optional. There are some subtile differences right now which are tracked here https://github.com/hashicorp/terraform-cdk/issues/798\r\n\r\nSo, it's perfectly fine to do something like `cdktf deploy --app 'npx tsc && node render-stack.js` or even skipping the CLI entirely `npx tsc && node render-stack.js`. My specific use-case here is an integration test scenario.\r\n\r\nDon't know to which extent that's documented (probably not at all)","createdAt":"2021-08-02T13:17:45Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/880#issuecomment-891019806","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5LdWaB","author":{"login":"michaellzc"},"authorAssociation":"CONTRIBUTOR","body":"we also have a similar use case. \r\n\r\nImagine we have two repos\r\n\r\n- controller (it contains the `cdktf.json` and this is where the cdktf generation logic live)\r\n- deployment (it contains all the output instances of cdktf apps/stacks)\r\n  - app1\r\n    - manifest.json\r\n    - stacks/*\r\n  - app2\r\n    - manifest.json\r\n    - stacks/*\r\n\r\nwe want to be able to run `cdktf output` within the `deployment` to retrieve the output programmatically, and this is not possible because `cdktf-cli` is completely couple with the `cdktf.json`.\r\n\r\nalternative\r\n\r\n- creates a dummy `cdktf.json` in the deployment repo for each app\r\n- run cdktf from the `controller` repo (not possible because `cdktf output` implicitly run `cdktf synth`, but each app in deployment requires different command argumements to run the cdktf app)\r\n\r\n","createdAt":"2022-10-03T20:19:36Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/880#issuecomment-1265985153","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5wBvN_","author":{"login":"shinebayar-g"},"authorAssociation":"NONE","body":"We generate cdktf apps on the fly per folder and don't want to have `cdktf.json` everywhere. All the parameters are passed in via cli flags anyways. Since `cdktf --app` flag already exists why `cdktf.json` can't be optional?","createdAt":"2024-01-06T02:29:26Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/880#issuecomment-1879503743","viewerDidAuthor":false}],"createdAt":"2021-08-02T09:29:28Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMDEzNzM4ODIw","name":"needs-research","description":"","color":"709F22"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"}],"milestone":null,"number":880,"title":"Allow using CLI without having a config file","updatedAt":"2024-01-16T00:41:00Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"Currently `cdktf watch` invokes the `app` command of the `cdktf.json` config.\r\n\r\nHowever, most of the target languages of the CDKTF have tooling for watching the source\r\nfiles and incrementally compiling the resulting binary (e.g. `tsc --watch`,\r\n`gradle --watch-fs` [Maven does not seem to support watching], `gomon`). We\r\ncould make use of this to speed up the build and synth part of the `cdktf watch`\r\ncommand. We could e.g. add a `watch` option to the `cdktf.json` config which\r\ncontains a command that is spawned by the `cdktf watch` command.\r\nInstead of running a file watcher for synthesizing, watch would then spawn a child process for the command passed. Watch would also need to pipe output from that command to allow the user to notice compilation errors that might surface.","comments":[{"id":"IC_kwDODd1Amc41CmuT","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"I just played around with this a bit by running `tsc --watch` in a separate terminal and changing the app command to just run the program (`node main.js`).\r\nWe need this! This is sooooo fast ğŸš€\r\n![watch_tsc](https://user-images.githubusercontent.com/1112056/127656053-185e6c67-71b8-4180-8388-6a63a0041ff6.gif)\r\n\r\n(And this could even be optimized some more, because `watch` will currently do an unnecessary synth because it also detects my change to `main.ts` ğŸ˜)","createdAt":"2021-07-30T12:58:19Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/871#issuecomment-889875347","viewerDidAuthor":false}],"createdAt":"2021-07-30T07:20:24Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjEzNDkxMzEy","name":"feature/watch","description":"","color":"3068EA"}],"milestone":null,"number":871,"title":"Watch: Make use of target language tooling for recompiling","updatedAt":"2021-09-02T15:42:57Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"Currently `cdktf watch` always deploys automatically. While this is the main intended workflow, for some use cases it might make sense to be able to confirm those changes first.\r\n\r\nWhen invoking `cdktf watch` without the --auto-approve flag the user would have to\r\nconfirm applying the changes by e.g. pressing the enter key.","comments":[],"createdAt":"2021-07-30T07:16:45Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjEzNDkxMzEy","name":"feature/watch","description":"","color":"3068EA"}],"milestone":null,"number":870,"title":"Watch: Support manual approval","updatedAt":"2021-09-02T15:43:35Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"When source files of an `Asset` construct are located outside of the project directory, `cdktf watch` won't detect changes to them because it only watches the project directory.\r\nBy making a note (maybe to the manifest, tbd) while synthesizing, we can make a list of those directories and have `watch` read and use them to adjust its file watcher for synthezising.","comments":[],"createdAt":"2021-07-30T07:13:52Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjEzNDkxMzEy","name":"feature/watch","description":"","color":"3068EA"}],"milestone":null,"number":869,"title":"Watch: Detect changes for Assets source files located outside of project directory","updatedAt":"2021-09-02T15:44:55Z"},{"assignees":[{"id":"MDQ6VXNlcjEzMzcwNDY=","login":"DanielMSchmidt","name":"Daniel Schmidt","databaseId":0}],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\n### Affected Resource(s)\r\n\r\n<!--- Please list the affected resources. --->\r\n\r\n### Debug Output\r\n\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\n\r\n### Expected Behavior\r\n\r\n<!--- What should have happened? --->\r\n\r\nWe see telemetry related to all errors.\r\n\r\n### Actual Behavior\r\n\r\n<!--- What actually happened? --->\r\nWhen we send telemetry before the process is exited via `process.exit` the `process.exit` stops the node event loop leading to the request not being sent.\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Please list the steps required to reproduce the issue. --->\r\n\r\n### Important Factoids\r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n- #0000\r\n","comments":[{"id":"IC_kwDODd1Amc4-c5vt","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"We could resolve this differently by building a small JS artifact (similar to our initial CLI without the handlers) that just sends a telemetry event passed as a command line argument and call it in a separate background process so it does not get terminated. (intentionally creating a zombie process)","createdAt":"2022-02-22T12:49:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/841#issuecomment-1047763949","viewerDidAuthor":false}],"createdAt":"2021-07-22T22:36:02Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjA1MTMzMjIz","name":"feature/telemetry","description":"","color":"2A3D32"}],"milestone":null,"number":841,"title":"Telemetry does not get send due to process.exit","updatedAt":"2022-02-22T12:49:37Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM0Mzk3MTA=","is_bot":false,"login":"warlockdn","name":"warlockD"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nWorking with CDK has been very helpful recently. But I have come across a use case and need to understand how would you approach it. \r\n\r\nI have a simple configuration application which in-turn uses CDK to generate Terraform File works perfectly. \r\nBut here are some limitations I am not able to understand. \r\n\r\nLet's suppose I have multiple Infra configuration for multiple projects. Now I have a simple config which I pass on to the CDK as parameters and based on the passed config params I would generate a stack with a unique-name. Then run deploy and the infra would provision and my rest of the things work out. \r\n\r\nEvery time there is a new project I would need to generate stack with a unique-name and provision new infra based on the config params using the underlying module that used CDK. \r\n\r\nBut the issue is every-time I would run **synth** all the stacks would delete the generated stack (not the actual infra) and run again. \r\n\r\nWhat would be your ideal workflow here. How do I keep using the same module (CDK) to keep generating stacks based on incoming config params. And also make sure if there are any changes in the already generated stack it can take care of the diff and do the provisioning or deletion.\r\n\r\nWould really like to know your opinions.\r\n\r\n### References\r\n","comments":[{"id":"IC_kwDODd1Amc40pvQ5","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"Are you using local state backend or a remote backend? If you are using local state and the terraform state file for the previous stack is being deleted that sounds like it may be a bug.\r\n\r\nIf just the synthesized json is being deleted, that sounds like a potential improvement area. The trade off with not deleting would be potentially having old stacks (that a user potentially wanted to remove/rename) pile up.\r\n\r\nI think multiple stack support was added assuming stacks would be more static, but I'm not thinking of any strong reason why they couldn't be dynamically created.\r\n\r\nIn order to update existing stacks, you'll need to make sure to pass configuration that will generate the same stack name. If you are using a remote state backend, then it doesn't matter if any local files are present. The diff and deploy will still be possible.","createdAt":"2021-07-20T12:34:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/838#issuecomment-883356729","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc40p18P","author":{"login":"warlockdn"},"authorAssociation":"NONE","body":"> Are you using local state backend or a remote backend?\r\n\r\nLocal for now. But I want to move to Terraform Cloud once I am able to run this POC\r\n\r\nI am not sure what's the issue here. Whenever I do synth old generated stack gets deleted. \r\n\r\nHow can I stop this from happening. stacks and manifest.json is completely replaced every time I run synth. \r\n\r\nHow should I go about this. My idea is to generate json for multiple projects with multiple environments. And only source of truth needs to be the one where I am using the CDK. ","createdAt":"2021-07-20T13:15:36Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/838#issuecomment-883384079","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc40q1Md","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @warlockdn!\r\nThis is happening by design, we treat the source code (e.g. in TypeScript) as the single source of truth. If you want the `cdk.tf.json` file to be the source of truth, you could e.g. commit it to your Git repository to keep a history of changes to that file.\r\n\r\nHowever for your use case I'd suggest an alternative. You could create multiple instances of the same stack for your different projects. Like in this example:\r\nhttps://github.com/hashicorp/terraform-cdk/blob/f43270e3ceb633e53725d73fb314db29b831a0e3/examples/typescript/aws-multiple-stacks/main.ts#L31-L33\r\n(You can also do this for different projects â€“ not just for different environments)","createdAt":"2021-07-20T19:34:48Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/838#issuecomment-883643165","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc40r4ZC","author":{"login":"warlockdn"},"authorAssociation":"NONE","body":"@ansgarm \r\n\r\nThe scenario that you are suggesting is by creating and running things at once. But my use case is where configuration don't come to different projects at once. Configurations can be generated at any given time for any project. \r\n\r\nSo for eg: \r\nProject1 comes in and sends params: 1gb ram, 2 core cpu and source code\r\nProject2 comes in at a separate time with: 2gb ram, 2 core and source code\r\n\r\nNow by design cdktf would delete the last generated terraform. Now since all this would be a part of an automated process it becomes difficult to maintain git commits and run back and get the json and stuff. Hope you get my point. \r\n\r\nCan this be taken as a use case and can be used to alter the cli to accomodate the change may be using some config change. May be a change in cdktf.json using **deleteonsynth: boolean** or something may be. ","createdAt":"2021-07-21T06:08:14Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/838#issuecomment-883918402","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc40sDaf","author":{"login":"warlockdn"},"authorAssociation":"NONE","body":"The idea behind using a CDK would be for many I suppose would to manage multiple infrastructure requirements. Now this way anyone can be truly an infrastructure as code (since we are generating infra based on received parameters). Now involving multiple infra would enable generating and maintaining much more complex and very exhaustive configuration detailing.\r\n\r\nSo instead of thinking other directories already generated as orphaned we could look at them as multiple projects. This way states and other things can be part of that single directory where the plan would take place. And that and only that directory becomes the source of truth for that particular project. (This is only while thinking things are local)","createdAt":"2021-07-21T07:37:11Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/838#issuecomment-883963551","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc40sKyI","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Ah, sounds more like you want to build some kind of self-service that offers an API where projects can request infrastructure, is that right?\r\n\r\nI'm very hesitant with something like `deleteonsynth: boolean` because that could leave old artifacts inside the `cdktf.out` directory if you e.g. rename a stack or remove an `Asset`.\r\n\r\nBut that doesn't make your underlying use case invalid, so maybe we can find another way for the CDK for Terraform to support that (which might need some additional design work and deeper thoughts first before we incorporate it into the CLI itself).\r\n\r\nSo, to better understand your problem first, I'd like to dig a bit deeper (if that's okay with you).\r\n\r\nYou mentioned an example:\r\n> Project1 comes in and sends params: 1gb ram, 2 core cpu and source code\r\n> Project2 comes in at a separate time with: 2gb ram, 2 core and source code\r\n\r\nHow does the project send those params? And are they stored somewhere or just sent one-off?\r\nHow does the CDKTF itself run when it receives them? How is it invoked? Or is Terraform invoked directly instead?\r\n\r\nEven if the use case is not supported natively by the CDKTF at the moment, I'm pretty sure that it could be achieved with a bit of scripting inside a CI that might run all of this. There are users of the CDKTF which synthesize the Terraform config without the `cdktf-cli` but by invoking the program defined in `cdktf.json > app` directly. You could do a similar thing where you take control of the `cdk.tf.json` output file and move it into a specific directory based on the project it was generated for and deploy from there using Terraform or Terraform Cloud.","createdAt":"2021-07-21T08:24:00Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/838#issuecomment-883993736","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc40seI7","author":{"login":"warlockdn"},"authorAssociation":"NONE","body":"@ansgarm you got my use case right. \r\n\r\nSo since cdk supports typescript I have build the whole thing as a submodule inside my main app which would takes in a config params containing the necessary stuff to generate a infra around it. \r\n\r\n```\r\ninterface AppConfig {\r\n  domain: string;\r\n  type: 'backend' | 'ui';\r\n  appName: string; // unique app name\r\n}\r\n```\r\n\r\nNow this is passed to the appropriate app which looks like \r\n\r\n```\r\nconstructor(scope: Construct, name: string, config: AppConfig) {\r\n    super(scope, name);\r\n}\r\n```\r\n\r\nNow by using exec or zx I am able to run synth I am able to create a stack\r\n\r\n```\r\nnew AppStack(app, appName, config);\r\napp.synth();\r\n```\r\n\r\nJust a very straight forward thing I am doing here. Now since this is a cdk it would generally allow a developer writing business logic and other validations to allow this thing to be deployed to any cloud provider right. That's pretty much my idea. \r\n\r\n\r\n> You could do a similar thing where you take control of the cdk.tf.json output file and move it into a specific directory based on the project it was generated for and deploy from there using Terraform or Terraform Cloud\r\n\r\nYes right I can go ahead and do that as well. I can depend on cdktf to do synth and move the stack to my own user directory or terraform cloud. Right now its a straight forward deal (For my POC) -> synth -> deploy\r\n\r\nI understand your concern as well it could delete the old stack if the same name is passed again but same should or can even throw and error if in case the directory and the stack name exists already in the manifest.json right ?\r\n\r\nWhat according to you I can try to make this work even more easier to achieve. I see a solution you are suggesting\r\n\r\n1. synth a new stack \r\n2. transfer the stack to a new directory all together\r\n3. let terraform cli handle plan and deploy\r\n\r\nAnything else should I be doing ? ","createdAt":"2021-07-21T10:17:59Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/838#issuecomment-884073019","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc40ssj0","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Thank you for explaining your use case in more detail ğŸ‘ That helped a lot!\r\n\r\nTo me your proposed approach (using Terraform CLI to deploy) is reasonable for now. While we have thought about this use case / workflow before, we have not yet gathered sufficient data on it, so we cannot recommend a \"single best way\" to solve this, yet. But after gathering some more data on this workflow I'm pretty sure that we'll at some point be able to make a recommendation for how to best handle this.\r\n\r\nOn a related note: We plan to offer an API which exposes the underlying invocation of Terraform: https://github.com/hashicorp/terraform-cdk/issues/804\r\nHowever, that won't be shipped shortly, so I'd recommend to invoke the Terraform CLI yourself for now.\r\n\r\nPlease feel free to post more feedback to this issue as you go along with your POC! That would be very valuable to us â¤ï¸ ","createdAt":"2021-07-21T11:56:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/838#issuecomment-884132084","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc40tV2o","author":{"login":"warlockdn"},"authorAssociation":"NONE","body":"@ansgarm thank you for the validation on this. \r\n\r\nI have one case that I would like to mention. The current use case seems to be working when the infra is generated once. What happens when we modify the same config to update the infra with latest changes. No my plan is to use terraform cloud for remote state. How all this would pan out when using terraform cloud. \r\n\r\nI will try and post small poc on this. But what are your views on this. Do you think the use case can be taken as an initial idea and be discussed with core team and check if it means any sense to be taken for further dev.\r\n\r\nThanks. ","createdAt":"2021-07-21T15:56:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/838#issuecomment-884301224","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc40v6FS","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"> Do you think the use case can be taken as an initial idea and be discussed with core team and check if it means any sense to be taken for further dev.\r\n\r\nDefinitely, this workflow will be something we will think about ğŸ‘ ","createdAt":"2021-07-22T14:48:56Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/838#issuecomment-884973906","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc40wRgm","author":{"login":"warlockdn"},"authorAssociation":"NONE","body":"I would definitely be looking forward for this. Thank you","createdAt":"2021-07-22T17:02:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/838#issuecomment-885069862","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc40zoj0","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> What happens when we modify the same config to update the infra with latest changes. No my plan is to use terraform cloud for remote state. How all this would pan out when using terraform cloud.\r\n\r\nUntil you ran again with parameters that match the original stack name, nothing would happen. Once that stack is known to be needed, it will update it.","createdAt":"2021-07-23T22:50:46Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/838#issuecomment-885950708","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc41YBL7","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> > What happens when we modify the same config to update the infra with latest changes. No my plan is to use terraform cloud for remote state. How all this would pan out when using terraform cloud.\r\n> \r\n> Until you ran again with parameters that match the original stack name, nothing would happen. Once that stack is known to be needed, it will update it.\r\n\r\nYes, as long the input config stays the same, the output will be identical for the given input. So, in theory your described use-case should be working already. You'd essentially generate one stack at a time, with changed configurations. \r\n\r\nRegarding the TF Cloud backend,  Iâ€™d try to use an API client for TF cloud (e.g. https://github.com/mijailr/terraform-cloud) to make sure a workspace exists and pass this as config into the stack. Generally, thatâ€™s something which is one of the use-cases we have in mind for #682","createdAt":"2021-08-09T19:39:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/838#issuecomment-895488763","viewerDidAuthor":false}],"createdAt":"2021-07-20T07:27:39Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMDEzNzM4ODIw","name":"needs-research","description":"","color":"709F22"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjA1MTIxODAz","name":"enhancement/new-workflow","description":"Proposed new workflow","color":"4A1023"}],"milestone":null,"number":838,"title":"Using CDK to manage multiple Stacks generated separately ? ","updatedAt":"2021-08-09T19:39:12Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM4Njg3NTQ=","is_bot":false,"login":"jsteinich","name":"Jon Steinich"},"body":"Hmm, that doesn't seem to be enough for cdktf:\r\n```\r\n[Container] 2021/06/23 14:35:58 Running command cdktf synth\r\nERROR: synthesis failed, run \"cdktf get\" to generate providers in imports\r\n```\r\n\r\nIf I execute the Python script directly instead:\r\n```\r\n[Container] 2021/06/23 14:41:42 Running command pipenv run ./main.py\r\nTraceback (most recent call last):\r\n  File \"/...../main.py\", line 4, in <module>\r\n    from imports.aws import AwsProvider\r\nModuleNotFoundError: No module named 'imports'\r\n```\r\n\r\nThis happens because the Python script references the generated imports folder.\r\nI can address this by replacing `from imports.aws import AwsProvider, ...` with `from cdktf_cdktf_provider_aws import AwsProvider, ...`  - looks a bit awkward, but I suppose it's intended that way?\r\n\r\n_Originally posted by @onitake in https://github.com/hashicorp/terraform-cdk/issues/791#issuecomment-866930714_","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDg3OTA2NDc2OQ==","author":{"login":"onitake"},"authorAssociation":"NONE","body":"@jsteinich Did you intend to create a new issue from this comment?\r\nIf yes, I'll cross-post some more context here.\r\nI can also open a new issue.","createdAt":"2021-07-13T12:58:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/831#issuecomment-879064769","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg3OTA3MDg0OA==","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"As Jon added labels I think it was on purpose ğŸ˜„\r\nIf the context is related to improving the documentation (as tagged) it would be useful here â€“ if there are things to fix instead, I'd say file a new bug ğŸ‘\r\n\r\nFor either way: Thank you for contributing!","createdAt":"2021-07-13T13:06:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/831#issuecomment-879070848","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg3OTA5MDU1Ng==","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"Yep, definitely intentional. I think improving `cdktf get` performance is a standalone issue and anything else that has come up while working around it should be separate.\r\n@onitake as I understood the issues you ran into where windows/linux path problems and needing to update imports when switching to pre-built. If there were other problems, please file as separate issues.","createdAt":"2021-07-13T13:31:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/831#issuecomment-879090556","viewerDidAuthor":false}],"createdAt":"2021-07-13T02:05:52Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"}],"milestone":null,"number":831,"title":"Document transition between generated and pre-built providers","updatedAt":"2021-07-13T13:31:16Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzNjc4OQ==","is_bot":false,"login":"skorfmann","name":"Sebastian Korfmann"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nI've been repeating this pattern across several test projects:\r\n\r\n```ts\r\n    const tmpWorkDir = path.join(process.cwd(), 'tmp', 'build', 'data-sources')\r\n    fs.mkdirSync(tmpWorkDir, { recursive: true })\r\n    const filePath = path.join(tmpWorkDir, `${name}-data-source.js`)\r\n```\r\n\r\nThat's useful whenever a user wants to write generated files to disk and use it in conjunction with `TerraformAsset`.\r\n\r\nIt would be nice to have something like:\r\n\r\n```ts\r\nconst tmpFile = new TmpFile(this, 'my-file', {\r\n  content: `my file contents`\r\n})\r\n\r\nnew TerraformAsset(this, 'data-source-asset', {\r\n  path: tmpFile.path,\r\n  type: AssetType.FILE,\r\n});\r\n\r\n// or perhaps even just like this\r\n\r\nnew TmpFile(this, 'my-file', {\r\n  content: `my file contents`\r\n  distributeAs: AssetType.FILE\r\n})\r\n```\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDg3NjQxOTE1OA==","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Sounds interesting!\r\n\r\nJust a random idea: Why not extending TerraformAsset (or composing with it in some other way), so that the TmpFile itself would \"be the Asset\". Or is there any use case to just writing the TmpFile?\r\n\r\nHow I would imagine using it:\r\n```\r\nconst tmpFile = new TmpFile(this, 'file', {\r\n  content: `<html><body>Welcome to my empty website</body></html>`\r\n})\r\n\r\nnew S3BucketObject(this, \"index\", {\r\n      bucket: bucket.bucket,\r\n      key: 'index.html',\r\n      source: tmpFile.path,\r\n});\r\n```","createdAt":"2021-07-08T13:00:49Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/824#issuecomment-876419158","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg3NjQzMTgzNg==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> Why not extending TerraformAsset (or composing with it in some other way), so that the TmpFile itself would \"be the Asset\".\r\n\r\nI think that would make  sense indeed ğŸ‘ \r\n\r\nPerhaps it's more something like `GeneratedFile` or `FileGenerator`? ","createdAt":"2021-07-08T13:17:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/824#issuecomment-876431836","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg3NjUwMTA2NQ==","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"`InlineFile`? ğŸ˜„ (I'm not 100% satisfied with this name though)","createdAt":"2021-07-08T14:45:34Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/824#issuecomment-876501065","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg3NjY4NDMyMg==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> `InlineFile`? ğŸ˜„\r\n\r\nHm, not bad - I like that ğŸ‘ ","createdAt":"2021-07-08T19:20:07Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/824#issuecomment-876684322","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5CxMCo","author":{"login":"aayushharwani-aidash"},"authorAssociation":"CONTRIBUTOR","body":"@skorfmann  @ansgarm  can you guys plz explain little bit more about this issue. I am interested in working on it.","createdAt":"2022-05-07T11:17:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/824#issuecomment-1120190632","viewerDidAuthor":false}],"createdAt":"2021-07-08T08:48:54Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzky","name":"good first issue","description":"Good for newcomers","color":"7057ff"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":824,"title":"Provide Common Temporary Directory ","updatedAt":"2023-02-28T17:35:55Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n- Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n- Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n- If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n[Internally](https://github.com/hashicorp/terraform-cdk/tree/v0.4.1/packages/cdktf-cli/bin/cmds/ui/models) the `cdktf-cli` uses the Terraform CLI and the Terraform Cloud API to provision infrastructure.  \r\nIt would be useful to extract this code into a separate package as this would allow us to use `JSII` to offer that package across the languages we support.  \r\nThis would satisfy the [requests for such an api](https://github.com/hashicorp/terraform-cdk/issues/237) and could serve as a foundation e.g. when building integrations into testing frameworks.  \r\nBesides that, it would also serve as a precursor to refactoring the `cdktf-cli` \"UI\" which makes sense to do before working on e.g. [supporting displaying individual attributes](https://github.com/hashicorp/terraform-cdk/issues/114) for a `diff`.\r\n\r\n#### Tasks\r\n- [ ] Extract code from [models directory](https://github.com/hashicorp/terraform-cdk/tree/main/packages/cdktf-cli/bin/cmds/ui/models) into a separate package\r\n- [ ] Add / Move tests for that package\r\n- [ ] Configure JSII to build and publish this package in other languages\r\n- [ ] Add Readme to package (optional: with first rough description that could serve as docs)\r\n- [ ] Research & write follow-up issue for adding CDKTF specific apis to that package (might be done as part of a later \"UI\" refactoring): E.g. for triggering a synth, listing stacks, etc. (later to be used by the `cdktf-cli` when it is refactored.\r\n- [ ] _â€¦probably moreâ€¦_\r\n\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n- https://github.com/hashicorp/terraform-cdk/issues/237\r\n- https://github.com/hashicorp/terraform-cdk/issues/114\r\n- https://github.com/hashicorp/terraform-cdk/issues/152\r\n- https://github.com/aws/aws-cdk-rfcs/issues/300\r\n- https://github.com/hashicorp/terraform-cdk/issues/1377\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2021-06-29T10:37:36Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"LA_kwDODd1Amc7q-uL1","name":"feature/programmatic-api","description":"","color":"54AAC9"}],"milestone":null,"number":804,"title":"Public API for Terraform CLI / TF Cloud exec code","updatedAt":"2023-06-01T16:34:37Z"},{"assignees":[{"id":"MDQ6VXNlcjM4Njg3NTQ=","login":"jsteinich","name":"Jon Steinich","databaseId":0}],"author":{"id":"MDQ6VXNlcjM4Njg3NTQ=","is_bot":false,"login":"jsteinich","name":"Jon Steinich"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nWe should document the differences between `cdktf synth` vs running application directly and then eliminate differences where it makes sense.\r\nStarting list of differences:\r\n\r\n- Feature flags aren't applied when running app directly. This impacts the naming of resources. I don't have a good reason for the discrepancy.\r\n- Terraform Cloud automation. There's quite a bit to make using Terraform Cloud easier. Probably best to just leave alone\r\n- #682 proposes adding hooks which would be cli only\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDg3NTU2MjI4OQ==","author":{"login":"onitake"},"authorAssociation":"NONE","body":"For the use case of writing a cdktf script that generates Terraform code, it looks like the CLI is not needed.\r\nI haven't used feature flags so far, so the output from cdktf-cli and running scripts directly has been the same for me.\r\n\r\nI'm processing the generated JSON with Terraform afterwards. cdktf still requires Terraform to do the grunt work too, so the added benefit is somewhat limited.\r\n\r\nIt's understandable that more advanced features, such as Terraform Cloud integration, wouldn't work, but I think it would make sense to support the basic use case described above as well.\r\n\r\nComparison with other IaC toolkits:\r\n* Pulumi: CLI required, plus either running agent or state storage required\r\n* AWS CDK: CLI required, plus CloudFormation as deployment infrastructure required. Although, there's a similar discussion here: https://github.com/aws/aws-cdk-rfcs/issues/300","createdAt":"2021-07-07T12:29:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/798#issuecomment-875562289","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc40kMLU","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> * Feature flags aren't applied when running app directly. This impacts the naming of resources. I don't have a good reason for the discrepancy.\r\n\r\nThis just bit me hard and essentially destroyed an entire stack with lots of stuff requiring manual fixes now. That's really something we'll have to address.","createdAt":"2021-07-17T13:48:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/798#issuecomment-881902292","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc48C3D_","author":{"login":"vitoravancini"},"authorAssociation":"NONE","body":"> > * Feature flags aren't applied when running app directly. This impacts the naming of resources. I don't have a good reason for the discrepancy.\r\n> \r\n> This just bit me hard and essentially destroyed an entire stack with lots of stuff requiring manual fixes now. That's really something we'll have to address.\r\n\r\nIs there any workaround for this? I was developing my app using 'cdktf synth' and wrote quite a large infrasctructure with it, now i'm trying to run the app and I think i'm hitting the situation youre describing.\r\n\r\nthe modules names changed from: \r\n`module.quero2pay-dataplatform-eks-eks-cluster.module.node_groups.aws_launch_template.workers[\"main\"]`\r\nto `module.baseinfrastructurestack_quero2paydataplatformeksekscluster_F8C7987B.module.node_groups.aws_launch_template.workers[\"main\"]`\r\n\r\nNot sure it's the same situation but it looks like it.\r\n\r\nthank you!","createdAt":"2022-01-07T12:50:07Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/798#issuecomment-1007382783","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc48DG1D","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> Is there any workaround for this? I was developing my app using 'cdktf synth' and wrote quite a large infrasctructure with it, now i'm trying to run the app and I think i'm hitting the situation youre describing.\r\n\r\nYou could try setting the `CDKTF_CONTEXT_JSON` environment variable to a json string of your `cdktf.json` file.","createdAt":"2022-01-07T14:27:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/798#issuecomment-1007447363","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Vouji","author":{"login":"kemalizing"},"authorAssociation":"NONE","body":"hi,\r\nI'm hit by https://github.com/hashicorp/terraform-cdk/issues/2550 issue which looks like related to this one. Any news about this issue?","createdAt":"2023-02-20T10:52:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/798#issuecomment-1436739810","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5WgZNy","author":{"login":"kemalizing"},"authorAssociation":"NONE","body":"I saw a great work around for naming inconsistencies in another issue:\r\nhttps://github.com/hashicorp/terraform-cdk/issues/2341#issuecomment-1326760534","createdAt":"2023-03-02T05:45:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/798#issuecomment-1451332466","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5z0lCo","author":{"login":"shinebayar-g"},"authorAssociation":"NONE","body":"Hi. What are the actual differences of running the cdktf code directly vs using the cdktf cli? _(Apart from the CLI flags ofc)_\r\nI just did a quick comparison and I can't tell the difference.\r\nBoth `yarn run cdktf synth --app 'yarn run tsx main.ts'` and `yarn run tsx main.ts` still generated the cdktf json files.\r\n","createdAt":"2024-02-14T06:34:45Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/798#issuecomment-1943163048","viewerDidAuthor":false}],"createdAt":"2021-06-24T21:40:47Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMDEzNzM4ODIw","name":"needs-research","description":"","color":"709F22"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"}],"milestone":null,"number":798,"title":"Reduce/document differences between cdktf synth and running app directly","updatedAt":"2024-02-14T06:35:27Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM4Njg3NTQ=","is_bot":false,"login":"jsteinich","name":"Jon Steinich"},"body":"> > The contents were different between `cdktf get` runs on Windows and Linux machines.\r\n> \r\n> Are there more differences than just line endings? Likely something that could be improved if so.\r\n\r\nAs a matter of fact, there is:\r\n\r\n```\r\n[Container] 2021/06/23 09:58:56 Running command cdktf synth\r\ncdktf encountered an error while synthesizing\r\n\r\nSynth command: pipenv run python main.py\r\nError:         non-zero exit code 1\r\n\r\nCommand output on stderr:\r\n\r\n    jsii.errors.JavaScriptError: \r\n      internal/modules/cjs/loader.js:303\r\n            throw err;\r\n            ^\r\n  \r\n      Error: Cannot find module '/tmp/jsii-kernel-7PD2Kw/node_modules/hashicorp_aws/providers\\aws\\index.js'. Please verify that the package.json has a valid \"main\" entry\r\n          at tryPackage (internal/modules/cjs/loader.js:295:19)\r\n          at Function.Module._findPath (internal/modules/cjs/loader.js:508:18)\r\n          at Function.Module._resolveFilename (internal/modules/cjs/loader.js:802:27)\r\n          at Module._load (internal/modules/cjs/loader.js:667:27)\r\n          at nodeRequire (/tmp/tmplj38tl2q/lib/program.js:7809:42)\r\n          at /tmp/jsii-kernel-7PD2Kw/node_modules/hashicorp_aws:1:1\r\n          at Script.runInContext (vm.js:130:18)\r\n          at Kernel._execute (/tmp/tmplj38tl2q/lib/program.js:8588:31)\r\n          at Kernel.load (/tmp/tmplj38tl2q/lib/program.js:7856:38)\r\n          at KernelHost.processRequest (/tmp/tmplj38tl2q/lib/program.js:9479:36)\r\n```\r\n\r\nThe `imports` were created on a Windows machine, and the `synth` command was executed on AWS CodeBuild in a Ubuntu build container. Looks like the generated code contains some Windows path separators that don't work on Linux...\r\n\r\n_Originally posted by @onitake in https://github.com/hashicorp/terraform-cdk/issues/791#issuecomment-866843698_","comments":[{"id":"IC_kwDODd1Amc4_WIUL","author":{"login":"surajgawas110"},"authorAssociation":"NONE","body":" Even i m facing same issue. :(\r\nCDKTF Java - working on windows, failing to synth via docker nodejs container.\r\n\r\n![image](https://user-images.githubusercontent.com/48012652/157421384-0a1b006e-3de8-41d0-a87f-dae29eb2db35.png)\r\n","createdAt":"2022-03-09T10:17:19Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/794#issuecomment-1062765835","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc4_XLhl","author":{"login":"surajgawas110"},"authorAssociation":"NONE","body":"Found one workaround while doing R&D, **if we create cdktf new project in linux env and then move it to windows it works on both os.** But if you create project on windows you will face this issue.  \r\n\r\nSo if you are facing above issue just create new project copy all changes that you made to the template and then try cdktf synth on linux just to confirm its working on linux, then you can compress tha code and move it windows.\r\n","createdAt":"2022-03-09T15:28:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/794#issuecomment-1063041125","viewerDidAuthor":false}],"createdAt":"2021-06-23T14:34:42Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjE4NTU2NzE0","name":"windows","description":"","color":"839ad1"},{"id":"MDU6TGFiZWwyMjQ2NzM1NDk1","name":"providers","description":"","color":"2bd8cd"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2MjAxMTE5","name":"provider get / generation","description":"","color":"CC3938"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":794,"title":"Providers generated on Windows don't work on Linux","updatedAt":"2023-06-01T14:32:35Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzNjc4OQ==","is_bot":false,"login":"skorfmann","name":"Sebastian Korfmann"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nThere are scenarios, where a custom construct includes a few resources and one wants to define a dependency on that custom construct. E.g. when dealing with the [AWS ApiGateway](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/apigatewayv2_deployment):\r\n\r\n![Screenshot 2021-06-18 at 13 00 37](https://user-images.githubusercontent.com/136789/122551591-7a61b580-d035-11eb-86c6-37b319f3fda7.png)\r\n\r\n\r\nConstructs have the concept of dependencies. We could use this, to add explicit Terraform `depends_on`:\r\n\r\n```ts\r\n// ApiRoute contains a handful of resources\r\nconst route = new ApiRoute(this, 'route', {\r\n  api,\r\n  route: 'POST /foo/bar/{baz}',\r\n  authorizer: new NodejsFunction(this, 'auth', {\r\n    path: path.join(__dirname, 'function', 'authorizer', 'index.ts')\r\n  })\r\n})\r\n\r\nconst deployment = new aws.Apigatewayv2Deployment(this, 'deployment', {\r\n  apiId: api.id,\r\n  description: 'some deployment'\r\n})\r\n\r\nNode.of(route).addDependency(deployment)\r\n```\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDg2NDAyNTc1OA==","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"Would that add `depends_on` to every resource within the custom construct?","createdAt":"2021-06-18T13:08:39Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/785#issuecomment-864025758","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5m1qdn","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> Would that add `depends_on` to every resource within the custom construct?\r\n\r\nYes, I think that would be the desired outcome. Would be nice if that was supported without having to create an Aspect. However, saw that a similar issue (https://github.com/hashicorp/terraform-cdk/issues/2727) got closed. So, I'm wondering if that's something where contributions would be accepted? /cc @DanielMSchmidt Asking since there's a similar story in Wing which could use this :) https://github.com/winglang/wing/issues/3225\r\n\r\n","createdAt":"2023-09-19T11:45:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/785#issuecomment-1725343591","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5m19vr","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"I think we would accept contributions ğŸ‘ ","createdAt":"2023-09-19T12:32:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/785#issuecomment-1725422571","viewerDidAuthor":false}],"createdAt":"2021-06-18T11:08:48Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"}],"milestone":null,"number":785,"title":"Add Dependency on Custom Construct","updatedAt":"2023-09-19T12:32:20Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nWe had a [user report](https://cdk-dev.slack.com/archives/C017XMM5L7N/p1621507578007600) on an issue with the `excludeStackIdFromLogicalIds` flag in the `cdktf.json` via the CDK Dev Slack. The flag had been set to `\"false\"` (string) instead of `false` (boolean). As TypeScript treats `\"false\"` as a truthy value the setting was interpreted as if `true` would have been passed.  \r\n\r\nBy validating the `cdktf.json` against a schema, we could catch such errors without having to do much work.  \r\n\r\nFurthermore, it would be possible to use somehow publish e.g. a [json schema](https://json-schema.org/) which then can be picked up by editors and offer intellisense when editing the `cdktf.json` config. For this versioning (e.g. feature flags that change) might be a concern that could make this more complicated.\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc6BtriV","author":{"login":"anden-akkio"},"authorAssociation":"NONE","body":"Here's an at least mostly correct one, translated from the spec on [this page](https://developer.hashicorp.com/terraform/cdktf/create-and-deploy/configuration-file):\r\n\r\n```json\r\n{\r\n  \"$schema\": \"https://json-schema.org/draft/2020-12/schema\",\r\n  \"$id\": \"cdktf.schema.json\",\r\n  \"type\": \"object\",\r\n  \"properties\": {\r\n    \"app\": {\r\n      \"type\": \"string\",\r\n      \"description\": \"The command to run in order to synthesize the code to Terraform compatible JSON\"\r\n    },\r\n    \"language\": {\r\n      \"type\": \"string\",\r\n      \"enum\": [\"typescript\", \"python\", \"csharp\", \"java\", \"go\"],\r\n      \"description\": \"Target language for building provider or module bindings. Currently supported: `typescript`, `python`, `java`, `csharp`, and `go`\"\r\n    },\r\n    \"output\": {\r\n      \"type\": \"string\",\r\n      \"default\": \"cdktf.out\",\r\n      \"description\": \"Default: 'cdktf.out'. Where the synthesized JSON should go. Also will be the working directory for Terraform operations\"\r\n    },\r\n    \"codeMakerOutput\": {\r\n      \"type\": \"string\",\r\n      \"default\": \".gen\",\r\n      \"description\": \"Default: '.gen'. Path where generated provider bindings will be rendered to.\"\r\n    },\r\n    \"projectId\": {\r\n      \"type\": \"string\",\r\n      \"description\": \"Default: generated UUID. Unique identifier for the project used to differentiate projects\"\r\n    },\r\n    \"sendCrashReports\": {\r\n      \"type\": \"boolean\",\r\n      \"default\": false,\r\n      \"description\": \"Default: false. Whether to send crash reports to the CDKTF team\"\r\n    },\r\n    \"terraformProviders\": {\r\n      \"type\": \"array\",\r\n      \"items\": {\r\n        \"anyOf\": [\r\n          { \"type\": \"string\" },\r\n          {\r\n            \"type\": \"object\",\r\n            \"properties\": {\r\n              \"name\": { \"type\": \"string\" },\r\n              \"source\": { \"type\": \"string\" },\r\n              \"version\": { \"type\": \"string\" }\r\n            },\r\n            \"required\": [\"name\"]\r\n          }\r\n        ]\r\n      },\r\n      \"description\": \"Terraform Providers to build\"\r\n    },\r\n    \"terraformModules\": {\r\n      \"type\": \"array\",\r\n      \"items\": {\r\n        \"anyOf\": [\r\n          { \"type\": \"string\" },\r\n          {\r\n            \"type\": \"object\",\r\n            \"properties\": {\r\n              \"name\": { \"type\": \"string\" },\r\n              \"source\": { \"type\": \"string\" },\r\n              \"version\": { \"type\": \"string\" }\r\n            },\r\n            \"required\": [\"name\"]\r\n          }\r\n        ]\r\n      },\r\n      \"description\": \"Terraform Modules to build\"\r\n    }\r\n  },\r\n  \"required\": [\"app\", \"language\", \"terraformProviders\", \"terraformModules\"]\r\n}\r\n```\r\n\r\nYou can tell your editor to validate against it by adding a line to your `cdktf.json` file pointing it towards the schema file (which I have directly adjacent to my `cdktf.json`):\r\n\r\n```json\r\n{\r\n\t\"$schema\": \"./cdktf.schema.json\",\r\n}\r\n```\r\n\r\nWould of course be great to get an \"official\" one maintained by Hashicorp, as I doubt I'll update the above if any changes are made.","createdAt":"2024-06-18T14:24:01Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/782#issuecomment-2176235669","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6UN3ZQ","author":{"login":"icholy"},"authorAssociation":"CONTRIBUTOR","body":"We have some custom properties in our `cdktf.json` file which are used by internal tooling. If validation was added, would it be possible to either:\r\n\r\n1. Add a dedicated property which can contain arbitrary configuration (a `metadata` property).\r\n2. Add a prefix (similar to `x-` properties in swagger) to be used for custom properties. https://swagger.io/docs/specification/v3_0/openapi-extensions/\r\n3. Guarantee that the json schema won't have `additionalProperties: false` enable. ","createdAt":"2024-11-19T20:15:45Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/782#issuecomment-2486662736","viewerDidAuthor":false}],"createdAt":"2021-06-15T08:17:09Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"}],"milestone":null,"number":782,"title":"Validate cdktf.json to catch simple configuration errors","updatedAt":"2024-11-19T20:15:47Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nI recently provisioned a CloudFront Distribution with a single origin which at first was a S3 bucket but than changed to a S3 bucket website endpoint. I had to `terraform taint` the resource to be able to replace it.  \r\nIt would be nice if that command would be made available via the cdktf-cli so I don't have to manually supply all the required args to the Terraform CLI like this:\r\n`terraform -state=../../../terraform.frontend-dev.tfstate taint aws_cloudfront_distribution.frontend_cf_6C82FC12`\r\n\r\nThe [docs](https://www.terraform.io/docs/cli/commands/taint.html) mention `taint` as deprecated (although it'll still be supported in all Terraform 1.x version). So maybe supporting the new (as of Terraform v0.15.2) `-replace` option would also be fine (if not both).\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2021-06-11T08:42:44Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2MjkzOTA4","name":"core-parity","description":"Better experience in Terraform Core than CDKTF","color":"1A80B6"}],"milestone":null,"number":775,"title":"Support tainting a resource (or new -replace option)","updatedAt":"2021-07-02T19:02:36Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\n### Affected Resource(s)\r\n\r\n<!--- Please list the affected resources. --->\r\n\r\n- RegistryImage in the kreuzwerker/docker provider\r\n\r\n### Debug Output\r\n\r\n<!---\r\nPlease provide a link to a GitHub Gist containing the complete debug output. Please do NOT paste the debug output in the issue; just paste a link to the Gist.\r\n--->\r\n\r\ncdktf.log outputs this line:\r\n\r\n```\r\n[2021-06-02T13:20:52.443] [DEBUG] default - â•·\r\nâ”‚ Error: Error building docker image: 0: When using ADD with more than one source file, the destination must be a directory and end with a /\r\nâ”‚\r\nâ”‚   with docker_registry_image.backend-image,\r\nâ”‚   on cdk.tf.json line 87, in resource.docker_registry_image.backend-image:\r\nâ”‚   87:       }\r\nâ”‚\r\nâ•µ\r\n```\r\n\r\n### Expected Behavior\r\n\r\n<!--- What should have happened? --->\r\n\r\nI would want to see something similar to `Error building docker image: 0: When using ADD with more than one source file, the destination must be a directory and end with a /` as part of the cdktf output\r\n\r\n### Actual Behavior\r\n\r\n<!--- What actually happened? --->\r\n\r\nThis output is printed (note the double output, the missing error message, and the missing debug output)\r\n\r\n```\r\nâ ´ Deploying Stack: aws\r\nResources\r\n âœ”Â AWS_ECR_REPOSITORY   backend-ecr         aws_ecr_repository.backend-ecr\r\n â §Â DOCKER_REGISTRY_IMAG backend-image       docker_registry_image.backend-image\r\n   E\r\n\r\nSummary: 1 created, 0 updated, 0 destroyed.\r\nâ•·\r\nâ ´ Deploying Stack: aws\r\nResources\r\n âœ”Â AWS_ECR_REPOSITORY   backend-ecr         aws_ecr_repository.backend-ecr\r\n â ‡Â DOCKER_REGISTRY_IMAG backend-image       docker_registry_image.backend-image\r\n   E\r\n\r\nSummary: 1 created, 0 updated, 0 destroyed.\r\nnon-zero exit code 1\r\n```\r\n\r\n### Steps to Reproduce\r\n\r\n<!--- Please list the steps required to reproduce the issue. --->\r\n\r\nUse TerraformAsset + RegistryImage to build an invalid docker image\r\n\r\n\r\n### Workaround\r\n\r\nEnabling the debug logs with `CDKTF_DISABLE_LOGGING=false` helped me debug this, I find this flag pretty hidden, maybe we could add a verbose/log entry in the cdktf.json so that people stumble upon it earlier\r\n\r\n### Important Factoids\r\n\r\n<!--- Are there anything atypical about your accounts that we should know? --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor documentation? For example:\r\n--->\r\n\r\n* #0000\r\n","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDg1MzY3OTQ5OA==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"This seems to be related to https://github.com/hashicorp/terraform-cdk/issues/218","createdAt":"2021-06-03T08:16:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/755#issuecomment-853679498","viewerDidAuthor":false}],"createdAt":"2021-06-02T11:27:09Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM1OTU1Nzk1","name":"ux/debugging","description":"","color":"2703FD"}],"milestone":null,"number":755,"title":"Docker provider build error not surfaced","updatedAt":"2023-08-10T15:42:25Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM4Njg3NTQ=","is_bot":false,"login":"jsteinich","name":"Jon Steinich"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nCreate another repository (perhaps `terraform-cdk-examples`) to host the examples. This is something that has come up a couple times, but I don't believe formally tracked. Would allow us to remove the references to locally built distribution and replace with more standard user experience. May want to also expand readmes to better explain examples / setup.\r\n\r\n### References\r\n\r\n#745 \r\n#551 \r\n","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDg1MTI4Mzg2Mw==","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"We're currently using the examples as some kind of smoke test ([.github/workflows/examples.yml](https://github.com/hashicorp/terraform-cdk/blob/main/.github/workflows/examples.yml#L38))\r\nIt would be nice to keep something like that in place, when we move the examples to another repository.\r\n\r\nHowever, I don't quite understand, why we can't currently expand the readmes of the examples. That should also be possible while within this repo?\r\n\r\nFrom a \"monorepo\" perspective: We could also remove the references to locally built packages to make them more \"copy-pastable\" but still keep the examples in this repo. This would also allow running them locally for testing changes. But I have no strong opinion here.","createdAt":"2021-05-31T07:51:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/749#issuecomment-851283863","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg1MTMyNTA2Mg==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> We're currently using the examples as some kind of smoke test ([.github/workflows/examples.yml](https://github.com/hashicorp/terraform-cdk/blob/main/.github/workflows/examples.yml#L38))\r\n> It would be nice to keep something like that in place, when we move the examples to another repository.\r\n\r\nYes, that's the primary reason they are still part of this repo. In addition, I also find it quite useful for local manual testing without having to use links or something like yalc.","createdAt":"2021-05-31T08:42:00Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/749#issuecomment-851325062","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg1MTQzODYyMA==","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> We're currently using the examples as some kind of smoke test ([.github/workflows/examples.yml](https://github.com/hashicorp/terraform-cdk/blob/main/.github/workflows/examples.yml#L38))\r\n> It would be nice to keep something like that in place, when we move the examples to another repository.\r\n\r\nYes, I meant to reference #558 since we could do event more testing.\r\n\r\n\r\n\r\n> However, I don't quite understand, why we can't currently expand the readmes of the examples. That should also be possible while within this repo?\r\n\r\nAbsolutely. I just see moving to a different repo as a trigger to \"let's improve the examples\", but that could be done at anytime. Perhaps just opening this issue is enough of a starter.\r\n\r\nI actually don't have a strong opinion on where they should be. I know there has been some informal discussion in the past and just wanted to continue that.","createdAt":"2021-05-31T11:55:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/749#issuecomment-851438620","viewerDidAuthor":false}],"createdAt":"2021-05-30T17:31:02Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"}],"milestone":null,"number":749,"title":"Create a separate repo for examples","updatedAt":"2021-07-20T15:56:55Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEyNTA4NDcz","is_bot":false,"login":"karthikns16","name":"Karthik NS"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n \r\nI am working on setting up OKTA application using OKTA provider https://registry.terraform.io/providers/oktadeveloper/okta/latest/docs\r\n\r\nThis provider seems to have a bug https://github.com/okta/terraform-provider-okta/issues/162 and are unable to handle parallel request sent by terraform. We have to use ```-parallelism=1```. cdktf deploy doesn't seem support terraform cli options\r\n\r\nHence instead of using cdktf deploy, I have to resort to using ```terraform apply --auto-approve -parallelism=1``` after cdktf synth\r\n\r\nWould be great if terraform cli options honored by cdktf cli\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc43tJ7G","author":{"login":"RomeroGaliza"},"authorAssociation":"NONE","body":"I have a very similar use case with SignalFX provider, where it turns out that `-parallelism=1` can be used as a workaround.","createdAt":"2021-10-05T16:49:48Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/734#issuecomment-934584006","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Bgjwt","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"It might be interesting to explore allowing something like `cdktf deploy stack -- -parallelism=1 -target=mymodule`.\r\nI've worked with a few tools that have this idea of a separator after which all options are directly passed to underlying tools. In this example an empty `--` is treated as the separator, but could come up with something else.","createdAt":"2022-04-14T10:40:07Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/734#issuecomment-1099054125","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Rn3Yl","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"I think this will be solved between #2107 and the move to Terraform CLI","createdAt":"2023-01-03T05:19:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/734#issuecomment-1369404965","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5SfjVw","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"Closed by #2468","createdAt":"2023-01-16T12:43:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/734#issuecomment-1384002928","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5TZ2ym","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"While a few cli flags are supported, there still isn't general support for them.","createdAt":"2023-01-21T16:49:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/734#issuecomment-1399286950","viewerDidAuthor":false}],"createdAt":"2021-05-26T23:39:10Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"}],"milestone":null,"number":734,"title":"Support terraform cli options","updatedAt":"2023-06-27T15:07:38Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nImports for generated providers in Go are currently nested according to their namespace.\r\nSo, for example:\r\n```\r\n\"cdk.tf/go/stack/generated/hashicorp/random\"\r\n```\r\nHowever, this only happens if the namespace is explicitly passed in `cdktf.json`:\r\n```\r\n\"terraformProviders\": [\"hashicorp/random@~> 3.1.0\"],\r\n```\r\nAs the shorthand without the prefix `hashicorp/` is also allowed for official providers, this:\r\n```\r\n\"terraformProviders\": [\"random@~> 3.1.0\"],\r\n```\r\nshould also result in the same import to work.\r\n\r\nBut, as the implementation currently does not fall back to `hashicorp` for an empty namespace, it results in generated code that needs to be imported from another directory:\r\n```\r\n\"cdk.tf/go/stack/generated/random\"\r\n```\r\nIt should always have the same import name.\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n* This is a follow-up for https://github.com/hashicorp/terraform-cdk/pull/727\r\n","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDg3MzE5NjI3Nw==","author":{"login":"danieldreier"},"authorAssociation":"CONTRIBUTOR","body":"This is a good pragmatic approach, but we should also print a warning or informational message when we do this. There is a long-term effort across Core and the registry to move away from implicit hashicorp namespacing, so we should help nudge people in the right direction if they omit the `hashicorp` namespace.","createdAt":"2021-07-02T18:49:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/728#issuecomment-873196277","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5LmBlV","author":{"login":"mutahhir"},"authorAssociation":"MEMBER","body":"After #2146 `hashicorp` will be `cdktf` now, but Daniel's point stands regarding informational message.","createdAt":"2022-10-05T10:40:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/728#issuecomment-1268259157","viewerDidAuthor":false}],"createdAt":"2021-05-26T12:44:38Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjQ2NzM1NDk1","name":"providers","description":"","color":"2bd8cd"},{"id":"MDU6TGFiZWwzMDMwODE1NTQy","name":"language/golang","description":"","color":"22ED90"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2MjkzOTA4","name":"core-parity","description":"Better experience in Terraform Core than CDKTF","color":"1A80B6"}],"milestone":null,"number":728,"title":"fallback to hashicorp namespace if none is passed in go provider generation","updatedAt":"2022-10-05T10:40:12Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nIn #648 we introduce assets as a construct. To make the usage a little nicer and easier we could introduce a helper function for the most common usecase, using relative files:\r\n\r\n```ts\r\nclass MyStack extends TerraformStack {\r\n  constructor(scope: Construct, name: string) {\r\n    super(scope, name);\r\n\r\n    new AwsProvider(this, \"provider\", {\r\n      region: \"us-west-2\",\r\n    });\r\n\r\n    const bucket = new S3Bucket(this, \"bucket\", {\r\n      bucket: \"demo\",\r\n    });\r\n\r\n    new S3BucketObject(this, \"lambda-archive\", {\r\n      bucket: bucket.bucket,\r\n      key: \"lambda.zip\",\r\n      source: this.relativeFile(\"../lambda.zip\"),\r\n    });\r\n  }\r\n}\r\n``` \r\n\r\nAn implementation could look like\r\n\r\n```ts\r\npublic function relativeFile(p: string) {\r\n  const asset = new TerraformAsset(this, p, {\r\n    path: path.resolve(__dirname, p) \r\n  });\r\n\r\n  return asset.path;\r\n}\r\n```\r\n\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDg0NDkwMzMxOQ==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"I like this in general. Why do you think it should live in `TerraformStack` and not be an individual helper function / construct?","createdAt":"2021-05-20T09:21:16Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/708#issuecomment-844903319","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg0NDkzMzIwMA==","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"A reference to the TerraformStack is required when creating an Asset behind the scenes. So the user doesn't need to explicitly pass the stack.","createdAt":"2021-05-20T09:54:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/708#issuecomment-844933200","viewerDidAuthor":false}],"createdAt":"2021-05-17T11:13:29Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"}],"milestone":null,"number":708,"title":"Helper for using local files","updatedAt":"2021-11-29T15:32:44Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEwNDU5Nzcy","is_bot":false,"login":"giraffesyo","name":"Michael McQuade"},"body":"One of the powerful uses of TypeScript is that you can limit values to only certain values. As an example with strings you can do something like:\r\n\r\n```typescript\r\ninterface IApiGatewayV2APIOptions {\r\nprotocol_type: \"HTTP\" | \"WEBSOCKET\"\r\napi_key_selection_expression? : \"$context.authorizer.usageIdentifierKey\" | \"$request.header.x-api-key\"\r\n...\r\n}\r\n```\r\nThen when you are using that interface, you get nice autocomplete in your IDE because it knows what strings are allowed for `protocol_type` and `api_key_selection_expression`. \r\n\r\nIt looks like currently the provider schema is generated from the [golang files](https://github.com/hashicorp/terraform-provider-aws/blob/main/aws/data_source_aws_apigatewayv2_api.go) in the terraform provider project, so it might not be a very easy task However, if someone smarter than me can come up with a way to do this then I think it would be a pretty useful feature and would be willing to try to help implement it.","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDg0MzE0MjI5MQ==","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"Ideally Terraform would publish this information in the provider schema. However, it looks like this is managed with a validate function which would likely be tricky to determine simple rules like this vs more complex validations. Perhaps the work being done for https://github.com/hashicorp/terraform-provider-aws/issues/14601 could make it feasible within Terraform.","createdAt":"2021-05-18T12:49:15Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/707#issuecomment-843142291","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg0NDkwMDQ2NA==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"Trying to parse the provider docs might also be an option. This will likely include a few custom tweaks, though.","createdAt":"2021-05-20T09:18:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/707#issuecomment-844900464","viewerDidAuthor":false}],"createdAt":"2021-05-16T21:45:06Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMDEzNzM4ODIw","name":"needs-research","description":"","color":"709F22"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"}],"milestone":null,"number":707,"title":"Providers should know \"allowed\" values where possible","updatedAt":"2021-11-30T12:24:38Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjY4NzM1MDU0","is_bot":false,"login":"maciak-g","name":""},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n0.3.0\r\n\r\n### Affected Resource(s)\r\n\r\nproject initialize\r\n\r\n### Debug Output\r\n\r\nhttps://gist.github.com/maciak-g/2435e8595ca23c33c374c0c774a857ec\r\n\r\n### Expected Behavior\r\n\r\nProject should be initialized\r\n\r\n### Actual Behavior\r\n\r\nError message that pip cannot perform --user install.\r\n\r\n### Steps to Reproduce\r\n\r\nInstall pycharm, create project with pycharm, initialize venv environment in the project.\r\n\r\n### Important Factoids\r\n\r\nI want to initialize project from the level of pycharm not custom initialization tool and install pip packages within initialized python virtual environment. The second case is I want to add this library to existing project where I have already prepared configuration for objects I will provision to cloud. I am puzzled why there are no alternative instructions to setup project manually or some more options to direct how packages should be installed.\r\n\r\n### References\r\n\r\n* #0000\r\n","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDg0MTIzOTcyOA==","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"There may be a conflict between pip and your virtualenv. There are 2 separate templates, perhaps trying the `python` one would work better with your setup.\r\n\r\nWhen it comes to manual setup, there's really only a couple steps.\r\n1. Create a [cdktf.json file](https://github.com/hashicorp/terraform-cdk/blob/main/docs/working-with-cdk-for-terraform/cdktf-json.md)\r\n2. Install the [cdktf package](https://pypi.org/project/cdktf/0.3.0/)\r\n3. Optionally install [prebuilt providers](https://pypi.org/user/cdktf-team/)","createdAt":"2021-05-14T13:20:38Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/705#issuecomment-841239728","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg0MTI5NTU1OA==","author":{"login":"maciak-g"},"authorAssociation":"NONE","body":"But could you check this hardcoded --user parameter in `python-pip` template ? For example as I have found on stackoverflow it is not needed when using venv, so forcing it doesn't have sense:\r\nhttps://stackoverflow.com/questions/30604952/pip-default-behavior-conflicts-with-virtualenv","createdAt":"2021-05-14T14:56:07Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/705#issuecomment-841295558","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg0MTcwNzA3Ng==","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"I think right now the `python-pip` template is assuming you aren't using a virtual environment while the `python` template creates one for you.\r\n\r\n@cmclaughlin Do you have any thoughts on if it makes sense for the pip version to better support virtual environments?","createdAt":"2021-05-15T18:43:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/705#issuecomment-841707076","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc41j4XH","author":{"login":"tl24"},"authorAssociation":"CONTRIBUTOR","body":"I ran into this as well.  I couldn't make sense from the docs whether --user is the default or not, but you could detect whether you're in a virtual environment by checking to see if the VIRTUAL_ENV environment variable is set and not specify the --user flag if you are.","createdAt":"2021-08-13T17:00:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/705#issuecomment-898598343","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc41pBIU","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"@tl24 that sounds like a reasonable solution. Would you be interested in creating a PR that does just that?","createdAt":"2021-08-17T02:26:38Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/705#issuecomment-899944980","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc41qQnN","author":{"login":"tl24"},"authorAssociation":"CONTRIBUTOR","body":"Sure I can do that","createdAt":"2021-08-17T12:51:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/705#issuecomment-900270541","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc41qf11","author":{"login":"tl24"},"authorAssociation":"CONTRIBUTOR","body":"FYI I ran into an issue trying to test.  There is a check in packages/cdktf-cli/bin/cmds/helper/init.ts that won't let you run with version 0.0.0.  I'm not sure how one is supposed to test locally with that check.  I had to comment it out temporarily.","createdAt":"2021-08-17T14:10:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/705#issuecomment-900332917","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc41rd53","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"> I'm not sure how one is supposed to test locally with that check\r\n\r\nYou can build the `cdktf` package and specify it via `--dist` or `CDKTF_DIST`. I usually use the former with the `init` command. It is mentioned [here](https://github.com/hashicorp/terraform-cdk/blob/main/CONTRIBUTING.md#build--package), but please file an issue if something was left unclear and we can improve the docs there ğŸ‘€","createdAt":"2021-08-17T19:54:15Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/705#issuecomment-900587127","viewerDidAuthor":false}],"createdAt":"2021-05-14T09:18:50Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwyMTEzNjU3MzA2","name":"language/python","description":"","color":"5c2596"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"}],"milestone":null,"number":705,"title":"~Unable to initialize cdktf project in pycharm with venv activated","updatedAt":"2022-11-23T11:56:26Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMzcwNDY=","is_bot":false,"login":"DanielMSchmidt","name":"Daniel Schmidt"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nCurrently init defaults to a cloud backend if the user has a cloud token. You can work around by using the `--local` flag, but it was quite surprising to me that I could not select this like I could when I hadn't logged in yet. I'd prefer a `--cloud` option and a selection like as if no token is set, so that the workflow stays the same.\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDg0MjMxMzI0Mw==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> I'd prefer a `--cloud` option and a selection like as if no token is set, so that the workflow stays the same.\r\n\r\nYou mean some sort of dialog in the init workflow which asks for `local` / `cloud` ?\r\n\r\n","createdAt":"2021-05-17T13:12:43Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/694#issuecomment-842313243","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg0MjMxNzU0OQ==","author":{"login":"DanielMSchmidt"},"authorAssociation":"CONTRIBUTOR","body":"> You mean some sort of dialog in the init workflow which asks for local / cloud?\r\n\r\nExactly, there seems to be one that exists already when no terraform cloud credentials exist in the system","createdAt":"2021-05-17T13:18:48Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/694#issuecomment-842317549","viewerDidAuthor":false}],"createdAt":"2021-05-07T17:32:32Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"},{"id":"LA_kwDODd1Amc7x0kYM","name":"feature/init","description":"cdktf init related features","color":"C1E24A"}],"milestone":null,"number":694,"title":"Init: allow users to choose between local and cloud when not setting a cloud ","updatedAt":"2023-06-02T09:04:35Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzNjc4OQ==","is_bot":false,"login":"skorfmann","name":"Sebastian Korfmann"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nIt'd be great if we were able to use hooks for the various lifecycles of the `cdktf cli`. I'm thinking about something like \r\n\r\n- [before|after]Synth\r\n- [before|after]Diff\r\n- [before|after]Deploy\r\n- [before|after]Destroy\r\n\r\nI could see this becoming useful, if we'd want to build certain features in a pluggable way and at the same time enabling users to build their own hooks / plugins.\r\n\r\nOne slightly adapted example from this [issue](https://github.com/hashicorp/terraform-cdk/issues/237):\r\n\r\n```ts\r\nconst app = new App()\r\nconst stack = new MyStack(app, \"automate-everything\")\r\n\r\nstack.on('afterDiff', (plan, executor) => {\r\n  if (plan.changes && plan.changes.module.custom.fruits > 4) {\r\n    executor.addTarget('module.custom.fruits')\r\n  }\r\n})\r\n```\r\n\r\nOr when thinking about [creating](https://github.com/hashicorp/terraform-cdk/issues/670) Terraform Cloud workspaces, perhaps something like this in more global fashion could work:\r\n\r\n```ts\r\nconst allBackends(TerraformBackend): TerraformBackend[] {\r\n  const backends: TerraformBackend[] = [];\r\n\r\n  const visit = (node: IConstruct) => {\r\n    if (node instanceof TerraformBackend) {\r\n      backends.push(node)\r\n    }\r\n\r\n    for (const child of Node.of(node).children) {\r\n      visit(child);\r\n    }\r\n  }\r\n\r\n  visit(app)\r\n\r\n  return backends\r\n}\r\n\r\nexport beforeSynth = (app) => {\r\n  const backends = allBackends(app)\r\n\r\n  for (const backend of backends) {\r\n    // make sure backend exists\r\n  }\r\n}\r\n\r\n```\r\n\r\nAll of this above is pseudo code and are just rough ideas. It would only work in the context of the `cdktf cli` being used. However, I think this could be quite helpful for us and our users.\r\n\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n\r\n- https://github.com/hashicorp/terraform-cdk/issues/670\r\n- https://github.com/hashicorp/terraform-cdk/issues/237\r\n","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDgzMjY4Njk1NA==","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> It would only work in the context of the `cdktf cli` being used\r\n\r\nI understand the simplicity of routing through the cli; however, pieces that only work through the cli do add friction; particularly in languages where it is expected to just be able to run from your ide without setting up anything special.","createdAt":"2021-05-05T13:27:56Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/682#issuecomment-832686954","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDgzMjcwMjI0MA==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> > It would only work in the context of the `cdktf cli` being used\r\n> \r\n> I understand the simplicity of routing through the cli; however, pieces that only work through the cli do add friction; particularly in languages where it is expected to just be able to run from your ide without setting up anything special.\r\n\r\nI don't think we can make this work as part of the Terraform CLI, so I think depending on the `cdktf cli` is likely the only option here - or do you have another idea?","createdAt":"2021-05-05T13:48:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/682#issuecomment-832702240","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDgzMjcxMDE5NQ==","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> I don't think we can make this work as part of the Terraform CLI, so I think depending on the `cdktf cli` is likely the only option here - or do you have another idea?\r\n\r\nApologies. That was more of a user reaction rather than thinking it through. #408 really covers the only part that makes sense in the current context. #237 is also interesting, but that would probably exist on a layer above / side of the cli.","createdAt":"2021-05-05T13:58:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/682#issuecomment-832710195","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg3MDkzMjQ0Mg==","author":{"login":"matschaffer"},"authorAssociation":"NONE","body":"I think if I needed to run the hook directly I'd opt to move the operations into a library and keep the hook as just something like:\r\n\r\n```\r\nimport * as hooks from './hooks';\r\nstack.on('afterDiff', hooks.afterDiff);\r\n```\r\n\r\nThat way I could use jest or something to run/validate hook assumptions outside of the cdktf cli.","createdAt":"2021-06-29T21:30:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/682#issuecomment-870932442","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc49Z2py","author":{"login":"rirze"},"authorAssociation":"CONTRIBUTOR","body":"I'd like to bring up another benefit of this approach-- this could enable dynamic importing of Terraform resources from code. It would be similar to how Pulumi works, where you could specify a `import` parameter into the resource and the first `apply` will generate the import statements necessary. \r\n\r\nHowever, it would involve removing the import parameter from the code after one successful run. \r\n\r\nI imagine this function running `pre-deploy`. ","createdAt":"2022-02-04T17:15:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/682#issuecomment-1030187634","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5NiISH","author":{"login":"eahrend"},"authorAssociation":"NONE","body":"Hey,\r\n\r\nSo, this would actually be super useful at the construct level. For example, we want to spin up a new K8S cluster and put a vendor's pods on said cluster. Unfortunately the vendor doesn't have a terraform provider, and we need to communicate with the API to generate a secret in order to deploy those pods, however the vendor keeps a record of this secret and we'd like to revoke that secret after we destroy said cluster and remove the vendor's pods from our cluster.\r\n\r\nFor example, I'd like to be able to do this:\r\n```GO\r\npackage main\r\n\r\n// copying from an example in the CDKTF tutorial page.\r\n\r\nimport (\r\n    kubernetes \"github.com/hashicorp/terraform-cdk/examples/go/documentation/generated/hashicorp/kubernetes/provider\"\r\n    // psuedo-code for this, not sure where this would go\r\n    helm \"github.com/hashicorp/terraform-cdk/examples/go/documentation/generated/hashicorp/kubernetes/helm\"\r\n    \"github.com/hashicorp/terraform-cdk/examples/go/documentation/myconstructs\"\r\n    \"github.com/aws/constructs-go/constructs/v10\"\r\n    \"github.com/aws/jsii-runtime-go\"\r\n    \"github.com/hashicorp/terraform-cdk-go/cdktf\"\r\n\r\n    // placeholder for library used to interact with the vendor's API\r\n    \"github.com/eahrend/vendor\"\r\n\r\n    \"os\"\r\n    \"path\"\r\n)\r\n\r\nfunc NewExampleCdktfDocumentationStack(scope constructs.Construct, name string) cdktf.TerraformStack {\r\n    stack := cdktf.NewTerraformStack(scope, &name)\r\n\r\n    cwd, _ := os.Getwd()\r\n\r\n    kubernetes.NewKubernetesProvider(stack, jsii.String(\"kind\"), &kubernetes.KubernetesProviderConfig{\r\n        ConfigPath: jsii.String(path.Join(cwd, \"kubeconfig.yaml\")),\r\n    })\r\n    // instantiating a new vendor client to get the token\r\n    vendorClient, _ := vendor.NewClient(\"some configuration options\")\r\n    vendorToken, _ := vendorClient.GetToken()\r\n    myconstructs.NewKubernetesWebAppDeployment(stack, \"deployment\", map[string]interface{}{\r\n        \"image\":       jsii.String(\"nginx:latest\"),\r\n        \"replicas\":    jsii.Number(2),\r\n        \"app\":         jsii.String(\"myapp\"),\r\n        \"component\":   jsii.String(\"frontend\"),\r\n        \"environment\": jsii.String(\"dev\"),\r\n        \"token\": jsii.String(vendorToken),\r\n    })\r\n    myconstructs.OnDelete(revokeToken(vendorToken))\r\n\r\n    return stack\r\n}\r\n\r\n\r\n// here we're revoking the token from the vendor's API\r\nfunc revokeToken(vendorToken string) error {\r\n    vendorClient, _ := vendor.NewClient(\"some configuration options\")\r\n    vendorClient.RevokeToken(vendorToken)\r\n}\r\n\r\nfunc main() {\r\n    app := cdktf.NewApp(nil)\r\n\r\n    NewExampleCdktfDocumentationStack(app, \"demo\")\r\n\r\n    app.Synth()\r\n}\r\n\r\n```","createdAt":"2022-11-02T16:11:13Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":4}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/682#issuecomment-1300792455","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5XB1I8","author":{"login":"ntrp"},"authorAssociation":"NONE","body":"This would be useful also in case we need to open a tunnel to access the resources, the tunnel init code could be in the before hook and the tunnel shutdown code in the after hook.\r\n\r\nOne example: Open a SSM port forwarding to RDS before refreshing or applying postgresql resources via the postgres provider","createdAt":"2023-03-08T12:42:44Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/682#issuecomment-1460097596","viewerDidAuthor":false}],"createdAt":"2021-05-04T08:16:23Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"LA_kwDODd1Amc7WpEvS","name":"ux/integration","description":"","color":"D670CB"},{"id":"LA_kwDODd1Amc7q-uL1","name":"feature/programmatic-api","description":"","color":"54AAC9"}],"milestone":null,"number":682,"title":"Lifecycle Hooks","updatedAt":"2023-03-08T12:42:44Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzNjc4OQ==","is_bot":false,"login":"skorfmann","name":"Sebastian Korfmann"},"body":"> I skimmed through your documentation and am looking at the codebase, but it's a bit hard for me to understand how things go from a construct to HCL to JSON.\r\n\r\nLooks like we could improve the docs about the synthesizing process. \r\n\r\nBesides from what @jsteinich wrote, is there anything else we could provide you context on?\r\n\r\n_Originally posted by @skorfmann in https://github.com/hashicorp/terraform-cdk/issues/667#issuecomment-831085795_","comments":[],"createdAt":"2021-05-03T07:44:53Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":674,"title":"Document Synth Process","updatedAt":"2023-06-01T13:29:10Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzNjc4OQ==","is_bot":false,"login":"skorfmann","name":"Sebastian Korfmann"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nIt'd be fantastic to have the option to create custom, stateful resources on the fly. Essentially an `cdktf-adhoc-provider`, which acts as a [Terraform Plugin](https://www.terraform.io/docs/extend/index.html). This should be auto generated from user written code. \r\n\r\n#### Prior Art\r\n\r\nThere is the [https://github.com/lukekaalim/terraform-plugin-node-SDK](https://github.com/lukekaalim/terraform-plugin-node-SDK) project which is doing something like this for nodejs already. While it seems to be more like a proof of concept, their [readme](https://github.com/lukekaalim/terraform-plugin-node-SDK#why-create-plugins) describes the use-cases I have in mind pretty well:\r\n\r\n> Why create Plugins?\r\n> Terraform has a wealth of plugins available to it already created that allow you to manage a vast amount of resources in an interconnected graph, but it doesn't have all of them.\r\n>\r\n>When using terraform, you may wish to:\r\n>\r\n>- Create resources that talk to a proprietary or internal API\r\n>- Create resource for an API that doesn't have a provider yet\r\n>- Manage a resource for an existing provider that doesn't provide certain functionality\r\n>- Disagree with the implementation of an API and want to give yourself greater flexibility\r\n>- Model existing build scripts as declarative structures\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nThere's also an [example](https://github.com/lukekaalim/terraform-plugin-node-SDK/blob/78d6b3074a59dbb72405aa607e9dbc4c3c909039/examples/example/plugin.js) how their implementation looks like.","comments":[{"id":"IC_kwDODd1Amc5WKC8h","author":{"login":"RichiCoder1"},"authorAssociation":"NONE","body":"While I think part of the hard part would be creating a maintained plugin framework to simplify custom resources (see below), I was also thinking about how CDKTF might bootstrap these custom \"plugins\".\r\n\r\nIn very abbreviated psudeo form, my thought process was:\r\n* CDKTF, either via `cdktf` or another cli, provides a generic entrypoint like `cdktf plugin-exec` which handles the Go Plugin Handshake as well as standing up a compatible `gRPC` server and loading the plugin implementation.\r\n* CDKTF emits a [special configuration](https://developer.hashicorp.com/terraform/cli/config/config-file#explicit-installation-method-configuration) like:\r\n```hcl\r\nprovider_installation {\r\n  filesystem_mirror {\r\n    path    = \"<output-dir>/plugin/bin/entrypoint\"\r\n    include = [\"terraform-cdk.local/*/*\"]\r\n  }\r\n  direct {\r\n    exclude = [\"terraform-cdk.local/*/*\"]\r\n  }\r\n}\r\n```\r\n* CDKTF then dynamically loads/runs the plugin implementation as defined in code like:\r\n```typescript\r\nimport { App, Stack } from \"cdktf\";\r\nimport { CustomProvider, CustomResource, Handler } from \"cdktf/custom_resource\";\r\n\r\n/* ... some code ... */\r\n\tconst provider = new CustomProvider(this, \"MyProvider\", {\r\n\t   // Gets translated into the entrypoint defined above as appropraite\r\n       handler: Handler.fromNodejs(path.join(__dirname, \"src/index.js\")),\r\n    });\r\n    new CustomResource(this, \"MyResource\", {\r\n\t   provider,\r\n       // CDKTF can probably handle auto-prefixing resoruces\"\r\n       resource: \"my_resource\",\r\n       properties: /* my properties */,\r\n    });\r\n/* ... more code ... */\r\n```\r\n\r\nThe hard part off course is after. Creating NodeJS plugins is one thing, creating plugins that will work in any of CDKTF's supported runtimes is another matter. CloudFormation and the AWS CDK supports this via Lambda's runtime support and well-defined event model but it's not so simple with local execution.\r\n\r\nA possibility is a JSII provided meta-framework that effectively duplicates https://github.com/hashicorp/terraform-plugin-framework via JSII, but you still have to solve for the communication layer between Terraform and the plugin without leaking too much to the consumer. I'm not sure there's a reasonable low effort way to support this in other language and an MVP might just be to implement Node-based custom resources and punt on JSII-based ones.","createdAt":"2023-02-26T21:38:34Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/661#issuecomment-1445474081","viewerDidAuthor":false}],"createdAt":"2021-04-22T13:59:15Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"},{"id":"LA_kwDODd1Amc7KjeH8","name":"feature/dynamic-terraform","description":"","color":"8D7D9C"}],"milestone":null,"number":661,"title":"Custom Resources","updatedAt":"2023-02-26T21:38:49Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzNjc4OQ==","is_bot":false,"login":"skorfmann","name":"Sebastian Korfmann"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nEnable users to write custom code for fetching and processing data which gets executed within the Terraform workflow. Here's an [example](https://gist.github.com/skorfmann/e399bbd85be6e5a8a5a021adcb570dd4) which leverages the `external` Terraform provider to run a custom generated script. \r\n\r\nThis likely depends on #648 and the biggest challenge is to make this work across all supported jsii languages. \r\n\r\n\r\n### References\r\n\r\n- https://github.com/hashicorp/terraform-cdk/issues/423","comments":[],"createdAt":"2021-04-22T13:10:16Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"},{"id":"LA_kwDODd1Amc7KjeH8","name":"feature/dynamic-terraform","description":"","color":"8D7D9C"},{"id":"LA_kwDODd1Amc7WpEvS","name":"ux/integration","description":"","color":"D670CB"}],"milestone":null,"number":660,"title":"Custom Data Source","updatedAt":"2022-02-10T16:44:34Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjExMTIwNTY=","is_bot":false,"login":"ansgarm","name":"Ansgar Mertens"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\nI think it would be good to support file URI as well, so something like `file:///foo/bar/archive.zip`\r\n\r\n_Originally posted by @skorfmann in https://github.com/hashicorp/terraform-cdk/pull/645#discussion_r616661630_\r\n\r\n### References\r\n\r\n#645 \r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[],"createdAt":"2021-04-20T22:00:46Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":653,"title":"Support remote templates from file:// uris","updatedAt":"2021-11-30T13:28:37Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjU1NjAyNjc=","is_bot":false,"login":"zmsy","name":"Zach Morrissey"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\nRight now, `cdktf` can only use inputs from the current directory, and it would be helpful if it could run against other directories as well. There's an option to specify output directory for synth, but not input directory. If there's already an option to do this, please add the correct flag to the `cdktf` help text.\r\n\r\n```\r\n# ideally can pass along like this\r\ncdktf synth <input_dir_flag> <directory>\r\n```","comments":[],"createdAt":"2021-04-13T22:47:52Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMTM2MjgxMDY3","name":"ux/cli","description":"","color":"40FE53"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":632,"title":"Pass input directory as a CLI argument","updatedAt":"2022-02-10T16:17:05Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzNjc4OQ==","is_bot":false,"login":"skorfmann","name":"Sebastian Korfmann"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nWe omit the Provider name from resource names. For Data Sources, that's not done. \r\n\r\nExample:\r\n\r\n```ts\r\nimport { SnsTopic } from './.gen/providers/aws/sns-topic';\r\nimport { DataAwsRegion } from './.gen/providers/aws'\r\n```\r\n\r\nShould become\r\n\r\n```ts\r\nimport { SnsTopic } from './.gen/providers/aws/sns-topic';\r\nimport { DataRegion } from './.gen/providers/aws'\r\n```\r\n\r\nAlternatively, we could go in a similar direction as #572 and move data source to their own namespace. Something like:\r\n\r\n```ts\r\nimport { SnsTopic } from './.gen/providers/aws/sns-topic';\r\nimport { DataSources } from './.gen/providers/aws'\r\n\r\nnew DataSources.Region() \r\n```\r\n\r\n\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDc4MjEyNTE0OA==","author":{"login":"vbudilov"},"authorAssociation":"NONE","body":"This is great. What's the timeline for it? ","createdAt":"2021-02-19T14:55:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/575#issuecomment-782125148","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc4MjQyNTExMg==","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"Definitely a breaking change, but seems like one for the better.\r\n\r\n> Alternatively, we could go in a similar direction as #572 and move data source to their own namespace. Something like:\r\n\r\nNeed to be more specific than just `DataSources` or likely to conflict between providers. #568 also conflicted for data sources within a single provider.","createdAt":"2021-02-19T22:43:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/575#issuecomment-782425112","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc4MjY1Nzg4Mg==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> Need to be more specific than just `DataSources` or likely to conflict between providers. #568 also conflicted for data sources within a single provider.\r\n\r\nDon't think it would be an issue across multiple providers, but it's certainly is within one provider. Would have to be on service level then. However, then it would likely be better to go with the first approach.","createdAt":"2021-02-20T13:35:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/575#issuecomment-782657882","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc4MjY1ODg0Ng==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> This is great. What's the timeline for it?\r\n\r\nJust wanted to start the discussion, no immediate plan to implement. ","createdAt":"2021-02-20T13:38:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/575#issuecomment-782658846","viewerDidAuthor":false}],"createdAt":"2021-02-19T13:40:06Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjQ2NzM1NDk1","name":"providers","description":"","color":"2bd8cd"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":575,"title":"Align Data Source Names with Resource Name Schema","updatedAt":"2023-06-01T16:34:36Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzNjc4OQ==","is_bot":false,"login":"skorfmann","name":"Sebastian Korfmann"},"body":"> Also, would you agree with the assumption that it's good enough to test the provider generation process for all providers to Typescript only? Or would you see a huge benefit in testing all providers in all languages?\r\n\r\nGiven that we have encountered bugs that are language specific (equals in Java AWS, comments in Python Google, etc), I think we need to test at least some of the providers in all languages. Maybe that is just the big 3 cloud providers (examples currently cover that), but maybe it should be the full official provider list.\r\n\r\n> Same question for Linux / Windows.\r\n\r\nI think we need to generate at least one provider in all languages on Windows. Probably doesn't need to be AWS (I imagine a smaller provider would be much quicker).\r\n\r\nI'm not sure what would make sense for module testing. Maybe ones with 500k+ downloads (currently 19).\r\n\r\n_Originally posted by @jsteinich in https://github.com/hashicorp/terraform-cdk/issues/553#issuecomment-777483808_","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDg0NTE0MDM3MA==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"When approaching this issue, we should make sure to cleanup these tests as well https://github.com/hashicorp/terraform-cdk/pull/713#discussion_r636019727","createdAt":"2021-05-20T13:49:20Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/558#issuecomment-845140370","viewerDidAuthor":false}],"createdAt":"2021-02-11T14:51:32Z","labels":[{"id":"MDU6TGFiZWwyMjE3NjIyNTkw","name":"modules","description":"","color":"2ffc8f"},{"id":"MDU6TGFiZWwyMjQ2NzM1NDk1","name":"providers","description":"","color":"2bd8cd"},{"id":"MDU6TGFiZWwyNTcwMTY0OTY5","name":"testing","description":"","color":"456cc6"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"}],"milestone":null,"number":558,"title":"Testing Modules and Providers","updatedAt":"2023-06-02T10:07:16Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM4Njg3NTQ=","is_bot":false,"login":"jsteinich","name":"Jon Steinich"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\nThere have been a couple tickets that have come in that ended up just being an error in upgrading cdktf. The typescript templates have some information about which commands to run, but not really an explanation of the full process. Other templates don't even have that much.\r\n\r\nI'm thinking either a dedicated page or a section within the using the cli page. Possibly linking to it with each version's changelog entry.\r\n\r\nContents to include:\r\n- Updating cdktf-cli / cdktf packages themselves\r\n- Needing to run `cdktf get`\r\n- Updating package/project files to use newer versions of the libraries for other languages\r\n\r\n### References\r\n#468\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5Vajzv","author":{"login":"xiehan"},"authorAssociation":"MEMBER","body":"@jsteinich Do our upgrade guides on https://developer.hashicorp.com/terraform/cdktf/release satisfy this need or is there more you think we should still do here?","createdAt":"2023-02-16T12:38:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/526#issuecomment-1433025775","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Va3Lv","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"@xiehan, I'd still see this as an opportunity to improve, as our upgrade guides usually explain the changes and how to adjust for them, but not how to upgrade `cdktf` itself in the first place in general (e.g. by changing the dependency version, running `npm install`, and optionally re-running `cdktf get`).","createdAt":"2023-02-16T13:41:21Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/526#issuecomment-1433105135","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5VeP0T","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> @jsteinich Do our upgrade guides on https://developer.hashicorp.com/terraform/cdktf/release satisfy this need or is there more you think we should still do here?\r\n\r\nI agree with everything that @ansgarm stated. The most common issue that I've seen here is updating the cli without updating the cdktf library or vice versa. Re-running `cdktf get` has become less of an issue since there are pre-built providers and fewer breaking changes, but it does still come up.","createdAt":"2023-02-17T02:04:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/526#issuecomment-1433992467","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc58Rm_n","author":{"login":"zeph"},"authorAssociation":"NONE","body":"@xiehan I'd really love to be more constructive on detailing what's wrong with the upgrade procedure... but it is the 3rd time in 2years that I pick up a `cdktf` project from a git repo, from colleagues, with an outdated stack. This time too, I'll simply nuke the whole setup and leave it be. I quote how my colleague tried to describe the upgrade process to me:\r\n\r\n> Basically it is try and error. You start with the offocial cli. If this does not work, you try to update manually the deps in the package.json. If this does not work, then you remove package.json, do an init, reinstall all the libs you need so that they  automatically resource their deps from scratch and Then finally you can start changing your Code\r\n> \r\n> The third method is the most sure to work, but the it is the longest too\r\n\r\nThis cannot be, it simply leads to frustration and insane amount of wasted hours of manual attempts of changes\r\n\r\nI really hope such documentation gets improved with a step by step guide for someone that stumbles on project that require nodejs 14.x and related dependencies... that's the picture of the market in my personal bubble (given the low engagement on this ticket, it is probably just my own issue)","createdAt":"2024-04-30T10:56:59Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/526#issuecomment-2084990951","viewerDidAuthor":false}],"createdAt":"2021-01-27T13:42:17Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":526,"title":"Improve cdktf upgrade documentation.","updatedAt":"2024-04-30T11:38:03Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjMxNTExNQ==","is_bot":false,"login":"ducva","name":"Vu Anh Duc"},"body":"As you known, Chalice support package in terraform format, ref: https://aws.github.io/chalice/topics/tf.html\r\n\r\nDo we have any way to import the `chalice.tf.json` file, and use terraform cdk to create resources and the lambda functions? ","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDc2NjczMDI3Ng==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"That's an interesting suggestion, I wasn't aware that Chalice can generate Terraform config as well.\r\n\r\n> Do we have any way to import the `chalice.tf.json` file, and use terraform cdk to create resources and the lambda functions?\r\n\r\nBy importing you mean, being able to reference the resources generated by Chalice via the JSON output? So, essentially generating Typescript constructs out of the JSON?\r\n\r\n","createdAt":"2021-01-25T10:52:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/516#issuecomment-766730276","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc2NzIyMzIwNg==","author":{"login":"ducva"},"authorAssociation":"NONE","body":"> By importing you mean, being able to reference the resources generated by Chalice via the JSON output? So, essentially generating Typescript constructs out of the JSON?\r\n\r\nIn my imagination: I can parse the `chalice.tf.json` and manipulate these resources. \r\n\r\nIs there any way to create a resource from JSON format? I know Terraform also support JSON format, so support parsing JSON to resources may not only useful for `chalice` but also other cases too. \r\n\r\n","createdAt":"2021-01-26T01:31:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/516#issuecomment-767223206","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc2NzQzODAxMA==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> > By importing you mean, being able to reference the resources generated by Chalice via the JSON output? So, essentially generating Typescript constructs out of the JSON?\r\n> \r\n> In my imagination: I can parse the `chalice.tf.json` and manipulate these resources.\r\n> \r\n> Is there any way to create a resource from JSON format? I know Terraform also support JSON format, so support parsing JSON to resources may not only useful for `chalice` but also other cases too.\r\n\r\nThere's no way to do this at the moment. However, that's certainly an interesting use-case which I could see to be quite valuable. That's something which would be needed for https://github.com/hashicorp/terraform-cdk/issues/231 as well.","createdAt":"2021-01-26T10:05:49Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/516#issuecomment-767438010","viewerDidAuthor":false}],"createdAt":"2021-01-25T07:16:44Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"},{"id":"LA_kwDODd1Amc7WpEvS","name":"ux/integration","description":"","color":"D670CB"}],"milestone":null,"number":516,"title":"Support Chalice","updatedAt":"2023-06-02T14:15:16Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE1NTc4ODc=","is_bot":false,"login":"mikeparker","name":"Mike Parker"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n\r\n0.1.0 (2 days old)\r\n\r\n### Affected Resource(s)\r\n\r\n<!--- Please list the affected resources. --->\r\n\r\n### Debug Output\r\n\r\nhttps://gist.github.com/mikeparker/be19bd259f059c24cc2c6616d41d06fb\r\nSpecifically `Error: Cannot find module 'C:\\Users\\Mike'`, note the truncated directory name due to whitespace\r\n\r\n### Expected Behavior\r\n\r\nIt completes successfully\r\n\r\n### Actual Behavior\r\n\r\nIt errored\r\n\r\n### Steps to Reproduce\r\n\r\nRun `cdktf synth` on windows where node modules are in a directory with whitespace in directory name (e.g. inside windows user directory)\r\n","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDc2MTY2Mzc5Ng==","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"This seems likely to be caused by https://github.com/aws/jsii/issues/1296","createdAt":"2021-01-16T21:16:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/502#issuecomment-761663796","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc2MjQ1OTg3MQ==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"Would the suggested workaround apply here as well? https://github.com/aws/jsii/issues/1296#issuecomment-591663558\r\n\r\n```\r\nPS C:\\> $env:TMP = \"C:\\tmp\"\r\n```","createdAt":"2021-01-18T20:35:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/502#issuecomment-762459871","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc2MjU0OTIxNg==","author":{"login":"mikeparker"},"authorAssociation":"NONE","body":"Yes, the workaround works :) ","createdAt":"2021-01-19T01:48:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/502#issuecomment-762549216","viewerDidAuthor":false}],"createdAt":"2021-01-16T14:13:28Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjE4NTU2NzE0","name":"windows","description":"","color":"839ad1"},{"id":"MDU6TGFiZWwyMjQ2NzM3OTc1","name":"upstream/jsii","description":"Pending upstream work on JSII","color":"f9a2cf"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwyMjk5ODAzNDMw","name":"waiting-for-3rd-party-fix","description":"","color":"cc62ef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":502,"title":"cdktf synth fails on windows when directory has whitespace in the name","updatedAt":"2023-06-01T14:33:03Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzNjc4OQ==","is_bot":false,"login":"skorfmann","name":"Sebastian Korfmann"},"body":"It would be good to have common types for Terraform related resources, so we can use them within `cdktf`, `cdktf-cli` and the `terraform-cloud` client.\r\n\r\nThings which are coming to mind:\r\n\r\n- Terraform JSON output format (the stack)\r\n- Terraform Plan JSON\r\n- Provider Schema (the input for provider generation)\r\n\r\n\r\n_Originally mentioned by @jsteinich in https://github.com/hashicorp/terraform-cdk/pull/449#r556523773_","comments":[],"createdAt":"2021-01-13T20:51:20Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"},{"id":"MDU6TGFiZWwzMzE3NzI2NjM4","name":"tech-debt","description":"","color":"191658"}],"milestone":null,"number":492,"title":"Extract common Terraform JSON types","updatedAt":"2022-04-04T12:58:05Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjQ2MDEyNTI0","is_bot":false,"login":"neilkuan","name":"Neil Kuan"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\nStart to build L2 library like `@cdktf/aws` `@cdktf/azure` `@cdktf/gcloud`  ??\r\n\r\n### Description\r\n\r\nI think is time to build L2 library let `cdktf` more powerful.\r\n\r\n### References\r\n---\r\n## This is  ğŸš€ Feature Request\r\n","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDc1NTE1MDg5MQ==","author":{"login":"pahud"},"authorAssociation":"NONE","body":"What about L2s like:\r\n\r\n- @cdktf/aws-ec2\r\n- @cdktf/aws-eks\r\n- @cdktf/aws-ecs\r\n\r\nAnd then we have L2s for cdktf out-of-the-box. Any plans about this?\r\n","createdAt":"2021-01-06T08:08:54Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"ROCKET","users":{"totalCount":4}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/474#issuecomment-755150891","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc1Njc0NzYxMA==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"L2 / L3 constructs are certainly something which is on our radar. In the context of AWS, I still would love to somehow leverage what has been built for the AWS CDK already. There are a few ideas floating around how to make this happen, but none of them is really straightforward. There's another issue for AWS CDK compatibility as well - see https://github.com/hashicorp/terraform-cdk/issues/244\r\n\r\nThere are no immediate plans to start tackling this. However, generally speaking I think this is the topic which will have the biggest impact. \r\n\r\n@guan840912 / @pahud Out of curiosity: how would you approach this?","createdAt":"2021-01-08T13:09:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/474#issuecomment-756747610","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc464lAy","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Note for everyone stumbling on this issue: Alongside CDKTF 0.7 we released a first technical preview of the `AwsTerraformAdapter` ([docs](https://www.terraform.io/docs/cdktf/create-and-deploy/aws-adapter.html), [repo](https://github.com/hashicorp/cdktf-aws-cdk)) which enables you to use AWS CDK constructs with the CDK for Terraform. It is currently TypeScript only ([issue](https://github.com/hashicorp/cdktf-aws-cdk/issues/151)) and comes with [limitations](https://www.terraform.io/docs/cdktf/create-and-deploy/aws-adapter.html#known-limitations). Have a look at the [examples](https://github.com/hashicorp/cdktf-aws-cdk/tree/main/examples) or [docs](https://www.terraform.io/docs/cdktf/create-and-deploy/aws-adapter.html) if you're interested ğŸ‘€","createdAt":"2021-12-07T13:08:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/474#issuecomment-987910194","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc7CLU98","author":{"login":"vincenthsh"},"authorAssociation":"NONE","body":"This is late, but check out https://terraconstructs.dev","createdAt":"2025-09-05T09:47:50Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"ROCKET","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/474#issuecomment-3257749372","viewerDidAuthor":false}],"createdAt":"2021-01-06T08:05:32Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjk5ODU0MzY0","name":"abstractions (level 2 / level 3)","description":"","color":"279ebc"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"}],"milestone":null,"number":474,"title":"Start to build L2 library like @cdktf/aws @cdktf/azure @cdktf/gcloud  ??","updatedAt":"2025-09-05T09:47:50Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM4Njg3NTQ=","is_bot":false,"login":"jsteinich","name":"Jon Steinich"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nI'm starting to see two main groups of users:\r\n\r\n1. Those that see and use cdktf as a terraform configuration language generator\r\n2. Those that are looking to expose the full power of terraform through a programming language of their choice\r\n\r\nFor the 1st group, things mostly work as expected. There are a few bugs, not all hcl features are available, and there aren't yet higher level abstractions. This makes sense since cdktf quite literally generates the terraform configuration language json variant.\r\n\r\nThe 2nd group experiences quite a few issues since other than provided information, nothing is actually available at runtime. I think this is what someone without a CDK background or deeper knowledge of cdktf would expect. I also think that it is a completely reasonable expectation. That said, I would be very surprised if the terraform team actually had plans to control the terraform runtime via external languages (think replacing the jsii runtime with terraform).\r\n\r\nAssuming an actual terraform runtime is out of the question (seems like it), then I think we need to look for ways of emulating it:\r\n\r\nOne possible avenue is analyzing the syntax tree of the user code and converting to terraform json. This would basically be a very smart generator (still static configuration). A for loop could get translated into a count or a for each, etc. I have no doubt we could get a few simple cases working, but further support could be a very large and brittle project, not to mention that it would quite likely break down in more complex scenarios.\r\n\r\nHaving access to the multitude of functions built into hcl would go a long ways. These are commonly what are used in hcl to go beyond simple references and make it feel more dynamic. This is also sort of tangential to my main points, but since I brought it up, we should figure out mimicking intrinsic functions from AWS CDK is the way to go, or if having an order of magnitude more functions (+ arithmetic operations) means that a different approach is needed.\r\n\r\nOne of the most common areas that have common up is actually how to access a list (or set, or map, or complex object). We have `Tokens` which partially make that work. They are a bit buggy, so that doesn't help anything, but they are also incomplete (and in some ways never can fully handle possible goals). There's also a special case method for accessing a particular index from a list. Generating full wrapper types that track access and convert to for each loops and count index loops in terraform might get us far enough here. Admittedly, something as simple as printing a value or accessing the length in an integer for loop would still not work. Side note, there's also a bug where computed types don't even generate all of their properties.\r\n\r\nAnother possible route is building custom code to simply call various sdks during run time (synth time) to make information actually available. This really feels like building out functionality that terraform already has though. I can imagine building an intermediate layer that is made up of just data sources and ran through terraform. However, even data sources aren't always that simple. They can have dependencies on resources being built and such so that weren't starting to venture into build terraform outside of terraform in order to call terraform.\r\n\r\nI'd like to look towards AWS CDK for some guidance; however, terraform is by nature more dynamic than cloud formation, so we may need to forge our own path on a lot of this. A lot of thought and effort needs to go into solving these problems, but I'm confident the end result can be something very powerful and extremely useful.\r\n\r\nThis isn't meant to be a spec or a rant; just a brain dump that can hopefully serve as a starting point for some design conversations. I truly want this project to succeed. We just need to ask ourselves these hard questions to push the design forward.\r\n\r\n### References\r\n\r\n- https://github.com/hashicorp/terraform-cdk/issues/423\r\n- https://github.com/hashicorp/terraform-cdk/issues/430\r\n- https://github.com/hashicorp/terraform-cdk/issues/25\r\n- https://github.com/hashicorp/terraform-cdk/issues/288\r\n- https://github.com/hashicorp/terraform-cdk/issues/220\r\n- https://github.com/hashicorp/terraform-cdk/issues/172\r\n- https://github.com/hashicorp/terraform-cdk/issues/42\r\n- https://github.com/hashicorp/terraform-cdk/issues/434\r\n- https://github.com/hashicorp/terraform-cdk/issues/424\r\n- https://github.com/hashicorp/terraform-cdk/issues/374\r\n- https://github.com/hashicorp/terraform-cdk/issues/29\r\n- https://github.com/hashicorp/terraform-cdk/issues/287\r\n- https://github.com/hashicorp/terraform-cdk/issues/256\r\n- https://github.com/aws/jsii/issues/1841\r\n- https://github.com/aws/jsii/issues/1302\r\n- https://github.com/aws/jsii/issues/746\r\n- https://github.com/aws/jsii/issues/1\r\n","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDczMDM2MzYxNQ==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"Well, first and foremost cdktf is a generator for HCL compatible JSON and relies on Terraform for applying the configuration. As you correctly stated, making it really dynamic would involve customizing the Terraform runtime. \r\n\r\nBesides from this, a few bugs and other little issues, I think there are three major limitations which we have:\r\n\r\n1. jsii limits Typescript capabilities to a commonly supported feature set across all target languages\r\n2. Synth is a synchronous operation and makes it difficult to use most SDKs for data fetching (in TS / JS at least)\r\n3. Complex operations (loops, functions, etc) aren't abstracted\r\n\r\nI believe all points can be addressed, but need thorough thinking before implementation. \r\n\r\n\r\n","createdAt":"2020-11-19T13:08:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/435#issuecomment-730363615","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDczMjY0MDM1OQ==","author":{"login":"cmclaughlin"},"authorAssociation":"CONTRIBUTOR","body":"I'm happy with cdktf as a simple Python to HCL bridge... that's a major improvement for me and I'm very thankful for this project as it is.\r\n\r\nHowever, interacting with Terraform dynamically would be amazing. When I first got started with cdktf, that is what I expected. But it didn't take me long to understand what the constraints are and how to work with them. \r\n\r\nPreviously I experimented with Pulumi, but didn't get very far with it - I couldn't get past a few bugs that I thought were serious. However, their backend design seems really good - I think they wrote some sort of RPC server written in Go that provides an interface to Terraform, so the various client programming languages (Python, Typscript, etc) can interact with Terraform directly at runtime. \r\n\r\n\r\n\r\n","createdAt":"2020-11-24T04:08:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/435#issuecomment-732640359","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDczNTgxNzc5Nw==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> I think they wrote some sort of RPC server written in Go that provides an interface to Terraform, so the various client programming languages (Python, Typscript, etc) can interact with Terraform directly at runtime.\r\n\r\nHaven't looked at this in detail - but my understanding so far was, that they're using the Terraform providers via that [rpc protocol](https://github.com/hashicorp/terraform/tree/master/docs/plugin-protocol) and wrote their own engine. \r\n\r\n","createdAt":"2020-11-30T14:26:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/435#issuecomment-735817797","viewerDidAuthor":false}],"createdAt":"2020-11-19T03:40:03Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMDEzNzM4ODIw","name":"needs-research","description":"","color":"709F22"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"}],"milestone":null,"number":435,"title":"Making cdktf dynamic","updatedAt":"2021-07-02T19:24:09Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjIwODU0ODA1","is_bot":false,"login":"cesarpball","name":"CÃ©sar Prieto Ballester"},"body":"\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n\r\n### Description\r\n\r\nWould be nice if more examples are added to show the real potential of using CDK with Terraform like Python Inheritance \r\n\r\n\r\n\r\n### References\r\n\r\nNo references\r\n","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDcyOTcxMzEyMQ==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"Do you have a specific case in mind?","createdAt":"2020-11-18T14:25:57Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/432#issuecomment-729713121","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDcyOTkwNzg2Ng==","author":{"login":"cmclaughlin"},"authorAssociation":"CONTRIBUTOR","body":"I have a base class that extends `TerraformStack` where I setup Terraform state on S3 with DynamoDB locking - that way I don't have to do it in every stack. The bucket/table name is company-specific, but I suppose that's the sort of thing that you'd like in an example?  ","createdAt":"2020-11-18T19:36:32Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/432#issuecomment-729907866","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDczMDIxMjI0MQ==","author":{"login":"cesarpball"},"authorAssociation":"NONE","body":"> Do you have a specific case in mind?\r\n\r\nFor example, have the following structure:\r\n\r\n`Jenkinsfile  \r\nPipfile.lock \r\ncdktf.out    \r\nimports      \r\ntemplates\r\n  eks.py\r\n  iam.py\r\nPipfile     \r\ncdktf.json   \r\nhelp         \r\nmain.py`\r\n  \r\nThen in main.py\r\n\r\n`class MyStack (TerraformStack, EKSClass, IAMClass):`\r\n\r\nAnd use those class in the main one","createdAt":"2020-11-19T08:27:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/432#issuecomment-730212241","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDczMDIxMjM4Ng==","author":{"login":"cesarpball"},"authorAssociation":"NONE","body":"> I have a base class that extends `TerraformStack` where I setup Terraform state on S3 with DynamoDB locking - that way I don't have to do it in every stack. The bucket/table name is company-specific, but I suppose that's the sort of thing that you'd like in an example?\r\n\r\nThat would be a great way to point on the Documentation!","createdAt":"2020-11-19T08:27:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/432#issuecomment-730212386","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc1MzAwNTU1MA==","author":{"login":"bafonso"},"authorAssociation":"NONE","body":"> I have a base class that extends `TerraformStack` where I setup Terraform state on S3 with DynamoDB locking - that way I don't have to do it in every stack. The bucket/table name is company-specific, but I suppose that's the sort of thing that you'd like in an example?\r\n\r\n@cmclaughlin  I'd love to use this.. as of now I am still struggling with doing this the normal way :-D","createdAt":"2020-12-31T16:57:41Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/432#issuecomment-753005550","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc1NDUyOTg4MQ==","author":{"login":"teamdts"},"authorAssociation":"NONE","body":"expected below two example\r\n1. create Iam User , role , policy ,group, download iam user access key , credential\r\n2. create Ec2 instance , assign role,policy ,upload ssh key/generate ssh key , download key\r\n","createdAt":"2021-01-05T09:51:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/432#issuecomment-754529881","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc41UuuL","author":{"login":"1oglop1"},"authorAssociation":"NONE","body":"I've been also looking for examples with IAM because the AWS CDK IAM API is the main selling point for me. Especially when compared to what terraform/cloudformation offers right now.\r\nI was wondering if I could use libs from CDK that implement https://docs.aws.amazon.com/cdk/api/latest/docs/@aws-cdk_aws-iam.IGrantable.html instead of terraform specific libraries.","createdAt":"2021-08-07T08:51:30Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/432#issuecomment-894626699","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc41btL1","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> I've been also looking for examples with IAM because the AWS CDK IAM API is the main selling point for me. Especially when compared to what terraform/cloudformation offers right now.\r\n> I was wondering if I could use libs from CDK that implement https://docs.aws.amazon.com/cdk/api/latest/docs/@aws-cdk_aws-iam.IGrantable.html instead of terraform specific libraries.\r\n\r\nNot at this time. It is possible to use [iam floyd](https://iam-floyd.readthedocs.io/en/v0.225.0/index.html) by adding a small wrapper to your code.","createdAt":"2021-08-11T02:40:31Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/432#issuecomment-896455413","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc41imTA","author":{"login":"1oglop1"},"authorAssociation":"NONE","body":"> > I've been also looking for examples with IAM because the AWS CDK IAM API is the main selling point for me. Especially when compared to what terraform/cloudformation offers right now.\r\n> > I was wondering if I could use libs from CDK that implement https://docs.aws.amazon.com/cdk/api/latest/docs/@aws-cdk_aws-iam.IGrantable.html instead of terraform specific libraries.\r\n> \r\n> Not at this time. It is possible to use [iam floyd](https://iam-floyd.readthedocs.io/en/v0.225.0/index.html) by adding a small wrapper to your code.\r\n\r\nWow thank you, this is what I needed! I was hacking my own version with Pydantic but having someone who can dedicate the time developing this is great! ","createdAt":"2021-08-13T07:51:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/432#issuecomment-898262208","viewerDidAuthor":false}],"createdAt":"2020-11-18T11:51:37Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwxNzc1NzEyNzky","name":"good first issue","description":"Good for newcomers","color":"7057ff"},{"id":"MDU6TGFiZWwyMTEzNjU3MzA2","name":"language/python","description":"","color":"5c2596"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMjIzNzk4Mjg1","name":"size/small","description":"estimated < 1 day","color":"4671C0"}],"milestone":null,"number":432,"title":"More examples using inheritance in Python for CDKTF","updatedAt":"2023-01-10T15:50:00Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzMjEyNzY=","is_bot":false,"login":"damienpontifex","name":"Damien Pontifex"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nSearching around and I couldn't find an equivalent for [Current Workspace Interpolation](https://www.terraform.io/docs/state/workspaces.html#current-workspace-interpolation) in terraform-cdk. Currently we use this in terraform for environment suffixes and would be nice to transfer that capability across to our usage with cdktf\r\n","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDY5NDk1NjQ1Ng==","author":{"login":"cmclaughlin"},"authorAssociation":"CONTRIBUTOR","body":"I was chatting with @jsteinich about this yesterday... I was going to open an issue this morning, but you beat me to it :)\r\n\r\nNot sure if you're seeing the exact same thing as me, but there are situations where the cdktf-cli hangs when Terraform prompts about workspaces. Here's an example:\r\n\r\n```\r\n$ CDKTF_LOG_LEVEL=DEBUG TF_WORKSPACE=qa cdktf deploy\r\n[2020-09-17T15:40:32.112] [DEBUG] default - Terraform v0.12.29\r\n\r\n[2020-09-17T15:40:32.578] [DEBUG] default - + provider.aws v2.70.0\r\n\r\n[2020-09-17T15:40:32.579] [DEBUG] default -\r\nYour version of Terraform is out of date! The latest version\r\nis 0.13.2. You can update by downloading from https://www.terraform.io/downloads.html\r\n\r\nâ ¼ synthesizingÂ ...\r\n[2020-09-17T15:40:34.689] [DEBUG] default - REGION is not set. Defaulting to \"us-east-1\".\r\n\r\nâ ¹ initializingÂ my-stack-qa-us-east-1...\r\n[2020-09-17T15:40:35.369] [DEBUG] default - 2020/09/17 15:40:35 [DEBUG] Using modified User-Agent: Terraform/0.12.29 cdktf/0.0.17 (+https://github.com/hashicorp/terraform-cdk)\r\n\r\n2020/09/17 15:40:35 [DEBUG] Using modified User-Agent: Terraform/0.12.29 cdktf/0.0.17 (+https://github.com/hashicorp/teâ ¸ initializingÂ my-stack-qa-us-east-1...\r\n[2020-09-17T15:40:35.389] [DEBUG] default -\r\n\r\n[2020-09-17T15:40:35.389] [DEBUG] default - Initializing the backend...\r\nâ ¸ initializingÂ my-stack-qa-us-east-1...\r\n[2020-09-17T15:40:37.103] [DEBUG] default -\r\n\r\n[2020-09-17T15:40:37.103] [DEBUG] default - The currently selected workspace (qa) does not exist.\r\n  This is expected behavior when the selected workspace did not have an\r\n\r\n[2020-09-17T15:40:37.103] [DEBUG] default -   existing non-empty state. Please enter a number to select a workspace:\r\n\r\n  1. default\r\n\r\n[2020-09-17T15:40:37.103] [DEBUG] default -\r\nâ ´ initializingÂ my-stack-qa-us-east-1...\r\n# This hangs...\r\n```\r\n\r\nSorry to conflate these, but I think this is generally related to another problem I've seen initializing state with `cdktf deploy` - if there are changes to the state, Terraform prompts and cdktf-cli hangs on this too:\r\n\r\n\r\n```\r\n[2020-09-17T15:39:22.236] [DEBUG] default - Do you want to copy existing state to the new backend?\r\n\r\n[2020-09-17T15:39:22.236] [DEBUG] default -   Pre-existing state was found while migrating the previous \"s3\" backend to the\r\n\r\n[2020-09-17T15:39:22.236] [DEBUG] default -   newly configured \"s3\" backend. No existing state was found in the newly\r\n\r\n[2020-09-17T15:39:22.236] [DEBUG] default -   configured \"s3\" backend. Do you want to copy this state to the new \"s3\"\r\n\r\n[2020-09-17T15:39:22.236] [DEBUG] default -   backend? Enter \"yes\" to copy and \"no\" to start with an empty state.\r\n# This hangs\r\n```\r\n","createdAt":"2020-09-18T16:11:57Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/376#issuecomment-694956456","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDY5NTA1NDQ3MQ==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"@cmclaughlin \r\n\r\n> Sorry to conflate these, but I think this is generally related to another problem I've seen initializing state with `cdktf deploy` - if there are changes to the state, Terraform prompts and cdktf-cli hangs on this too:\r\n\r\nHm, I thought `-input=false` should have fixed these kind of issues (see here https://github.com/hashicorp/terraform-cdk/pull/343)\r\n\r\nWhich version are you running? ","createdAt":"2020-09-18T19:49:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/376#issuecomment-695054471","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDY5NTA1NTgxMg==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"@damienpontifex \r\n\r\n> Searching around and I couldn't find an equivalent for [Current Workspace Interpolation](https://www.terraform.io/docs/state/workspaces.html#current-workspace-interpolation) in terraform-cdk. Currently we use this in terraform for environment suffixes and would be nice to transfer that capability across to our usage with cdktf\r\n\r\nThe interpolation itself should just work:\r\n\r\n```ts\r\nnew Instance(this, 'aws instance', {\r\n  name:  \"web - ${terraform.workspace}\"\r\n})\r\n```\r\n\r\nCould you elaborate on the use-case you're trying to solve?","createdAt":"2020-09-18T19:52:58Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/376#issuecomment-695055812","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDY5NTA1NjA0MQ==","author":{"login":"cmclaughlin"},"authorAssociation":"CONTRIBUTOR","body":"Debug output shows I was using:\r\n\r\n```\r\n[DEBUG] Using modified User-Agent: Terraform/0.12.29 cdktf/0.0.17\r\n```\r\n\r\n","createdAt":"2020-09-18T19:53:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/376#issuecomment-695056041","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDY5NTA2NTU4Mg==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> Debug output shows I was using:\r\n> \r\n> ```\r\n> [DEBUG] Using modified User-Agent: Terraform/0.12.29 cdktf/0.0.17\r\n> ```\r\n\r\nHm, interesting. Well, that's something to investigate then, but it's probably a separate issue?","createdAt":"2020-09-18T20:16:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/376#issuecomment-695065582","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDY5NTc1Mjk2Mg==","author":{"login":"damienpontifex"},"authorAssociation":"NONE","body":"@skorfmann I understand the interpolation - maybe it's just that I couldn't find the `terraform` variable/global as appropriate to access this property as `${terraform.workspace}`.\r\n\r\nMy workaround was that I was setting up the `RemoteBackend` as below and if custom workspace needing run it as `WORKSPACE=ponti-dev cdktf deploy`\r\n\r\n```typescript\r\nconst workspaceName = process.env.WORKSPACE || 'dev'\r\nnew Instance(this, 'aws instance', {\r\n  name:  \"web - ${workspaceName}\"\r\n})\r\nnew RemoteBackend(stack, {\r\n  organization: 'pontifex',\r\n  workspaces: {\r\n    name: workspaceName\r\n  },\r\n});\r\n```\r\n\r\nThen I can reuse the `workspaceName` local. This works fine for our use cases. Probably I was looking to how some of our existing code would translate.\r\n\r\nJust seeing if this was the current recommended? Or similar to how we would do `terraform workspace select ponti-dev && terraform apply` is there an equivalent with `cdktf`","createdAt":"2020-09-20T06:53:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/376#issuecomment-695752962","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDY5NTc5NTQ2OQ==","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"@damienpontifex `TF_WORKSPACE` is supported by Terraform, but as @cmclaughlin noted, there are currently some issues with it.","createdAt":"2020-09-20T14:46:24Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/376#issuecomment-695795469","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDcwMzYwNDc5OQ==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"@damienpontifex what you're looking for is 1st class support Terraform workspaces in `cdktf`?","createdAt":"2020-10-05T12:39:55Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/376#issuecomment-703604799","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDcwNDYxNjEyNQ==","author":{"login":"damienpontifex"},"authorAssociation":"NONE","body":"Something like that @skorfmann. \r\nWe use workspace naming to differentiate developer environments from UAT and prod etc so use the naming for unique suffixes across resources. So we could adapt the `terraform.workspace` variable that's available in HCL terraform to something different here, just looking to see what was the recommended approach in Typescript. It might be that we do something like `const workspaceName = process.env.TF_WORKSPACE` if that's the recommended approach with `cdktf`","createdAt":"2020-10-07T00:05:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/376#issuecomment-704616125","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg0NjQwMDM1MQ==","author":{"login":"nick0lay"},"authorAssociation":"NONE","body":"We are using the following approach to access workspace in the code:\r\n```\r\nconst workspace = Token.asString(\"${terraform.workspace}\");\r\nnew Instance(this, `${workspace}-app-instance`, {\r\n  name:  \"Application instance\"\r\n})\r\n```","createdAt":"2021-05-22T12:19:03Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":8}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/376#issuecomment-846400351","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg0NzQ4NjQzMg==","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"This would be pretty simple to add after #525 is completed.","createdAt":"2021-05-25T02:39:13Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/376#issuecomment-847486432","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc42jRDg","author":{"login":"javier-caylent"},"authorAssociation":"NONE","body":"> We are using the following approach to access workspace in the code:\r\n> \r\n> ```\r\n> const workspace = Token.asString(\"${terraform.workspace}\");\r\n> new Instance(this, `${workspace}-app-instance`, {\r\n>   name:  \"Application instance\"\r\n> })\r\n> ```\r\n\r\nHi, on which folder are you executing the cdk synth command?, I mean in the cdktf.out folder or if you have an example about the folder structure to have this approach, I tried but the workspace that I'm getting is default","createdAt":"2021-09-08T12:56:19Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/376#issuecomment-915214560","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc42lNlR","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> Hi, on which folder are you executing the cdk synth command?, I mean in the cdktf.out folder or if you have an example about the folder structure to have this approach, I tried but the workspace that I'm getting is default\r\n\r\n`cdktf synth` won't actually know the workspace. It will just generate access to the interpolation. `cdktf diff/deploy` will be able to access it (assuming the workspace already exists), but it can be a bit tricky to setup. The simplest approach is probably using the `TF_WORKSPACE` environment variable (if workspace exists from elsewhere), or running Terraform commands directly if the workspace doesn't exist. Note that when running Terraform commands directly, you'll need to navigate to the specific stack directory.\r\n\r\nI think this is something that would be good to have better built in support for, but I'm not aware of any planned work as of yet.\r\n@javier-caylent how are you hoping to use workspaces?","createdAt":"2021-09-09T03:08:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/376#issuecomment-915724625","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc42l2Vb","author":{"login":"nick0lay"},"authorAssociation":"NONE","body":"> > We are using the following approach to access workspace in the code:\r\n> > ```\r\n> > const workspace = Token.asString(\"${terraform.workspace}\");\r\n> > new Instance(this, `${workspace}-app-instance`, {\r\n> >   name:  \"Application instance\"\r\n> > })\r\n> > ```\r\n> \r\n> Hi, on which folder are you executing the cdk synth command?, I mean in the cdktf.out folder or if you have an example about the folder structure to have this approach, I tried but the workspace that I'm getting is default\r\n\r\nHi @javier-caylent! Since CDKTF generate stack to run it with terraform it's important in which folder to run command to switch workspace, for example `terraform workspace new my_workspace`. Terraform put generated stacks in `cdktf.out/stacks`. For example if you have stack `my_stack` you can find generated assets in `cdktf.out/stacks/my_stack`, hence if you want to change workspace for `my_stack` you should navigate to `cdktf.out/stacks/my_stack` and switch to required workspace in this folder. After changing workspace you should see `cdktf.out/stacks/my_stack/.terraform/environment` following file created.\r\n\r\nThe full flow:\r\n1. `cdktf synth` - generate stack\r\n2. `cd cdktf.out/stacks/my_stack` - navigate to stack folder\r\n3. `terraform workspace new my_workspace` - switch to required workspace\r\n4. `cdktf deploy my_stack`\r\n\r\n","createdAt":"2021-09-09T08:51:14Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/376#issuecomment-915891547","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc42mtoR","author":{"login":"javier-caylent"},"authorAssociation":"NONE","body":"Awesome, You help me a lot with this information. Thank you very much!!! @nick0lay. ","createdAt":"2021-09-09T13:52:18Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/376#issuecomment-916118033","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc42o95z","author":{"login":"nick0lay"},"authorAssociation":"NONE","body":"> Awesome, You help me a lot with this information. Thank you very much!!! @nick0lay.\r\n\r\nWelcome!\r\n\r\nThere is one more thing which you might be aware of. Even though that you have access to workspace in `cdktf`, workspaces works differently in `terraform` and `cdktf` in terms of state isolation.\r\n\r\n**Terrafrom**\r\nIf you switch workspace to `my_workspace` terraform will save state to `terraform.tfstate.d/my_workspace/terraform.tfstate` it you switch workspace to  `my_new_workspace` hence new state will be saved to `project_root/terraform.tfstate.d/my_new_workspace/terraform.tfstate`\r\n\r\n**CDKTF**\r\nFor this case workspaces works a bit differently. If you switch workspace you will be able to see folder `project_root/cdktf.out/stacks/cdktf_example/terraform.tfstate.d/my_workspace` but `terraform.tfstate` won't be there. Instead `cdktf` create it in the following place `project_root/terraform.cdktf_example.tfstate` where `cdktf_example` is stack name.\r\n\r\n```\r\nconst app = new App();\r\nnew MyStack(app, \"cdktf_example\");\r\napp.synth();\r\n```\r\n\r\nHence when you use `cdktf` it's better separate states by creating different stacks rather than use workspaces. For example:\r\n\r\n```\r\nconst app = new App();\r\nnew MyStack(app, \"cdktf_example_stack\");\r\nnew MyStack(app, \"cdktf_example_test_stack\");\r\napp.synth();\r\n```\r\n\r\nBut switching workspace still might be useful if you use `cdktf` with `terraform` modules which rely on workspace variable `${terraform.workspace}` inside it.","createdAt":"2021-09-10T07:56:10Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/376#issuecomment-916708979","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc42pskH","author":{"login":"javier-caylent"},"authorAssociation":"NONE","body":"Hi @nick0lay\r\n\r\nhmm, got it, I think that we can \"emulate\" the ${terraform.workspace}, sending the environment for each stack and get the variables values in the same way.\r\n\r\nI'll test it and see, how works this approach and the s3 remote state (S3Backend) and where will be store the tfstate file for each stack.\r\n\r\n```\r\nfrom imports.my_compute_module import MyComputeModule\r\nfrom variables import Variables\r\n\r\nclass MyStackConfig(object):\r\n    def __init__(self, environment: str, region: str):\r\n        self.environment = environment\r\n        self.region = region \r\n\r\nclass MyStack(TerraformStack):\r\n    def __init__(self, scope: Construct, ns: str, config: MyStackConfig):\r\n        myec2 = MyComputeModule(self,\r\n            'my-ec2', \r\n            ami = Variables.get(\"ami\").get(config.environment),\r\n            instance_type = Variables.get(\"instance_type\").get(config.environment),\r\n            vpc_security_group_ids = Variables.get(\"vpc_security_group_ids\").get(config.environment),\r\n            subnet_id = Variables.get(\"vpc\").get(\"public_subnets_ids\").get(config.environment),\r\n            key_name = Variables.get(\"key_name\").get(config.environment),\r\n            additional_tags = { \"Name\": f\"python-{config.environment}\" }\r\n        )\r\n\r\napp = App();\r\nMyStack(app, \"cdktf_example_dev\", {\"environment\": \"dev\", \"region\": \"us-east-1\"});\r\nMyStack(app, \"cdktf_example_stg\", {\"environment\": \"stg\", \"region\": \"us-east-1\"});\r\napp.synth();\r\n\r\n```","createdAt":"2021-09-10T13:21:17Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/376#issuecomment-916900103","viewerDidAuthor":false}],"createdAt":"2020-09-18T10:10:40Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"MDU6TGFiZWwzMTM2MjkzOTA4","name":"core-parity","description":"Better experience in Terraform Core than CDKTF","color":"1A80B6"},{"id":"MDU6TGFiZWwzMjM2NDcwNTQ1","name":"feature/tokens","description":"","color":"58CF13"}],"milestone":null,"number":376,"title":"`terraform.workspace` equivalent","updatedAt":"2023-01-10T15:46:39Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzNjc4OQ==","is_bot":false,"login":"skorfmann","name":"Sebastian Korfmann"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nFor some constructs / resources allowing custom type coercions could be very useful to enable an idiomatic usage.\r\n\r\nFor `TerraformLocals` I think it would make sense to add the following to the Typescript classes.\r\n\r\n```ts\r\n    public toString(): string {\r\n        return this.asString\r\n    }\r\n```\r\n\r\nThis would allow to use it like `my-first-table-${local}` rather than `my-first-table-${local.asString}`.\r\n\r\nThe issue is, that this would only work for Typescript, but none of the other target languages. Python would look like this: `\"my-first-sns-topic-<cdktf.TerraformLocal object at 0x10cd45190>\"`\r\n\r\nIt doesn't look like, that Jsii is handling this automatically if there's `toString()` function defined. Defining the required method for Python in the Typescript class manually only works as `@internal` and therefore wouldn't be compiled via jsii. \r\n\r\n```ts\r\n /** @internal */\r\n    public __str__(): string {\r\n        return this.asString\r\n    }\r\n```\r\n\r\nI think there are more cases where this becomes relevant. In the best case this would be addressed in Jsii directly.\r\n\r\n### References\r\n\r\n- https://github.com/aws/jsii/issues/380\r\n- https://github.com/hashicorp/terraform-cdk/pull/357#pullrequestreview-483129573","comments":[],"createdAt":"2020-09-07T08:25:47Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjI4Mzg3NjY3","name":"cdktf","description":"","color":"fccac4"},{"id":"MDU6TGFiZWwyMjQ2NzM3OTc1","name":"upstream/jsii","description":"Pending upstream work on JSII","color":"f9a2cf"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"}],"milestone":null,"number":361,"title":"Allow Custom String Representation of Constructs","updatedAt":"2023-01-10T15:44:21Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEwODg2NTk3","is_bot":false,"login":"MalloZup","name":"Dario Maiocchi"},"body":"HI all,\r\n\r\nI was wondering if we have some guideline/doc and requirements for providers maintainer who want to support terraform-cdk for their provider.\r\n\r\nThank you","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDY3MzM0OTY5OQ==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"The way the provider bindings are generated are relying on the `terraform providers schema -json` command. As long as this works somehow, it should just work for any given provider. Since we're in an alpha stage, there might occur schema related issues (e.g. #290). We'll try to fix those issues rather quickly though.\r\n\r\nHave you tried it with the [libvirt provider](https://github.com/dmacvicar/terraform-provider-libvirt) and ran into issues?","createdAt":"2020-08-13T08:47:42Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/304#issuecomment-673349699","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDY3MzM2MzE5MQ==","author":{"login":"MalloZup"},"authorAssociation":"NONE","body":"@skorfmann many thanks! No I didn't tried it yet , I discovered cdk in these days and was curious to know how to integrate and see if there were any docs that I could follow for future","createdAt":"2020-08-13T09:14:15Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/304#issuecomment-673363191","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDY3MzM3MTExMA==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> @skorfmann many thanks! No I didn't tried it yet , I discovered cdk in these days and was curious to know how to integrate and see if there were any docs that I could follow for future\r\n\r\nHappy to help you out there, would be awesome to have an example for this scenario.","createdAt":"2020-08-13T09:29:52Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/304#issuecomment-673371110","viewerDidAuthor":false}],"createdAt":"2020-08-13T08:01:57Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzgw","name":"documentation","description":"Improvements or additions to documentation","color":"0075ca"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":304,"title":"DOC: is there any API/DOC for providers maintainer to support terraform-cdk?","updatedAt":"2023-06-28T18:29:45Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjE1MDA5NTIy","is_bot":false,"login":"Tirke","name":"Thomas Schersach"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n<!--- Please make note of the version you are using for the `hashicorp/terraform-cdk` and language bindings you are using.\r\nIf you are not running the latest version, please upgrade because your issue may have already been fixed. --->\r\n\r\n```\r\ncdktf --version\r\n0.0.13-pre.2f0b966cb25b6dc5066ee1551fdb32ff47a9c0fd\r\n```\r\n\r\n### Affected Resource(s)\r\n\r\n<!--- Please list the affected resources. --->\r\n State and state locks\r\n\r\n\r\n### Expected Behavior\r\n\r\n<!--- What should have happened? --->\r\nA way to escape a leaky abstraction of Terraform, directly with cdk-tf tooling. \r\nI don't see any way to manage a local state directly with the cdktf cli.\r\n\r\n### Actual Behavior\r\n\r\n<!--- What actually happened? --->\r\nI happened to have a state lock because I hard cancelled a deploy. Next deploy failed because of the lock. Manually deleting lock files didn't really work. The CLI didn't suggest any way to resolve the issue (I think Terraform actually helps you resolve locked states because of mistakes). \r\nI'm wondering if your aiming (for the future I know that this is alpha software) only for experienced Terraform devs or if this will be a tool that can fully abstract that it's all Terraform under doing the hard work (like Pulumi does).\r\nI'm really missing state commands like the ones in Terraform.\r\n\r\n### Steps to Reproduce\r\n\r\nHard cancel a deploy (with a local state) and try to deal with the lock.","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDY3MDY0NTE2MA==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> I happened to have a state lock because I hard cancelled a deploy. Next deploy failed because of the lock. Manually deleting lock files didn't really work. The CLI didn't suggest any way to resolve the issue (I think Terraform actually helps you resolve locked states because of mistakes).\r\n\r\nWe're wrapping the Terraform CLI and parse / filter the output of it. Right now we don't handle this particular use case. However, it's totally possible to fallback to the Terraform CLI itself in such cases.  \r\n\r\n> I'm wondering if your aiming (for the future I know that this is alpha software) only for experienced Terraform devs or if this will be a tool that can fully abstract that it's all Terraform under doing the hard work\r\n\r\nThe long term goal is certainly to provide a good level of abstraction, so that it's not mandatory to know how all the internals are working together. For the near future, it certainly helps to have a bit more context - in particular in error scenarios like this. \r\n\r\n> I'm really missing state commands like the ones in Terraform.\r\n\r\nWhile that's not our top priority right now, it'll certainly help to cover common use-cases in this area as well. As this is more like a feature request, would you mind if I relabel it as feature?","createdAt":"2020-08-07T18:14:29Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/294#issuecomment-670645160","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDcyMzY3ODk1MA==","author":{"login":"gvasquez95"},"authorAssociation":"NONE","body":"The same happened here, pressed `CTRL-C` while synthesizing and now I got a pending lock:\r\n\r\n```\r\nError: Error locking state: Error acquiring the state lock: ConditionalCheckFailedException: The conditional request failed\r\nLock Info:\r\n  ID:        df88a85e-b426-1d22-bae6-290c6a8c16de\r\n  Path:      terraform-jooycar/state/danlaw-vpc\r\n  Operation: OperationTypePlan\r\n  Who:       gonzalovasquez@ip-192-168-0-102.ec2.internal\r\n  Version:   0.13.4\r\n  Created:   2020-11-08 22:57:29.580825 +0000 UTC\r\n  Info:      \r\n\r\n\r\nTerraform acquires a state lock to protect the state from being written\r\nby multiple users at the same time. Please resolve the issue above and try\r\nagain. For most commands, you can disable locking with the \"-lock=false\"\r\nflag, but this is not recommended.\r\n```","createdAt":"2020-11-08T23:01:37Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/294#issuecomment-723678950","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDgyNDgyMDQzNA==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"I think we should try to gracefully cancel ongoing Terraform operations when `CTRL-C` is pressed. ","createdAt":"2021-04-22T13:00:51Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/294#issuecomment-824820434","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDgyNDgzNDM1MA==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"Related to https://github.com/hashicorp/terraform-cdk/issues/482","createdAt":"2021-04-22T13:18:47Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/294#issuecomment-824834350","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc42vFjq","author":{"login":"logusgraphics"},"authorAssociation":"NONE","body":"I'm completely stuck on this one. Anyone got a workaround?","createdAt":"2021-09-13T15:32:17Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/294#issuecomment-918313194","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc42vJes","author":{"login":"logusgraphics"},"authorAssociation":"NONE","body":"For anyone encountering this issue. I went to the DynamoDB table where the locks are stored and remove the lock manually. That helped me re-run `cdktf deploy <stack>` successfully.","createdAt":"2021-09-13T15:49:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"CONFUSED","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/294#issuecomment-918329260","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc44efG5","author":{"login":"akazakou-incomm"},"authorAssociation":"NONE","body":"Hey. I'm using `cdktf plan` in CI and each time it locking state for all CI jobs. Can I disable locking? Seems that `-lock=false` will not work with `cdktf` ?","createdAt":"2021-10-20T10:00:44Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/294#issuecomment-947515833","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc44hiwW","author":{"login":"ansgarm"},"authorAssociation":"MEMBER","body":"Hi @akazakou-incomm, currently that flag is not supported by the CDKTF CLI. But we're happy to take a [feature request](https://cdk.tf/feature) for that.\r\nA workaround in the meantime would be to do a `cdktf synth` in CI and then go to `cdktf.out/stacks/<your stack>` and invoke `terraform plan -lock=false` there instead.","createdAt":"2021-10-21T07:03:58Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":7}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/294#issuecomment-948317206","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5f5jkK","author":{"login":""},"authorAssociation":"NONE","body":"I'm using cdktf version 0.17.0, but since I started using GCS as a remote backend, I've been getting `Error acquiring the state lock` frequently.\r\n\r\n```txt\r\nxxx-function  Success! Terraform has updated the lock file.\r\n\r\n              Review the changes in .terraform.lock.hcl and then commit to your\r\n              version control system to retain the new checksums.\r\nxxx-network  Acquiring state lock. This may take a few moments...\r\nxxx-network  â•·\r\n             â”‚ Error: Error acquiring the state lock\r\n```","createdAt":"2023-06-27T07:10:19Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/294#issuecomment-1608923402","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5gAfaL","author":{"login":""},"authorAssociation":"NONE","body":"None of the methods worked, but I noticed that when deploying 3 or more stacks with the same prefix, an error occurred when retrieving the lock file.\r\n\r\nIf you think about it, if you rely on lock files for deployment integrity, I thought I was going to run into a read consistency problem with object storage, so I was able to solve it by changing the prefix for each stack.","createdAt":"2023-06-28T05:05:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/294#issuecomment-1610741387","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc55zBsv","author":{"login":"LozanoMatheus"},"authorAssociation":"NONE","body":"Hey,\r\n\r\nI also got stuck on this and tbh, I think this should be possible to do via CDKTF as well. In my understanding, the locking is a core feature in Terraform and it doesn't make sense to me to have all my code written in whatever language (Go, Typescript, etc), but if something goes wrong and it creates a locking, I'm forced to write a small TF/HCL code just to overcome this.\r\n\r\nTo fix this, I created a file called `empty_provider.tf` (content below) and executed the command `terraform force-unlock <LOCK_ID>`. I think this should be `cdktf force-unlock <LOCK_ID>` instead.\r\n\r\nIt's also good to point out that, it didn't take me much time to get the values below, but if it's an inexperienced person, this will for sure take a lot of time or if the person/team doesn't have control (or even access) to this configuration file.\r\n\r\nFile `empty_provider.tf` content:\r\n```hcl\r\nprovider \"aws\" {\r\n  region  = var.aws_region\r\n  profile = var.aws_profile\r\n}\r\n\r\nterraform {\r\n  required_version = \"~> 1\"\r\n  required_providers {\r\n    aws = \"> 5\"\r\n  }\r\n\r\n  backend \"s3\" {\r\n    profile          = \"<AWS_PROFILE>\"\r\n    region           = \"<AWS_REGION>\"\r\n    bucket           = \"<TERRAFORM_STATE_BUCKET>\"\r\n    dynamodb_table   = \"<TERRAFORM_STATE_DYNAMODB>\"\r\n    encrypt          = true\r\n    key              = \"<TERRAFORM_PATH>/terraform.tfstate\"\r\n    force_path_style = true\r\n  }\r\n}\r\n```","createdAt":"2024-04-08T18:35:06Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/294#issuecomment-2043419439","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc60jV6d","author":{"login":"jeremysprofile"},"authorAssociation":"NONE","body":"FWIW, for me it was surprisingly simple to handle in `terraform`. My error message:\n\n```\ndaily-ats  â•·\n           â”‚ Error: Error acquiring the state lock\n           â”‚\n           â”‚ Error message: operation error DynamoDB: PutItem, https response error\n           â”‚ StatusCode: 400, RequestID:\n           â”‚ SSIJDJ3USP393N8PF22I7B97SRVV4KQNSO5AEMVJF66Q9ASUAAJG,\n           â”‚ ConditionalCheckFailedException: The conditional request failed\n           â”‚ Lock Info:\n           â”‚   ID:        fcc18b1b-f683-1c17-33ee-01db0880808e\n           â”‚   Path:      XXXXXXXXXXXXXXXXXXXXXX\n           â”‚   Operation: OperationTypeApply\n           â”‚   Who:       XXXXXXXXXXXXXXXXXXXXXX\n           â”‚   Version:   1.6.4\n           â”‚   Created:   2025-05-12 16:38:44.378253 +0000 UTC\n           â”‚ Error: Error acquiring the state lock\n...\n```\n\nAll I had to do was \n```\ncd cdktf.out/stacks/daily-ats && \\\n  echo \"yes\" | terraform force-unlock fcc18b1b-f683-1c17-33ee-01db0880808e\n```\n\nto unlock so that I could `cdktf apply daily-ats`\n\n","createdAt":"2025-07-02T20:04:59Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/294#issuecomment-3029163677","viewerDidAuthor":false}],"createdAt":"2020-08-07T17:12:37Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjYwNjQ0NDQx","name":"cdktf-cli","description":"","color":"82e5de"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTM2MjkzOTA4","name":"core-parity","description":"Better experience in Terraform Core than CDKTF","color":"1A80B6"},{"id":"MDU6TGFiZWwzMjIzNzk4MjEz","name":"size/medium","description":"estimated < 1 week","color":"291E63"}],"milestone":null,"number":294,"title":"State locking and how to handle it","updatedAt":"2025-07-02T20:05:20Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzNjc4OQ==","is_bot":false,"login":"skorfmann","name":"Sebastian Korfmann"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### cdktf & Language Versions\r\n\r\n- ALL\r\n\r\n### Affected Resource(s)\r\n\r\n- Modules\r\n\r\n### Debug Output\r\n\r\nE.g the AWS VPC Module:\r\n\r\n```ts\r\npublic get publicSubnetsOutput(): string {\r\n    return this.interpolationForOutput('public_subnets')\r\n  }\r\n```\r\n\r\n### Expected Behavior\r\n\r\nThis should be treated as list of strings\r\n\r\n### Actual Behavior\r\n\r\nIt's treated as simple string\r\n\r\n### Steps to Reproduce\r\n\r\nImport VPC module and reference the output\r\n","comments":[{"id":"IC_kwDODd1Amc43Zucw","author":{"login":"orendain"},"authorAssociation":"NONE","body":"In the meantime, are there workarounds that are expected to work?\r\n\r\n@jsteinich wrote in #606:\r\n> You could try using `Token.asList` on the module output to workaround.\r\n\r\nIn my case, I have an output that should be recognized as an object w/ a couple of attributes.  I'm struggling to have it recognized as such.   Using `Token().as_any` will still result in `AttributeError: '<class 'cdktf._IResolvableProxy'>' object has no attribute 'my_attribute'` when synthesizing.","createdAt":"2021-09-28T17:54:12Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/287#issuecomment-929490736","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc43a5sd","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> In my case, I have an output that should be recognized as an object w/ a couple of attributes. I'm struggling to have it recognized as such. Using `Token().as_any` will still result in `AttributeError: '<class 'cdktf._IResolvableProxy'>' object has no attribute 'my_attribute'` when synthesizing.\r\n\r\nYou could manually construct hcl and use escape hatches, but probably easier to try to use `Fn.lookup`. Should just be able to pass the output directly, the name of the attribute, and a default value to the function.","createdAt":"2021-09-29T03:30:50Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/287#issuecomment-929798941","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5RiMnm","author":{"login":"c0deaddict"},"authorAssociation":"NONE","body":"I also encounter this bug using Python with the CDKTF and the VPC module. Is there any known workaround for Python? I tried `typing.cast(list[str], self.vpc.private_subnet_outputs)` but that doesn't change anything.\r\n\r\n*Update* Found it! `Token.as_list(self.vpc.private_subnet_outputs)` seems to work","createdAt":"2022-12-30T13:24:45Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/287#issuecomment-1367919078","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5fbExY","author":{"login":"josh-thisisbud"},"authorAssociation":"NONE","body":"This sort of thing needs to be documented.","createdAt":"2023-06-21T14:22:04Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":4}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/287#issuecomment-1600932952","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc6CTzz0","author":{"login":"starbuggx"},"authorAssociation":"NONE","body":"Token.as_list is working with a list from _output, but when I tried to get a target group arn from target_groups_output, the original output is string, but after I tried Token.as_list, Token.as_string_map(dict), I still cannot get the arn.","createdAt":"2024-06-24T10:34:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/287#issuecomment-2186231028","viewerDidAuthor":false}],"createdAt":"2020-08-06T13:21:39Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzc1","name":"bug","description":"Something isn't working","color":"d73a4a"},{"id":"MDU6TGFiZWwxNzc1NzEyNzk3","name":"help wanted","description":"Community contributions welcome as the core team is unlikely to work on this soon","color":"008672"},{"id":"MDU6TGFiZWwyMjE3NjIyNTkw","name":"modules","description":"","color":"2ffc8f"},{"id":"MDU6TGFiZWwzMTMwNzgyNzYx","name":"priority/backlog","description":"Low priority (though possibly still important). Unlikely to be worked on within the next 6 months.","color":"30649B"},{"id":"LA_kwDODd1Amc8AAAABH924aQ","name":"bug/has-workaround","description":"A bug with a workaround (may not be elegant)","color":"9e202d"}],"milestone":null,"number":287,"title":"All Module Outputs Typed as String","updatedAt":"2024-06-24T10:34:36Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjQwMjcwNTA1","is_bot":false,"login":"JayDoubleu","name":"Jay W"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\nIt would be very useful to have an API to interact with terraform cli (not cloud) from cdk.\r\n\r\nExample below:\r\n\r\n```python\r\napp = App()\r\nMyStack(app, \"automate-everything\")\r\nsynth = app.synth()\r\nplan = app.plan(synth)\r\n\r\nif plan.changes is not None:\r\n    if len(plan.changes.module.custom.fruits) > 4:\r\n       app.apply(synth, target='module.custom.fruits')\r\n```\r\n\r\n<!--- Please leave a helpful description of the feature request here. --->\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\nhttps://github.com/hashicorp/terraform-cdk/issues/225 \r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDY2MzE3NzYzNw==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"The general idea of this is quite appealing to me. \r\n\r\nHowever, At the moment, the `cdktf cli` is almost independent from a synthesized Stack. Means, it's really just interfacing with the Terraform CLI and interacting with the generated `plan` and the `stdout` / `stderr` output from it. \r\n\r\nIn the `cdktf cli`, we do have the `plan` at hand , `synth` isn't available as it's just doing a `terraform apply` in the `cdktf.out` directory. Means, as long as it's just about analyzing a plan and dynamically changing cli arguments, this could theoretically work within the current cli concept. However, I don't think this would be part of the `app`, more like some sort of hook in the CLI. Since the cli is just available in Typescript, it'd likely be Typescript code.\r\n\r\nI think a similar concept could work for https://github.com/hashicorp/terraform-cdk/issues/219","createdAt":"2020-07-23T18:59:27Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/237#issuecomment-663177637","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg2MTg1MTUwNQ==","author":{"login":"1mamute"},"authorAssociation":"NONE","body":"Maybe we can use [terraform-exec](https://github.com/hashicorp/terraform-exec) to interact with synthesized outputs from the stack?","createdAt":"2021-06-15T21:39:11Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/237#issuecomment-861851505","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg2MzA0MDQ2NA==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> Maybe we can use [terraform-exec](https://github.com/hashicorp/terraform-exec) to interact with synthesized outputs from the stack?\r\n\r\nSince terraform-exec is a go module, it's not the best fit for this project since it's mostly written in Typescript. We sort of built something similar in Typescript.\r\n","createdAt":"2021-06-17T08:26:33Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/237#issuecomment-863040464","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg2MzEyODU0Ng==","author":{"login":"1mamute"},"authorAssociation":"NONE","body":"> > Maybe we can use [terraform-exec](https://github.com/hashicorp/terraform-exec) to interact with synthesized outputs from the stack?\r\n> \r\n> Since terraform-exec is a go module, it's not the best fit for this project since it's mostly written in Typescript. We sort of built something similar in Typescript.\r\n\r\nMind sharing the link or is it not publicly avaiable?","createdAt":"2021-06-17T10:35:26Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/237#issuecomment-863128546","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg2NDUyMzkxNA==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"Was playing around with this a bit. While it requires the usage of JS / Typescript, it's sort of possible to drive synth and deploy / destroy bypassing the full `cdktf-cli` workflow. It's a bit clunky, but works. Please be aware, that this is using internal APIs of the `cdktf-cli` which might break without prior warning.\r\n\r\n### deploy \r\n\r\n```ts\r\nimport { SynthStack } from 'cdktf-cli/bin/cmds/helper/synth-stack';\r\nimport { TerraformCli } from 'cdktf-cli/bin/cmds/ui/models/terraform-cli';\r\n\r\nconst setup = async () => {\r\n  const stacks = await SynthStack.synth('node stack.js', 'cdktf.test.out');\r\n  const cli = new TerraformCli(stacks[0]);\r\n  await cli.init();\r\n  await cli.deploy('', (chunk: Buffer) => (console.log(chunk.toString('utf-8'))));\r\n}\r\n\r\n(async function() { await setup() } ());\r\n```\r\n\r\n### destroy\r\n\r\n```ts\r\nimport { SynthStack } from 'cdktf-cli/bin/cmds/helper/synth-stack';\r\nimport { TerraformCli } from 'cdktf-cli/bin/cmds/ui/models/terraform-cli';\r\n\r\nconst teardown = async () => {\r\n  const stacks = await SynthStack.synth('node stack.js', 'cdktf.test.out');\r\n  const cli = new TerraformCli(stacks[0]);\r\n  await cli.init();\r\n  await cli.destroy((chunk: Buffer) => (console.log(chunk.toString('utf-8'))));\r\n}\r\n\r\n(async function() { await teardown() } ());\r\n```\r\n\r\nI'm using this right now for driving automated test setups / teardowns. Since this skips generating the plan and is running headless, it's also a bit faster compared to using the `cdktf-cli` directly.\r\n","createdAt":"2021-06-20T09:14:36Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":13}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/237#issuecomment-864523914","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg2OTIwODMxMw==","author":{"login":"drandell"},"authorAssociation":"NONE","body":"@skorfmann I think this would be a great feature, it would mirror some of the functionality available in pulumi with its API. Is there a potential python approach to your sample? ","createdAt":"2021-06-27T18:45:48Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/237#issuecomment-869208313","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg3MDM2MTU1Ng==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"> Is there a potential python approach to your sample?\r\n\r\nSince the CLI is written in Typescript only, I don't think there's a similar way to do this right now - except for shelling out und using the cli directly. However, cross language support for programmatic interaction is something we'd like to address - but I can't give you an ETA on that.","createdAt":"2021-06-29T07:50:59Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/237#issuecomment-870361556","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDg3NDI5MDkxMA==","author":{"login":"drandell"},"authorAssociation":"NONE","body":"> > Is there a potential python approach to your sample?\r\n> \r\n> Since the CLI is written in Typescript only, I don't think there's a similar way to do this right now - except for shelling out und using the cli directly. However, cross language support for programmatic interaction is something we'd like to address - but I can't give you an ETA on that.\r\n\r\nTook a bit of time, but I managed to play around with JSII and add the necessary files into a local cdktf package, its not clear and I've probably brutalised it somewhat but I've got the following working in python;\r\n\r\n```python\r\ndef main():\r\n    app = App()\r\n    tfStack = MyStack(app, \"python-cdk\", GCP_PROJECT_NAME)\r\n    app.synth()\r\n    stack = SynthesizedStack(**tfStack.get_stack_args())\r\n    cli = TerraformCli(stack=stack)\r\n    print(cli.version())\r\n    # print(cli.init())\r\n    # plan = cli.plan()\r\n    # print(plan)\r\n    # print(cli.deploy())\r\n    # print(cli.destroy())\r\n```\r\nAnd running that produces;\r\n![image](https://user-images.githubusercontent.com/393945/124511366-dcf4d880-ddcd-11eb-8df6-a5aa465a9480.png)\r\n","createdAt":"2021-07-05T19:16:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"ROCKET","users":{"totalCount":5}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/237#issuecomment-874290910","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc48uHQ9","author":{"login":"kc-dot-io"},"authorAssociation":"CONTRIBUTOR","body":"Thanks for these examples @skorfmann! This is my new favorite way to use CDKTF. I'd love to see a more formal API...\r\n\r\nA few things from my experience that would help this...\r\n1) Better error handling with remote runners using try/catch or promise\r\n2) Better API for handing / templating response to stdin/stdout\r\n3) Ideally JSON events with lifecycle hooks would be great\r\n4) API support for multi-stack delpoyments / cross stack references\r\n\r\nLooking forward to seeing this evolve. This is the most excited I've been about IaC in a while.","createdAt":"2022-01-21T17:35:57Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"HEART","users":{"totalCount":6}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/237#issuecomment-1018721341","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc4-WIut","author":{"login":"danielloader"},"authorAssociation":"NONE","body":"Just to add to this issue, though it's not anything other than more justification:\r\nI'm looking to design a SaaS deployment project to deploy a simple Lambda Serverless stack with some auxiliary services, and for simplicity sakes was hoping I could utilise CDKTF in a Lambda function to deploy a new customer, patch/update it or delete a customer (fed off a DynamoDB table with streams for some audit log of infrastructure changes).\r\n\r\nPulumi works with the automation API but hesitant to commit to using it when both AWS CDK, and Terraform CDK are maturing and both offer advantages (already a Terraform Cloud customer at work and cloudformation state in AWS appeals in some scenarios). AWS CDK still doesn't have a programmatic interface, and the demo example from @drandell looks promising - though as cited, you'd want a formalised API before taking this into production.\r\n\r\nIdeally the interface would allow you to run a stack synth, stack deploy and then take the outputs from the resolved deployed stack to do something with (insertion into dynamo/webhooks for notification of deployment and triggering an email etc).","createdAt":"2022-02-19T10:53:53Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/237#issuecomment-1045990317","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc4-WPDa","author":{"login":"JayDoubleu"},"authorAssociation":"NONE","body":"@danielloader I've since fully moved on to pulumi automation API and I couldn't be happier. Not only I can do what you described (and more) but no longer have to deal with burdens of terraform itself ( fighting with provider bugs and new *features that completely change development workflow )\r\n\r\nI took me a while to convince myself to it but now I wouldn't go back even if those features would be implemented and the reason is because I finally realised that I was completely locked in to terraform, same way as many are trying to avoid vendor lock-in's but not realising terraform discretely managed to create another term ... Tooling lock in. \r\n\r\nOne think I did tho in pulumi is making myself completely independant of their cloud APIs ( for state files) but luckily automaton API allows you to do that.","createdAt":"2022-02-19T13:16:56Z","includesCreatedEdit":true,"isMinimized":true,"minimizedReason":"OFF_TOPIC","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/237#issuecomment-1046016218","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc4-Wdv7","author":{"login":"danielloader"},"authorAssociation":"NONE","body":"@JayDoubleu Sounds good, using Pulumi cloud for state or S3 etc? \r\nI do wonder if it ultimately if it matters what to use, to do the work - The only selling point for CDKTF for me is we're already using Terraform Cloud for state management - and I'd be happy to continue doing so with this functionality in AWS Lambda functions - it's just not formalised into a public API so can't risk it - though I guess the whole CDKTF API isn't formalised yet.","createdAt":"2022-02-19T18:18:41Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/237#issuecomment-1046076411","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc4-We7r","author":{"login":"JayDoubleu"},"authorAssociation":"NONE","body":"> using Pulumi cloud for state or S3 etc?\r\nI don't run any IaC code with third party solutions, I just don't like the idea of third parties having visibility into a state given it's sensitivity regardless of how \"strong\" they security or encryption would be. So yes, the answer is S3/Azure Blob storage.\r\n\r\nMy main selling point for pulumi is \"native\" providers. Meaning if it's out there available as API on Azure or AWS it's automatically available for you to use within automation. While terraform has a layer of providers and I find myself and other teams spending too much time \"maintaining\" and fixing bugs with providers/terraform rather than focusing on actual infrastructure. Also it's often that people are now recruiting the \"terraform\" experts with knowledge on how to fix bugs and work around terraform rather than general expert knowledge about programming/scripting language + infrastructure. With pulumi these problems do go away. In fact you can even build your own \"terraform\" like product with pulumi while you can't do it the other way around.","createdAt":"2022-02-19T18:45:51Z","includesCreatedEdit":true,"isMinimized":true,"minimizedReason":"OFF_TOPIC","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/237#issuecomment-1046081259","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc4-Zqpa","author":{"login":"danielloader"},"authorAssociation":"NONE","body":"As a follow up, Pulumi is agonisingly slow to resolve changes compared to CDKTF so guess I'll be hoping this \"automation API\" can be formalised soonish.\r\nGood job to Hashicorp.","createdAt":"2022-02-21T14:06:08Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/237#issuecomment-1046915674","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Vv2fr","author":{"login":"irfanjs"},"authorAssociation":"NONE","body":"Hi All,\r\nwhen can we see this feature release ? Any ETA please ? \r\nwe are seriously looking for API integration , how we can call this synth process (plan, apply and destroy) using sprintBoot ? \r\nwe are developing some JAVA API which will call terraform to deploy the EKS cluster in AWS . \r\nsomething like POST http://localhost/api/eks/create will hit the cdktf synth process and deploy the EKS cluster .\r\n\r\nplease suggest ","createdAt":"2023-02-21T14:43:21Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":3}},{"content":"EYES","users":{"totalCount":2}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/237#issuecomment-1438607339","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5nJcsu","author":{"login":"anamitra-saikia"},"authorAssociation":"NONE","body":"Hi all,\r\nIt will be fantastic to have this API feature in Terraform cdk.  Any estimated time for the development of this feature?\r\nAlso @skorfmann the bypass for cdktf-cli you mentioned is exactly what I was looking for but it is applicable for old versions of the cli. Could you show how to achieve the same in the current version of cdktf-cli?","createdAt":"2023-09-22T00:27:12Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/237#issuecomment-1730530094","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5nQDrX","author":{"login":"irfanjs"},"authorAssociation":"NONE","body":"@anamitra-saikia : No workaround yet  and havent implemented .\r\nStill waiting for this feature from Terraform-cdk ","createdAt":"2023-09-23T09:14:33Z","includesCreatedEdit":true,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/237#issuecomment-1732262615","viewerDidAuthor":false}],"createdAt":"2020-07-23T11:03:05Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMjIzNzk4MjUx","name":"size/large","description":"estimated < 1 month","color":"9559B0"},{"id":"LA_kwDODd1Amc7WpEvS","name":"ux/integration","description":"","color":"D670CB"},{"id":"LA_kwDODd1Amc7q-uL1","name":"feature/programmatic-api","description":"","color":"54AAC9"}],"milestone":null,"number":237,"title":"API to interact with terraform cli","updatedAt":"2023-09-23T09:15:58Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjEzNjc4OQ==","is_bot":false,"login":"skorfmann","name":"Sebastian Korfmann"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nRight now, the support of Terraform Modules is quite limited. Besides from only being available via the Terraform Registry, we parse the metadata only. From that metadata, the type information is derived and a Construct class for that Module interface is created. When synthesized, it ends up being treated as a classical Terraform module where Terraform will fetch the actual module source code.\r\n\r\nThere are a few drawbacks to this from my point of view:\r\n\r\n- Special handing is required when parsing output (e.g. see #113)\r\n- Resources in the module are hidden from the `constructs` tree \r\n  - No dynamic changes to these resources (e.g. thinking of tagging aspects)\r\n  - No way of accessing this in unit tests\r\n  - Supportive tooling will likely be limited (e.g. #189)\r\n\r\n#### Proposal \r\n\r\nA Terraform module could be fully transformed into a Construct and enable the use-cases described above. A prerequisite for this to happen would be:\r\n\r\n- A `hcl2cdktf` tool\r\n- Full coverage of the HCL syntax in `cdktf`","comments":[{"id":"MDEyOklzc3VlQ29tbWVudDY3ODQ4MTkzMg==","author":{"login":"thesurlydev"},"authorAssociation":"NONE","body":"@skorfmann Would this enable using a module such as the following?\r\n```\r\nmodule \"api_gateway_cors_proxy\" {\r\n  source = \"github.com/kyeotic/terraform-api-gateway-cors-module.git?ref=1.1\"\r\n  resource_id = aws_api_gateway_resource.proxy.id\r\n  rest_api_id = aws_api_gateway_rest_api.rest_api.id\r\n}\r\n```\r\nI'm trying to determine which of the issues here. Thanks.\r\n","createdAt":"2020-08-21T20:36:12Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/231#issuecomment-678481932","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDY3ODUyOTAzMA==","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"@digitalsanctum I think what you're after is covered by #16.\r\nThis is going farther and converting a terraform module into a construct tree. Writing in code would look very similar to using a terraform module in hcl, but the generated terraform json would actually just contain all of the resources that would have been in the module.","createdAt":"2020-08-21T21:42:07Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[{"content":"THUMBS_UP","users":{"totalCount":1}}],"url":"https://github.com/hashicorp/terraform-cdk/issues/231#issuecomment-678529030","viewerDidAuthor":false},{"id":"MDEyOklzc3VlQ29tbWVudDc5MTQ5MjQxNA==","author":{"login":"skorfmann"},"authorAssociation":"CONTRIBUTOR","body":"While working on #522 I stumbled upon [this](https://www.terraform.io/docs/language/modules/sources.html#modules-in-package-sub-directories) regarding submodules.\r\n\r\n>Terraform will still extract the entire package to local disk, but will read the module from the subdirectory. As a result, it is safe for a module in a sub-directory of a package to use a local path to another module as long as it is in the same package.\r\n\r\nThat's something to keep in mind here.\r\n\r\n","createdAt":"2021-03-05T15:30:53Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/231#issuecomment-791492414","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5JFBvf","author":{"login":"benkeil"},"authorAssociation":"NONE","body":"Could we add in the meantime a `Testing.toHaveResourceWithProperties` method to test at least the input of a module?","createdAt":"2022-08-24T17:57:23Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/231#issuecomment-1226054623","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Jrp1l","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> Could we add in the meantime a `Testing.toHaveResourceWithProperties` method to test at least the input of a module?\r\n\r\nUnfortunately modules aren't compatible with how the tests work as the module contents aren't part of the cdktf output.\r\n\r\nExtracting the information from Terraform would either involve doing everything needed to implement this or some tricky workarounds with reading existing state and planned changes.","createdAt":"2022-09-03T18:44:09Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/231#issuecomment-1236180325","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5Jrp5J","author":{"login":"benkeil"},"authorAssociation":"NONE","body":"But I have the input of the module in the Synth output. Thatâ€™s better than nothing. ","createdAt":"2022-09-03T18:45:35Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/231#issuecomment-1236180553","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5JrqME","author":{"login":"jsteinich"},"authorAssociation":"COLLABORATOR","body":"> But I have the input of the module in the Synth output. Thatâ€™s better than nothing.\r\n\r\nAh, I'd probably opt for having a `Testing.toHaveModuleWithProperties` to clarify that it is checking something different than resources (could also have a `Testing.toHaveConstructWithProperties` for more general checking). Definitely possible to add something like that.","createdAt":"2022-09-03T18:54:02Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/231#issuecomment-1236181764","viewerDidAuthor":false},{"id":"IC_kwDODd1Amc5JrqQr","author":{"login":"benkeil"},"authorAssociation":"NONE","body":"Sounds good. I think about to write an extension for kotest","createdAt":"2022-09-03T18:56:28Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/231#issuecomment-1236182059","viewerDidAuthor":false}],"createdAt":"2020-07-22T14:21:09Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwzMTMwNzgzNDMx","name":"priority/important-longterm","description":"Medium priority, to be worked on within the following 1-2 business quarters.","color":"5CC9C1"},{"id":"MDU6TGFiZWwzMTg1Mzg1NTQ2","name":"feature/convert","description":"","color":"d93f0b"},{"id":"LA_kwDODd1Amc7KX5aA","name":"theme/construct-ecosystem","description":"","color":"5E568C"}],"milestone":null,"number":231,"title":"Transform Modules to Constructs","updatedAt":"2023-06-01T15:22:10Z"},{"assignees":[],"author":{"id":"MDQ6VXNlcjM4Njg3NTQ=","is_bot":false,"login":"jsteinich","name":"Jon Steinich"},"body":"<!--- Please keep this note for the community --->\r\n\r\n### Community Note\r\n\r\n* Please vote on this issue by adding a ğŸ‘ [reaction](https://blog.github.com/2016-03-10-add-reactions-to-pull-requests-issues-and-comments/) to the original issue to help the community and maintainers prioritize this request\r\n* Please do not leave \"+1\" or other comments that do not add relevant new information or questions, they generate extra noise for issue followers and do not help prioritize the request\r\n* If you are interested in working on this issue or have submitted a pull request, please leave a comment\r\n\r\n<!--- Thank you for keeping this note for the community --->\r\n\r\n### Description\r\n\r\nAutomatically build and publish generated libraries for every verified module on the terraform registry.\r\nThis would allow for easier quick starts and faster synths for users wanting to use supported modules.\r\nI'm imagining an action that would run every day and check for new versions.\r\n\r\n<!--- Information about code formatting: https://help.github.com/articles/basic-writing-and-formatting-syntax/#quoting-code --->\r\n\r\n### References\r\n\r\nCould possibly share some implementation work with https://github.com/hashicorp/terraform-cdk/issues/98\r\nSupported list can even be dynamic: https://www.terraform.io/docs/registry/api.html#list-modules\r\n<!---\r\nInformation about referencing Github Issues: https://help.github.com/articles/basic-writing-and-formatting-syntax/#referencing-issues-and-pull-requests\r\n\r\nAre there any other GitHub issues (open or closed) or pull requests that should be linked here? Vendor blog posts or documentation?\r\n--->\r\n","comments":[{"id":"IC_kwDODd1Amc5du7pz","author":{"login":"xiehan"},"authorAssociation":"MEMBER","body":"We've discussed this recently among the team and just the ~50 prebuilt providers that we currently publish have been a huge effort to maintain, to the point where it's almost one person's full-time job _just_ to stay on top of keeping those CI pipelines running smoothly. As much as we'd like to, we can't scale out to all providers, and expanding this to include modules as well is basically out of the question at this point. The team also feels like there are diminishing returns for our efforts here because modules are typically very small compared to providers. For the large providers like AWS and Azure, yes, the performance improvements are significant and worthwhile. For modules, it won't make nearly as big of a dent in synth times.","createdAt":"2023-06-01T18:33:25Z","includesCreatedEdit":false,"isMinimized":false,"minimizedReason":"","reactionGroups":[],"url":"https://github.com/hashicorp/terraform-cdk/issues/195#issuecomment-1572584051","viewerDidAuthor":false}],"createdAt":"2020-07-16T23:21:53Z","labels":[{"id":"MDU6TGFiZWwxNzc1NzEyNzg3","name":"enhancement","description":"New feature or request","color":"a2eeef"},{"id":"MDU6TGFiZWwyMjE3NjIyNTkw","name":"modules","description":"","color":"2ffc8f"},{"id":"MDU6TGFiZWwzMTMwNzgzMjI1","name":"priority/awaiting-more-evidence","description":"Lowest priority. Unlikely to be worked on unless/until it gets a lot more upvotes.","color":"CBD1C1"},{"id":"MDU6TGFiZWwzMTM2Mjc5MjMx","name":"ux/configuration","description":"","color":"58FCA0"}],"milestone":null,"number":195,"title":"Prebuild Verified Module Packages","updatedAt":"2023-06-01T18:33:25Z"}]
